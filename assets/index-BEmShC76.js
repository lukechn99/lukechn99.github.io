function wS(s,a){for(var h=0;h<a.length;h++){const g=a[h];if(typeof g!="string"&&!Array.isArray(g)){for(const S in g)if(S!=="default"&&!(S in s)){const A=Object.getOwnPropertyDescriptor(g,S);A&&Object.defineProperty(s,S,A.get?A:{enumerable:!0,get:()=>g[S]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const S of document.querySelectorAll('link[rel="modulepreload"]'))g(S);new MutationObserver(S=>{for(const A of S)if(A.type==="childList")for(const w of A.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&g(w)}).observe(document,{childList:!0,subtree:!0});function h(S){const A={};return S.integrity&&(A.integrity=S.integrity),S.referrerPolicy&&(A.referrerPolicy=S.referrerPolicy),S.crossOrigin==="use-credentials"?A.credentials="include":S.crossOrigin==="anonymous"?A.credentials="omit":A.credentials="same-origin",A}function g(S){if(S.ep)return;S.ep=!0;const A=h(S);fetch(S.href,A)}})();function Ry(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var S0={exports:{}},ny={};var Hx;function TS(){if(Hx)return ny;Hx=1;var s=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function h(g,S,A){var w=null;if(A!==void 0&&(w=""+A),S.key!==void 0&&(w=""+S.key),"key"in S){A={};for(var c in S)c!=="key"&&(A[c]=S[c])}else A=S;return S=A.ref,{$$typeof:s,type:g,key:w,ref:S!==void 0?S:null,props:A}}return ny.Fragment=a,ny.jsx=h,ny.jsxs=h,ny}var Xx;function SS(){return Xx||(Xx=1,S0.exports=TS()),S0.exports}var rt=SS(),M0={exports:{}},Bi={};var Yx;function MS(){if(Yx)return Bi;Yx=1;var s=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),w=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),N=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),ae=Symbol.iterator;function ue(ze){return ze===null||typeof ze!="object"?null:(ze=ae&&ze[ae]||ze["@@iterator"],typeof ze=="function"?ze:null)}var ge={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fe=Object.assign,ce={};function qe(ze,dt,It){this.props=ze,this.context=dt,this.refs=ce,this.updater=It||ge}qe.prototype.isReactComponent={},qe.prototype.setState=function(ze,dt){if(typeof ze!="object"&&typeof ze!="function"&&ze!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ze,dt,"setState")},qe.prototype.forceUpdate=function(ze){this.updater.enqueueForceUpdate(this,ze,"forceUpdate")};function Fe(){}Fe.prototype=qe.prototype;function Ne(ze,dt,It){this.props=ze,this.context=dt,this.refs=ce,this.updater=It||ge}var Be=Ne.prototype=new Fe;Be.constructor=Ne,fe(Be,qe.prototype),Be.isPureReactComponent=!0;var Pe=Array.isArray;function $e(){}var Qe={H:null,A:null,T:null,S:null},Et=Object.prototype.hasOwnProperty;function Ut(ze,dt,It){var zt=It.ref;return{$$typeof:s,type:ze,key:dt,ref:zt!==void 0?zt:null,props:It}}function $t(ze,dt){return Ut(ze.type,dt,ze.props)}function hi(ze){return typeof ze=="object"&&ze!==null&&ze.$$typeof===s}function li(ze){var dt={"=":"=0",":":"=2"};return"$"+ze.replace(/[=:]/g,function(It){return dt[It]})}var nn=/\/+/g;function Ci(ze,dt){return typeof ze=="object"&&ze!==null&&ze.key!=null?li(""+ze.key):dt.toString(36)}function Qi(ze){switch(ze.status){case"fulfilled":return ze.value;case"rejected":throw ze.reason;default:switch(typeof ze.status=="string"?ze.then($e,$e):(ze.status="pending",ze.then(function(dt){ze.status==="pending"&&(ze.status="fulfilled",ze.value=dt)},function(dt){ze.status==="pending"&&(ze.status="rejected",ze.reason=dt)})),ze.status){case"fulfilled":return ze.value;case"rejected":throw ze.reason}}throw ze}function lt(ze,dt,It,zt,Dt){var kt=typeof ze;(kt==="undefined"||kt==="boolean")&&(ze=null);var fi=!1;if(ze===null)fi=!0;else switch(kt){case"bigint":case"string":case"number":fi=!0;break;case"object":switch(ze.$$typeof){case s:case a:fi=!0;break;case H:return fi=ze._init,lt(fi(ze._payload),dt,It,zt,Dt)}}if(fi)return Dt=Dt(ze),fi=zt===""?"."+Ci(ze,0):zt,Pe(Dt)?(It="",fi!=null&&(It=fi.replace(nn,"$&/")+"/"),lt(Dt,dt,It,"",function(hr){return hr})):Dt!=null&&(hi(Dt)&&(Dt=$t(Dt,It+(Dt.key==null||ze&&ze.key===Dt.key?"":(""+Dt.key).replace(nn,"$&/")+"/")+fi)),dt.push(Dt)),1;fi=0;var Ei=zt===""?".":zt+":";if(Pe(ze))for(var rn=0;rn<ze.length;rn++)zt=ze[rn],kt=Ei+Ci(zt,rn),fi+=lt(zt,dt,It,kt,Dt);else if(rn=ue(ze),typeof rn=="function")for(ze=rn.call(ze),rn=0;!(zt=ze.next()).done;)zt=zt.value,kt=Ei+Ci(zt,rn++),fi+=lt(zt,dt,It,kt,Dt);else if(kt==="object"){if(typeof ze.then=="function")return lt(Qi(ze),dt,It,zt,Dt);throw dt=String(ze),Error("Objects are not valid as a React child (found: "+(dt==="[object Object]"?"object with keys {"+Object.keys(ze).join(", ")+"}":dt)+"). If you meant to render a collection of children, use an array instead.")}return fi}function Pt(ze,dt,It){if(ze==null)return ze;var zt=[],Dt=0;return lt(ze,zt,"","",function(kt){return dt.call(It,kt,Dt++)}),zt}function Mt(ze){if(ze._status===-1){var dt=ze._result;dt=dt(),dt.then(function(It){(ze._status===0||ze._status===-1)&&(ze._status=1,ze._result=It)},function(It){(ze._status===0||ze._status===-1)&&(ze._status=2,ze._result=It)}),ze._status===-1&&(ze._status=0,ze._result=dt)}if(ze._status===1)return ze._result.default;throw ze._result}var ei=typeof reportError=="function"?reportError:function(ze){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var dt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ze=="object"&&ze!==null&&typeof ze.message=="string"?String(ze.message):String(ze),error:ze});if(!window.dispatchEvent(dt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ze);return}console.error(ze)},Nt={map:Pt,forEach:function(ze,dt,It){Pt(ze,function(){dt.apply(this,arguments)},It)},count:function(ze){var dt=0;return Pt(ze,function(){dt++}),dt},toArray:function(ze){return Pt(ze,function(dt){return dt})||[]},only:function(ze){if(!hi(ze))throw Error("React.Children.only expected to receive a single React element child.");return ze}};return Bi.Activity=K,Bi.Children=Nt,Bi.Component=qe,Bi.Fragment=h,Bi.Profiler=S,Bi.PureComponent=Ne,Bi.StrictMode=g,Bi.Suspense=k,Bi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Qe,Bi.__COMPILER_RUNTIME={__proto__:null,c:function(ze){return Qe.H.useMemoCache(ze)}},Bi.cache=function(ze){return function(){return ze.apply(null,arguments)}},Bi.cacheSignal=function(){return null},Bi.cloneElement=function(ze,dt,It){if(ze==null)throw Error("The argument must be a React element, but you passed "+ze+".");var zt=fe({},ze.props),Dt=ze.key;if(dt!=null)for(kt in dt.key!==void 0&&(Dt=""+dt.key),dt)!Et.call(dt,kt)||kt==="key"||kt==="__self"||kt==="__source"||kt==="ref"&&dt.ref===void 0||(zt[kt]=dt[kt]);var kt=arguments.length-2;if(kt===1)zt.children=It;else if(1<kt){for(var fi=Array(kt),Ei=0;Ei<kt;Ei++)fi[Ei]=arguments[Ei+2];zt.children=fi}return Ut(ze.type,Dt,zt)},Bi.createContext=function(ze){return ze={$$typeof:w,_currentValue:ze,_currentValue2:ze,_threadCount:0,Provider:null,Consumer:null},ze.Provider=ze,ze.Consumer={$$typeof:A,_context:ze},ze},Bi.createElement=function(ze,dt,It){var zt,Dt={},kt=null;if(dt!=null)for(zt in dt.key!==void 0&&(kt=""+dt.key),dt)Et.call(dt,zt)&&zt!=="key"&&zt!=="__self"&&zt!=="__source"&&(Dt[zt]=dt[zt]);var fi=arguments.length-2;if(fi===1)Dt.children=It;else if(1<fi){for(var Ei=Array(fi),rn=0;rn<fi;rn++)Ei[rn]=arguments[rn+2];Dt.children=Ei}if(ze&&ze.defaultProps)for(zt in fi=ze.defaultProps,fi)Dt[zt]===void 0&&(Dt[zt]=fi[zt]);return Ut(ze,kt,Dt)},Bi.createRef=function(){return{current:null}},Bi.forwardRef=function(ze){return{$$typeof:c,render:ze}},Bi.isValidElement=hi,Bi.lazy=function(ze){return{$$typeof:H,_payload:{_status:-1,_result:ze},_init:Mt}},Bi.memo=function(ze,dt){return{$$typeof:N,type:ze,compare:dt===void 0?null:dt}},Bi.startTransition=function(ze){var dt=Qe.T,It={};Qe.T=It;try{var zt=ze(),Dt=Qe.S;Dt!==null&&Dt(It,zt),typeof zt=="object"&&zt!==null&&typeof zt.then=="function"&&zt.then($e,ei)}catch(kt){ei(kt)}finally{dt!==null&&It.types!==null&&(dt.types=It.types),Qe.T=dt}},Bi.unstable_useCacheRefresh=function(){return Qe.H.useCacheRefresh()},Bi.use=function(ze){return Qe.H.use(ze)},Bi.useActionState=function(ze,dt,It){return Qe.H.useActionState(ze,dt,It)},Bi.useCallback=function(ze,dt){return Qe.H.useCallback(ze,dt)},Bi.useContext=function(ze){return Qe.H.useContext(ze)},Bi.useDebugValue=function(){},Bi.useDeferredValue=function(ze,dt){return Qe.H.useDeferredValue(ze,dt)},Bi.useEffect=function(ze,dt){return Qe.H.useEffect(ze,dt)},Bi.useEffectEvent=function(ze){return Qe.H.useEffectEvent(ze)},Bi.useId=function(){return Qe.H.useId()},Bi.useImperativeHandle=function(ze,dt,It){return Qe.H.useImperativeHandle(ze,dt,It)},Bi.useInsertionEffect=function(ze,dt){return Qe.H.useInsertionEffect(ze,dt)},Bi.useLayoutEffect=function(ze,dt){return Qe.H.useLayoutEffect(ze,dt)},Bi.useMemo=function(ze,dt){return Qe.H.useMemo(ze,dt)},Bi.useOptimistic=function(ze,dt){return Qe.H.useOptimistic(ze,dt)},Bi.useReducer=function(ze,dt,It){return Qe.H.useReducer(ze,dt,It)},Bi.useRef=function(ze){return Qe.H.useRef(ze)},Bi.useState=function(ze){return Qe.H.useState(ze)},Bi.useSyncExternalStore=function(ze,dt,It){return Qe.H.useSyncExternalStore(ze,dt,It)},Bi.useTransition=function(){return Qe.H.useTransition()},Bi.version="19.2.3",Bi}var Wx;function Ib(){return Wx||(Wx=1,M0.exports=MS()),M0.exports}var ct=Ib();const Lb=Ry(ct),ES=wS({__proto__:null,default:Lb},[ct]);var E0={exports:{}},ry={},A0={exports:{}},C0={};var Kx;function AS(){return Kx||(Kx=1,(function(s){function a(lt,Pt){var Mt=lt.length;lt.push(Pt);e:for(;0<Mt;){var ei=Mt-1>>>1,Nt=lt[ei];if(0<S(Nt,Pt))lt[ei]=Pt,lt[Mt]=Nt,Mt=ei;else break e}}function h(lt){return lt.length===0?null:lt[0]}function g(lt){if(lt.length===0)return null;var Pt=lt[0],Mt=lt.pop();if(Mt!==Pt){lt[0]=Mt;e:for(var ei=0,Nt=lt.length,ze=Nt>>>1;ei<ze;){var dt=2*(ei+1)-1,It=lt[dt],zt=dt+1,Dt=lt[zt];if(0>S(It,Mt))zt<Nt&&0>S(Dt,It)?(lt[ei]=Dt,lt[zt]=Mt,ei=zt):(lt[ei]=It,lt[dt]=Mt,ei=dt);else if(zt<Nt&&0>S(Dt,Mt))lt[ei]=Dt,lt[zt]=Mt,ei=zt;else break e}}return Pt}function S(lt,Pt){var Mt=lt.sortIndex-Pt.sortIndex;return Mt!==0?Mt:lt.id-Pt.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var A=performance;s.unstable_now=function(){return A.now()}}else{var w=Date,c=w.now();s.unstable_now=function(){return w.now()-c}}var k=[],N=[],H=1,K=null,ae=3,ue=!1,ge=!1,fe=!1,ce=!1,qe=typeof setTimeout=="function"?setTimeout:null,Fe=typeof clearTimeout=="function"?clearTimeout:null,Ne=typeof setImmediate<"u"?setImmediate:null;function Be(lt){for(var Pt=h(N);Pt!==null;){if(Pt.callback===null)g(N);else if(Pt.startTime<=lt)g(N),Pt.sortIndex=Pt.expirationTime,a(k,Pt);else break;Pt=h(N)}}function Pe(lt){if(fe=!1,Be(lt),!ge)if(h(k)!==null)ge=!0,$e||($e=!0,li());else{var Pt=h(N);Pt!==null&&Qi(Pe,Pt.startTime-lt)}}var $e=!1,Qe=-1,Et=5,Ut=-1;function $t(){return ce?!0:!(s.unstable_now()-Ut<Et)}function hi(){if(ce=!1,$e){var lt=s.unstable_now();Ut=lt;var Pt=!0;try{e:{ge=!1,fe&&(fe=!1,Fe(Qe),Qe=-1),ue=!0;var Mt=ae;try{t:{for(Be(lt),K=h(k);K!==null&&!(K.expirationTime>lt&&$t());){var ei=K.callback;if(typeof ei=="function"){K.callback=null,ae=K.priorityLevel;var Nt=ei(K.expirationTime<=lt);if(lt=s.unstable_now(),typeof Nt=="function"){K.callback=Nt,Be(lt),Pt=!0;break t}K===h(k)&&g(k),Be(lt)}else g(k);K=h(k)}if(K!==null)Pt=!0;else{var ze=h(N);ze!==null&&Qi(Pe,ze.startTime-lt),Pt=!1}}break e}finally{K=null,ae=Mt,ue=!1}Pt=void 0}}finally{Pt?li():$e=!1}}}var li;if(typeof Ne=="function")li=function(){Ne(hi)};else if(typeof MessageChannel<"u"){var nn=new MessageChannel,Ci=nn.port2;nn.port1.onmessage=hi,li=function(){Ci.postMessage(null)}}else li=function(){qe(hi,0)};function Qi(lt,Pt){Qe=qe(function(){lt(s.unstable_now())},Pt)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(lt){lt.callback=null},s.unstable_forceFrameRate=function(lt){0>lt||125<lt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Et=0<lt?Math.floor(1e3/lt):5},s.unstable_getCurrentPriorityLevel=function(){return ae},s.unstable_next=function(lt){switch(ae){case 1:case 2:case 3:var Pt=3;break;default:Pt=ae}var Mt=ae;ae=Pt;try{return lt()}finally{ae=Mt}},s.unstable_requestPaint=function(){ce=!0},s.unstable_runWithPriority=function(lt,Pt){switch(lt){case 1:case 2:case 3:case 4:case 5:break;default:lt=3}var Mt=ae;ae=lt;try{return Pt()}finally{ae=Mt}},s.unstable_scheduleCallback=function(lt,Pt,Mt){var ei=s.unstable_now();switch(typeof Mt=="object"&&Mt!==null?(Mt=Mt.delay,Mt=typeof Mt=="number"&&0<Mt?ei+Mt:ei):Mt=ei,lt){case 1:var Nt=-1;break;case 2:Nt=250;break;case 5:Nt=1073741823;break;case 4:Nt=1e4;break;default:Nt=5e3}return Nt=Mt+Nt,lt={id:H++,callback:Pt,priorityLevel:lt,startTime:Mt,expirationTime:Nt,sortIndex:-1},Mt>ei?(lt.sortIndex=Mt,a(N,lt),h(k)===null&&lt===h(N)&&(fe?(Fe(Qe),Qe=-1):fe=!0,Qi(Pe,Mt-ei))):(lt.sortIndex=Nt,a(k,lt),ge||ue||(ge=!0,$e||($e=!0,li()))),lt},s.unstable_shouldYield=$t,s.unstable_wrapCallback=function(lt){var Pt=ae;return function(){var Mt=ae;ae=Pt;try{return lt.apply(this,arguments)}finally{ae=Mt}}}})(C0)),C0}var Jx;function CS(){return Jx||(Jx=1,A0.exports=AS()),A0.exports}var P0={exports:{}},ws={};var Qx;function PS(){if(Qx)return ws;Qx=1;var s=Ib();function a(k){var N="https://react.dev/errors/"+k;if(1<arguments.length){N+="?args[]="+encodeURIComponent(arguments[1]);for(var H=2;H<arguments.length;H++)N+="&args[]="+encodeURIComponent(arguments[H])}return"Minified React error #"+k+"; visit "+N+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function h(){}var g={d:{f:h,r:function(){throw Error(a(522))},D:h,C:h,L:h,m:h,X:h,S:h,M:h},p:0,findDOMNode:null},S=Symbol.for("react.portal");function A(k,N,H){var K=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:S,key:K==null?null:""+K,children:k,containerInfo:N,implementation:H}}var w=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(k,N){if(k==="font")return"";if(typeof N=="string")return N==="use-credentials"?N:""}return ws.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=g,ws.createPortal=function(k,N){var H=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N||N.nodeType!==1&&N.nodeType!==9&&N.nodeType!==11)throw Error(a(299));return A(k,N,null,H)},ws.flushSync=function(k){var N=w.T,H=g.p;try{if(w.T=null,g.p=2,k)return k()}finally{w.T=N,g.p=H,g.d.f()}},ws.preconnect=function(k,N){typeof k=="string"&&(N?(N=N.crossOrigin,N=typeof N=="string"?N==="use-credentials"?N:"":void 0):N=null,g.d.C(k,N))},ws.prefetchDNS=function(k){typeof k=="string"&&g.d.D(k)},ws.preinit=function(k,N){if(typeof k=="string"&&N&&typeof N.as=="string"){var H=N.as,K=c(H,N.crossOrigin),ae=typeof N.integrity=="string"?N.integrity:void 0,ue=typeof N.fetchPriority=="string"?N.fetchPriority:void 0;H==="style"?g.d.S(k,typeof N.precedence=="string"?N.precedence:void 0,{crossOrigin:K,integrity:ae,fetchPriority:ue}):H==="script"&&g.d.X(k,{crossOrigin:K,integrity:ae,fetchPriority:ue,nonce:typeof N.nonce=="string"?N.nonce:void 0})}},ws.preinitModule=function(k,N){if(typeof k=="string")if(typeof N=="object"&&N!==null){if(N.as==null||N.as==="script"){var H=c(N.as,N.crossOrigin);g.d.M(k,{crossOrigin:H,integrity:typeof N.integrity=="string"?N.integrity:void 0,nonce:typeof N.nonce=="string"?N.nonce:void 0})}}else N==null&&g.d.M(k)},ws.preload=function(k,N){if(typeof k=="string"&&typeof N=="object"&&N!==null&&typeof N.as=="string"){var H=N.as,K=c(H,N.crossOrigin);g.d.L(k,H,{crossOrigin:K,integrity:typeof N.integrity=="string"?N.integrity:void 0,nonce:typeof N.nonce=="string"?N.nonce:void 0,type:typeof N.type=="string"?N.type:void 0,fetchPriority:typeof N.fetchPriority=="string"?N.fetchPriority:void 0,referrerPolicy:typeof N.referrerPolicy=="string"?N.referrerPolicy:void 0,imageSrcSet:typeof N.imageSrcSet=="string"?N.imageSrcSet:void 0,imageSizes:typeof N.imageSizes=="string"?N.imageSizes:void 0,media:typeof N.media=="string"?N.media:void 0})}},ws.preloadModule=function(k,N){if(typeof k=="string")if(N){var H=c(N.as,N.crossOrigin);g.d.m(k,{as:typeof N.as=="string"&&N.as!=="script"?N.as:void 0,crossOrigin:H,integrity:typeof N.integrity=="string"?N.integrity:void 0})}else g.d.m(k)},ws.requestFormReset=function(k){g.d.r(k)},ws.unstable_batchedUpdates=function(k,N){return k(N)},ws.useFormState=function(k,N,H){return w.H.useFormState(k,N,H)},ws.useFormStatus=function(){return w.H.useHostTransitionStatus()},ws.version="19.2.3",ws}var e1;function Vw(){if(e1)return P0.exports;e1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(a){console.error(a)}}return s(),P0.exports=PS(),P0.exports}var t1;function zS(){if(t1)return ry;t1=1;var s=CS(),a=Ib(),h=Vw();function g(r){var l="https://react.dev/errors/"+r;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)l+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+r+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function S(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function A(r){var l=r,m=r;if(r.alternate)for(;l.return;)l=l.return;else{r=l;do l=r,(l.flags&4098)!==0&&(m=l.return),r=l.return;while(r)}return l.tag===3?m:null}function w(r){if(r.tag===13){var l=r.memoizedState;if(l===null&&(r=r.alternate,r!==null&&(l=r.memoizedState)),l!==null)return l.dehydrated}return null}function c(r){if(r.tag===31){var l=r.memoizedState;if(l===null&&(r=r.alternate,r!==null&&(l=r.memoizedState)),l!==null)return l.dehydrated}return null}function k(r){if(A(r)!==r)throw Error(g(188))}function N(r){var l=r.alternate;if(!l){if(l=A(r),l===null)throw Error(g(188));return l!==r?null:r}for(var m=r,T=l;;){var I=m.return;if(I===null)break;var B=I.alternate;if(B===null){if(T=I.return,T!==null){m=T;continue}break}if(I.child===B.child){for(B=I.child;B;){if(B===m)return k(I),r;if(B===T)return k(I),l;B=B.sibling}throw Error(g(188))}if(m.return!==T.return)m=I,T=B;else{for(var J=!1,he=I.child;he;){if(he===m){J=!0,m=I,T=B;break}if(he===T){J=!0,T=I,m=B;break}he=he.sibling}if(!J){for(he=B.child;he;){if(he===m){J=!0,m=B,T=I;break}if(he===T){J=!0,T=B,m=I;break}he=he.sibling}if(!J)throw Error(g(189))}}if(m.alternate!==T)throw Error(g(190))}if(m.tag!==3)throw Error(g(188));return m.stateNode.current===m?r:l}function H(r){var l=r.tag;if(l===5||l===26||l===27||l===6)return r;for(r=r.child;r!==null;){if(l=H(r),l!==null)return l;r=r.sibling}return null}var K=Object.assign,ae=Symbol.for("react.element"),ue=Symbol.for("react.transitional.element"),ge=Symbol.for("react.portal"),fe=Symbol.for("react.fragment"),ce=Symbol.for("react.strict_mode"),qe=Symbol.for("react.profiler"),Fe=Symbol.for("react.consumer"),Ne=Symbol.for("react.context"),Be=Symbol.for("react.forward_ref"),Pe=Symbol.for("react.suspense"),$e=Symbol.for("react.suspense_list"),Qe=Symbol.for("react.memo"),Et=Symbol.for("react.lazy"),Ut=Symbol.for("react.activity"),$t=Symbol.for("react.memo_cache_sentinel"),hi=Symbol.iterator;function li(r){return r===null||typeof r!="object"?null:(r=hi&&r[hi]||r["@@iterator"],typeof r=="function"?r:null)}var nn=Symbol.for("react.client.reference");function Ci(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===nn?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case fe:return"Fragment";case qe:return"Profiler";case ce:return"StrictMode";case Pe:return"Suspense";case $e:return"SuspenseList";case Ut:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case ge:return"Portal";case Ne:return r.displayName||"Context";case Fe:return(r._context.displayName||"Context")+".Consumer";case Be:var l=r.render;return r=r.displayName,r||(r=l.displayName||l.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Qe:return l=r.displayName||null,l!==null?l:Ci(r.type)||"Memo";case Et:l=r._payload,r=r._init;try{return Ci(r(l))}catch{}}return null}var Qi=Array.isArray,lt=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pt=h.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Mt={pending:!1,data:null,method:null,action:null},ei=[],Nt=-1;function ze(r){return{current:r}}function dt(r){0>Nt||(r.current=ei[Nt],ei[Nt]=null,Nt--)}function It(r,l){Nt++,ei[Nt]=r.current,r.current=l}var zt=ze(null),Dt=ze(null),kt=ze(null),fi=ze(null);function Ei(r,l){switch(It(kt,l),It(Dt,r),It(zt,null),l.nodeType){case 9:case 11:r=(r=l.documentElement)&&(r=r.namespaceURI)?ip(r):0;break;default:if(r=l.tagName,l=l.namespaceURI)l=ip(l),r=um(l,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}dt(zt),It(zt,r)}function rn(){dt(zt),dt(Dt),dt(kt)}function hr(r){r.memoizedState!==null&&It(fi,r);var l=zt.current,m=um(l,r.type);l!==m&&(It(Dt,r),It(zt,m))}function _o(r){Dt.current===r&&(dt(zt),dt(Dt)),fi.current===r&&(dt(fi),sp._currentValue=Mt)}var Mr,as;function Rn(r){if(Mr===void 0)try{throw Error()}catch(m){var l=m.stack.trim().match(/\n( *(at )?)/);Mr=l&&l[1]||"",as=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Mr+r+as}var Jr=!1;function wa(r,l){if(!r||Jr)return"";Jr=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var T={DetermineComponentFrameRoot:function(){try{if(l){var St=function(){throw Error()};if(Object.defineProperty(St.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(St,[])}catch(ht){var st=ht}Reflect.construct(r,[],St)}else{try{St.call()}catch(ht){st=ht}r.call(St.prototype)}}else{try{throw Error()}catch(ht){st=ht}(St=r())&&typeof St.catch=="function"&&St.catch(function(){})}}catch(ht){if(ht&&st&&typeof ht.stack=="string")return[ht.stack,st.stack]}return[null,null]}};T.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var I=Object.getOwnPropertyDescriptor(T.DetermineComponentFrameRoot,"name");I&&I.configurable&&Object.defineProperty(T.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var B=T.DetermineComponentFrameRoot(),J=B[0],he=B[1];if(J&&he){var De=J.split(`
`),at=he.split(`
`);for(I=T=0;T<De.length&&!De[T].includes("DetermineComponentFrameRoot");)T++;for(;I<at.length&&!at[I].includes("DetermineComponentFrameRoot");)I++;if(T===De.length||I===at.length)for(T=De.length-1,I=at.length-1;1<=T&&0<=I&&De[T]!==at[I];)I--;for(;1<=T&&0<=I;T--,I--)if(De[T]!==at[I]){if(T!==1||I!==1)do if(T--,I--,0>I||De[T]!==at[I]){var yt=`
`+De[T].replace(" at new "," at ");return r.displayName&&yt.includes("<anonymous>")&&(yt=yt.replace("<anonymous>",r.displayName)),yt}while(1<=T&&0<=I);break}}}finally{Jr=!1,Error.prepareStackTrace=m}return(m=r?r.displayName||r.name:"")?Rn(m):""}function Cn(r,l){switch(r.tag){case 26:case 27:case 5:return Rn(r.type);case 16:return Rn("Lazy");case 13:return r.child!==l&&l!==null?Rn("Suspense Fallback"):Rn("Suspense");case 19:return Rn("SuspenseList");case 0:case 15:return wa(r.type,!1);case 11:return wa(r.type.render,!1);case 1:return wa(r.type,!0);case 31:return Rn("Activity");default:return""}}function La(r){try{var l="",m=null;do l+=Cn(r,m),m=r,r=r.return;while(r);return l}catch(T){return`
Error generating stack: `+T.message+`
`+T.stack}}var ko=Object.prototype.hasOwnProperty,Oo=s.unstable_scheduleCallback,no=s.unstable_cancelCallback,vo=s.unstable_shouldYield,wl=s.unstable_requestPaint,Rr=s.unstable_now,Da=s.unstable_getCurrentPriorityLevel,Ve=s.unstable_ImmediatePriority,ne=s.unstable_UserBlockingPriority,ie=s.unstable_NormalPriority,de=s.unstable_LowPriority,Ee=s.unstable_IdlePriority,Le=s.log,Ye=s.unstable_setDisableYieldValue,je=null,Re=null;function We(r){if(typeof Le=="function"&&Ye(r),Re&&typeof Re.setStrictMode=="function")try{Re.setStrictMode(je,r)}catch{}}var mt=Math.clz32?Math.clz32:Kt,pt=Math.log,Vt=Math.LN2;function Kt(r){return r>>>=0,r===0?32:31-(pt(r)/Vt|0)|0}var di=256,en=262144,Fi=4194304;function Ze(r){var l=r&42;if(l!==0)return l;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ln(r,l,m){var T=r.pendingLanes;if(T===0)return 0;var I=0,B=r.suspendedLanes,J=r.pingedLanes;r=r.warmLanes;var he=T&134217727;return he!==0?(T=he&~B,T!==0?I=Ze(T):(J&=he,J!==0?I=Ze(J):m||(m=he&~r,m!==0&&(I=Ze(m))))):(he=T&~B,he!==0?I=Ze(he):J!==0?I=Ze(J):m||(m=T&~r,m!==0&&(I=Ze(m)))),I===0?0:l!==0&&l!==I&&(l&B)===0&&(B=I&-I,m=l&-l,B>=m||B===32&&(m&4194048)!==0)?l:I}function dr(r,l){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&l)===0}function gi(r,l){switch(r){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function un(){var r=Fi;return Fi<<=1,(Fi&62914560)===0&&(Fi=4194304),r}function Er(r){for(var l=[],m=0;31>m;m++)l.push(r);return l}function an(r,l){r.pendingLanes|=l,l!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function nr(r,l,m,T,I,B){var J=r.pendingLanes;r.pendingLanes=m,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=m,r.entangledLanes&=m,r.errorRecoveryDisabledLanes&=m,r.shellSuspendCounter=0;var he=r.entanglements,De=r.expirationTimes,at=r.hiddenUpdates;for(m=J&~m;0<m;){var yt=31-mt(m),St=1<<yt;he[yt]=0,De[yt]=-1;var st=at[yt];if(st!==null)for(at[yt]=null,yt=0;yt<st.length;yt++){var ht=st[yt];ht!==null&&(ht.lane&=-536870913)}m&=~St}T!==0&&_n(r,T,0),B!==0&&I===0&&r.tag!==0&&(r.suspendedLanes|=B&~(J&~l))}function _n(r,l,m){r.pendingLanes|=l,r.suspendedLanes&=~l;var T=31-mt(l);r.entangledLanes|=l,r.entanglements[T]=r.entanglements[T]|1073741824|m&261930}function fr(r,l){var m=r.entangledLanes|=l;for(r=r.entanglements;m;){var T=31-mt(m),I=1<<T;I&l|r[T]&l&&(r[T]|=l),m&=~I}}function du(r,l){var m=l&-l;return m=(m&42)!==0?1:ha(m),(m&(r.suspendedLanes|l))!==0?0:m}function ha(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function et(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Qr(){var r=Pt.p;return r!==0?r:(r=window.event,r===void 0?32:k_(r.type))}function ea(r,l){var m=Pt.p;try{return Pt.p=r,l()}finally{Pt.p=m}}var bo=Math.random().toString(36).slice(2),vn="__reactFiber$"+bo,At="__reactProps$"+bo,yi="__reactContainer$"+bo,pi="__reactEvents$"+bo,Ra="__reactListeners$"+bo,Bc="__reactHandles$"+bo,os="__reactResources$"+bo,_i="__reactMarker$"+bo;function Tl(r){delete r[vn],delete r[At],delete r[pi],delete r[Ra],delete r[Bc]}function Bo(r){var l=r[vn];if(l)return l;for(var m=r.parentNode;m;){if(l=m[yi]||m[vn]){if(m=l.alternate,l.child!==null||m!==null&&m.child!==null)for(r=id(r);r!==null;){if(m=r[vn])return m;r=id(r)}return l}r=m,m=r.parentNode}return null}function Ts(r){if(r=r[vn]||r[yi]){var l=r.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return r}return null}function ro(r){var l=r.tag;if(l===5||l===26||l===27||l===6)return r.stateNode;throw Error(g(33))}function ss(r){var l=r[os];return l||(l=r[os]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Xn(r){r[_i]=!0}var fu=new Set,da={};function Vi(r,l){Fo(r,l),Fo(r+"Capture",l)}function Fo(r,l){for(da[r]=l,r=0;r<l.length;r++)fu.add(l[r])}var ls=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Sl={},Ss={};function Ta(r){return ko.call(Ss,r)?!0:ko.call(Sl,r)?!1:ls.test(r)?Ss[r]=!0:(Sl[r]=!0,!1)}function Gi(r,l,m){if(Ta(l))if(m===null)r.removeAttribute(l);else{switch(typeof m){case"undefined":case"function":case"symbol":r.removeAttribute(l);return;case"boolean":var T=l.toLowerCase().slice(0,5);if(T!=="data-"&&T!=="aria-"){r.removeAttribute(l);return}}r.setAttribute(l,""+m)}}function on(r,l,m){if(m===null)r.removeAttribute(l);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttribute(l,""+m)}}function Sa(r,l,m,T){if(T===null)r.removeAttribute(m);else{switch(typeof T){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(m);return}r.setAttributeNS(l,m,""+T)}}function Li(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Ks(r){var l=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Fc(r,l,m){var T=Object.getOwnPropertyDescriptor(r.constructor.prototype,l);if(!r.hasOwnProperty(l)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var I=T.get,B=T.set;return Object.defineProperty(r,l,{configurable:!0,get:function(){return I.call(this)},set:function(J){m=""+J,B.call(this,J)}}),Object.defineProperty(r,l,{enumerable:T.enumerable}),{getValue:function(){return m},setValue:function(J){m=""+J},stopTracking:function(){r._valueTracker=null,delete r[l]}}}}function Ti(r){if(!r._valueTracker){var l=Ks(r)?"checked":"value";r._valueTracker=Fc(r,l,""+r[l])}}function Yn(r){if(!r)return!1;var l=r._valueTracker;if(!l)return!0;var m=l.getValue(),T="";return r&&(T=Ks(r)?r.checked?"true":"false":r.value),r=T,r!==m?(l.setValue(r),!0):!1}function Ml(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Zu=/[\n"\\]/g;function kn(r){return r.replace(Zu,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function qu(r,l,m,T,I,B,J,he){r.name="",J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"?r.type=J:r.removeAttribute("type"),l!=null?J==="number"?(l===0&&r.value===""||r.value!=l)&&(r.value=""+Li(l)):r.value!==""+Li(l)&&(r.value=""+Li(l)):J!=="submit"&&J!=="reset"||r.removeAttribute("value"),l!=null?No(r,J,Li(l)):m!=null?No(r,J,Li(m)):T!=null&&r.removeAttribute("value"),I==null&&B!=null&&(r.defaultChecked=!!B),I!=null&&(r.checked=I&&typeof I!="function"&&typeof I!="symbol"),he!=null&&typeof he!="function"&&typeof he!="symbol"&&typeof he!="boolean"?r.name=""+Li(he):r.removeAttribute("name")}function El(r,l,m,T,I,B,J,he){if(B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(r.type=B),l!=null||m!=null){if(!(B!=="submit"&&B!=="reset"||l!=null)){Ti(r);return}m=m!=null?""+Li(m):"",l=l!=null?""+Li(l):m,he||l===r.value||(r.value=l),r.defaultValue=l}T=T??I,T=typeof T!="function"&&typeof T!="symbol"&&!!T,r.checked=he?r.checked:!!T,r.defaultChecked=!!T,J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"&&(r.name=J),Ti(r)}function No(r,l,m){l==="number"&&Ml(r.ownerDocument)===r||r.defaultValue===""+m||(r.defaultValue=""+m)}function Pn(r,l,m,T){if(r=r.options,l){l={};for(var I=0;I<m.length;I++)l["$"+m[I]]=!0;for(m=0;m<r.length;m++)I=l.hasOwnProperty("$"+r[m].value),r[m].selected!==I&&(r[m].selected=I),I&&T&&(r[m].defaultSelected=!0)}else{for(m=""+Li(m),l=null,I=0;I<r.length;I++){if(r[I].value===m){r[I].selected=!0,T&&(r[I].defaultSelected=!0);return}l!==null||r[I].disabled||(l=r[I])}l!==null&&(l.selected=!0)}}function Js(r,l,m){if(l!=null&&(l=""+Li(l),l!==r.value&&(r.value=l),m==null)){r.defaultValue!==l&&(r.defaultValue=l);return}r.defaultValue=m!=null?""+Li(m):""}function us(r,l,m,T){if(l==null){if(T!=null){if(m!=null)throw Error(g(92));if(Qi(T)){if(1<T.length)throw Error(g(93));T=T[0]}m=T}m==null&&(m=""),l=m}m=Li(l),r.defaultValue=m,T=r.textContent,T===m&&T!==""&&T!==null&&(r.value=T),Ti(r)}function ao(r,l){if(l){var m=r.firstChild;if(m&&m===r.lastChild&&m.nodeType===3){m.nodeValue=l;return}}r.textContent=l}var Nc=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function jo(r,l,m){var T=l.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?T?r.setProperty(l,""):l==="float"?r.cssFloat="":r[l]="":T?r.setProperty(l,m):typeof m!="number"||m===0||Nc.has(l)?l==="float"?r.cssFloat=m:r[l]=(""+m).trim():r[l]=m+"px"}function pu(r,l,m){if(l!=null&&typeof l!="object")throw Error(g(62));if(r=r.style,m!=null){for(var T in m)!m.hasOwnProperty(T)||l!=null&&l.hasOwnProperty(T)||(T.indexOf("--")===0?r.setProperty(T,""):T==="float"?r.cssFloat="":r[T]="");for(var I in l)T=l[I],l.hasOwnProperty(I)&&m[I]!==T&&jo(r,I,T)}else for(var B in l)l.hasOwnProperty(B)&&jo(r,B,l[B])}function Ms(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Uo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Qs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xi(r){return Qs.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function ka(){}var jc=null;function Al(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Ar=null,ii=null;function Xi(r){var l=Ts(r);if(l&&(r=l.stateNode)){var m=r[At]||null;e:switch(r=l.stateNode,l.type){case"input":if(qu(r,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),l=m.name,m.type==="radio"&&l!=null){for(m=r;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+kn(""+l)+'"][type="radio"]'),l=0;l<m.length;l++){var T=m[l];if(T!==r&&T.form===r.form){var I=T[At]||null;if(!I)throw Error(g(90));qu(T,I.value,I.defaultValue,I.defaultValue,I.checked,I.defaultChecked,I.type,I.name)}}for(l=0;l<m.length;l++)T=m[l],T.form===r.form&&Yn(T)}break e;case"textarea":Js(r,m.value,m.defaultValue);break e;case"select":l=m.value,l!=null&&Pn(r,!!m.multiple,l,!1)}}}var Zt=!1;function fn(r,l,m){if(Zt)return r(l,m);Zt=!0;try{var T=r(l);return T}finally{if(Zt=!1,(Ar!==null||ii!==null)&&(qf(),Ar&&(l=Ar,r=ii,ii=Ar=null,Xi(l),r)))for(l=0;l<r.length;l++)Xi(r[l])}}function Oa(r,l){var m=r.stateNode;if(m===null)return null;var T=m[At]||null;if(T===null)return null;m=T[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(T=!T.disabled)||(r=r.type,T=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!T;break e;default:r=!1}if(r)return null;if(m&&typeof m!="function")throw Error(g(231,l,typeof m));return m}var Bn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ta=!1;if(Bn)try{var Fn={};Object.defineProperty(Fn,"passive",{get:function(){ta=!0}}),window.addEventListener("test",Fn,Fn),window.removeEventListener("test",Fn,Fn)}catch{ta=!1}var Ma=null,Ba=null,Ai=null;function Fa(){if(Ai)return Ai;var r,l=Ba,m=l.length,T,I="value"in Ma?Ma.value:Ma.textContent,B=I.length;for(r=0;r<m&&l[r]===I[r];r++);var J=m-r;for(T=1;T<=J&&l[m-T]===I[B-T];T++);return Ai=I.slice(r,1<T?1-T:void 0)}function Na(r){var l=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&l===13&&(r=13)):r=l,r===10&&(r=13),32<=r||r===13?r:0}function el(){return!0}function Ea(){return!1}function pr(r){function l(m,T,I,B,J){this._reactName=m,this._targetInst=I,this.type=T,this.nativeEvent=B,this.target=J,this.currentTarget=null;for(var he in r)r.hasOwnProperty(he)&&(m=r[he],this[he]=m?m(B):B[he]);return this.isDefaultPrevented=(B.defaultPrevented!=null?B.defaultPrevented:B.returnValue===!1)?el:Ea,this.isPropagationStopped=Ea,this}return K(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=el)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=el)},persist:function(){},isPersistent:el}),l}var ia={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$u=pr(ia),tl=K({},ia,{view:0,detail:0}),Pi=pr(tl),pn,kr,Mi,vi=K({},tl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yu,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Mi&&(Mi&&r.type==="mousemove"?(pn=r.screenX-Mi.screenX,kr=r.screenY-Mi.screenY):kr=pn=0,Mi=r),pn)},movementY:function(r){return"movementY"in r?r.movementY:kr}}),Cl=pr(vi),Di=K({},vi,{dataTransfer:0}),Hu=pr(Di),oo=K({},tl,{relatedTarget:0}),il=pr(oo),nl=K({},ia,{animationName:0,elapsedTime:0,pseudoElement:0}),Uc=pr(nl),Xu=K({},ia,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),xo=pr(Xu),vf=K({},ia,{data:0}),Vc=pr(vf),rr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},On={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Es(r){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(r):(r=On[r])?!!l[r]:!1}function Yu(){return Es}var mu=K({},tl,{key:function(r){if(r.key){var l=rr[r.key]||r.key;if(l!=="Unidentified")return l}return r.type==="keypress"?(r=Na(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Vo[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yu,charCode:function(r){return r.type==="keypress"?Na(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Na(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Gn=pr(mu),pd=K({},vi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gc=pr(pd),Zc=K({},tl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yu}),bf=pr(Zc),Pl=K({},ia,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wu=pr(Pl),As=K({},vi,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Cs=pr(As),Ku=K({},ia,{newState:0,oldState:0}),cs=pr(Ku),na=[9,13,27,32],Wn=Bn&&"CompositionEvent"in window,zl=null;Bn&&"documentMode"in document&&(zl=document.documentMode);var gu=Bn&&"TextEvent"in window&&!zl,rl=Bn&&(!Wn||zl&&8<zl&&11>=zl),hs=" ",md=!1;function Ju(r,l){switch(r){case"keyup":return na.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zh(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Go=!1;function ja(r,l){switch(r){case"compositionend":return zh(l);case"keypress":return l.which!==32?null:(md=!0,hs);case"textInput":return r=l.data,r===hs&&md?null:r;default:return null}}function Il(r,l){if(Go)return r==="compositionend"||!Wn&&Ju(r,l)?(r=Fa(),Ai=Ba=Ma=null,Go=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return rl&&l.locale!=="ko"?null:l.data;default:return null}}var gd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wo(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l==="input"?!!gd[r.type]:l==="textarea"}function qc(r,l,m,T){Ar?ii?ii.push(T):ii=[T]:Ar=T,l=Jf(l,"onChange"),0<l.length&&(m=new $u("onChange","change",null,m,T),r.push({event:m,listeners:l}))}var To=null,yu=null;function _u(r){y_(r,0)}function vu(r){var l=ro(r);if(Yn(l))return r}function Zo(r,l){if(r==="change")return l}var Ih=!1;if(Bn){var So;if(Bn){var qo="oninput"in document;if(!qo){var Lh=document.createElement("div");Lh.setAttribute("oninput","return;"),qo=typeof Lh.oninput=="function"}So=qo}else So=!1;Ih=So&&(!document.documentMode||9<document.documentMode)}function Ll(){To&&(To.detachEvent("onpropertychange",yd),yu=To=null)}function yd(r){if(r.propertyName==="value"&&vu(yu)){var l=[];qc(l,yu,r,Al(r)),fn(_u,l)}}function Ps(r,l,m){r==="focusin"?(Ll(),To=l,yu=m,To.attachEvent("onpropertychange",yd)):r==="focusout"&&Ll()}function _d(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return vu(yu)}function ds(r,l){if(r==="click")return vu(l)}function vd(r,l){if(r==="input"||r==="change")return vu(l)}function $o(r,l){return r===l&&(r!==0||1/r===1/l)||r!==r&&l!==l}var ra=typeof Object.is=="function"?Object.is:$o;function zs(r,l){if(ra(r,l))return!0;if(typeof r!="object"||r===null||typeof l!="object"||l===null)return!1;var m=Object.keys(r),T=Object.keys(l);if(m.length!==T.length)return!1;for(T=0;T<m.length;T++){var I=m[T];if(!ko.call(l,I)||!ra(r[I],l[I]))return!1}return!0}function Ua(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function al(r,l){var m=Ua(r);r=0;for(var T;m;){if(m.nodeType===3){if(T=r+m.textContent.length,r<=l&&T>=l)return{node:m,offset:l-r};r=T}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=Ua(m)}}function bu(r,l){return r&&l?r===l?!0:r&&r.nodeType===3?!1:l&&l.nodeType===3?bu(r,l.parentNode):"contains"in r?r.contains(l):r.compareDocumentPosition?!!(r.compareDocumentPosition(l)&16):!1:!1}function Dl(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var l=Ml(r.document);l instanceof r.HTMLIFrameElement;){try{var m=typeof l.contentWindow.location.href=="string"}catch{m=!1}if(m)r=l.contentWindow;else break;l=Ml(r.document)}return l}function fs(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l&&(l==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||l==="textarea"||r.contentEditable==="true")}var Rl=Bn&&"documentMode"in document&&11>=document.documentMode,Va=null,xu=null,Qu=null,kl=!1;function bd(r,l,m){var T=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;kl||Va==null||Va!==Ml(T)||(T=Va,"selectionStart"in T&&fs(T)?T={start:T.selectionStart,end:T.selectionEnd}:(T=(T.ownerDocument&&T.ownerDocument.defaultView||window).getSelection(),T={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset}),Qu&&zs(Qu,T)||(Qu=T,T=Jf(xu,"onSelect"),0<T.length&&(l=new $u("onSelect","select",null,l,m),r.push({event:l,listeners:T}),l.target=Va)))}function ol(r,l){var m={};return m[r.toLowerCase()]=l.toLowerCase(),m["Webkit"+r]="webkit"+l,m["Moz"+r]="moz"+l,m}var Ol={animationend:ol("Animation","AnimationEnd"),animationiteration:ol("Animation","AnimationIteration"),animationstart:ol("Animation","AnimationStart"),transitionrun:ol("Transition","TransitionRun"),transitionstart:ol("Transition","TransitionStart"),transitioncancel:ol("Transition","TransitionCancel"),transitionend:ol("Transition","TransitionEnd")},$c={},Yi={};Bn&&(Yi=document.createElement("div").style,"AnimationEvent"in window||(delete Ol.animationend.animation,delete Ol.animationiteration.animation,delete Ol.animationstart.animation),"TransitionEvent"in window||delete Ol.transitionend.transition);function Cr(r){if($c[r])return $c[r];if(!Ol[r])return r;var l=Ol[r],m;for(m in l)if(l.hasOwnProperty(m)&&m in Yi)return $c[r]=l[m];return r}var sl=Cr("animationend"),ec=Cr("animationiteration"),Bl=Cr("animationstart"),Fl=Cr("transitionrun"),wu=Cr("transitionstart"),Tu=Cr("transitioncancel"),aa=Cr("transitionend"),Dh=new Map,Is="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Is.push("scrollEnd");function Ga(r,l){Dh.set(r,l),Vi(l,[r])}var Ho=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Aa=[],oa=0,ll=0;function ul(){for(var r=oa,l=ll=oa=0;l<r;){var m=Aa[l];Aa[l++]=null;var T=Aa[l];Aa[l++]=null;var I=Aa[l];Aa[l++]=null;var B=Aa[l];if(Aa[l++]=null,T!==null&&I!==null){var J=T.pending;J===null?I.next=I:(I.next=J.next,J.next=I),T.pending=I}B!==0&&Nl(m,I,B)}}function Ls(r,l,m,T){Aa[oa++]=r,Aa[oa++]=l,Aa[oa++]=m,Aa[oa++]=T,ll|=T,r.lanes|=T,r=r.alternate,r!==null&&(r.lanes|=T)}function cl(r,l,m,T){return Ls(r,l,m,T),jl(r)}function Ca(r,l){return Ls(r,null,null,l),jl(r)}function Nl(r,l,m){r.lanes|=m;var T=r.alternate;T!==null&&(T.lanes|=m);for(var I=!1,B=r.return;B!==null;)B.childLanes|=m,T=B.alternate,T!==null&&(T.childLanes|=m),B.tag===22&&(r=B.stateNode,r===null||r._visibility&1||(I=!0)),r=B,B=B.return;return r.tag===3?(B=r.stateNode,I&&l!==null&&(I=31-mt(m),r=B.hiddenUpdates,T=r[I],T===null?r[I]=[l]:T.push(l),l.lane=m|536870912),B):null}function jl(r){if(50<Zf)throw Zf=0,Sg=null,Error(g(185));for(var l=r.return;l!==null;)r=l,l=r.return;return r.tag===3?r.stateNode:null}var Si={};function Hc(r,l,m,T){this.tag=r,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Za(r,l,m,T){return new Hc(r,l,m,T)}function tc(r){return r=r.prototype,!(!r||!r.isReactComponent)}function qa(r,l){var m=r.alternate;return m===null?(m=Za(r.tag,l,r.key,r.mode),m.elementType=r.elementType,m.type=r.type,m.stateNode=r.stateNode,m.alternate=r,r.alternate=m):(m.pendingProps=l,m.type=r.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=r.flags&65011712,m.childLanes=r.childLanes,m.lanes=r.lanes,m.child=r.child,m.memoizedProps=r.memoizedProps,m.memoizedState=r.memoizedState,m.updateQueue=r.updateQueue,l=r.dependencies,m.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},m.sibling=r.sibling,m.index=r.index,m.ref=r.ref,m.refCleanup=r.refCleanup,m}function Rh(r,l){r.flags&=65011714;var m=r.alternate;return m===null?(r.childLanes=0,r.lanes=l,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=m.childLanes,r.lanes=m.lanes,r.child=m.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=m.memoizedProps,r.memoizedState=m.memoizedState,r.updateQueue=m.updateQueue,r.type=m.type,l=m.dependencies,r.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),r}function ic(r,l,m,T,I,B){var J=0;if(T=r,typeof r=="function")tc(r)&&(J=1);else if(typeof r=="string")J=Gg(r,m,zt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case Ut:return r=Za(31,m,l,I),r.elementType=Ut,r.lanes=B,r;case fe:return hl(m.children,I,B,l);case ce:J=8,I|=24;break;case qe:return r=Za(12,m,l,I|2),r.elementType=qe,r.lanes=B,r;case Pe:return r=Za(13,m,l,I),r.elementType=Pe,r.lanes=B,r;case $e:return r=Za(19,m,l,I),r.elementType=$e,r.lanes=B,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Ne:J=10;break e;case Fe:J=9;break e;case Be:J=11;break e;case Qe:J=14;break e;case Et:J=16,T=null;break e}J=29,m=Error(g(130,r===null?"null":typeof r,"")),T=null}return l=Za(J,m,l,I),l.elementType=r,l.type=T,l.lanes=B,l}function hl(r,l,m,T){return r=Za(7,r,T,l),r.lanes=m,r}function Xc(r,l,m){return r=Za(6,r,null,l),r.lanes=m,r}function nc(r){var l=Za(18,null,null,0);return l.stateNode=r,l}function dl(r,l,m){return l=Za(4,r.children!==null?r.children:[],r.key,l),l.lanes=m,l.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},l}var d=new WeakMap;function x(r,l){if(typeof r=="object"&&r!==null){var m=d.get(r);return m!==void 0?m:(l={value:r,source:l,stack:La(l)},d.set(r,l),l)}return{value:r,source:l,stack:La(l)}}var z=[],j=0,Y=null,se=0,Ae=[],Ue=0,ot=null,Tt=1,jt="";function ui(r,l){z[j++]=se,z[j++]=Y,Y=r,se=l}function zi(r,l,m){Ae[Ue++]=Tt,Ae[Ue++]=jt,Ae[Ue++]=ot,ot=r;var T=Tt;r=jt;var I=32-mt(T)-1;T&=~(1<<I),m+=1;var B=32-mt(l)+I;if(30<B){var J=I-I%5;B=(T&(1<<J)-1).toString(32),T>>=J,I-=J,Tt=1<<32-mt(l)+I|m<<I|T,jt=B+r}else Tt=1<<B|m<<I|T,jt=r}function mr(r){r.return!==null&&(ui(r,1),zi(r,1,0))}function Kn(r){for(;r===Y;)Y=z[--j],z[j]=null,se=z[--j],z[j]=null;for(;r===ot;)ot=Ae[--Ue],Ae[Ue]=null,jt=Ae[--Ue],Ae[Ue]=null,Tt=Ae[--Ue],Ae[Ue]=null}function $a(r,l){Ae[Ue++]=Tt,Ae[Ue++]=jt,Ae[Ue++]=ot,Tt=l.id,jt=l.overflow,ot=r}var cn=null,Wi=null,Ri=!1,Ds=null,so=!1,Nn=Error(g(519));function Ha(r){var l=Error(g(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Rs(x(l,r)),Nn}function Xa(r){var l=r.stateNode,m=r.type,T=r.memoizedProps;switch(l[vn]=r,l[At]=T,m){case"dialog":tn("cancel",l),tn("close",l);break;case"iframe":case"object":case"embed":tn("load",l);break;case"video":case"audio":for(m=0;m<Wf.length;m++)tn(Wf[m],l);break;case"source":tn("error",l);break;case"img":case"image":case"link":tn("error",l),tn("load",l);break;case"details":tn("toggle",l);break;case"input":tn("invalid",l),El(l,T.value,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name,!0);break;case"select":tn("invalid",l);break;case"textarea":tn("invalid",l),us(l,T.value,T.defaultValue,T.children)}m=T.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||l.textContent===""+m||T.suppressHydrationWarning===!0||om(l.textContent,m)?(T.popover!=null&&(tn("beforetoggle",l),tn("toggle",l)),T.onScroll!=null&&tn("scroll",l),T.onScrollEnd!=null&&tn("scrollend",l),T.onClick!=null&&(l.onclick=ka),l=!0):l=!1,l||Ha(r,!0)}function Zn(r){for(cn=r.return;cn;)switch(cn.tag){case 5:case 31:case 13:so=!1;return;case 27:case 3:so=!0;return;default:cn=cn.return}}function lo(r){if(r!==cn)return!1;if(!Ri)return Zn(r),Ri=!0,!1;var l=r.tag,m;if((m=l!==3&&l!==27)&&((m=l===5)&&(m=r.type,m=!(m!=="form"&&m!=="button")||np(r.type,r.memoizedProps)),m=!m),m&&Wi&&Ha(r),Zn(r),l===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(g(317));Wi=mh(r)}else if(l===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(g(317));Wi=mh(r)}else l===27?(l=Wi,_r(r.type)?(r=fm,fm=null,Wi=r):Wi=l):Wi=cn?bl(r.stateNode.nextSibling):null;return!0}function ps(){Wi=cn=null,Ri=!1}function ms(){var r=Ds;return r!==null&&(bs===null?bs=r:bs.push.apply(bs,r),Ds=null),r}function Rs(r){Ds===null?Ds=[r]:Ds.push(r)}var Xo=ze(null),uo=null,gs=null;function Ul(r,l,m){It(Xo,l._currentValue),l._currentValue=m}function fl(r){r._currentValue=Xo.current,dt(Xo)}function xd(r,l,m){for(;r!==null;){var T=r.alternate;if((r.childLanes&l)!==l?(r.childLanes|=l,T!==null&&(T.childLanes|=l)):T!==null&&(T.childLanes&l)!==l&&(T.childLanes|=l),r===m)break;r=r.return}}function wd(r,l,m,T){var I=r.child;for(I!==null&&(I.return=r);I!==null;){var B=I.dependencies;if(B!==null){var J=I.child;B=B.firstContext;e:for(;B!==null;){var he=B;B=I;for(var De=0;De<l.length;De++)if(he.context===l[De]){B.lanes|=m,he=B.alternate,he!==null&&(he.lanes|=m),xd(B.return,m,r),T||(J=null);break e}B=he.next}}else if(I.tag===18){if(J=I.return,J===null)throw Error(g(341));J.lanes|=m,B=J.alternate,B!==null&&(B.lanes|=m),xd(J,m,r),J=null}else J=I.child;if(J!==null)J.return=I;else for(J=I;J!==null;){if(J===r){J=null;break}if(I=J.sibling,I!==null){I.return=J.return,J=I;break}J=J.return}I=J}}function ys(r,l,m,T){r=null;for(var I=l,B=!1;I!==null;){if(!B){if((I.flags&524288)!==0)B=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var J=I.alternate;if(J===null)throw Error(g(387));if(J=J.memoizedProps,J!==null){var he=I.type;ra(I.pendingProps.value,J.value)||(r!==null?r.push(he):r=[he])}}else if(I===fi.current){if(J=I.alternate,J===null)throw Error(g(387));J.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(r!==null?r.push(sp):r=[sp])}I=I.return}r!==null&&wd(l,r,m,T),l.flags|=262144}function Yc(r){for(r=r.firstContext;r!==null;){if(!ra(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Vl(r){uo=r,gs=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Pr(r){return Td(uo,r)}function kh(r,l){return uo===null&&Vl(r),Td(r,l)}function Td(r,l){var m=l._currentValue;if(l={context:l,memoizedValue:m,next:null},gs===null){if(r===null)throw Error(g(308));gs=l,r.dependencies={lanes:0,firstContext:l},r.flags|=524288}else gs=gs.next=l;return m}var xf=typeof AbortController<"u"?AbortController:function(){var r=[],l=this.signal={aborted:!1,addEventListener:function(m,T){r.push(T)}};this.abort=function(){l.aborted=!0,r.forEach(function(m){return m()})}},Op=s.unstable_scheduleCallback,wf=s.unstable_NormalPriority,ar={$$typeof:Ne,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Su(){return{controller:new xf,data:new Map,refCount:0}}function Ya(r){r.refCount--,r.refCount===0&&Op(wf,function(){r.controller.abort()})}var co=null,Sd=0,Wa=0,Wc=null;function Kc(r,l){if(co===null){var m=co=[];Sd=0,Wa=fh(),Wc={status:"pending",value:void 0,then:function(T){m.push(T)}}}return Sd++,l.then(Jc,Jc),l}function Jc(){if(--Sd===0&&co!==null){Wc!==null&&(Wc.status="fulfilled");var r=co;co=null,Wa=0,Wc=null;for(var l=0;l<r.length;l++)(0,r[l])()}}function Oh(r,l){var m=[],T={status:"pending",value:null,reason:null,then:function(I){m.push(I)}};return r.then(function(){T.status="fulfilled",T.value=l;for(var I=0;I<m.length;I++)(0,m[I])(l)},function(I){for(T.status="rejected",T.reason=I,I=0;I<m.length;I++)(0,m[I])(void 0)}),T}var Mo=lt.S;lt.S=function(r,l){bg=Rr(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&Kc(r,l),Mo!==null&&Mo(r,l)};var ks=ze(null);function Bh(){var r=ks.current;return r!==null?r:tr.pooledCache}function Mu(r,l){l===null?It(ks,ks.current):It(ks,l.pool)}function pl(){var r=Bh();return r===null?null:{parent:ar._currentValue,pool:r}}var Ot=Error(g(460)),Fh=Error(g(474)),Eu=Error(g(542)),Nh={then:function(){}};function Au(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Qc(r,l,m){switch(m=r[m],m===void 0?r.push(l):m!==l&&(l.then(ka,ka),l=m),l.status){case"fulfilled":return l.value;case"rejected":throw r=l.reason,Tf(r),r;default:if(typeof l.status=="string")l.then(ka,ka);else{if(r=tr,r!==null&&100<r.shellSuspendCounter)throw Error(g(482));r=l,r.status="pending",r.then(function(T){if(l.status==="pending"){var I=l;I.status="fulfilled",I.value=T}},function(T){if(l.status==="pending"){var I=l;I.status="rejected",I.reason=T}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw r=l.reason,Tf(r),r}throw rc=l,Ot}}function Yo(r){try{var l=r._init;return l(r._payload)}catch(m){throw m!==null&&typeof m=="object"&&typeof m.then=="function"?(rc=m,Ot):m}}var rc=null;function Md(){if(rc===null)throw Error(g(459));var r=rc;return rc=null,r}function Tf(r){if(r===Ot||r===Eu)throw Error(g(483))}var _s=null,jh=0;function Uh(r){var l=jh;return jh+=1,_s===null&&(_s=[]),Qc(_s,r,l)}function Cu(r,l){l=l.props.ref,r.ref=l!==void 0?l:null}function Ed(r,l){throw l.$$typeof===ae?Error(g(525)):(r=Object.prototype.toString.call(l),Error(g(31,r==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":r)))}function Vh(r){function l(Ge,Oe){if(r){var nt=Ge.deletions;nt===null?(Ge.deletions=[Oe],Ge.flags|=16):nt.push(Oe)}}function m(Ge,Oe){if(!r)return null;for(;Oe!==null;)l(Ge,Oe),Oe=Oe.sibling;return null}function T(Ge){for(var Oe=new Map;Ge!==null;)Ge.key!==null?Oe.set(Ge.key,Ge):Oe.set(Ge.index,Ge),Ge=Ge.sibling;return Oe}function I(Ge,Oe){return Ge=qa(Ge,Oe),Ge.index=0,Ge.sibling=null,Ge}function B(Ge,Oe,nt){return Ge.index=nt,r?(nt=Ge.alternate,nt!==null?(nt=nt.index,nt<Oe?(Ge.flags|=67108866,Oe):nt):(Ge.flags|=67108866,Oe)):(Ge.flags|=1048576,Oe)}function J(Ge){return r&&Ge.alternate===null&&(Ge.flags|=67108866),Ge}function he(Ge,Oe,nt,vt){return Oe===null||Oe.tag!==6?(Oe=Xc(nt,Ge.mode,vt),Oe.return=Ge,Oe):(Oe=I(Oe,nt),Oe.return=Ge,Oe)}function De(Ge,Oe,nt,vt){var Qt=nt.type;return Qt===fe?yt(Ge,Oe,nt.props.children,vt,nt.key):Oe!==null&&(Oe.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===Et&&Yo(Qt)===Oe.type)?(Oe=I(Oe,nt.props),Cu(Oe,nt),Oe.return=Ge,Oe):(Oe=ic(nt.type,nt.key,nt.props,null,Ge.mode,vt),Cu(Oe,nt),Oe.return=Ge,Oe)}function at(Ge,Oe,nt,vt){return Oe===null||Oe.tag!==4||Oe.stateNode.containerInfo!==nt.containerInfo||Oe.stateNode.implementation!==nt.implementation?(Oe=dl(nt,Ge.mode,vt),Oe.return=Ge,Oe):(Oe=I(Oe,nt.children||[]),Oe.return=Ge,Oe)}function yt(Ge,Oe,nt,vt,Qt){return Oe===null||Oe.tag!==7?(Oe=hl(nt,Ge.mode,vt,Qt),Oe.return=Ge,Oe):(Oe=I(Oe,nt),Oe.return=Ge,Oe)}function St(Ge,Oe,nt){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return Oe=Xc(""+Oe,Ge.mode,nt),Oe.return=Ge,Oe;if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case ue:return nt=ic(Oe.type,Oe.key,Oe.props,null,Ge.mode,nt),Cu(nt,Oe),nt.return=Ge,nt;case ge:return Oe=dl(Oe,Ge.mode,nt),Oe.return=Ge,Oe;case Et:return Oe=Yo(Oe),St(Ge,Oe,nt)}if(Qi(Oe)||li(Oe))return Oe=hl(Oe,Ge.mode,nt,null),Oe.return=Ge,Oe;if(typeof Oe.then=="function")return St(Ge,Uh(Oe),nt);if(Oe.$$typeof===Ne)return St(Ge,kh(Ge,Oe),nt);Ed(Ge,Oe)}return null}function st(Ge,Oe,nt,vt){var Qt=Oe!==null?Oe.key:null;if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return Qt!==null?null:he(Ge,Oe,""+nt,vt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case ue:return nt.key===Qt?De(Ge,Oe,nt,vt):null;case ge:return nt.key===Qt?at(Ge,Oe,nt,vt):null;case Et:return nt=Yo(nt),st(Ge,Oe,nt,vt)}if(Qi(nt)||li(nt))return Qt!==null?null:yt(Ge,Oe,nt,vt,null);if(typeof nt.then=="function")return st(Ge,Oe,Uh(nt),vt);if(nt.$$typeof===Ne)return st(Ge,Oe,kh(Ge,nt),vt);Ed(Ge,nt)}return null}function ht(Ge,Oe,nt,vt,Qt){if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return Ge=Ge.get(nt)||null,he(Oe,Ge,""+vt,Qt);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case ue:return Ge=Ge.get(vt.key===null?nt:vt.key)||null,De(Oe,Ge,vt,Qt);case ge:return Ge=Ge.get(vt.key===null?nt:vt.key)||null,at(Oe,Ge,vt,Qt);case Et:return vt=Yo(vt),ht(Ge,Oe,nt,vt,Qt)}if(Qi(vt)||li(vt))return Ge=Ge.get(nt)||null,yt(Oe,Ge,vt,Qt,null);if(typeof vt.then=="function")return ht(Ge,Oe,nt,Uh(vt),Qt);if(vt.$$typeof===Ne)return ht(Ge,Oe,nt,kh(Oe,vt),Qt);Ed(Oe,vt)}return null}function ti(Ge,Oe,nt,vt){for(var Qt=null,yn=null,oi=Oe,Oi=Oe=0,Ki=null;oi!==null&&Oi<nt.length;Oi++){oi.index>Oi?(Ki=oi,oi=null):Ki=oi.sibling;var Mn=st(Ge,oi,nt[Oi],vt);if(Mn===null){oi===null&&(oi=Ki);break}r&&oi&&Mn.alternate===null&&l(Ge,oi),Oe=B(Mn,Oe,Oi),yn===null?Qt=Mn:yn.sibling=Mn,yn=Mn,oi=Ki}if(Oi===nt.length)return m(Ge,oi),Ri&&ui(Ge,Oi),Qt;if(oi===null){for(;Oi<nt.length;Oi++)oi=St(Ge,nt[Oi],vt),oi!==null&&(Oe=B(oi,Oe,Oi),yn===null?Qt=oi:yn.sibling=oi,yn=oi);return Ri&&ui(Ge,Oi),Qt}for(oi=T(oi);Oi<nt.length;Oi++)Ki=ht(oi,Ge,Oi,nt[Oi],vt),Ki!==null&&(r&&Ki.alternate!==null&&oi.delete(Ki.key===null?Oi:Ki.key),Oe=B(Ki,Oe,Oi),yn===null?Qt=Ki:yn.sibling=Ki,yn=Ki);return r&&oi.forEach(function(Mc){return l(Ge,Mc)}),Ri&&ui(Ge,Oi),Qt}function mi(Ge,Oe,nt,vt){if(nt==null)throw Error(g(151));for(var Qt=null,yn=null,oi=Oe,Oi=Oe=0,Ki=null,Mn=nt.next();oi!==null&&!Mn.done;Oi++,Mn=nt.next()){oi.index>Oi?(Ki=oi,oi=null):Ki=oi.sibling;var Mc=st(Ge,oi,Mn.value,vt);if(Mc===null){oi===null&&(oi=Ki);break}r&&oi&&Mc.alternate===null&&l(Ge,oi),Oe=B(Mc,Oe,Oi),yn===null?Qt=Mc:yn.sibling=Mc,yn=Mc,oi=Ki}if(Mn.done)return m(Ge,oi),Ri&&ui(Ge,Oi),Qt;if(oi===null){for(;!Mn.done;Oi++,Mn=nt.next())Mn=St(Ge,Mn.value,vt),Mn!==null&&(Oe=B(Mn,Oe,Oi),yn===null?Qt=Mn:yn.sibling=Mn,yn=Mn);return Ri&&ui(Ge,Oi),Qt}for(oi=T(oi);!Mn.done;Oi++,Mn=nt.next())Mn=ht(oi,Ge,Oi,Mn.value,vt),Mn!==null&&(r&&Mn.alternate!==null&&oi.delete(Mn.key===null?Oi:Mn.key),Oe=B(Mn,Oe,Oi),yn===null?Qt=Mn:yn.sibling=Mn,yn=Mn);return r&&oi.forEach(function(N_){return l(Ge,N_)}),Ri&&ui(Ge,Oi),Qt}function Dn(Ge,Oe,nt,vt){if(typeof nt=="object"&&nt!==null&&nt.type===fe&&nt.key===null&&(nt=nt.props.children),typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case ue:e:{for(var Qt=nt.key;Oe!==null;){if(Oe.key===Qt){if(Qt=nt.type,Qt===fe){if(Oe.tag===7){m(Ge,Oe.sibling),vt=I(Oe,nt.props.children),vt.return=Ge,Ge=vt;break e}}else if(Oe.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===Et&&Yo(Qt)===Oe.type){m(Ge,Oe.sibling),vt=I(Oe,nt.props),Cu(vt,nt),vt.return=Ge,Ge=vt;break e}m(Ge,Oe);break}else l(Ge,Oe);Oe=Oe.sibling}nt.type===fe?(vt=hl(nt.props.children,Ge.mode,vt,nt.key),vt.return=Ge,Ge=vt):(vt=ic(nt.type,nt.key,nt.props,null,Ge.mode,vt),Cu(vt,nt),vt.return=Ge,Ge=vt)}return J(Ge);case ge:e:{for(Qt=nt.key;Oe!==null;){if(Oe.key===Qt)if(Oe.tag===4&&Oe.stateNode.containerInfo===nt.containerInfo&&Oe.stateNode.implementation===nt.implementation){m(Ge,Oe.sibling),vt=I(Oe,nt.children||[]),vt.return=Ge,Ge=vt;break e}else{m(Ge,Oe);break}else l(Ge,Oe);Oe=Oe.sibling}vt=dl(nt,Ge.mode,vt),vt.return=Ge,Ge=vt}return J(Ge);case Et:return nt=Yo(nt),Dn(Ge,Oe,nt,vt)}if(Qi(nt))return ti(Ge,Oe,nt,vt);if(li(nt)){if(Qt=li(nt),typeof Qt!="function")throw Error(g(150));return nt=Qt.call(nt),mi(Ge,Oe,nt,vt)}if(typeof nt.then=="function")return Dn(Ge,Oe,Uh(nt),vt);if(nt.$$typeof===Ne)return Dn(Ge,Oe,kh(Ge,nt),vt);Ed(Ge,nt)}return typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint"?(nt=""+nt,Oe!==null&&Oe.tag===6?(m(Ge,Oe.sibling),vt=I(Oe,nt),vt.return=Ge,Ge=vt):(m(Ge,Oe),vt=Xc(nt,Ge.mode,vt),vt.return=Ge,Ge=vt),J(Ge)):m(Ge,Oe)}return function(Ge,Oe,nt,vt){try{jh=0;var Qt=Dn(Ge,Oe,nt,vt);return _s=null,Qt}catch(oi){if(oi===Ot||oi===Eu)throw oi;var yn=Za(29,oi,null,Ge.mode);return yn.lanes=vt,yn.return=Ge,yn}}}var ml=Vh(!0),Ad=Vh(!1),Gl=!1;function Cd(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Os(r,l){r=r.updateQueue,l.updateQueue===r&&(l.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function $i(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Zl(r,l,m){var T=r.updateQueue;if(T===null)return null;if(T=T.shared,(wn&2)!==0){var I=T.pending;return I===null?l.next=l:(l.next=I.next,I.next=l),T.pending=l,l=jl(r),Nl(r,null,m),l}return Ls(r,T,l,m),jl(r)}function Pu(r,l,m){if(l=l.updateQueue,l!==null&&(l=l.shared,(m&4194048)!==0)){var T=l.lanes;T&=r.pendingLanes,m|=T,l.lanes=m,fr(r,m)}}function ac(r,l){var m=r.updateQueue,T=r.alternate;if(T!==null&&(T=T.updateQueue,m===T)){var I=null,B=null;if(m=m.firstBaseUpdate,m!==null){do{var J={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};B===null?I=B=J:B=B.next=J,m=m.next}while(m!==null);B===null?I=B=l:B=B.next=l}else I=B=l;m={baseState:T.baseState,firstBaseUpdate:I,lastBaseUpdate:B,shared:T.shared,callbacks:T.callbacks},r.updateQueue=m;return}r=m.lastBaseUpdate,r===null?m.firstBaseUpdate=l:r.next=l,m.lastBaseUpdate=l}var Gh=!1;function oc(){if(Gh){var r=Wc;if(r!==null)throw r}}function eh(r,l,m,T){Gh=!1;var I=r.updateQueue;Gl=!1;var B=I.firstBaseUpdate,J=I.lastBaseUpdate,he=I.shared.pending;if(he!==null){I.shared.pending=null;var De=he,at=De.next;De.next=null,J===null?B=at:J.next=at,J=De;var yt=r.alternate;yt!==null&&(yt=yt.updateQueue,he=yt.lastBaseUpdate,he!==J&&(he===null?yt.firstBaseUpdate=at:he.next=at,yt.lastBaseUpdate=De))}if(B!==null){var St=I.baseState;J=0,yt=at=De=null,he=B;do{var st=he.lane&-536870913,ht=st!==he.lane;if(ht?(Zi&st)===st:(T&st)===st){st!==0&&st===Wa&&(Gh=!0),yt!==null&&(yt=yt.next={lane:0,tag:he.tag,payload:he.payload,callback:null,next:null});e:{var ti=r,mi=he;st=l;var Dn=m;switch(mi.tag){case 1:if(ti=mi.payload,typeof ti=="function"){St=ti.call(Dn,St,st);break e}St=ti;break e;case 3:ti.flags=ti.flags&-65537|128;case 0:if(ti=mi.payload,st=typeof ti=="function"?ti.call(Dn,St,st):ti,st==null)break e;St=K({},St,st);break e;case 2:Gl=!0}}st=he.callback,st!==null&&(r.flags|=64,ht&&(r.flags|=8192),ht=I.callbacks,ht===null?I.callbacks=[st]:ht.push(st))}else ht={lane:st,tag:he.tag,payload:he.payload,callback:he.callback,next:null},yt===null?(at=yt=ht,De=St):yt=yt.next=ht,J|=st;if(he=he.next,he===null){if(he=I.shared.pending,he===null)break;ht=he,he=ht.next,ht.next=null,I.lastBaseUpdate=ht,I.shared.pending=null}}while(!0);yt===null&&(De=St),I.baseState=De,I.firstBaseUpdate=at,I.lastBaseUpdate=yt,B===null&&(I.shared.lanes=0),_l|=J,r.lanes=J,r.memoizedState=St}}function Pd(r,l){if(typeof r!="function")throw Error(g(191,r));r.call(l)}function Sf(r,l){var m=r.callbacks;if(m!==null)for(r.callbacks=null,r=0;r<m.length;r++)Pd(m[r],l)}var ho=ze(null),sc=ze(0);function Jt(r,l){r=gc,It(sc,r),It(ho,l),gc=r|l.baseLanes}function ai(){It(sc,gc),It(ho,ho.current)}function zu(){gc=sc.current,dt(ho),dt(sc)}var fo=ze(null),fa=null;function xr(r){var l=r.alternate;It(wr,wr.current&1),It(fo,r),fa===null&&(l===null||ho.current!==null||l.memoizedState!==null)&&(fa=r)}function po(r){It(wr,wr.current),It(fo,r),fa===null&&(fa=r)}function Mf(r){r.tag===22?(It(wr,wr.current),It(fo,r),fa===null&&(fa=r)):Iu()}function Iu(){It(wr,wr.current),It(fo,fo.current)}function Eo(r){dt(fo),fa===r&&(fa=null),dt(wr)}var wr=ze(0);function ql(r){for(var l=r;l!==null;){if(l.tag===13){var m=l.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||ts(m)||la(m)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var mn=0,ri=null,zn=null,or=null,lc=!1,Wo=!1,$l=!1,th=0,Hl=0,Xl=null,Ef=0;function sr(){throw Error(g(321))}function Bs(r,l){if(l===null)return!1;for(var m=0;m<l.length&&m<r.length;m++)if(!ra(r[m],l[m]))return!1;return!0}function ih(r,l,m,T,I,B){return mn=B,ri=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,lt.H=r===null||r.memoizedState===null?Nr:mo,$l=!1,B=m(T,I),$l=!1,Wo&&(B=Zh(l,m,T,I)),nh(r),B}function nh(r){lt.H=ur;var l=zn!==null&&zn.next!==null;if(mn=0,or=zn=ri=null,lc=!1,Hl=0,Xl=null,l)throw Error(g(300));r===null||jr||(r=r.dependencies,r!==null&&Yc(r)&&(jr=!0))}function Zh(r,l,m,T){ri=r;var I=0;do{if(Wo&&(Xl=null),Hl=0,Wo=!1,25<=I)throw Error(g(301));if(I+=1,or=zn=null,r.updateQueue!=null){var B=r.updateQueue;B.lastEffect=null,B.events=null,B.stores=null,B.memoCache!=null&&(B.memoCache.index=0)}lt.H=Qn,B=l(m,T)}while(Wo);return B}function qh(){var r=lt.H,l=r.useState()[0];return l=typeof l.then=="function"?uc(l):l,r=r.useState()[0],(zn!==null?zn.memoizedState:null)!==r&&(ri.flags|=1024),l}function $h(){var r=th!==0;return th=0,r}function Yl(r,l,m){l.updateQueue=r.updateQueue,l.flags&=-2053,r.lanes&=~m}function Wl(r){if(lc){for(r=r.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}lc=!1}mn=0,or=zn=ri=null,Wo=!1,Hl=th=0,Xl=null}function Pa(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return or===null?ri.memoizedState=or=r:or=or.next=r,or}function Jn(){if(zn===null){var r=ri.alternate;r=r!==null?r.memoizedState:null}else r=zn.next;var l=or===null?ri.memoizedState:or.next;if(l!==null)or=l,zn=r;else{if(r===null)throw ri.alternate===null?Error(g(467)):Error(g(310));zn=r,r={memoizedState:zn.memoizedState,baseState:zn.baseState,baseQueue:zn.baseQueue,queue:zn.queue,next:null},or===null?ri.memoizedState=or=r:or=or.next=r}return or}function gl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function uc(r){var l=Hl;return Hl+=1,Xl===null&&(Xl=[]),r=Qc(Xl,r,l),l=ri,(or===null?l.memoizedState:or.next)===null&&(l=l.alternate,lt.H=l===null||l.memoizedState===null?Nr:mo),r}function rh(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return uc(r);if(r.$$typeof===Ne)return Pr(r)}throw Error(g(438,String(r)))}function ah(r){var l=null,m=ri.updateQueue;if(m!==null&&(l=m.memoCache),l==null){var T=ri.alternate;T!==null&&(T=T.updateQueue,T!==null&&(T=T.memoCache,T!=null&&(l={data:T.data.map(function(I){return I.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),m===null&&(m=gl(),ri.updateQueue=m),m.memoCache=l,m=l.data[l.index],m===void 0)for(m=l.data[l.index]=Array(r),T=0;T<r;T++)m[T]=$t;return l.index++,m}function Fs(r,l){return typeof l=="function"?l(r):l}function b(r){var l=Jn();return t(l,zn,r)}function t(r,l,m){var T=r.queue;if(T===null)throw Error(g(311));T.lastRenderedReducer=m;var I=r.baseQueue,B=T.pending;if(B!==null){if(I!==null){var J=I.next;I.next=B.next,B.next=J}l.baseQueue=I=B,T.pending=null}if(B=r.baseState,I===null)r.memoizedState=B;else{l=I.next;var he=J=null,De=null,at=l,yt=!1;do{var St=at.lane&-536870913;if(St!==at.lane?(Zi&St)===St:(mn&St)===St){var st=at.revertLane;if(st===0)De!==null&&(De=De.next={lane:0,revertLane:0,gesture:null,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null}),St===Wa&&(yt=!0);else if((mn&st)===st){at=at.next,st===Wa&&(yt=!0);continue}else St={lane:0,revertLane:at.revertLane,gesture:null,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null},De===null?(he=De=St,J=B):De=De.next=St,ri.lanes|=st,_l|=st;St=at.action,$l&&m(B,St),B=at.hasEagerState?at.eagerState:m(B,St)}else st={lane:St,revertLane:at.revertLane,gesture:at.gesture,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null},De===null?(he=De=st,J=B):De=De.next=st,ri.lanes|=St,_l|=St;at=at.next}while(at!==null&&at!==l);if(De===null?J=B:De.next=he,!ra(B,r.memoizedState)&&(jr=!0,yt&&(m=Wc,m!==null)))throw m;r.memoizedState=B,r.baseState=J,r.baseQueue=De,T.lastRenderedState=B}return I===null&&(T.lanes=0),[r.memoizedState,T.dispatch]}function o(r){var l=Jn(),m=l.queue;if(m===null)throw Error(g(311));m.lastRenderedReducer=r;var T=m.dispatch,I=m.pending,B=l.memoizedState;if(I!==null){m.pending=null;var J=I=I.next;do B=r(B,J.action),J=J.next;while(J!==I);ra(B,l.memoizedState)||(jr=!0),l.memoizedState=B,l.baseQueue===null&&(l.baseState=B),m.lastRenderedState=B}return[B,T]}function f(r,l,m){var T=ri,I=Jn(),B=Ri;if(B){if(m===void 0)throw Error(g(407));m=m()}else m=l();var J=!ra((zn||I).memoizedState,m);if(J&&(I.memoizedState=m,jr=!0),I=I.queue,tt(C.bind(null,T,I,r),[r]),I.getSnapshot!==l||J||or!==null&&or.memoizedState.tag&1){if(T.flags|=2048,we(9,{destroy:void 0},M.bind(null,T,I,m,l),null),tr===null)throw Error(g(349));B||(mn&127)!==0||y(T,l,m)}return m}function y(r,l,m){r.flags|=16384,r={getSnapshot:l,value:m},l=ri.updateQueue,l===null?(l=gl(),ri.updateQueue=l,l.stores=[r]):(m=l.stores,m===null?l.stores=[r]:m.push(r))}function M(r,l,m,T){l.value=m,l.getSnapshot=T,D(l)&&O(r)}function C(r,l,m){return m(function(){D(l)&&O(r)})}function D(r){var l=r.getSnapshot;r=r.value;try{var m=l();return!ra(r,m)}catch{return!0}}function O(r){var l=Ca(r,2);l!==null&&xs(l,r,2)}function U(r){var l=Pa();if(typeof r=="function"){var m=r;if(r=m(),$l){We(!0);try{m()}finally{We(!1)}}}return l.memoizedState=l.baseState=r,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fs,lastRenderedState:r},l}function G(r,l,m,T){return r.baseState=m,t(r,zn,typeof T=="function"?T:Fs)}function X(r,l,m,T,I){if(sa(r))throw Error(g(485));if(r=l.action,r!==null){var B={payload:I,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(J){B.listeners.push(J)}};lt.T!==null?m(!0):B.isTransition=!1,T(B),m=l.pending,m===null?(B.next=l.pending=B,$(l,B)):(B.next=m.next,l.pending=m.next=B)}}function $(r,l){var m=l.action,T=l.payload,I=r.state;if(l.isTransition){var B=lt.T,J={};lt.T=J;try{var he=m(I,T),De=lt.S;De!==null&&De(J,he),ee(r,l,he)}catch(at){me(r,l,at)}finally{B!==null&&J.types!==null&&(B.types=J.types),lt.T=B}}else try{B=m(I,T),ee(r,l,B)}catch(at){me(r,l,at)}}function ee(r,l,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(T){re(r,l,T)},function(T){return me(r,l,T)}):re(r,l,m)}function re(r,l,m){l.status="fulfilled",l.value=m,_e(l),r.state=m,l=r.pending,l!==null&&(m=l.next,m===l?r.pending=null:(m=m.next,l.next=m,$(r,m)))}function me(r,l,m){var T=r.pending;if(r.pending=null,T!==null){T=T.next;do l.status="rejected",l.reason=m,_e(l),l=l.next;while(l!==T)}r.action=null}function _e(r){r=r.listeners;for(var l=0;l<r.length;l++)(0,r[l])()}function ye(r,l){return l}function ve(r,l){if(Ri){var m=tr.formState;if(m!==null){e:{var T=ri;if(Ri){if(Wi){t:{for(var I=Wi,B=so;I.nodeType!==8;){if(!B){I=null;break t}if(I=bl(I.nextSibling),I===null){I=null;break t}}B=I.data,I=B==="F!"||B==="F"?I:null}if(I){Wi=bl(I.nextSibling),T=I.data==="F!";break e}}Ha(T)}T=!1}T&&(l=m[0])}}return m=Pa(),m.memoizedState=m.baseState=l,T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ye,lastRenderedState:l},m.queue=T,m=hc.bind(null,ri,T),T.dispatch=m,T=U(!1),B=Fr.bind(null,ri,!1,T.queue),T=Pa(),I={state:l,dispatch:null,action:r,pending:null},T.queue=I,m=X.bind(null,ri,I,B,m),I.dispatch=m,T.memoizedState=r,[l,m,!1]}function Se(r){var l=Jn();return be(l,zn,r)}function be(r,l,m){if(l=t(r,l,ye)[0],r=b(Fs)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var T=uc(l)}catch(J){throw J===Ot?Eu:J}else T=l;l=Jn();var I=l.queue,B=I.dispatch;return m!==l.memoizedState&&(ri.flags|=2048,we(9,{destroy:void 0},Ce.bind(null,I,m),null)),[T,B,r]}function Ce(r,l){r.action=l}function Ie(r){var l=Jn(),m=zn;if(m!==null)return be(l,m,r);Jn(),l=l.memoizedState,m=Jn();var T=m.queue.dispatch;return m.memoizedState=r,[l,T,!1]}function we(r,l,m,T){return r={tag:r,create:m,deps:T,inst:l,next:null},l=ri.updateQueue,l===null&&(l=gl(),ri.updateQueue=l),m=l.lastEffect,m===null?l.lastEffect=r.next=r:(T=m.next,m.next=r,r.next=T,l.lastEffect=r),r}function ke(){return Jn().memoizedState}function Ke(r,l,m,T){var I=Pa();ri.flags|=r,I.memoizedState=we(1|l,{destroy:void 0},m,T===void 0?null:T)}function He(r,l,m,T){var I=Jn();T=T===void 0?null:T;var B=I.memoizedState.inst;zn!==null&&T!==null&&Bs(T,zn.memoizedState.deps)?I.memoizedState=we(l,B,m,T):(ri.flags|=r,I.memoizedState=we(1|l,B,m,T))}function Je(r,l){Ke(8390656,8,r,l)}function tt(r,l){He(2048,8,r,l)}function bt(r){ri.flags|=4;var l=ri.updateQueue;if(l===null)l=gl(),ri.updateQueue=l,l.events=[r];else{var m=l.events;m===null?l.events=[r]:m.push(r)}}function Ct(r){var l=Jn().memoizedState;return bt({ref:l,nextImpl:r}),function(){if((wn&2)!==0)throw Error(g(440));return l.impl.apply(void 0,arguments)}}function _t(r,l){return He(4,2,r,l)}function Yt(r,l){return He(4,4,r,l)}function wi(r,l){if(typeof l=="function"){r=r();var m=l(r);return function(){typeof m=="function"?m():l(null)}}if(l!=null)return r=r(),l.current=r,function(){l.current=null}}function hn(r,l,m){m=m!=null?m.concat([r]):null,He(4,4,wi.bind(null,l,r),m)}function In(){}function gn(r,l){var m=Jn();l=l===void 0?null:l;var T=m.memoizedState;return l!==null&&Bs(l,T[1])?T[0]:(m.memoizedState=[r,l],r)}function qn(r,l){var m=Jn();l=l===void 0?null:l;var T=m.memoizedState;if(l!==null&&Bs(l,T[1]))return T[0];if(T=r(),$l){We(!0);try{r()}finally{We(!1)}}return m.memoizedState=[T,l],T}function xn(r,l,m){return m===void 0||(mn&1073741824)!==0&&(Zi&261930)===0?r.memoizedState=l:(r.memoizedState=m,r=Zd(),ri.lanes|=r,_l|=r,m)}function Or(r,l,m,T){return ra(m,l)?m:ho.current!==null?(r=xn(r,m,T),ra(r,l)||(jr=!0),r):(mn&42)===0||(mn&1073741824)!==0&&(Zi&261930)===0?(jr=!0,r.memoizedState=m):(r=Zd(),ri.lanes|=r,_l|=r,l)}function jn(r,l,m,T,I){var B=Pt.p;Pt.p=B!==0&&8>B?B:8;var J=lt.T,he={};lt.T=he,Fr(r,!1,l,m);try{var De=I(),at=lt.S;if(at!==null&&at(he,De),De!==null&&typeof De=="object"&&typeof De.then=="function"){var yt=Oh(De,T);Ao(r,l,yt,Tn(r))}else Ao(r,l,T,Tn(r))}catch(St){Ao(r,l,{then:function(){},status:"rejected",reason:St},Tn())}finally{Pt.p=B,J!==null&&he.types!==null&&(J.types=he.types),lt.T=J}}function Br(){}function lr(r,l,m,T){if(r.tag!==5)throw Error(g(476));var I=gr(r).queue;jn(r,I,l,Mt,m===null?Br:function(){return pa(r),m(T)})}function gr(r){var l=r.memoizedState;if(l!==null)return l;l={memoizedState:Mt,baseState:Mt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fs,lastRenderedState:Mt},next:null};var m={};return l.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fs,lastRenderedState:m},next:null},r.memoizedState=l,r=r.alternate,r!==null&&(r.memoizedState=l),l}function pa(r){var l=gr(r);l.next===null&&(l=r.alternate.memoizedState),Ao(r,l.next.queue,{},Tn())}function za(){return Pr(sp)}function Ns(){return Jn().memoizedState}function Kl(){return Jn().memoizedState}function cc(r){for(var l=r.return;l!==null;){switch(l.tag){case 24:case 3:var m=Tn();r=$i(m);var T=Zl(l,r,m);T!==null&&(xs(T,l,m),Pu(T,l,m)),l={cache:Su()},r.payload=l;return}l=l.return}}function zd(r,l,m){var T=Tn();m={lane:T,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},sa(r)?ma(l,m):(m=cl(r,l,m,T),m!==null&&(xs(m,r,T),Ko(m,l,T)))}function hc(r,l,m){var T=Tn();Ao(r,l,m,T)}function Ao(r,l,m,T){var I={lane:T,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null};if(sa(r))ma(l,I);else{var B=r.alternate;if(r.lanes===0&&(B===null||B.lanes===0)&&(B=l.lastRenderedReducer,B!==null))try{var J=l.lastRenderedState,he=B(J,m);if(I.hasEagerState=!0,I.eagerState=he,ra(he,J))return Ls(r,l,I,0),tr===null&&ul(),!1}catch{}if(m=cl(r,l,I,T),m!==null)return xs(m,r,T),Ko(m,l,T),!0}return!1}function Fr(r,l,m,T){if(T={lane:2,revertLane:fh(),gesture:null,action:T,hasEagerState:!1,eagerState:null,next:null},sa(r)){if(l)throw Error(g(479))}else l=cl(r,m,T,2),l!==null&&xs(l,r,2)}function sa(r){var l=r.alternate;return r===ri||l!==null&&l===ri}function ma(r,l){Wo=lc=!0;var m=r.pending;m===null?l.next=l:(l.next=m.next,m.next=l),r.pending=l}function Ko(r,l,m){if((m&4194048)!==0){var T=l.lanes;T&=r.pendingLanes,m|=T,l.lanes=m,fr(r,m)}}var ur={readContext:Pr,use:rh,useCallback:sr,useContext:sr,useEffect:sr,useImperativeHandle:sr,useLayoutEffect:sr,useInsertionEffect:sr,useMemo:sr,useReducer:sr,useRef:sr,useState:sr,useDebugValue:sr,useDeferredValue:sr,useTransition:sr,useSyncExternalStore:sr,useId:sr,useHostTransitionStatus:sr,useFormState:sr,useActionState:sr,useOptimistic:sr,useMemoCache:sr,useCacheRefresh:sr};ur.useEffectEvent=sr;var Nr={readContext:Pr,use:rh,useCallback:function(r,l){return Pa().memoizedState=[r,l===void 0?null:l],r},useContext:Pr,useEffect:Je,useImperativeHandle:function(r,l,m){m=m!=null?m.concat([r]):null,Ke(4194308,4,wi.bind(null,l,r),m)},useLayoutEffect:function(r,l){return Ke(4194308,4,r,l)},useInsertionEffect:function(r,l){Ke(4,2,r,l)},useMemo:function(r,l){var m=Pa();l=l===void 0?null:l;var T=r();if($l){We(!0);try{r()}finally{We(!1)}}return m.memoizedState=[T,l],T},useReducer:function(r,l,m){var T=Pa();if(m!==void 0){var I=m(l);if($l){We(!0);try{m(l)}finally{We(!1)}}}else I=l;return T.memoizedState=T.baseState=I,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:I},T.queue=r,r=r.dispatch=zd.bind(null,ri,r),[T.memoizedState,r]},useRef:function(r){var l=Pa();return r={current:r},l.memoizedState=r},useState:function(r){r=U(r);var l=r.queue,m=hc.bind(null,ri,l);return l.dispatch=m,[r.memoizedState,m]},useDebugValue:In,useDeferredValue:function(r,l){var m=Pa();return xn(m,r,l)},useTransition:function(){var r=U(!1);return r=jn.bind(null,ri,r.queue,!0,!1),Pa().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,l,m){var T=ri,I=Pa();if(Ri){if(m===void 0)throw Error(g(407));m=m()}else{if(m=l(),tr===null)throw Error(g(349));(Zi&127)!==0||y(T,l,m)}I.memoizedState=m;var B={value:m,getSnapshot:l};return I.queue=B,Je(C.bind(null,T,B,r),[r]),T.flags|=2048,we(9,{destroy:void 0},M.bind(null,T,B,m,l),null),m},useId:function(){var r=Pa(),l=tr.identifierPrefix;if(Ri){var m=jt,T=Tt;m=(T&~(1<<32-mt(T)-1)).toString(32)+m,l="_"+l+"R_"+m,m=th++,0<m&&(l+="H"+m.toString(32)),l+="_"}else m=Ef++,l="_"+l+"r_"+m.toString(32)+"_";return r.memoizedState=l},useHostTransitionStatus:za,useFormState:ve,useActionState:ve,useOptimistic:function(r){var l=Pa();l.memoizedState=l.baseState=r;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=m,l=Fr.bind(null,ri,!0,m),m.dispatch=l,[r,l]},useMemoCache:ah,useCacheRefresh:function(){return Pa().memoizedState=cc.bind(null,ri)},useEffectEvent:function(r){var l=Pa(),m={impl:r};return l.memoizedState=m,function(){if((wn&2)!==0)throw Error(g(440));return m.impl.apply(void 0,arguments)}}},mo={readContext:Pr,use:rh,useCallback:gn,useContext:Pr,useEffect:tt,useImperativeHandle:hn,useInsertionEffect:_t,useLayoutEffect:Yt,useMemo:qn,useReducer:b,useRef:ke,useState:function(){return b(Fs)},useDebugValue:In,useDeferredValue:function(r,l){var m=Jn();return Or(m,zn.memoizedState,r,l)},useTransition:function(){var r=b(Fs)[0],l=Jn().memoizedState;return[typeof r=="boolean"?r:uc(r),l]},useSyncExternalStore:f,useId:Ns,useHostTransitionStatus:za,useFormState:Se,useActionState:Se,useOptimistic:function(r,l){var m=Jn();return G(m,zn,r,l)},useMemoCache:ah,useCacheRefresh:Kl};mo.useEffectEvent=Ct;var Qn={readContext:Pr,use:rh,useCallback:gn,useContext:Pr,useEffect:tt,useImperativeHandle:hn,useInsertionEffect:_t,useLayoutEffect:Yt,useMemo:qn,useReducer:o,useRef:ke,useState:function(){return o(Fs)},useDebugValue:In,useDeferredValue:function(r,l){var m=Jn();return zn===null?xn(m,r,l):Or(m,zn.memoizedState,r,l)},useTransition:function(){var r=o(Fs)[0],l=Jn().memoizedState;return[typeof r=="boolean"?r:uc(r),l]},useSyncExternalStore:f,useId:Ns,useHostTransitionStatus:za,useFormState:Ie,useActionState:Ie,useOptimistic:function(r,l){var m=Jn();return zn!==null?G(m,zn,r,l):(m.baseState=r,[r,m.queue.dispatch])},useMemoCache:ah,useCacheRefresh:Kl};Qn.useEffectEvent=Ct;function Af(r,l,m,T){l=r.memoizedState,m=m(T,l),m=m==null?l:K({},l,m),r.memoizedState=m,r.lanes===0&&(r.updateQueue.baseState=m)}var Id={enqueueSetState:function(r,l,m){r=r._reactInternals;var T=Tn(),I=$i(T);I.payload=l,m!=null&&(I.callback=m),l=Zl(r,I,T),l!==null&&(xs(l,r,T),Pu(l,r,T))},enqueueReplaceState:function(r,l,m){r=r._reactInternals;var T=Tn(),I=$i(T);I.tag=1,I.payload=l,m!=null&&(I.callback=m),l=Zl(r,I,T),l!==null&&(xs(l,r,T),Pu(l,r,T))},enqueueForceUpdate:function(r,l){r=r._reactInternals;var m=Tn(),T=$i(m);T.tag=2,l!=null&&(T.callback=l),l=Zl(r,T,m),l!==null&&(xs(l,r,m),Pu(l,r,m))}};function Ld(r,l,m,T,I,B,J){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(T,B,J):l.prototype&&l.prototype.isPureReactComponent?!zs(m,T)||!zs(I,B):!0}function Cf(r,l,m,T){r=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(m,T),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(m,T),l.state!==r&&Id.enqueueReplaceState(l,l.state,null)}function Jo(r,l){var m=l;if("ref"in l){m={};for(var T in l)T!=="ref"&&(m[T]=l[T])}if(r=r.defaultProps){m===l&&(m=K({},m));for(var I in r)m[I]===void 0&&(m[I]=r[I])}return m}function Lu(r){Ho(r)}function Jl(r){console.error(r)}function Pf(r){Ho(r)}function dc(r,l){try{var m=r.onUncaughtError;m(l.value,{componentStack:l.stack})}catch(T){setTimeout(function(){throw T})}}function Dd(r,l,m){try{var T=r.onCaughtError;T(m.value,{componentStack:m.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function Du(r,l,m){return m=$i(m),m.tag=3,m.payload={element:null},m.callback=function(){dc(r,l)},m}function Rd(r){return r=$i(r),r.tag=3,r}function kd(r,l,m,T){var I=m.type.getDerivedStateFromError;if(typeof I=="function"){var B=T.value;r.payload=function(){return I(B)},r.callback=function(){Dd(l,m,T)}}var J=m.stateNode;J!==null&&typeof J.componentDidCatch=="function"&&(r.callback=function(){Dd(l,m,T),typeof I!="function"&&(ch===null?ch=new Set([this]):ch.add(this));var he=T.stack;this.componentDidCatch(T.value,{componentStack:he!==null?he:""})})}function Qm(r,l,m,T,I){if(m.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){if(l=m.alternate,l!==null&&ys(l,m,I,!0),m=fo.current,m!==null){switch(m.tag){case 31:case 13:return fa===null?_c():m.alternate===null&&Gr===0&&(Gr=3),m.flags&=-257,m.flags|=65536,m.lanes=I,T===Nh?m.flags|=16384:(l=m.updateQueue,l===null?m.updateQueue=new Set([T]):l.add(T),Hf(r,T,I)),!1;case 22:return m.flags|=65536,T===Nh?m.flags|=16384:(l=m.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([T])},m.updateQueue=l):(m=l.retryQueue,m===null?l.retryQueue=new Set([T]):m.add(T)),Hf(r,T,I)),!1}throw Error(g(435,m.tag))}return Hf(r,T,I),_c(),!1}if(Ri)return l=fo.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=I,T!==Nn&&(r=Error(g(422),{cause:T}),Rs(x(r,m)))):(T!==Nn&&(l=Error(g(423),{cause:T}),Rs(x(l,m))),r=r.current.alternate,r.flags|=65536,I&=-I,r.lanes|=I,T=x(T,m),I=Du(r.stateNode,T,I),ac(r,I),Gr!==4&&(Gr=2)),!1;var B=Error(g(520),{cause:T});if(B=x(B,m),Uf===null?Uf=[B]:Uf.push(B),Gr!==4&&(Gr=2),l===null)return!0;T=x(T,m),m=l;do{switch(m.tag){case 3:return m.flags|=65536,r=I&-I,m.lanes|=r,r=Du(m.stateNode,T,r),ac(m,r),!1;case 1:if(l=m.type,B=m.stateNode,(m.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(ch===null||!ch.has(B))))return m.flags|=65536,I&=-I,m.lanes|=I,I=Rd(I),kd(I,r,m,T),ac(m,I),!1}m=m.return}while(m!==null);return!1}var eg=Error(g(461)),jr=!1;function Ka(r,l,m,T){l.child=r===null?Ad(l,null,m,T):ml(l,r.child,m,T)}function tg(r,l,m,T,I){m=m.render;var B=l.ref;if("ref"in T){var J={};for(var he in T)he!=="ref"&&(J[he]=T[he])}else J=T;return Vl(l),T=ih(r,l,m,J,B,I),he=$h(),r!==null&&!jr?(Yl(r,l,I),zr(r,l,I)):(Ri&&he&&mr(l),l.flags|=1,Ka(r,l,T,I),l.child)}function Hh(r,l,m,T,I){if(r===null){var B=m.type;return typeof B=="function"&&!tc(B)&&B.defaultProps===void 0&&m.compare===null?(l.tag=15,l.type=B,$y(r,l,B,T,I)):(r=ic(m.type,null,T,l,l.mode,I),r.ref=l.ref,r.return=l,l.child=r)}if(B=r.child,!Gp(r,I)){var J=B.memoizedProps;if(m=m.compare,m=m!==null?m:zs,m(J,T)&&r.ref===l.ref)return zr(r,l,I)}return l.flags|=1,r=qa(B,T),r.ref=l.ref,r.return=l,l.child=r}function $y(r,l,m,T,I){if(r!==null){var B=r.memoizedProps;if(zs(B,T)&&r.ref===l.ref)if(jr=!1,l.pendingProps=T=B,Gp(r,I))(r.flags&131072)!==0&&(jr=!0);else return l.lanes=r.lanes,zr(r,l,I)}return ig(r,l,m,T,I)}function Xh(r,l,m,T){var I=T.children,B=r!==null?r.memoizedState:null;if(r===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),T.mode==="hidden"){if((l.flags&128)!==0){if(B=B!==null?B.baseLanes|m:m,r!==null){for(T=l.child=r.child,I=0;T!==null;)I=I|T.lanes|T.childLanes,T=T.sibling;T=I&~B}else T=0,l.child=null;return zf(r,l,B,m,T)}if((m&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},r!==null&&Mu(l,B!==null?B.cachePool:null),B!==null?Jt(l,B):ai(),Mf(l);else return T=l.lanes=536870912,zf(r,l,B!==null?B.baseLanes|m:m,m,T)}else B!==null?(Mu(l,B.cachePool),Jt(l,B),Iu(),l.memoizedState=null):(r!==null&&Mu(l,null),ai(),Iu());return Ka(r,l,I,m),l.child}function oh(r,l){return r!==null&&r.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function zf(r,l,m,T,I){var B=Bh();return B=B===null?null:{parent:ar._currentValue,pool:B},l.memoizedState={baseLanes:m,cachePool:B},r!==null&&Mu(l,null),ai(),Mf(l),r!==null&&ys(r,l,T,!0),l.childLanes=I,null}function Bp(r,l){return l=Vp({mode:l.mode,children:l.children},r.mode),l.ref=r.ref,r.child=l,l.return=r,l}function Hy(r,l,m){return ml(l,r.child,null,m),r=Bp(l,l.pendingProps),r.flags|=2,Eo(l),l.memoizedState=null,r}function Wv(r,l,m){var T=l.pendingProps,I=(l.flags&128)!==0;if(l.flags&=-129,r===null){if(Ri){if(T.mode==="hidden")return r=Bp(l,T),l.lanes=536870912,oh(null,r);if(po(l),(r=Wi)?(r=Fg(r,so),r=r!==null&&r.data==="&"?r:null,r!==null&&(l.memoizedState={dehydrated:r,treeContext:ot!==null?{id:Tt,overflow:jt}:null,retryLane:536870912,hydrationErrors:null},m=nc(r),m.return=l,l.child=m,cn=l,Wi=null)):r=null,r===null)throw Ha(l);return l.lanes=536870912,null}return Bp(l,T)}var B=r.memoizedState;if(B!==null){var J=B.dehydrated;if(po(l),I)if(l.flags&256)l.flags&=-257,l=Hy(r,l,m);else if(l.memoizedState!==null)l.child=r.child,l.flags|=128,l=null;else throw Error(g(558));else if(jr||ys(r,l,m,!1),I=(m&r.childLanes)!==0,jr||I){if(T=tr,T!==null&&(J=du(T,m),J!==0&&J!==B.retryLane))throw B.retryLane=J,Ca(r,J),xs(T,r,J),eg;_c(),l=Hy(r,l,m)}else r=B.treeContext,Wi=bl(J.nextSibling),cn=l,Ri=!0,Ds=null,so=!1,r!==null&&$a(l,r),l=Bp(l,T),l.flags|=4096;return l}return r=qa(r.child,{mode:T.mode,children:T.children}),r.ref=l.ref,l.child=r,r.return=l,r}function Fp(r,l){var m=l.ref;if(m===null)r!==null&&r.ref!==null&&(l.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(g(284));(r===null||r.ref!==m)&&(l.flags|=4194816)}}function ig(r,l,m,T,I){return Vl(l),m=ih(r,l,m,T,void 0,I),T=$h(),r!==null&&!jr?(Yl(r,l,I),zr(r,l,I)):(Ri&&T&&mr(l),l.flags|=1,Ka(r,l,m,I),l.child)}function ng(r,l,m,T,I,B){return Vl(l),l.updateQueue=null,m=Zh(l,T,m,I),nh(r),T=$h(),r!==null&&!jr?(Yl(r,l,B),zr(r,l,B)):(Ri&&T&&mr(l),l.flags|=1,Ka(r,l,m,B),l.child)}function Np(r,l,m,T,I){if(Vl(l),l.stateNode===null){var B=Si,J=m.contextType;typeof J=="object"&&J!==null&&(B=Pr(J)),B=new m(T,B),l.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,B.updater=Id,l.stateNode=B,B._reactInternals=l,B=l.stateNode,B.props=T,B.state=l.memoizedState,B.refs={},Cd(l),J=m.contextType,B.context=typeof J=="object"&&J!==null?Pr(J):Si,B.state=l.memoizedState,J=m.getDerivedStateFromProps,typeof J=="function"&&(Af(l,m,J,T),B.state=l.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof B.getSnapshotBeforeUpdate=="function"||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(J=B.state,typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount(),J!==B.state&&Id.enqueueReplaceState(B,B.state,null),eh(l,T,B,I),oc(),B.state=l.memoizedState),typeof B.componentDidMount=="function"&&(l.flags|=4194308),T=!0}else if(r===null){B=l.stateNode;var he=l.memoizedProps,De=Jo(m,he);B.props=De;var at=B.context,yt=m.contextType;J=Si,typeof yt=="object"&&yt!==null&&(J=Pr(yt));var St=m.getDerivedStateFromProps;yt=typeof St=="function"||typeof B.getSnapshotBeforeUpdate=="function",he=l.pendingProps!==he,yt||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(he||at!==J)&&Cf(l,B,T,J),Gl=!1;var st=l.memoizedState;B.state=st,eh(l,T,B,I),oc(),at=l.memoizedState,he||st!==at||Gl?(typeof St=="function"&&(Af(l,m,St,T),at=l.memoizedState),(De=Gl||Ld(l,m,De,T,st,at,J))?(yt||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(l.flags|=4194308)):(typeof B.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=T,l.memoizedState=at),B.props=T,B.state=at,B.context=J,T=De):(typeof B.componentDidMount=="function"&&(l.flags|=4194308),T=!1)}else{B=l.stateNode,Os(r,l),J=l.memoizedProps,yt=Jo(m,J),B.props=yt,St=l.pendingProps,st=B.context,at=m.contextType,De=Si,typeof at=="object"&&at!==null&&(De=Pr(at)),he=m.getDerivedStateFromProps,(at=typeof he=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(J!==St||st!==De)&&Cf(l,B,T,De),Gl=!1,st=l.memoizedState,B.state=st,eh(l,T,B,I),oc();var ht=l.memoizedState;J!==St||st!==ht||Gl||r!==null&&r.dependencies!==null&&Yc(r.dependencies)?(typeof he=="function"&&(Af(l,m,he,T),ht=l.memoizedState),(yt=Gl||Ld(l,m,yt,T,st,ht,De)||r!==null&&r.dependencies!==null&&Yc(r.dependencies))?(at||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(T,ht,De),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(T,ht,De)),typeof B.componentDidUpdate=="function"&&(l.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof B.componentDidUpdate!="function"||J===r.memoizedProps&&st===r.memoizedState||(l.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||J===r.memoizedProps&&st===r.memoizedState||(l.flags|=1024),l.memoizedProps=T,l.memoizedState=ht),B.props=T,B.state=ht,B.context=De,T=yt):(typeof B.componentDidUpdate!="function"||J===r.memoizedProps&&st===r.memoizedState||(l.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||J===r.memoizedProps&&st===r.memoizedState||(l.flags|=1024),T=!1)}return B=T,Fp(r,l),T=(l.flags&128)!==0,B||T?(B=l.stateNode,m=T&&typeof m.getDerivedStateFromError!="function"?null:B.render(),l.flags|=1,r!==null&&T?(l.child=ml(l,r.child,null,I),l.child=ml(l,null,m,I)):Ka(r,l,m,I),l.memoizedState=B.state,r=l.child):r=zr(r,l,I),r}function rg(r,l,m,T){return ps(),l.flags|=256,Ka(r,l,m,T),l.child}var jp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ag(r){return{baseLanes:r,cachePool:pl()}}function og(r,l,m){return r=r!==null?r.childLanes&~m:0,l&&(r|=Gs),r}function sg(r,l,m){var T=l.pendingProps,I=!1,B=(l.flags&128)!==0,J;if((J=B)||(J=r!==null&&r.memoizedState===null?!1:(wr.current&2)!==0),J&&(I=!0,l.flags&=-129),J=(l.flags&32)!==0,l.flags&=-33,r===null){if(Ri){if(I?xr(l):Iu(),(r=Wi)?(r=Fg(r,so),r=r!==null&&r.data!=="&"?r:null,r!==null&&(l.memoizedState={dehydrated:r,treeContext:ot!==null?{id:Tt,overflow:jt}:null,retryLane:536870912,hydrationErrors:null},m=nc(r),m.return=l,l.child=m,cn=l,Wi=null)):r=null,r===null)throw Ha(l);return la(r)?l.lanes=32:l.lanes=536870912,null}var he=T.children;return T=T.fallback,I?(Iu(),I=l.mode,he=Vp({mode:"hidden",children:he},I),T=hl(T,I,m,null),he.return=l,T.return=l,he.sibling=T,l.child=he,T=l.child,T.memoizedState=ag(m),T.childLanes=og(r,J,m),l.memoizedState=jp,oh(null,T)):(xr(l),Up(l,he))}var De=r.memoizedState;if(De!==null&&(he=De.dehydrated,he!==null)){if(B)l.flags&256?(xr(l),l.flags&=-257,l=If(r,l,m)):l.memoizedState!==null?(Iu(),l.child=r.child,l.flags|=128,l=null):(Iu(),he=T.fallback,I=l.mode,T=Vp({mode:"visible",children:T.children},I),he=hl(he,I,m,null),he.flags|=2,T.return=l,he.return=l,T.sibling=he,l.child=T,ml(l,r.child,null,m),T=l.child,T.memoizedState=ag(m),T.childLanes=og(r,J,m),l.memoizedState=jp,l=oh(null,T));else if(xr(l),la(he)){if(J=he.nextSibling&&he.nextSibling.dataset,J)var at=J.dgst;J=at,T=Error(g(419)),T.stack="",T.digest=J,Rs({value:T,source:null,stack:null}),l=If(r,l,m)}else if(jr||ys(r,l,m,!1),J=(m&r.childLanes)!==0,jr||J){if(J=tr,J!==null&&(T=du(J,m),T!==0&&T!==De.retryLane))throw De.retryLane=T,Ca(r,T),xs(J,r,T),eg;ts(he)||_c(),l=If(r,l,m)}else ts(he)?(l.flags|=192,l.child=r.child,l=null):(r=De.treeContext,Wi=bl(he.nextSibling),cn=l,Ri=!0,Ds=null,so=!1,r!==null&&$a(l,r),l=Up(l,T.children),l.flags|=4096);return l}return I?(Iu(),he=T.fallback,I=l.mode,De=r.child,at=De.sibling,T=qa(De,{mode:"hidden",children:T.children}),T.subtreeFlags=De.subtreeFlags&65011712,at!==null?he=qa(at,he):(he=hl(he,I,m,null),he.flags|=2),he.return=l,T.return=l,T.sibling=he,l.child=T,oh(null,T),T=l.child,he=r.child.memoizedState,he===null?he=ag(m):(I=he.cachePool,I!==null?(De=ar._currentValue,I=I.parent!==De?{parent:De,pool:De}:I):I=pl(),he={baseLanes:he.baseLanes|m,cachePool:I}),T.memoizedState=he,T.childLanes=og(r,J,m),l.memoizedState=jp,oh(r.child,T)):(xr(l),m=r.child,r=m.sibling,m=qa(m,{mode:"visible",children:T.children}),m.return=l,m.sibling=null,r!==null&&(J=l.deletions,J===null?(l.deletions=[r],l.flags|=16):J.push(r)),l.child=m,l.memoizedState=null,m)}function Up(r,l){return l=Vp({mode:"visible",children:l},r.mode),l.return=r,r.child=l}function Vp(r,l){return r=Za(22,r,null,l),r.lanes=0,r}function If(r,l,m){return ml(l,r.child,null,m),r=Up(l,l.pendingProps.children),r.flags|=2,l.memoizedState=null,r}function lg(r,l,m){r.lanes|=l;var T=r.alternate;T!==null&&(T.lanes|=l),xd(r.return,l,m)}function Lf(r,l,m,T,I,B){var J=r.memoizedState;J===null?r.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:T,tail:m,tailMode:I,treeForkCount:B}:(J.isBackwards=l,J.rendering=null,J.renderingStartTime=0,J.last=T,J.tail=m,J.tailMode=I,J.treeForkCount=B)}function Od(r,l,m){var T=l.pendingProps,I=T.revealOrder,B=T.tail;T=T.children;var J=wr.current,he=(J&2)!==0;if(he?(J=J&1|2,l.flags|=128):J&=1,It(wr,J),Ka(r,l,T,m),T=Ri?se:0,!he&&r!==null&&(r.flags&128)!==0)e:for(r=l.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&lg(r,m,l);else if(r.tag===19)lg(r,m,l);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===l)break e;for(;r.sibling===null;){if(r.return===null||r.return===l)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(I){case"forwards":for(m=l.child,I=null;m!==null;)r=m.alternate,r!==null&&ql(r)===null&&(I=m),m=m.sibling;m=I,m===null?(I=l.child,l.child=null):(I=m.sibling,m.sibling=null),Lf(l,!1,I,m,B,T);break;case"backwards":case"unstable_legacy-backwards":for(m=null,I=l.child,l.child=null;I!==null;){if(r=I.alternate,r!==null&&ql(r)===null){l.child=I;break}r=I.sibling,I.sibling=m,m=I,I=r}Lf(l,!0,m,null,B,T);break;case"together":Lf(l,!1,null,null,void 0,T);break;default:l.memoizedState=null}return l.child}function zr(r,l,m){if(r!==null&&(l.dependencies=r.dependencies),_l|=l.lanes,(m&l.childLanes)===0)if(r!==null){if(ys(r,l,m,!1),(m&l.childLanes)===0)return null}else return null;if(r!==null&&l.child!==r.child)throw Error(g(153));if(l.child!==null){for(r=l.child,m=qa(r,r.pendingProps),l.child=m,m.return=l;r.sibling!==null;)r=r.sibling,m=m.sibling=qa(r,r.pendingProps),m.return=l;m.sibling=null}return l.child}function Gp(r,l){return(r.lanes&l)!==0?!0:(r=r.dependencies,!!(r!==null&&Yc(r)))}function ug(r,l,m){switch(l.tag){case 3:Ei(l,l.stateNode.containerInfo),Ul(l,ar,r.memoizedState.cache),ps();break;case 27:case 5:hr(l);break;case 4:Ei(l,l.stateNode.containerInfo);break;case 10:Ul(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,po(l),null;break;case 13:var T=l.memoizedState;if(T!==null)return T.dehydrated!==null?(xr(l),l.flags|=128,null):(m&l.child.childLanes)!==0?sg(r,l,m):(xr(l),r=zr(r,l,m),r!==null?r.sibling:null);xr(l);break;case 19:var I=(r.flags&128)!==0;if(T=(m&l.childLanes)!==0,T||(ys(r,l,m,!1),T=(m&l.childLanes)!==0),I){if(T)return Od(r,l,m);l.flags|=128}if(I=l.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),It(wr,wr.current),T)break;return null;case 22:return l.lanes=0,Xh(r,l,m,l.pendingProps);case 24:Ul(l,ar,r.memoizedState.cache)}return zr(r,l,m)}function Xy(r,l,m){if(r!==null)if(r.memoizedProps!==l.pendingProps)jr=!0;else{if(!Gp(r,m)&&(l.flags&128)===0)return jr=!1,ug(r,l,m);jr=(r.flags&131072)!==0}else jr=!1,Ri&&(l.flags&1048576)!==0&&zi(l,se,l.index);switch(l.lanes=0,l.tag){case 16:e:{var T=l.pendingProps;if(r=Yo(l.elementType),l.type=r,typeof r=="function")tc(r)?(T=Jo(r,T),l.tag=1,l=Np(null,l,r,T,m)):(l.tag=0,l=ig(null,l,r,T,m));else{if(r!=null){var I=r.$$typeof;if(I===Be){l.tag=11,l=tg(null,l,r,T,m);break e}else if(I===Qe){l.tag=14,l=Hh(null,l,r,T,m);break e}}throw l=Ci(r)||r,Error(g(306,l,""))}}return l;case 0:return ig(r,l,l.type,l.pendingProps,m);case 1:return T=l.type,I=Jo(T,l.pendingProps),Np(r,l,T,I,m);case 3:e:{if(Ei(l,l.stateNode.containerInfo),r===null)throw Error(g(387));T=l.pendingProps;var B=l.memoizedState;I=B.element,Os(r,l),eh(l,T,null,m);var J=l.memoizedState;if(T=J.cache,Ul(l,ar,T),T!==B.cache&&wd(l,[ar],m,!0),oc(),T=J.element,B.isDehydrated)if(B={element:T,isDehydrated:!1,cache:J.cache},l.updateQueue.baseState=B,l.memoizedState=B,l.flags&256){l=rg(r,l,T,m);break e}else if(T!==I){I=x(Error(g(424)),l),Rs(I),l=rg(r,l,T,m);break e}else for(r=l.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,Wi=bl(r.firstChild),cn=l,Ri=!0,Ds=null,so=!0,m=Ad(l,null,T,m),l.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(ps(),T===I){l=zr(r,l,m);break e}Ka(r,l,T,m)}l=l.child}return l;case 26:return Fp(r,l),r===null?(m=mm(l.type,null,l.pendingProps,null))?l.memoizedState=m:Ri||(m=l.type,r=l.pendingProps,T=bc(kt.current).createElement(m),T[vn]=l,T[At]=r,qr(T,m,r),Xn(T),l.stateNode=T):l.memoizedState=mm(l.type,r.memoizedProps,l.pendingProps,r.memoizedState),null;case 27:return hr(l),r===null&&Ri&&(T=l.stateNode=T_(l.type,l.pendingProps,kt.current),cn=l,so=!0,I=Wi,_r(l.type)?(fm=I,Wi=bl(T.firstChild)):Wi=I),Ka(r,l,l.pendingProps.children,m),Fp(r,l),r===null&&(l.flags|=4194304),l.child;case 5:return r===null&&Ri&&((I=T=Wi)&&(T=ga(T,l.type,l.pendingProps,so),T!==null?(l.stateNode=T,cn=l,Wi=bl(T.firstChild),so=!1,I=!0):I=!1),I||Ha(l)),hr(l),I=l.type,B=l.pendingProps,J=r!==null?r.memoizedProps:null,T=B.children,np(I,B)?T=null:J!==null&&np(I,J)&&(l.flags|=32),l.memoizedState!==null&&(I=ih(r,l,qh,null,null,m),sp._currentValue=I),Fp(r,l),Ka(r,l,T,m),l.child;case 6:return r===null&&Ri&&((r=m=Wi)&&(m=ya(m,l.pendingProps,so),m!==null?(l.stateNode=m,cn=l,Wi=null,r=!0):r=!1),r||Ha(l)),null;case 13:return sg(r,l,m);case 4:return Ei(l,l.stateNode.containerInfo),T=l.pendingProps,r===null?l.child=ml(l,null,T,m):Ka(r,l,T,m),l.child;case 11:return tg(r,l,l.type,l.pendingProps,m);case 7:return Ka(r,l,l.pendingProps,m),l.child;case 8:return Ka(r,l,l.pendingProps.children,m),l.child;case 12:return Ka(r,l,l.pendingProps.children,m),l.child;case 10:return T=l.pendingProps,Ul(l,l.type,T.value),Ka(r,l,T.children,m),l.child;case 9:return I=l.type._context,T=l.pendingProps.children,Vl(l),I=Pr(I),T=T(I),l.flags|=1,Ka(r,l,T,m),l.child;case 14:return Hh(r,l,l.type,l.pendingProps,m);case 15:return $y(r,l,l.type,l.pendingProps,m);case 19:return Od(r,l,m);case 31:return Wv(r,l,m);case 22:return Xh(r,l,m,l.pendingProps);case 24:return Vl(l),T=Pr(ar),r===null?(I=Bh(),I===null&&(I=tr,B=Su(),I.pooledCache=B,B.refCount++,B!==null&&(I.pooledCacheLanes|=m),I=B),l.memoizedState={parent:T,cache:I},Cd(l),Ul(l,ar,I)):((r.lanes&m)!==0&&(Os(r,l),eh(l,null,null,m),oc()),I=r.memoizedState,B=l.memoizedState,I.parent!==T?(I={parent:T,cache:T},l.memoizedState=I,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=I),Ul(l,ar,T)):(T=B.cache,Ul(l,ar,T),T!==I.cache&&wd(l,[ar],m,!0))),Ka(r,l,l.pendingProps.children,m),l.child;case 29:throw l.pendingProps}throw Error(g(156,l.tag))}function Ru(r){r.flags|=4}function cg(r,l,m,T,I){if((l=(r.mode&32)!==0)&&(l=!1),l){if(r.flags|=16777216,(I&335544128)===I)if(r.stateNode.complete)r.flags|=8192;else if(Eg())r.flags|=8192;else throw rc=Nh,Fh}else r.flags&=-16777217}function Yy(r,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Zg(l))if(Eg())r.flags|=8192;else throw rc=Nh,Fh}function Df(r,l){l!==null&&(r.flags|=4),r.flags&16384&&(l=r.tag!==22?un():536870912,r.lanes|=l,Vd|=l)}function Rf(r,l){if(!Ri)switch(r.tailMode){case"hidden":l=r.tail;for(var m=null;l!==null;)l.alternate!==null&&(m=l),l=l.sibling;m===null?r.tail=null:m.sibling=null;break;case"collapsed":m=r.tail;for(var T=null;m!==null;)m.alternate!==null&&(T=m),m=m.sibling;T===null?l||r.tail===null?r.tail=null:r.tail.sibling=null:T.sibling=null}}function er(r){var l=r.alternate!==null&&r.alternate.child===r.child,m=0,T=0;if(l)for(var I=r.child;I!==null;)m|=I.lanes|I.childLanes,T|=I.subtreeFlags&65011712,T|=I.flags&65011712,I.return=r,I=I.sibling;else for(I=r.child;I!==null;)m|=I.lanes|I.childLanes,T|=I.subtreeFlags,T|=I.flags,I.return=r,I=I.sibling;return r.subtreeFlags|=T,r.childLanes=m,l}function Wy(r,l,m){var T=l.pendingProps;switch(Kn(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return er(l),null;case 1:return er(l),null;case 3:return m=l.stateNode,T=null,r!==null&&(T=r.memoizedState.cache),l.memoizedState.cache!==T&&(l.flags|=2048),fl(ar),rn(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(r===null||r.child===null)&&(lo(l)?Ru(l):r===null||r.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,ms())),er(l),null;case 26:var I=l.type,B=l.memoizedState;return r===null?(Ru(l),B!==null?(er(l),Yy(l,B)):(er(l),cg(l,I,null,T,m))):B?B!==r.memoizedState?(Ru(l),er(l),Yy(l,B)):(er(l),l.flags&=-16777217):(r=r.memoizedProps,r!==T&&Ru(l),er(l),cg(l,I,r,T,m)),null;case 27:if(_o(l),m=kt.current,I=l.type,r!==null&&l.stateNode!=null)r.memoizedProps!==T&&Ru(l);else{if(!T){if(l.stateNode===null)throw Error(g(166));return er(l),null}r=zt.current,lo(l)?Xa(l):(r=T_(I,T,m),l.stateNode=r,Ru(l))}return er(l),null;case 5:if(_o(l),I=l.type,r!==null&&l.stateNode!=null)r.memoizedProps!==T&&Ru(l);else{if(!T){if(l.stateNode===null)throw Error(g(166));return er(l),null}if(B=zt.current,lo(l))Xa(l);else{var J=bc(kt.current);switch(B){case 1:B=J.createElementNS("http://www.w3.org/2000/svg",I);break;case 2:B=J.createElementNS("http://www.w3.org/1998/Math/MathML",I);break;default:switch(I){case"svg":B=J.createElementNS("http://www.w3.org/2000/svg",I);break;case"math":B=J.createElementNS("http://www.w3.org/1998/Math/MathML",I);break;case"script":B=J.createElement("div"),B.innerHTML="<script><\/script>",B=B.removeChild(B.firstChild);break;case"select":B=typeof T.is=="string"?J.createElement("select",{is:T.is}):J.createElement("select"),T.multiple?B.multiple=!0:T.size&&(B.size=T.size);break;default:B=typeof T.is=="string"?J.createElement(I,{is:T.is}):J.createElement(I)}}B[vn]=l,B[At]=T;e:for(J=l.child;J!==null;){if(J.tag===5||J.tag===6)B.appendChild(J.stateNode);else if(J.tag!==4&&J.tag!==27&&J.child!==null){J.child.return=J,J=J.child;continue}if(J===l)break e;for(;J.sibling===null;){if(J.return===null||J.return===l)break e;J=J.return}J.sibling.return=J.return,J=J.sibling}l.stateNode=B;e:switch(qr(B,I,T),I){case"button":case"input":case"select":case"textarea":T=!!T.autoFocus;break e;case"img":T=!0;break e;default:T=!1}T&&Ru(l)}}return er(l),cg(l,l.type,r===null?null:r.memoizedProps,l.pendingProps,m),null;case 6:if(r&&l.stateNode!=null)r.memoizedProps!==T&&Ru(l);else{if(typeof T!="string"&&l.stateNode===null)throw Error(g(166));if(r=kt.current,lo(l)){if(r=l.stateNode,m=l.memoizedProps,T=null,I=cn,I!==null)switch(I.tag){case 27:case 5:T=I.memoizedProps}r[vn]=l,r=!!(r.nodeValue===m||T!==null&&T.suppressHydrationWarning===!0||om(r.nodeValue,m)),r||Ha(l,!0)}else r=bc(r).createTextNode(T),r[vn]=l,l.stateNode=r}return er(l),null;case 31:if(m=l.memoizedState,r===null||r.memoizedState!==null){if(T=lo(l),m!==null){if(r===null){if(!T)throw Error(g(318));if(r=l.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(g(557));r[vn]=l}else ps(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;er(l),r=!1}else m=ms(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),r=!0;if(!r)return l.flags&256?(Eo(l),l):(Eo(l),null);if((l.flags&128)!==0)throw Error(g(558))}return er(l),null;case 13:if(T=l.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(I=lo(l),T!==null&&T.dehydrated!==null){if(r===null){if(!I)throw Error(g(318));if(I=l.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(g(317));I[vn]=l}else ps(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;er(l),I=!1}else I=ms(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=I),I=!0;if(!I)return l.flags&256?(Eo(l),l):(Eo(l),null)}return Eo(l),(l.flags&128)!==0?(l.lanes=m,l):(m=T!==null,r=r!==null&&r.memoizedState!==null,m&&(T=l.child,I=null,T.alternate!==null&&T.alternate.memoizedState!==null&&T.alternate.memoizedState.cachePool!==null&&(I=T.alternate.memoizedState.cachePool.pool),B=null,T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(B=T.memoizedState.cachePool.pool),B!==I&&(T.flags|=2048)),m!==r&&m&&(l.child.flags|=8192),Df(l,l.updateQueue),er(l),null);case 4:return rn(),r===null&&rm(l.stateNode.containerInfo),er(l),null;case 10:return fl(l.type),er(l),null;case 19:if(dt(wr),T=l.memoizedState,T===null)return er(l),null;if(I=(l.flags&128)!==0,B=T.rendering,B===null)if(I)Rf(T,!1);else{if(Gr!==0||r!==null&&(r.flags&128)!==0)for(r=l.child;r!==null;){if(B=ql(r),B!==null){for(l.flags|=128,Rf(T,!1),r=B.updateQueue,l.updateQueue=r,Df(l,r),l.subtreeFlags=0,r=m,m=l.child;m!==null;)Rh(m,r),m=m.sibling;return It(wr,wr.current&1|2),Ri&&ui(l,T.treeForkCount),l.child}r=r.sibling}T.tail!==null&&Rr()>Vf&&(l.flags|=128,I=!0,Rf(T,!1),l.lanes=4194304)}else{if(!I)if(r=ql(B),r!==null){if(l.flags|=128,I=!0,r=r.updateQueue,l.updateQueue=r,Df(l,r),Rf(T,!0),T.tail===null&&T.tailMode==="hidden"&&!B.alternate&&!Ri)return er(l),null}else 2*Rr()-T.renderingStartTime>Vf&&m!==536870912&&(l.flags|=128,I=!0,Rf(T,!1),l.lanes=4194304);T.isBackwards?(B.sibling=l.child,l.child=B):(r=T.last,r!==null?r.sibling=B:l.child=B,T.last=B)}return T.tail!==null?(r=T.tail,T.rendering=r,T.tail=r.sibling,T.renderingStartTime=Rr(),r.sibling=null,m=wr.current,It(wr,I?m&1|2:m&1),Ri&&ui(l,T.treeForkCount),r):(er(l),null);case 22:case 23:return Eo(l),zu(),T=l.memoizedState!==null,r!==null?r.memoizedState!==null!==T&&(l.flags|=8192):T&&(l.flags|=8192),T?(m&536870912)!==0&&(l.flags&128)===0&&(er(l),l.subtreeFlags&6&&(l.flags|=8192)):er(l),m=l.updateQueue,m!==null&&Df(l,m.retryQueue),m=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(m=r.memoizedState.cachePool.pool),T=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(T=l.memoizedState.cachePool.pool),T!==m&&(l.flags|=2048),r!==null&&dt(ks),null;case 24:return m=null,r!==null&&(m=r.memoizedState.cache),l.memoizedState.cache!==m&&(l.flags|=2048),fl(ar),er(l),null;case 25:return null;case 30:return null}throw Error(g(156,l.tag))}function Ky(r,l){switch(Kn(l),l.tag){case 1:return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 3:return fl(ar),rn(),r=l.flags,(r&65536)!==0&&(r&128)===0?(l.flags=r&-65537|128,l):null;case 26:case 27:case 5:return _o(l),null;case 31:if(l.memoizedState!==null){if(Eo(l),l.alternate===null)throw Error(g(340));ps()}return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 13:if(Eo(l),r=l.memoizedState,r!==null&&r.dehydrated!==null){if(l.alternate===null)throw Error(g(340));ps()}return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 19:return dt(wr),null;case 4:return rn(),null;case 10:return fl(l.type),null;case 22:case 23:return Eo(l),zu(),r!==null&&dt(ks),r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 24:return fl(ar),null;case 25:return null;default:return null}}function Jy(r,l){switch(Kn(l),l.tag){case 3:fl(ar),rn();break;case 26:case 27:case 5:_o(l);break;case 4:rn();break;case 31:l.memoizedState!==null&&Eo(l);break;case 13:Eo(l);break;case 19:dt(wr);break;case 10:fl(l.type);break;case 22:case 23:Eo(l),zu(),r!==null&&dt(ks);break;case 24:fl(ar)}}function kf(r,l){try{var m=l.updateQueue,T=m!==null?m.lastEffect:null;if(T!==null){var I=T.next;m=I;do{if((m.tag&r)===r){T=void 0;var B=m.create,J=m.inst;T=B(),J.destroy=T}m=m.next}while(m!==I)}}catch(he){Sn(l,l.return,he)}}function sh(r,l,m){try{var T=l.updateQueue,I=T!==null?T.lastEffect:null;if(I!==null){var B=I.next;T=B;do{if((T.tag&r)===r){var J=T.inst,he=J.destroy;if(he!==void 0){J.destroy=void 0,I=l;var De=m,at=he;try{at()}catch(yt){Sn(I,De,yt)}}}T=T.next}while(T!==B)}}catch(yt){Sn(l,l.return,yt)}}function Of(r){var l=r.updateQueue;if(l!==null){var m=r.stateNode;try{Sf(l,m)}catch(T){Sn(r,r.return,T)}}}function Zp(r,l,m){m.props=Jo(r.type,r.memoizedProps),m.state=r.memoizedState;try{m.componentWillUnmount()}catch(T){Sn(r,l,T)}}function Bd(r,l){try{var m=r.ref;if(m!==null){switch(r.tag){case 26:case 27:case 5:var T=r.stateNode;break;case 30:T=r.stateNode;break;default:T=r.stateNode}typeof m=="function"?r.refCleanup=m(T):m.current=T}}catch(I){Sn(r,l,I)}}function Co(r,l){var m=r.ref,T=r.refCleanup;if(m!==null)if(typeof T=="function")try{T()}catch(I){Sn(r,l,I)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(I){Sn(r,l,I)}else m.current=null}function Fd(r){var l=r.type,m=r.memoizedProps,T=r.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":m.autoFocus&&T.focus();break e;case"img":m.src?T.src=m.src:m.srcSet&&(T.srcset=m.srcSet)}}catch(I){Sn(r,r.return,I)}}function hg(r,l,m){try{var T=r.stateNode;tp(T,r.type,m,l),T[At]=l}catch(I){Sn(r,r.return,I)}}function Qy(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&_r(r.type)||r.tag===4}function dg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Qy(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&_r(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function fg(r,l,m){var T=r.tag;if(T===5||T===6)r=r.stateNode,l?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(r,l):(l=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,l.appendChild(r),m=m._reactRootContainer,m!=null||l.onclick!==null||(l.onclick=ka));else if(T!==4&&(T===27&&_r(r.type)&&(m=r.stateNode,l=null),r=r.child,r!==null))for(fg(r,l,m),r=r.sibling;r!==null;)fg(r,l,m),r=r.sibling}function qp(r,l,m){var T=r.tag;if(T===5||T===6)r=r.stateNode,l?m.insertBefore(r,l):m.appendChild(r);else if(T!==4&&(T===27&&_r(r.type)&&(m=r.stateNode),r=r.child,r!==null))for(qp(r,l,m),r=r.sibling;r!==null;)qp(r,l,m),r=r.sibling}function e_(r){var l=r.stateNode,m=r.memoizedProps;try{for(var T=r.type,I=l.attributes;I.length;)l.removeAttributeNode(I[0]);qr(l,T,m),l[vn]=r,l[At]=m}catch(B){Sn(r,r.return,B)}}var fc=!1,Ur=!1,pg=!1,mg=typeof WeakSet=="function"?WeakSet:Set,Vr=null;function Kv(r,l){if(r=r.containerInfo,sm=rf,r=Dl(r),fs(r)){if("selectionStart"in r)var m={start:r.selectionStart,end:r.selectionEnd};else e:{m=(m=r.ownerDocument)&&m.defaultView||window;var T=m.getSelection&&m.getSelection();if(T&&T.rangeCount!==0){m=T.anchorNode;var I=T.anchorOffset,B=T.focusNode;T=T.focusOffset;try{m.nodeType,B.nodeType}catch{m=null;break e}var J=0,he=-1,De=-1,at=0,yt=0,St=r,st=null;t:for(;;){for(var ht;St!==m||I!==0&&St.nodeType!==3||(he=J+I),St!==B||T!==0&&St.nodeType!==3||(De=J+T),St.nodeType===3&&(J+=St.nodeValue.length),(ht=St.firstChild)!==null;)st=St,St=ht;for(;;){if(St===r)break t;if(st===m&&++at===I&&(he=J),st===B&&++yt===T&&(De=J),(ht=St.nextSibling)!==null)break;St=st,st=St.parentNode}St=ht}m=he===-1||De===-1?null:{start:he,end:De}}else m=null}m=m||{start:0,end:0}}else m=null;for(lm={focusedElem:r,selectionRange:m},rf=!1,Vr=l;Vr!==null;)if(l=Vr,r=l.child,(l.subtreeFlags&1028)!==0&&r!==null)r.return=l,Vr=r;else for(;Vr!==null;){switch(l=Vr,B=l.alternate,r=l.flags,l.tag){case 0:if((r&4)!==0&&(r=l.updateQueue,r=r!==null?r.events:null,r!==null))for(m=0;m<r.length;m++)I=r[m],I.ref.impl=I.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&B!==null){r=void 0,m=l,I=B.memoizedProps,B=B.memoizedState,T=m.stateNode;try{var ti=Jo(m.type,I);r=T.getSnapshotBeforeUpdate(ti,B),T.__reactInternalSnapshotBeforeUpdate=r}catch(mi){Sn(m,m.return,mi)}}break;case 3:if((r&1024)!==0){if(r=l.stateNode.containerInfo,m=r.nodeType,m===9)Po(r);else if(m===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Po(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(g(163))}if(r=l.sibling,r!==null){r.return=l.return,Vr=r;break}Vr=l.return}}function Tr(r,l,m){var T=m.flags;switch(m.tag){case 0:case 11:case 15:ku(r,m),T&4&&kf(5,m);break;case 1:if(ku(r,m),T&4)if(r=m.stateNode,l===null)try{r.componentDidMount()}catch(J){Sn(m,m.return,J)}else{var I=Jo(m.type,l.memoizedProps);l=l.memoizedState;try{r.componentDidUpdate(I,l,r.__reactInternalSnapshotBeforeUpdate)}catch(J){Sn(m,m.return,J)}}T&64&&Of(m),T&512&&Bd(m,m.return);break;case 3:if(ku(r,m),T&64&&(r=m.updateQueue,r!==null)){if(l=null,m.child!==null)switch(m.child.tag){case 27:case 5:l=m.child.stateNode;break;case 1:l=m.child.stateNode}try{Sf(r,l)}catch(J){Sn(m,m.return,J)}}break;case 27:l===null&&T&4&&e_(m);case 26:case 5:ku(r,m),l===null&&T&4&&Fd(m),T&512&&Bd(m,m.return);break;case 12:ku(r,m);break;case 31:ku(r,m),T&4&&gg(r,m);break;case 13:ku(r,m),T&4&&yg(r,m),T&64&&(r=m.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(m=r0.bind(null,m),dm(r,m))));break;case 22:if(T=m.memoizedState!==null||fc,!T){l=l!==null&&l.memoizedState!==null||Ur,I=fc;var B=Ur;fc=T,(Ur=l)&&!B?pc(r,m,(m.subtreeFlags&8772)!==0):ku(r,m),fc=I,Ur=B}break;case 30:break;default:ku(r,m)}}function Yh(r){var l=r.alternate;l!==null&&(r.alternate=null,Yh(l)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(l=r.stateNode,l!==null&&Tl(l)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var yr=null,go=!1;function yl(r,l,m){for(m=m.child;m!==null;)Nd(r,l,m),m=m.sibling}function Nd(r,l,m){if(Re&&typeof Re.onCommitFiberUnmount=="function")try{Re.onCommitFiberUnmount(je,m)}catch{}switch(m.tag){case 26:Ur||Co(m,l),yl(r,l,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:Ur||Co(m,l);var T=yr,I=go;_r(m.type)&&(yr=m.stateNode,go=!1),yl(r,l,m),Wd(m.stateNode),yr=T,go=I;break;case 5:Ur||Co(m,l);case 6:if(T=yr,I=go,yr=null,yl(r,l,m),yr=T,go=I,yr!==null)if(go)try{(yr.nodeType===9?yr.body:yr.nodeName==="HTML"?yr.ownerDocument.body:yr).removeChild(m.stateNode)}catch(B){Sn(m,l,B)}else try{yr.removeChild(m.stateNode)}catch(B){Sn(m,l,B)}break;case 18:yr!==null&&(go?(r=yr,vl(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,m.stateNode),sf(r)):vl(yr,m.stateNode));break;case 4:T=yr,I=go,yr=m.stateNode.containerInfo,go=!0,yl(r,l,m),yr=T,go=I;break;case 0:case 11:case 14:case 15:sh(2,m,l),Ur||sh(4,m,l),yl(r,l,m);break;case 1:Ur||(Co(m,l),T=m.stateNode,typeof T.componentWillUnmount=="function"&&Zp(m,l,T)),yl(r,l,m);break;case 21:yl(r,l,m);break;case 22:Ur=(T=Ur)||m.memoizedState!==null,yl(r,l,m),Ur=T;break;default:yl(r,l,m)}}function gg(r,l){if(l.memoizedState===null&&(r=l.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{sf(r)}catch(m){Sn(l,l.return,m)}}}function yg(r,l){if(l.memoizedState===null&&(r=l.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{sf(r)}catch(m){Sn(l,l.return,m)}}function Bf(r){switch(r.tag){case 31:case 13:case 19:var l=r.stateNode;return l===null&&(l=r.stateNode=new mg),l;case 22:return r=r.stateNode,l=r._retryCache,l===null&&(l=r._retryCache=new mg),l;default:throw Error(g(435,r.tag))}}function jd(r,l){var m=Bf(r);l.forEach(function(T){if(!m.has(T)){m.add(T);var I=a0.bind(null,r,T);T.then(I,I)}})}function Ia(r,l){var m=l.deletions;if(m!==null)for(var T=0;T<m.length;T++){var I=m[T],B=r,J=l,he=J;e:for(;he!==null;){switch(he.tag){case 27:if(_r(he.type)){yr=he.stateNode,go=!1;break e}break;case 5:yr=he.stateNode,go=!1;break e;case 3:case 4:yr=he.stateNode.containerInfo,go=!0;break e}he=he.return}if(yr===null)throw Error(g(160));Nd(B,J,I),yr=null,go=!1,B=I.alternate,B!==null&&(B.return=null),I.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)Wh(l,r),l=l.sibling}var vs=null;function Wh(r,l){var m=r.alternate,T=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Ia(l,r),Ja(r),T&4&&(sh(3,r,r.return),kf(3,r),sh(5,r,r.return));break;case 1:Ia(l,r),Ja(r),T&512&&(Ur||m===null||Co(m,m.return)),T&64&&fc&&(r=r.updateQueue,r!==null&&(T=r.callbacks,T!==null&&(m=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=m===null?T:m.concat(T))));break;case 26:var I=vs;if(Ia(l,r),Ja(r),T&512&&(Ur||m===null||Co(m,m.return)),T&4){var B=m!==null?m.memoizedState:null;if(T=r.memoizedState,m===null)if(T===null)if(r.stateNode===null){e:{T=r.type,m=r.memoizedProps,I=I.ownerDocument||I;t:switch(T){case"title":B=I.getElementsByTagName("title")[0],(!B||B[_i]||B[vn]||B.namespaceURI==="http://www.w3.org/2000/svg"||B.hasAttribute("itemprop"))&&(B=I.createElement(T),I.head.insertBefore(B,I.querySelector("head > title"))),qr(B,T,m),B[vn]=r,Xn(B),T=B;break e;case"link":var J=gm("link","href",I).get(T+(m.href||""));if(J){for(var he=0;he<J.length;he++)if(B=J[he],B.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&B.getAttribute("rel")===(m.rel==null?null:m.rel)&&B.getAttribute("title")===(m.title==null?null:m.title)&&B.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){J.splice(he,1);break t}}B=I.createElement(T),qr(B,T,m),I.head.appendChild(B);break;case"meta":if(J=gm("meta","content",I).get(T+(m.content||""))){for(he=0;he<J.length;he++)if(B=J[he],B.getAttribute("content")===(m.content==null?null:""+m.content)&&B.getAttribute("name")===(m.name==null?null:m.name)&&B.getAttribute("property")===(m.property==null?null:m.property)&&B.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&B.getAttribute("charset")===(m.charSet==null?null:m.charSet)){J.splice(he,1);break t}}B=I.createElement(T),qr(B,T,m),I.head.appendChild(B);break;default:throw Error(g(468,T))}B[vn]=r,Xn(B),T=B}r.stateNode=T}else ym(I,r.type,r.stateNode);else r.stateNode=C_(I,T,r.memoizedProps);else B!==T?(B===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):B.count--,T===null?ym(I,r.type,r.stateNode):C_(I,T,r.memoizedProps)):T===null&&r.stateNode!==null&&hg(r,r.memoizedProps,m.memoizedProps)}break;case 27:Ia(l,r),Ja(r),T&512&&(Ur||m===null||Co(m,m.return)),m!==null&&T&4&&hg(r,r.memoizedProps,m.memoizedProps);break;case 5:if(Ia(l,r),Ja(r),T&512&&(Ur||m===null||Co(m,m.return)),r.flags&32){I=r.stateNode;try{ao(I,"")}catch(ti){Sn(r,r.return,ti)}}T&4&&r.stateNode!=null&&(I=r.memoizedProps,hg(r,I,m!==null?m.memoizedProps:I)),T&1024&&(pg=!0);break;case 6:if(Ia(l,r),Ja(r),T&4){if(r.stateNode===null)throw Error(g(162));T=r.memoizedProps,m=r.stateNode;try{m.nodeValue=T}catch(ti){Sn(r,r.return,ti)}}break;case 3:if(nd=null,I=vs,vs=Kd(l.containerInfo),Ia(l,r),vs=I,Ja(r),T&4&&m!==null&&m.memoizedState.isDehydrated)try{sf(l.containerInfo)}catch(ti){Sn(r,r.return,ti)}pg&&(pg=!1,t_(r));break;case 4:T=vs,vs=Kd(r.stateNode.containerInfo),Ia(l,r),Ja(r),vs=T;break;case 12:Ia(l,r),Ja(r);break;case 31:Ia(l,r),Ja(r),T&4&&(T=r.updateQueue,T!==null&&(r.updateQueue=null,jd(r,T)));break;case 13:Ia(l,r),Ja(r),r.child.flags&8192&&r.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(Gd=Rr()),T&4&&(T=r.updateQueue,T!==null&&(r.updateQueue=null,jd(r,T)));break;case 22:I=r.memoizedState!==null;var De=m!==null&&m.memoizedState!==null,at=fc,yt=Ur;if(fc=at||I,Ur=yt||De,Ia(l,r),Ur=yt,fc=at,Ja(r),T&8192)e:for(l=r.stateNode,l._visibility=I?l._visibility&-2:l._visibility|1,I&&(m===null||De||fc||Ur||js(r)),m=null,l=r;;){if(l.tag===5||l.tag===26){if(m===null){De=m=l;try{if(B=De.stateNode,I)J=B.style,typeof J.setProperty=="function"?J.setProperty("display","none","important"):J.display="none";else{he=De.stateNode;var St=De.memoizedProps.style,st=St!=null&&St.hasOwnProperty("display")?St.display:null;he.style.display=st==null||typeof st=="boolean"?"":(""+st).trim()}}catch(ti){Sn(De,De.return,ti)}}}else if(l.tag===6){if(m===null){De=l;try{De.stateNode.nodeValue=I?"":De.memoizedProps}catch(ti){Sn(De,De.return,ti)}}}else if(l.tag===18){if(m===null){De=l;try{var ht=De.stateNode;I?ph(ht,!0):ph(De.stateNode,!1)}catch(ti){Sn(De,De.return,ti)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===r)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break e;for(;l.sibling===null;){if(l.return===null||l.return===r)break e;m===l&&(m=null),l=l.return}m===l&&(m=null),l.sibling.return=l.return,l=l.sibling}T&4&&(T=r.updateQueue,T!==null&&(m=T.retryQueue,m!==null&&(T.retryQueue=null,jd(r,m))));break;case 19:Ia(l,r),Ja(r),T&4&&(T=r.updateQueue,T!==null&&(r.updateQueue=null,jd(r,T)));break;case 30:break;case 21:break;default:Ia(l,r),Ja(r)}}function Ja(r){var l=r.flags;if(l&2){try{for(var m,T=r.return;T!==null;){if(Qy(T)){m=T;break}T=T.return}if(m==null)throw Error(g(160));switch(m.tag){case 27:var I=m.stateNode,B=dg(r);qp(r,B,I);break;case 5:var J=m.stateNode;m.flags&32&&(ao(J,""),m.flags&=-33);var he=dg(r);qp(r,he,J);break;case 3:case 4:var De=m.stateNode.containerInfo,at=dg(r);fg(r,at,De);break;default:throw Error(g(161))}}catch(yt){Sn(r,r.return,yt)}r.flags&=-3}l&4096&&(r.flags&=-4097)}function t_(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var l=r;t_(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),r=r.sibling}}function ku(r,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)Tr(r,l.alternate,l),l=l.sibling}function js(r){for(r=r.child;r!==null;){var l=r;switch(l.tag){case 0:case 11:case 14:case 15:sh(4,l,l.return),js(l);break;case 1:Co(l,l.return);var m=l.stateNode;typeof m.componentWillUnmount=="function"&&Zp(l,l.return,m),js(l);break;case 27:Wd(l.stateNode);case 26:case 5:Co(l,l.return),js(l);break;case 22:l.memoizedState===null&&js(l);break;case 30:js(l);break;default:js(l)}r=r.sibling}}function pc(r,l,m){for(m=m&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var T=l.alternate,I=r,B=l,J=B.flags;switch(B.tag){case 0:case 11:case 15:pc(I,B,m),kf(4,B);break;case 1:if(pc(I,B,m),T=B,I=T.stateNode,typeof I.componentDidMount=="function")try{I.componentDidMount()}catch(at){Sn(T,T.return,at)}if(T=B,I=T.updateQueue,I!==null){var he=T.stateNode;try{var De=I.shared.hiddenCallbacks;if(De!==null)for(I.shared.hiddenCallbacks=null,I=0;I<De.length;I++)Pd(De[I],he)}catch(at){Sn(T,T.return,at)}}m&&J&64&&Of(B),Bd(B,B.return);break;case 27:e_(B);case 26:case 5:pc(I,B,m),m&&T===null&&J&4&&Fd(B),Bd(B,B.return);break;case 12:pc(I,B,m);break;case 31:pc(I,B,m),m&&J&4&&gg(I,B);break;case 13:pc(I,B,m),m&&J&4&&yg(I,B);break;case 22:B.memoizedState===null&&pc(I,B,m),Bd(B,B.return);break;case 30:break;default:pc(I,B,m)}l=l.sibling}}function $p(r,l){var m=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(m=r.memoizedState.cachePool.pool),r=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(r=l.memoizedState.cachePool.pool),r!==m&&(r!=null&&r.refCount++,m!=null&&Ya(m))}function Kh(r,l){r=null,l.alternate!==null&&(r=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==r&&(l.refCount++,r!=null&&Ya(r))}function Us(r,l,m,T){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)_g(r,l,m,T),l=l.sibling}function _g(r,l,m,T){var I=l.flags;switch(l.tag){case 0:case 11:case 15:Us(r,l,m,T),I&2048&&kf(9,l);break;case 1:Us(r,l,m,T);break;case 3:Us(r,l,m,T),I&2048&&(r=null,l.alternate!==null&&(r=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==r&&(l.refCount++,r!=null&&Ya(r)));break;case 12:if(I&2048){Us(r,l,m,T),r=l.stateNode;try{var B=l.memoizedProps,J=B.id,he=B.onPostCommit;typeof he=="function"&&he(J,l.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(De){Sn(l,l.return,De)}}else Us(r,l,m,T);break;case 31:Us(r,l,m,T);break;case 13:Us(r,l,m,T);break;case 23:break;case 22:B=l.stateNode,J=l.alternate,l.memoizedState!==null?B._visibility&2?Us(r,l,m,T):Ff(r,l):B._visibility&2?Us(r,l,m,T):(B._visibility|=2,Jh(r,l,m,T,(l.subtreeFlags&10256)!==0||!1)),I&2048&&$p(J,l);break;case 24:Us(r,l,m,T),I&2048&&Kh(l.alternate,l);break;default:Us(r,l,m,T)}}function Jh(r,l,m,T,I){for(I=I&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var B=r,J=l,he=m,De=T,at=J.flags;switch(J.tag){case 0:case 11:case 15:Jh(B,J,he,De,I),kf(8,J);break;case 23:break;case 22:var yt=J.stateNode;J.memoizedState!==null?yt._visibility&2?Jh(B,J,he,De,I):Ff(B,J):(yt._visibility|=2,Jh(B,J,he,De,I)),I&&at&2048&&$p(J.alternate,J);break;case 24:Jh(B,J,he,De,I),I&&at&2048&&Kh(J.alternate,J);break;default:Jh(B,J,he,De,I)}l=l.sibling}}function Ff(r,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var m=r,T=l,I=T.flags;switch(T.tag){case 22:Ff(m,T),I&2048&&$p(T.alternate,T);break;case 24:Ff(m,T),I&2048&&Kh(T.alternate,T);break;default:Ff(m,T)}l=l.sibling}}var Nf=8192;function Ud(r,l,m){if(r.subtreeFlags&Nf)for(r=r.child;r!==null;)i_(r,l,m),r=r.sibling}function i_(r,l,m){switch(r.tag){case 26:Ud(r,l,m),r.flags&Nf&&r.memoizedState!==null&&P_(m,vs,r.memoizedState,r.memoizedProps);break;case 5:Ud(r,l,m);break;case 3:case 4:var T=vs;vs=Kd(r.stateNode.containerInfo),Ud(r,l,m),vs=T;break;case 22:r.memoizedState===null&&(T=r.alternate,T!==null&&T.memoizedState!==null?(T=Nf,Nf=16777216,Ud(r,l,m),Nf=T):Ud(r,l,m));break;default:Ud(r,l,m)}}function n_(r){var l=r.alternate;if(l!==null&&(r=l.child,r!==null)){l.child=null;do l=r.sibling,r.sibling=null,r=l;while(r!==null)}}function mc(r){var l=r.deletions;if((r.flags&16)!==0){if(l!==null)for(var m=0;m<l.length;m++){var T=l[m];Vr=T,a_(T,r)}n_(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)r_(r),r=r.sibling}function r_(r){switch(r.tag){case 0:case 11:case 15:mc(r),r.flags&2048&&sh(9,r,r.return);break;case 3:mc(r);break;case 12:mc(r);break;case 22:var l=r.stateNode;r.memoizedState!==null&&l._visibility&2&&(r.return===null||r.return.tag!==13)?(l._visibility&=-3,jf(r)):mc(r);break;default:mc(r)}}function jf(r){var l=r.deletions;if((r.flags&16)!==0){if(l!==null)for(var m=0;m<l.length;m++){var T=l[m];Vr=T,a_(T,r)}n_(r)}for(r=r.child;r!==null;){switch(l=r,l.tag){case 0:case 11:case 15:sh(8,l,l.return),jf(l);break;case 22:m=l.stateNode,m._visibility&2&&(m._visibility&=-3,jf(l));break;default:jf(l)}r=r.sibling}}function a_(r,l){for(;Vr!==null;){var m=Vr;switch(m.tag){case 0:case 11:case 15:sh(8,m,l);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var T=m.memoizedState.cachePool.pool;T!=null&&T.refCount++}break;case 24:Ya(m.memoizedState.cache)}if(T=m.child,T!==null)T.return=m,Vr=T;else e:for(m=r;Vr!==null;){T=Vr;var I=T.sibling,B=T.return;if(Yh(T),T===m){Vr=null;break e}if(I!==null){I.return=B,Vr=I;break e}Vr=B}}}var Jv={getCacheForType:function(r){var l=Pr(ar),m=l.data.get(r);return m===void 0&&(m=r(),l.data.set(r,m)),m},cacheSignal:function(){return Pr(ar).controller.signal}},Qv=typeof WeakMap=="function"?WeakMap:Map,wn=0,tr=null,Hi=null,Zi=0,Ln=0,Vs=null,lh=!1,Qh=!1,Hp=!1,gc=0,Gr=0,_l=0,uh=0,vg=0,Gs=0,Vd=0,Uf=null,bs=null,Xp=!1,Gd=0,bg=0,Vf=1/0,Gf=null,ch=null,Zr=0,hh=null,ed=null,yc=0,xg=0,wg=null,Tg=null,Zf=0,Sg=null;function Tn(){return(wn&2)!==0&&Zi!==0?Zi&-Zi:lt.T!==null?fh():Qr()}function Zd(){if(Gs===0)if((Zi&536870912)===0||Ri){var r=en;en<<=1,(en&3932160)===0&&(en=262144),Gs=r}else Gs=536870912;return r=fo.current,r!==null&&(r.flags|=32),Gs}function xs(r,l,m){(r===tr&&(Ln===2||Ln===9)||r.cancelPendingCommit!==null)&&(Ql(r,0),dh(r,Zi,Gs,!1)),an(r,m),((wn&2)===0||r!==tr)&&(r===tr&&((wn&2)===0&&(uh|=m),Gr===4&&dh(r,Zi,Gs,!1)),tu(r))}function o_(r,l,m){if((wn&6)!==0)throw Error(g(327));var T=!m&&(l&127)===0&&(l&r.expiredLanes)===0||dr(r,l),I=T?t0(r,l):Kp(r,l,!0),B=T;do{if(I===0){Qh&&!T&&dh(r,l,0,!1);break}else{if(m=r.current.alternate,B&&!s_(m)){I=Kp(r,l,!1),B=!1;continue}if(I===2){if(B=l,r.errorRecoveryDisabledLanes&B)var J=0;else J=r.pendingLanes&-536870913,J=J!==0?J:J&536870912?536870912:0;if(J!==0){l=J;e:{var he=r;I=Uf;var De=he.current.memoizedState.isDehydrated;if(De&&(Ql(he,J).flags|=256),J=Kp(he,J,!1),J!==2){if(Hp&&!De){he.errorRecoveryDisabledLanes|=B,uh|=B,I=4;break e}B=bs,bs=I,B!==null&&(bs===null?bs=B:bs.push.apply(bs,B))}I=J}if(B=!1,I!==2)continue}}if(I===1){Ql(r,0),dh(r,l,0,!0);break}e:{switch(T=r,B=I,B){case 0:case 1:throw Error(g(345));case 4:if((l&4194048)!==l)break;case 6:dh(T,l,Gs,!lh);break e;case 2:bs=null;break;case 3:case 5:break;default:throw Error(g(329))}if((l&62914560)===l&&(I=Gd+300-Rr(),10<I)){if(dh(T,l,Gs,!lh),ln(T,0,!0)!==0)break e;yc=l,T.timeoutHandle=hm(Mg.bind(null,T,m,bs,Gf,Xp,l,Gs,uh,Vd,lh,B,"Throttled",-0,0),I);break e}Mg(T,m,bs,Gf,Xp,l,Gs,uh,Vd,lh,B,null,-0,0)}}break}while(!0);tu(r)}function Mg(r,l,m,T,I,B,J,he,De,at,yt,St,st,ht){if(r.timeoutHandle=-1,St=l.subtreeFlags,St&8192||(St&16785408)===16785408){St={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ka},i_(l,B,St);var ti=(B&62914560)===B?Gd-Rr():(B&4194048)===B?bg-Rr():0;if(ti=z_(St,ti),ti!==null){yc=B,r.cancelPendingCommit=ti(h_.bind(null,r,l,B,m,T,I,J,he,De,yt,St,null,st,ht)),dh(r,B,J,!at);return}}h_(r,l,B,m,T,I,J,he,De)}function s_(r){for(var l=r;;){var m=l.tag;if((m===0||m===11||m===15)&&l.flags&16384&&(m=l.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var T=0;T<m.length;T++){var I=m[T],B=I.getSnapshot;I=I.value;try{if(!ra(B(),I))return!1}catch{return!1}}if(m=l.child,l.subtreeFlags&16384&&m!==null)m.return=l,l=m;else{if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function dh(r,l,m,T){l&=~vg,l&=~uh,r.suspendedLanes|=l,r.pingedLanes&=~l,T&&(r.warmLanes|=l),T=r.expirationTimes;for(var I=l;0<I;){var B=31-mt(I),J=1<<B;T[B]=-1,I&=~J}m!==0&&_n(r,m,l)}function qf(){return(wn&6)===0?(td(0),!1):!0}function Yp(){if(Hi!==null){if(Ln===0)var r=Hi.return;else r=Hi,gs=uo=null,Wl(r),_s=null,jh=0,r=Hi;for(;r!==null;)Jy(r.alternate,r),r=r.return;Hi=null}}function Ql(r,l){var m=r.timeoutHandle;m!==-1&&(r.timeoutHandle=-1,c0(m)),m=r.cancelPendingCommit,m!==null&&(r.cancelPendingCommit=null,m()),yc=0,Yp(),tr=r,Hi=m=qa(r.current,null),Zi=l,Ln=0,Vs=null,lh=!1,Qh=dr(r,l),Hp=!1,Vd=Gs=vg=uh=_l=Gr=0,bs=Uf=null,Xp=!1,(l&8)!==0&&(l|=l&32);var T=r.entangledLanes;if(T!==0)for(r=r.entanglements,T&=l;0<T;){var I=31-mt(T),B=1<<I;l|=r[I],T&=~B}return gc=l,ul(),m}function Wp(r,l){ri=null,lt.H=ur,l===Ot||l===Eu?(l=Md(),Ln=3):l===Fh?(l=Md(),Ln=4):Ln=l===eg?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Vs=l,Hi===null&&(Gr=1,dc(r,x(l,r.current)))}function Eg(){var r=fo.current;return r===null?!0:(Zi&4194048)===Zi?fa===null:(Zi&62914560)===Zi||(Zi&536870912)!==0?r===fa:!1}function Ag(){var r=lt.H;return lt.H=ur,r===null?ur:r}function $f(){var r=lt.A;return lt.A=Jv,r}function _c(){Gr=4,lh||(Zi&4194048)!==Zi&&fo.current!==null||(Qh=!0),(_l&134217727)===0&&(uh&134217727)===0||tr===null||dh(tr,Zi,Gs,!1)}function Kp(r,l,m){var T=wn;wn|=2;var I=Ag(),B=$f();(tr!==r||Zi!==l)&&(Gf=null,Ql(r,l)),l=!1;var J=Gr;e:do try{if(Ln!==0&&Hi!==null){var he=Hi,De=Vs;switch(Ln){case 8:Yp(),J=6;break e;case 3:case 2:case 9:case 6:fo.current===null&&(l=!0);var at=Ln;if(Ln=0,Vs=null,qd(r,he,De,at),m&&Qh){J=0;break e}break;default:at=Ln,Ln=0,Vs=null,qd(r,he,De,at)}}e0(),J=Gr;break}catch(yt){Wp(r,yt)}while(!0);return l&&r.shellSuspendCounter++,gs=uo=null,wn=T,lt.H=I,lt.A=B,Hi===null&&(tr=null,Zi=0,ul()),J}function e0(){for(;Hi!==null;)l_(Hi)}function t0(r,l){var m=wn;wn|=2;var T=Ag(),I=$f();tr!==r||Zi!==l?(Gf=null,Vf=Rr()+500,Ql(r,l)):Qh=dr(r,l);e:do try{if(Ln!==0&&Hi!==null){l=Hi;var B=Vs;t:switch(Ln){case 1:Ln=0,Vs=null,qd(r,l,B,1);break;case 2:case 9:if(Au(B)){Ln=0,Vs=null,u_(l);break}l=function(){Ln!==2&&Ln!==9||tr!==r||(Ln=7),tu(r)},B.then(l,l);break e;case 3:Ln=7;break e;case 4:Ln=5;break e;case 7:Au(B)?(Ln=0,Vs=null,u_(l)):(Ln=0,Vs=null,qd(r,l,B,7));break;case 5:var J=null;switch(Hi.tag){case 26:J=Hi.memoizedState;case 5:case 27:var he=Hi;if(J?Zg(J):he.stateNode.complete){Ln=0,Vs=null;var De=he.sibling;if(De!==null)Hi=De;else{var at=he.return;at!==null?(Hi=at,Jp(at)):Hi=null}break t}}Ln=0,Vs=null,qd(r,l,B,5);break;case 6:Ln=0,Vs=null,qd(r,l,B,6);break;case 8:Yp(),Gr=6;break e;default:throw Error(g(462))}}i0();break}catch(yt){Wp(r,yt)}while(!0);return gs=uo=null,lt.H=T,lt.A=I,wn=m,Hi!==null?0:(tr=null,Zi=0,ul(),Gr)}function i0(){for(;Hi!==null&&!vo();)l_(Hi)}function l_(r){var l=Xy(r.alternate,r,gc);r.memoizedProps=r.pendingProps,l===null?Jp(r):Hi=l}function u_(r){var l=r,m=l.alternate;switch(l.tag){case 15:case 0:l=ng(m,l,l.pendingProps,l.type,void 0,Zi);break;case 11:l=ng(m,l,l.pendingProps,l.type.render,l.ref,Zi);break;case 5:Wl(l);default:Jy(m,l),l=Hi=Rh(l,gc),l=Xy(m,l,gc)}r.memoizedProps=r.pendingProps,l===null?Jp(r):Hi=l}function qd(r,l,m,T){gs=uo=null,Wl(l),_s=null,jh=0;var I=l.return;try{if(Qm(r,I,l,m,Zi)){Gr=1,dc(r,x(m,r.current)),Hi=null;return}}catch(B){if(I!==null)throw Hi=I,B;Gr=1,dc(r,x(m,r.current)),Hi=null;return}l.flags&32768?(Ri||T===1?r=!0:Qh||(Zi&536870912)!==0?r=!1:(lh=r=!0,(T===2||T===9||T===3||T===6)&&(T=fo.current,T!==null&&T.tag===13&&(T.flags|=16384))),c_(l,r)):Jp(l)}function Jp(r){var l=r;do{if((l.flags&32768)!==0){c_(l,lh);return}r=l.return;var m=Wy(l.alternate,l,gc);if(m!==null){Hi=m;return}if(l=l.sibling,l!==null){Hi=l;return}Hi=l=r}while(l!==null);Gr===0&&(Gr=5)}function c_(r,l){do{var m=Ky(r.alternate,r);if(m!==null){m.flags&=32767,Hi=m;return}if(m=r.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!l&&(r=r.sibling,r!==null)){Hi=r;return}Hi=r=m}while(r!==null);Gr=6,Hi=null}function h_(r,l,m,T,I,B,J,he,De){r.cancelPendingCommit=null;do $d();while(Zr!==0);if((wn&6)!==0)throw Error(g(327));if(l!==null){if(l===r.current)throw Error(g(177));if(B=l.lanes|l.childLanes,B|=ll,nr(r,m,B,J,he,De),r===tr&&(Hi=tr=null,Zi=0),ed=l,hh=r,yc=m,xg=B,wg=I,Tg=T,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,o0(ie,function(){return Pg(),null})):(r.callbackNode=null,r.callbackPriority=0),T=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||T){T=lt.T,lt.T=null,I=Pt.p,Pt.p=2,J=wn,wn|=4;try{Kv(r,l,m)}finally{wn=J,Pt.p=I,lt.T=T}}Zr=1,d_(),f_(),p_()}}function d_(){if(Zr===1){Zr=0;var r=hh,l=ed,m=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||m){m=lt.T,lt.T=null;var T=Pt.p;Pt.p=2;var I=wn;wn|=4;try{Wh(l,r);var B=lm,J=Dl(r.containerInfo),he=B.focusedElem,De=B.selectionRange;if(J!==he&&he&&he.ownerDocument&&bu(he.ownerDocument.documentElement,he)){if(De!==null&&fs(he)){var at=De.start,yt=De.end;if(yt===void 0&&(yt=at),"selectionStart"in he)he.selectionStart=at,he.selectionEnd=Math.min(yt,he.value.length);else{var St=he.ownerDocument||document,st=St&&St.defaultView||window;if(st.getSelection){var ht=st.getSelection(),ti=he.textContent.length,mi=Math.min(De.start,ti),Dn=De.end===void 0?mi:Math.min(De.end,ti);!ht.extend&&mi>Dn&&(J=Dn,Dn=mi,mi=J);var Ge=al(he,mi),Oe=al(he,Dn);if(Ge&&Oe&&(ht.rangeCount!==1||ht.anchorNode!==Ge.node||ht.anchorOffset!==Ge.offset||ht.focusNode!==Oe.node||ht.focusOffset!==Oe.offset)){var nt=St.createRange();nt.setStart(Ge.node,Ge.offset),ht.removeAllRanges(),mi>Dn?(ht.addRange(nt),ht.extend(Oe.node,Oe.offset)):(nt.setEnd(Oe.node,Oe.offset),ht.addRange(nt))}}}}for(St=[],ht=he;ht=ht.parentNode;)ht.nodeType===1&&St.push({element:ht,left:ht.scrollLeft,top:ht.scrollTop});for(typeof he.focus=="function"&&he.focus(),he=0;he<St.length;he++){var vt=St[he];vt.element.scrollLeft=vt.left,vt.element.scrollTop=vt.top}}rf=!!sm,lm=sm=null}finally{wn=I,Pt.p=T,lt.T=m}}r.current=l,Zr=2}}function f_(){if(Zr===2){Zr=0;var r=hh,l=ed,m=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||m){m=lt.T,lt.T=null;var T=Pt.p;Pt.p=2;var I=wn;wn|=4;try{Tr(r,l.alternate,l)}finally{wn=I,Pt.p=T,lt.T=m}}Zr=3}}function p_(){if(Zr===4||Zr===3){Zr=0,wl();var r=hh,l=ed,m=yc,T=Tg;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Zr=5:(Zr=0,ed=hh=null,Cg(r,r.pendingLanes));var I=r.pendingLanes;if(I===0&&(ch=null),et(m),l=l.stateNode,Re&&typeof Re.onCommitFiberRoot=="function")try{Re.onCommitFiberRoot(je,l,void 0,(l.current.flags&128)===128)}catch{}if(T!==null){l=lt.T,I=Pt.p,Pt.p=2,lt.T=null;try{for(var B=r.onRecoverableError,J=0;J<T.length;J++){var he=T[J];B(he.value,{componentStack:he.stack})}}finally{lt.T=l,Pt.p=I}}(yc&3)!==0&&$d(),tu(r),I=r.pendingLanes,(m&261930)!==0&&(I&42)!==0?r===Sg?Zf++:(Zf=0,Sg=r):Zf=0,td(0)}}function Cg(r,l){(r.pooledCacheLanes&=l)===0&&(l=r.pooledCache,l!=null&&(r.pooledCache=null,Ya(l)))}function $d(){return d_(),f_(),p_(),Pg()}function Pg(){if(Zr!==5)return!1;var r=hh,l=xg;xg=0;var m=et(yc),T=lt.T,I=Pt.p;try{Pt.p=32>m?32:m,lt.T=null,m=wg,wg=null;var B=hh,J=yc;if(Zr=0,ed=hh=null,yc=0,(wn&6)!==0)throw Error(g(331));var he=wn;if(wn|=4,r_(B.current),_g(B,B.current,J,m),wn=he,td(0,!1),Re&&typeof Re.onPostCommitFiberRoot=="function")try{Re.onPostCommitFiberRoot(je,B)}catch{}return!0}finally{Pt.p=I,lt.T=T,Cg(r,l)}}function vc(r,l,m){l=x(m,l),l=Du(r.stateNode,l,2),r=Zl(r,l,2),r!==null&&(an(r,2),tu(r))}function Sn(r,l,m){if(r.tag===3)vc(r,r,m);else for(;l!==null;){if(l.tag===3){vc(l,r,m);break}else if(l.tag===1){var T=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(ch===null||!ch.has(T))){r=x(m,r),m=Rd(2),T=Zl(l,m,2),T!==null&&(kd(m,T,l,r),an(T,2),tu(T));break}}l=l.return}}function Hf(r,l,m){var T=r.pingCache;if(T===null){T=r.pingCache=new Qv;var I=new Set;T.set(l,I)}else I=T.get(l),I===void 0&&(I=new Set,T.set(l,I));I.has(m)||(Hp=!0,I.add(m),r=n0.bind(null,r,l,m),l.then(r,r))}function n0(r,l,m){var T=r.pingCache;T!==null&&T.delete(l),r.pingedLanes|=r.suspendedLanes&m,r.warmLanes&=~m,tr===r&&(Zi&m)===m&&(Gr===4||Gr===3&&(Zi&62914560)===Zi&&300>Rr()-Gd?(wn&2)===0&&Ql(r,0):vg|=m,Vd===Zi&&(Vd=0)),tu(r)}function zg(r,l){l===0&&(l=un()),r=Ca(r,l),r!==null&&(an(r,l),tu(r))}function r0(r){var l=r.memoizedState,m=0;l!==null&&(m=l.retryLane),zg(r,m)}function a0(r,l){var m=0;switch(r.tag){case 31:case 13:var T=r.stateNode,I=r.memoizedState;I!==null&&(m=I.retryLane);break;case 19:T=r.stateNode;break;case 22:T=r.stateNode._retryCache;break;default:throw Error(g(314))}T!==null&&T.delete(l),zg(r,m)}function o0(r,l){return Oo(r,l)}var Qp=null,Hd=null,em=!1,Xf=!1,eu=!1,Qo=0;function tu(r){r!==Hd&&r.next===null&&(Hd===null?Qp=Hd=r:Hd=Hd.next=r),Xf=!0,em||(em=!0,Ig())}function td(r,l){if(!eu&&Xf){eu=!0;do for(var m=!1,T=Qp;T!==null;){if(r!==0){var I=T.pendingLanes;if(I===0)var B=0;else{var J=T.suspendedLanes,he=T.pingedLanes;B=(1<<31-mt(42|r)+1)-1,B&=I&~(J&~he),B=B&201326741?B&201326741|1:B?B|2:0}B!==0&&(m=!0,im(T,B))}else B=Zi,B=ln(T,T===tr?B:0,T.cancelPendingCommit!==null||T.timeoutHandle!==-1),(B&3)===0||dr(T,B)||(m=!0,im(T,B));T=T.next}while(m);eu=!1}}function s0(){Yf()}function Yf(){Xf=em=!1;var r=0;Qo!==0&&Bg()&&(r=Qo);for(var l=Rr(),m=null,T=Qp;T!==null;){var I=T.next,B=tm(T,l);B===0?(T.next=null,m===null?Qp=I:m.next=I,I===null&&(Hd=m)):(m=T,(r!==0||(B&3)!==0)&&(Xf=!0)),T=I}Zr!==0&&Zr!==5||td(r),Qo!==0&&(Qo=0)}function tm(r,l){for(var m=r.suspendedLanes,T=r.pingedLanes,I=r.expirationTimes,B=r.pendingLanes&-62914561;0<B;){var J=31-mt(B),he=1<<J,De=I[J];De===-1?((he&m)===0||(he&T)!==0)&&(I[J]=gi(he,l)):De<=l&&(r.expiredLanes|=he),B&=~he}if(l=tr,m=Zi,m=ln(r,r===l?m:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),T=r.callbackNode,m===0||r===l&&(Ln===2||Ln===9)||r.cancelPendingCommit!==null)return T!==null&&T!==null&&no(T),r.callbackNode=null,r.callbackPriority=0;if((m&3)===0||dr(r,m)){if(l=m&-m,l===r.callbackPriority)return l;switch(T!==null&&no(T),et(m)){case 2:case 8:m=ne;break;case 32:m=ie;break;case 268435456:m=Ee;break;default:m=ie}return T=m_.bind(null,r),m=Oo(m,T),r.callbackPriority=l,r.callbackNode=m,l}return T!==null&&T!==null&&no(T),r.callbackPriority=2,r.callbackNode=null,2}function m_(r,l){if(Zr!==0&&Zr!==5)return r.callbackNode=null,r.callbackPriority=0,null;var m=r.callbackNode;if($d()&&r.callbackNode!==m)return null;var T=Zi;return T=ln(r,r===tr?T:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),T===0?null:(o_(r,T,l),tm(r,Rr()),r.callbackNode!=null&&r.callbackNode===m?m_.bind(null,r):null)}function im(r,l){if($d())return null;o_(r,l,!0)}function Ig(){ki(function(){(wn&6)!==0?Oo(Ve,s0):Yf()})}function fh(){if(Qo===0){var r=Wa;r===0&&(r=di,di<<=1,(di&261888)===0&&(di=256)),Qo=r}return Qo}function Lg(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:xi(""+r)}function Dg(r,l){var m=l.ownerDocument.createElement("input");return m.name=l.name,m.value=l.value,r.id&&m.setAttribute("form",r.id),l.parentNode.insertBefore(m,l),r=new FormData(r),m.parentNode.removeChild(m),r}function Rg(r,l,m,T,I){if(l==="submit"&&m&&m.stateNode===I){var B=Lg((I[At]||null).action),J=T.submitter;J&&(l=(l=J[At]||null)?Lg(l.formAction):J.getAttribute("formAction"),l!==null&&(B=l,J=null));var he=new $u("action","action",null,T,I);r.push({event:he,listeners:[{instance:null,listener:function(){if(T.defaultPrevented){if(Qo!==0){var De=J?Dg(I,J):new FormData(I);lr(m,{pending:!0,data:De,method:I.method,action:B},null,De)}}else typeof B=="function"&&(he.preventDefault(),De=J?Dg(I,J):new FormData(I),lr(m,{pending:!0,data:De,method:I.method,action:B},B,De))},currentTarget:I}]})}}for(var nm=0;nm<Is.length;nm++){var Xd=Is[nm],g_=Xd.toLowerCase(),l0=Xd[0].toUpperCase()+Xd.slice(1);Ga(g_,"on"+l0)}Ga(sl,"onAnimationEnd"),Ga(ec,"onAnimationIteration"),Ga(Bl,"onAnimationStart"),Ga("dblclick","onDoubleClick"),Ga("focusin","onFocus"),Ga("focusout","onBlur"),Ga(Fl,"onTransitionRun"),Ga(wu,"onTransitionStart"),Ga(Tu,"onTransitionCancel"),Ga(aa,"onTransitionEnd"),Fo("onMouseEnter",["mouseout","mouseover"]),Fo("onMouseLeave",["mouseout","mouseover"]),Fo("onPointerEnter",["pointerout","pointerover"]),Fo("onPointerLeave",["pointerout","pointerover"]),Vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),u0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wf));function y_(r,l){l=(l&4)!==0;for(var m=0;m<r.length;m++){var T=r[m],I=T.event;T=T.listeners;e:{var B=void 0;if(l)for(var J=T.length-1;0<=J;J--){var he=T[J],De=he.instance,at=he.currentTarget;if(he=he.listener,De!==B&&I.isPropagationStopped())break e;B=he,I.currentTarget=at;try{B(I)}catch(yt){Ho(yt)}I.currentTarget=null,B=De}else for(J=0;J<T.length;J++){if(he=T[J],De=he.instance,at=he.currentTarget,he=he.listener,De!==B&&I.isPropagationStopped())break e;B=he,I.currentTarget=at;try{B(I)}catch(yt){Ho(yt)}I.currentTarget=null,B=De}}}}function tn(r,l){var m=l[pi];m===void 0&&(m=l[pi]=new Set);var T=r+"__bubble";m.has(T)||(kg(l,r,2,!1),m.add(T))}function Kf(r,l,m){var T=0;l&&(T|=4),kg(m,r,T,l)}var iu="_reactListening"+Math.random().toString(36).slice(2);function rm(r){if(!r[iu]){r[iu]=!0,fu.forEach(function(m){m!=="selectionchange"&&(u0.has(m)||Kf(m,!1,r),Kf(m,!0,r))});var l=r.nodeType===9?r:r.ownerDocument;l===null||l[iu]||(l[iu]=!0,Kf("selectionchange",!1,l))}}function kg(r,l,m,T){switch(k_(l)){case 2:var I=Yg;break;case 8:I=R_;break;default:I=_h}m=I.bind(null,l,m,r),I=void 0,!ta||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(I=!0),T?I!==void 0?r.addEventListener(l,m,{capture:!0,passive:I}):r.addEventListener(l,m,!0):I!==void 0?r.addEventListener(l,m,{passive:I}):r.addEventListener(l,m,!1)}function am(r,l,m,T,I){var B=T;if((l&1)===0&&(l&2)===0&&T!==null)e:for(;;){if(T===null)return;var J=T.tag;if(J===3||J===4){var he=T.stateNode.containerInfo;if(he===I)break;if(J===4)for(J=T.return;J!==null;){var De=J.tag;if((De===3||De===4)&&J.stateNode.containerInfo===I)return;J=J.return}for(;he!==null;){if(J=Bo(he),J===null)return;if(De=J.tag,De===5||De===6||De===26||De===27){T=B=J;continue e}he=he.parentNode}}T=T.return}fn(function(){var at=B,yt=Al(m),St=[];e:{var st=Dh.get(r);if(st!==void 0){var ht=$u,ti=r;switch(r){case"keypress":if(Na(m)===0)break e;case"keydown":case"keyup":ht=Gn;break;case"focusin":ti="focus",ht=il;break;case"focusout":ti="blur",ht=il;break;case"beforeblur":case"afterblur":ht=il;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ht=Cl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ht=Hu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ht=bf;break;case sl:case ec:case Bl:ht=Uc;break;case aa:ht=Wu;break;case"scroll":case"scrollend":ht=Pi;break;case"wheel":ht=Cs;break;case"copy":case"cut":case"paste":ht=xo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ht=Gc;break;case"toggle":case"beforetoggle":ht=cs}var mi=(l&4)!==0,Dn=!mi&&(r==="scroll"||r==="scrollend"),Ge=mi?st!==null?st+"Capture":null:st;mi=[];for(var Oe=at,nt;Oe!==null;){var vt=Oe;if(nt=vt.stateNode,vt=vt.tag,vt!==5&&vt!==26&&vt!==27||nt===null||Ge===null||(vt=Oa(Oe,Ge),vt!=null&&mi.push(Yd(Oe,vt,nt))),Dn)break;Oe=Oe.return}0<mi.length&&(st=new ht(st,ti,null,m,yt),St.push({event:st,listeners:mi}))}}if((l&7)===0){e:{if(st=r==="mouseover"||r==="pointerover",ht=r==="mouseout"||r==="pointerout",st&&m!==jc&&(ti=m.relatedTarget||m.fromElement)&&(Bo(ti)||ti[yi]))break e;if((ht||st)&&(st=yt.window===yt?yt:(st=yt.ownerDocument)?st.defaultView||st.parentWindow:window,ht?(ti=m.relatedTarget||m.toElement,ht=at,ti=ti?Bo(ti):null,ti!==null&&(Dn=A(ti),mi=ti.tag,ti!==Dn||mi!==5&&mi!==27&&mi!==6)&&(ti=null)):(ht=null,ti=at),ht!==ti)){if(mi=Cl,vt="onMouseLeave",Ge="onMouseEnter",Oe="mouse",(r==="pointerout"||r==="pointerover")&&(mi=Gc,vt="onPointerLeave",Ge="onPointerEnter",Oe="pointer"),Dn=ht==null?st:ro(ht),nt=ti==null?st:ro(ti),st=new mi(vt,Oe+"leave",ht,m,yt),st.target=Dn,st.relatedTarget=nt,vt=null,Bo(yt)===at&&(mi=new mi(Ge,Oe+"enter",ti,m,yt),mi.target=nt,mi.relatedTarget=Dn,vt=mi),Dn=vt,ht&&ti)t:{for(mi=__,Ge=ht,Oe=ti,nt=0,vt=Ge;vt;vt=mi(vt))nt++;vt=0;for(var Qt=Oe;Qt;Qt=mi(Qt))vt++;for(;0<nt-vt;)Ge=mi(Ge),nt--;for(;0<vt-nt;)Oe=mi(Oe),vt--;for(;nt--;){if(Ge===Oe||Oe!==null&&Ge===Oe.alternate){mi=Ge;break t}Ge=mi(Ge),Oe=mi(Oe)}mi=null}else mi=null;ht!==null&&Qf(St,st,ht,mi,!1),ti!==null&&Dn!==null&&Qf(St,Dn,ti,mi,!0)}}e:{if(st=at?ro(at):window,ht=st.nodeName&&st.nodeName.toLowerCase(),ht==="select"||ht==="input"&&st.type==="file")var yn=Zo;else if(wo(st))if(Ih)yn=vd;else{yn=_d;var oi=Ps}else ht=st.nodeName,!ht||ht.toLowerCase()!=="input"||st.type!=="checkbox"&&st.type!=="radio"?at&&Ms(at.elementType)&&(yn=Zo):yn=ds;if(yn&&(yn=yn(r,at))){qc(St,yn,m,yt);break e}oi&&oi(r,st,at),r==="focusout"&&at&&st.type==="number"&&at.memoizedProps.value!=null&&No(st,"number",st.value)}switch(oi=at?ro(at):window,r){case"focusin":(wo(oi)||oi.contentEditable==="true")&&(Va=oi,xu=at,Qu=null);break;case"focusout":Qu=xu=Va=null;break;case"mousedown":kl=!0;break;case"contextmenu":case"mouseup":case"dragend":kl=!1,bd(St,m,yt);break;case"selectionchange":if(Rl)break;case"keydown":case"keyup":bd(St,m,yt)}var Oi;if(Wn)e:{switch(r){case"compositionstart":var Ki="onCompositionStart";break e;case"compositionend":Ki="onCompositionEnd";break e;case"compositionupdate":Ki="onCompositionUpdate";break e}Ki=void 0}else Go?Ju(r,m)&&(Ki="onCompositionEnd"):r==="keydown"&&m.keyCode===229&&(Ki="onCompositionStart");Ki&&(rl&&m.locale!=="ko"&&(Go||Ki!=="onCompositionStart"?Ki==="onCompositionEnd"&&Go&&(Oi=Fa()):(Ma=yt,Ba="value"in Ma?Ma.value:Ma.textContent,Go=!0)),oi=Jf(at,Ki),0<oi.length&&(Ki=new Vc(Ki,r,null,m,yt),St.push({event:Ki,listeners:oi}),Oi?Ki.data=Oi:(Oi=zh(m),Oi!==null&&(Ki.data=Oi)))),(Oi=gu?ja(r,m):Il(r,m))&&(Ki=Jf(at,"onBeforeInput"),0<Ki.length&&(oi=new Vc("onBeforeInput","beforeinput",null,m,yt),St.push({event:oi,listeners:Ki}),oi.data=Oi)),Rg(St,r,at,m,yt)}y_(St,l)})}function Yd(r,l,m){return{instance:r,listener:l,currentTarget:m}}function Jf(r,l){for(var m=l+"Capture",T=[];r!==null;){var I=r,B=I.stateNode;if(I=I.tag,I!==5&&I!==26&&I!==27||B===null||(I=Oa(r,m),I!=null&&T.unshift(Yd(r,I,B)),I=Oa(r,l),I!=null&&T.push(Yd(r,I,B))),r.tag===3)return T;r=r.return}return[]}function __(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Qf(r,l,m,T,I){for(var B=l._reactName,J=[];m!==null&&m!==T;){var he=m,De=he.alternate,at=he.stateNode;if(he=he.tag,De!==null&&De===T)break;he!==5&&he!==26&&he!==27||at===null||(De=at,I?(at=Oa(m,B),at!=null&&J.unshift(Yd(m,at,De))):I||(at=Oa(m,B),at!=null&&J.push(Yd(m,at,De)))),m=m.return}J.length!==0&&r.push({event:l,listeners:J})}var v_=/\r\n?/g,ep=/\u0000|\uFFFD/g;function Og(r){return(typeof r=="string"?r:""+r).replace(v_,`
`).replace(ep,"")}function om(r,l){return l=Og(l),Og(r)===l}function Un(r,l,m,T,I,B){switch(m){case"children":typeof T=="string"?l==="body"||l==="textarea"&&T===""||ao(r,T):(typeof T=="number"||typeof T=="bigint")&&l!=="body"&&ao(r,""+T);break;case"className":on(r,"class",T);break;case"tabIndex":on(r,"tabindex",T);break;case"dir":case"role":case"viewBox":case"width":case"height":on(r,m,T);break;case"style":pu(r,T,B);break;case"data":if(l!=="object"){on(r,"data",T);break}case"src":case"href":if(T===""&&(l!=="a"||m!=="href")){r.removeAttribute(m);break}if(T==null||typeof T=="function"||typeof T=="symbol"||typeof T=="boolean"){r.removeAttribute(m);break}T=xi(""+T),r.setAttribute(m,T);break;case"action":case"formAction":if(typeof T=="function"){r.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof B=="function"&&(m==="formAction"?(l!=="input"&&Un(r,l,"name",I.name,I,null),Un(r,l,"formEncType",I.formEncType,I,null),Un(r,l,"formMethod",I.formMethod,I,null),Un(r,l,"formTarget",I.formTarget,I,null)):(Un(r,l,"encType",I.encType,I,null),Un(r,l,"method",I.method,I,null),Un(r,l,"target",I.target,I,null)));if(T==null||typeof T=="symbol"||typeof T=="boolean"){r.removeAttribute(m);break}T=xi(""+T),r.setAttribute(m,T);break;case"onClick":T!=null&&(r.onclick=ka);break;case"onScroll":T!=null&&tn("scroll",r);break;case"onScrollEnd":T!=null&&tn("scrollend",r);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(g(61));if(m=T.__html,m!=null){if(I.children!=null)throw Error(g(60));r.innerHTML=m}}break;case"multiple":r.multiple=T&&typeof T!="function"&&typeof T!="symbol";break;case"muted":r.muted=T&&typeof T!="function"&&typeof T!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(T==null||typeof T=="function"||typeof T=="boolean"||typeof T=="symbol"){r.removeAttribute("xlink:href");break}m=xi(""+T),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":T!=null&&typeof T!="function"&&typeof T!="symbol"?r.setAttribute(m,""+T):r.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":T&&typeof T!="function"&&typeof T!="symbol"?r.setAttribute(m,""):r.removeAttribute(m);break;case"capture":case"download":T===!0?r.setAttribute(m,""):T!==!1&&T!=null&&typeof T!="function"&&typeof T!="symbol"?r.setAttribute(m,T):r.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":T!=null&&typeof T!="function"&&typeof T!="symbol"&&!isNaN(T)&&1<=T?r.setAttribute(m,T):r.removeAttribute(m);break;case"rowSpan":case"start":T==null||typeof T=="function"||typeof T=="symbol"||isNaN(T)?r.removeAttribute(m):r.setAttribute(m,T);break;case"popover":tn("beforetoggle",r),tn("toggle",r),Gi(r,"popover",T);break;case"xlinkActuate":Sa(r,"http://www.w3.org/1999/xlink","xlink:actuate",T);break;case"xlinkArcrole":Sa(r,"http://www.w3.org/1999/xlink","xlink:arcrole",T);break;case"xlinkRole":Sa(r,"http://www.w3.org/1999/xlink","xlink:role",T);break;case"xlinkShow":Sa(r,"http://www.w3.org/1999/xlink","xlink:show",T);break;case"xlinkTitle":Sa(r,"http://www.w3.org/1999/xlink","xlink:title",T);break;case"xlinkType":Sa(r,"http://www.w3.org/1999/xlink","xlink:type",T);break;case"xmlBase":Sa(r,"http://www.w3.org/XML/1998/namespace","xml:base",T);break;case"xmlLang":Sa(r,"http://www.w3.org/XML/1998/namespace","xml:lang",T);break;case"xmlSpace":Sa(r,"http://www.w3.org/XML/1998/namespace","xml:space",T);break;case"is":Gi(r,"is",T);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=Uo.get(m)||m,Gi(r,m,T))}}function es(r,l,m,T,I,B){switch(m){case"style":pu(r,T,B);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(g(61));if(m=T.__html,m!=null){if(I.children!=null)throw Error(g(60));r.innerHTML=m}}break;case"children":typeof T=="string"?ao(r,T):(typeof T=="number"||typeof T=="bigint")&&ao(r,""+T);break;case"onScroll":T!=null&&tn("scroll",r);break;case"onScrollEnd":T!=null&&tn("scrollend",r);break;case"onClick":T!=null&&(r.onclick=ka);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!da.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(I=m.endsWith("Capture"),l=m.slice(2,I?m.length-7:void 0),B=r[At]||null,B=B!=null?B[m]:null,typeof B=="function"&&r.removeEventListener(l,B,I),typeof T=="function")){typeof B!="function"&&B!==null&&(m in r?r[m]=null:r.hasAttribute(m)&&r.removeAttribute(m)),r.addEventListener(l,T,I);break e}m in r?r[m]=T:T===!0?r.setAttribute(m,""):Gi(r,m,T)}}}function qr(r,l,m){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":tn("error",r),tn("load",r);var T=!1,I=!1,B;for(B in m)if(m.hasOwnProperty(B)){var J=m[B];if(J!=null)switch(B){case"src":T=!0;break;case"srcSet":I=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(g(137,l));default:Un(r,l,B,J,m,null)}}I&&Un(r,l,"srcSet",m.srcSet,m,null),T&&Un(r,l,"src",m.src,m,null);return;case"input":tn("invalid",r);var he=B=J=I=null,De=null,at=null;for(T in m)if(m.hasOwnProperty(T)){var yt=m[T];if(yt!=null)switch(T){case"name":I=yt;break;case"type":J=yt;break;case"checked":De=yt;break;case"defaultChecked":at=yt;break;case"value":B=yt;break;case"defaultValue":he=yt;break;case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(g(137,l));break;default:Un(r,l,T,yt,m,null)}}El(r,B,he,De,at,J,I,!1);return;case"select":tn("invalid",r),T=J=B=null;for(I in m)if(m.hasOwnProperty(I)&&(he=m[I],he!=null))switch(I){case"value":B=he;break;case"defaultValue":J=he;break;case"multiple":T=he;default:Un(r,l,I,he,m,null)}l=B,m=J,r.multiple=!!T,l!=null?Pn(r,!!T,l,!1):m!=null&&Pn(r,!!T,m,!0);return;case"textarea":tn("invalid",r),B=I=T=null;for(J in m)if(m.hasOwnProperty(J)&&(he=m[J],he!=null))switch(J){case"value":T=he;break;case"defaultValue":I=he;break;case"children":B=he;break;case"dangerouslySetInnerHTML":if(he!=null)throw Error(g(91));break;default:Un(r,l,J,he,m,null)}us(r,T,I,B);return;case"option":for(De in m)m.hasOwnProperty(De)&&(T=m[De],T!=null)&&(De==="selected"?r.selected=T&&typeof T!="function"&&typeof T!="symbol":Un(r,l,De,T,m,null));return;case"dialog":tn("beforetoggle",r),tn("toggle",r),tn("cancel",r),tn("close",r);break;case"iframe":case"object":tn("load",r);break;case"video":case"audio":for(T=0;T<Wf.length;T++)tn(Wf[T],r);break;case"image":tn("error",r),tn("load",r);break;case"details":tn("toggle",r);break;case"embed":case"source":case"link":tn("error",r),tn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(at in m)if(m.hasOwnProperty(at)&&(T=m[at],T!=null))switch(at){case"children":case"dangerouslySetInnerHTML":throw Error(g(137,l));default:Un(r,l,at,T,m,null)}return;default:if(Ms(l)){for(yt in m)m.hasOwnProperty(yt)&&(T=m[yt],T!==void 0&&es(r,l,yt,T,m,void 0));return}}for(he in m)m.hasOwnProperty(he)&&(T=m[he],T!=null&&Un(r,l,he,T,m,null))}function tp(r,l,m,T){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var I=null,B=null,J=null,he=null,De=null,at=null,yt=null;for(ht in m){var St=m[ht];if(m.hasOwnProperty(ht)&&St!=null)switch(ht){case"checked":break;case"value":break;case"defaultValue":De=St;default:T.hasOwnProperty(ht)||Un(r,l,ht,null,T,St)}}for(var st in T){var ht=T[st];if(St=m[st],T.hasOwnProperty(st)&&(ht!=null||St!=null))switch(st){case"type":B=ht;break;case"name":I=ht;break;case"checked":at=ht;break;case"defaultChecked":yt=ht;break;case"value":J=ht;break;case"defaultValue":he=ht;break;case"children":case"dangerouslySetInnerHTML":if(ht!=null)throw Error(g(137,l));break;default:ht!==St&&Un(r,l,st,ht,T,St)}}qu(r,J,he,De,at,yt,B,I);return;case"select":ht=J=he=st=null;for(B in m)if(De=m[B],m.hasOwnProperty(B)&&De!=null)switch(B){case"value":break;case"multiple":ht=De;default:T.hasOwnProperty(B)||Un(r,l,B,null,T,De)}for(I in T)if(B=T[I],De=m[I],T.hasOwnProperty(I)&&(B!=null||De!=null))switch(I){case"value":st=B;break;case"defaultValue":he=B;break;case"multiple":J=B;default:B!==De&&Un(r,l,I,B,T,De)}l=he,m=J,T=ht,st!=null?Pn(r,!!m,st,!1):!!T!=!!m&&(l!=null?Pn(r,!!m,l,!0):Pn(r,!!m,m?[]:"",!1));return;case"textarea":ht=st=null;for(he in m)if(I=m[he],m.hasOwnProperty(he)&&I!=null&&!T.hasOwnProperty(he))switch(he){case"value":break;case"children":break;default:Un(r,l,he,null,T,I)}for(J in T)if(I=T[J],B=m[J],T.hasOwnProperty(J)&&(I!=null||B!=null))switch(J){case"value":st=I;break;case"defaultValue":ht=I;break;case"children":break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(g(91));break;default:I!==B&&Un(r,l,J,I,T,B)}Js(r,st,ht);return;case"option":for(var ti in m)st=m[ti],m.hasOwnProperty(ti)&&st!=null&&!T.hasOwnProperty(ti)&&(ti==="selected"?r.selected=!1:Un(r,l,ti,null,T,st));for(De in T)st=T[De],ht=m[De],T.hasOwnProperty(De)&&st!==ht&&(st!=null||ht!=null)&&(De==="selected"?r.selected=st&&typeof st!="function"&&typeof st!="symbol":Un(r,l,De,st,T,ht));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var mi in m)st=m[mi],m.hasOwnProperty(mi)&&st!=null&&!T.hasOwnProperty(mi)&&Un(r,l,mi,null,T,st);for(at in T)if(st=T[at],ht=m[at],T.hasOwnProperty(at)&&st!==ht&&(st!=null||ht!=null))switch(at){case"children":case"dangerouslySetInnerHTML":if(st!=null)throw Error(g(137,l));break;default:Un(r,l,at,st,T,ht)}return;default:if(Ms(l)){for(var Dn in m)st=m[Dn],m.hasOwnProperty(Dn)&&st!==void 0&&!T.hasOwnProperty(Dn)&&es(r,l,Dn,void 0,T,st);for(yt in T)st=T[yt],ht=m[yt],!T.hasOwnProperty(yt)||st===ht||st===void 0&&ht===void 0||es(r,l,yt,st,T,ht);return}}for(var Ge in m)st=m[Ge],m.hasOwnProperty(Ge)&&st!=null&&!T.hasOwnProperty(Ge)&&Un(r,l,Ge,null,T,st);for(St in T)st=T[St],ht=m[St],!T.hasOwnProperty(St)||st===ht||st==null&&ht==null||Un(r,l,St,st,T,ht)}function b_(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function x_(){if(typeof performance.getEntriesByType=="function"){for(var r=0,l=0,m=performance.getEntriesByType("resource"),T=0;T<m.length;T++){var I=m[T],B=I.transferSize,J=I.initiatorType,he=I.duration;if(B&&he&&b_(J)){for(J=0,he=I.responseEnd,T+=1;T<m.length;T++){var De=m[T],at=De.startTime;if(at>he)break;var yt=De.transferSize,St=De.initiatorType;yt&&b_(St)&&(De=De.responseEnd,J+=yt*(De<he?1:(he-at)/(De-at)))}if(--T,l+=8*(B+J)/(I.duration/1e3),r++,10<r)break}}if(0<r)return l/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var sm=null,lm=null;function bc(r){return r.nodeType===9?r:r.ownerDocument}function ip(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function um(r,l){if(r===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&l==="foreignObject"?0:r}function np(r,l){return r==="textarea"||r==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var cm=null;function Bg(){var r=window.event;return r&&r.type==="popstate"?r===cm?!1:(cm=r,!0):(cm=null,!1)}var hm=typeof setTimeout=="function"?setTimeout:void 0,c0=typeof clearTimeout=="function"?clearTimeout:void 0,w_=typeof Promise=="function"?Promise:void 0,ki=typeof queueMicrotask=="function"?queueMicrotask:typeof w_<"u"?function(r){return w_.resolve(null).then(r).catch(xc)}:hm;function xc(r){setTimeout(function(){throw r})}function _r(r){return r==="head"}function vl(r,l){var m=l,T=0;do{var I=m.nextSibling;if(r.removeChild(m),I&&I.nodeType===8)if(m=I.data,m==="/$"||m==="/&"){if(T===0){r.removeChild(I),sf(l);return}T--}else if(m==="$"||m==="$?"||m==="$~"||m==="$!"||m==="&")T++;else if(m==="html")Wd(r.ownerDocument.documentElement);else if(m==="head"){m=r.ownerDocument.head,Wd(m);for(var B=m.firstChild;B;){var J=B.nextSibling,he=B.nodeName;B[_i]||he==="SCRIPT"||he==="STYLE"||he==="LINK"&&B.rel.toLowerCase()==="stylesheet"||m.removeChild(B),B=J}}else m==="body"&&Wd(r.ownerDocument.body);m=I}while(m);sf(l)}function ph(r,l){var m=r;r=0;do{var T=m.nextSibling;if(m.nodeType===1?l?(m._stashedDisplay=m.style.display,m.style.display="none"):(m.style.display=m._stashedDisplay||"",m.getAttribute("style")===""&&m.removeAttribute("style")):m.nodeType===3&&(l?(m._stashedText=m.nodeValue,m.nodeValue=""):m.nodeValue=m._stashedText||""),T&&T.nodeType===8)if(m=T.data,m==="/$"){if(r===0)break;r--}else m!=="$"&&m!=="$?"&&m!=="$~"&&m!=="$!"||r++;m=T}while(m)}function Po(r){var l=r.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var m=l;switch(l=l.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":Po(m),Tl(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}r.removeChild(m)}}function ga(r,l,m,T){for(;r.nodeType===1;){var I=m;if(r.nodeName.toLowerCase()!==l.toLowerCase()){if(!T&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(T){if(!r[_i])switch(l){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(B=r.getAttribute("rel"),B==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(B!==I.rel||r.getAttribute("href")!==(I.href==null||I.href===""?null:I.href)||r.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin)||r.getAttribute("title")!==(I.title==null?null:I.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(B=r.getAttribute("src"),(B!==(I.src==null?null:I.src)||r.getAttribute("type")!==(I.type==null?null:I.type)||r.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin))&&B&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(l==="input"&&r.type==="hidden"){var B=I.name==null?null:""+I.name;if(I.type==="hidden"&&r.getAttribute("name")===B)return r}else return r;if(r=bl(r.nextSibling),r===null)break}return null}function ya(r,l,m){if(l==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!m||(r=bl(r.nextSibling),r===null))return null;return r}function Fg(r,l){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=bl(r.nextSibling),r===null))return null;return r}function ts(r){return r.data==="$?"||r.data==="$~"}function la(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function dm(r,l){var m=r.ownerDocument;if(r.data==="$~")r._reactRetry=l;else if(r.data!=="$?"||m.readyState!=="loading")l();else{var T=function(){l(),m.removeEventListener("DOMContentLoaded",T)};m.addEventListener("DOMContentLoaded",T),r._reactRetry=T}}function bl(r){for(;r!=null;r=r.nextSibling){var l=r.nodeType;if(l===1||l===3)break;if(l===8){if(l=r.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return r}var fm=null;function mh(r){r=r.nextSibling;for(var l=0;r;){if(r.nodeType===8){var m=r.data;if(m==="/$"||m==="/&"){if(l===0)return bl(r.nextSibling);l--}else m!=="$"&&m!=="$!"&&m!=="$?"&&m!=="$~"&&m!=="&"||l++}r=r.nextSibling}return null}function id(r){r=r.previousSibling;for(var l=0;r;){if(r.nodeType===8){var m=r.data;if(m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"){if(l===0)return r;l--}else m!=="/$"&&m!=="/&"||l++}r=r.previousSibling}return null}function T_(r,l,m){switch(l=bc(m),r){case"html":if(r=l.documentElement,!r)throw Error(g(452));return r;case"head":if(r=l.head,!r)throw Error(g(453));return r;case"body":if(r=l.body,!r)throw Error(g(454));return r;default:throw Error(g(451))}}function Wd(r){for(var l=r.attributes;l.length;)r.removeAttributeNode(l[0]);Tl(r)}var Zs=new Map,Ng=new Set;function Kd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ou=Pt.d;Pt.d={f:jg,r:zo,D:gh,C:pm,L:Ug,m:S_,X:E_,S:M_,M:A_};function jg(){var r=Ou.f(),l=qf();return r||l}function zo(r){var l=Ts(r);l!==null&&l.tag===5&&l.type==="form"?pa(l):Ou.r(r)}var Io=typeof document>"u"?null:document;function yo(r,l,m){var T=Io;if(T&&typeof l=="string"&&l){var I=kn(l);I='link[rel="'+r+'"][href="'+I+'"]',typeof m=="string"&&(I+='[crossorigin="'+m+'"]'),Ng.has(I)||(Ng.add(I),r={rel:r,crossOrigin:m,href:l},T.querySelector(I)===null&&(l=T.createElement("link"),qr(l,"link",r),Xn(l),T.head.appendChild(l)))}}function gh(r){Ou.D(r),yo("dns-prefetch",r,null)}function pm(r,l){Ou.C(r,l),yo("preconnect",r,l)}function Ug(r,l,m){Ou.L(r,l,m);var T=Io;if(T&&r&&l){var I='link[rel="preload"][as="'+kn(l)+'"]';l==="image"&&m&&m.imageSrcSet?(I+='[imagesrcset="'+kn(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(I+='[imagesizes="'+kn(m.imageSizes)+'"]')):I+='[href="'+kn(r)+'"]';var B=I;switch(l){case"style":B=wc(r);break;case"script":B=yh(r)}Zs.has(B)||(r=K({rel:"preload",href:l==="image"&&m&&m.imageSrcSet?void 0:r,as:l},m),Zs.set(B,r),T.querySelector(I)!==null||l==="style"&&T.querySelector(Jd(B))||l==="script"&&T.querySelector(ef(B))||(l=T.createElement("link"),qr(l,"link",r),Xn(l),T.head.appendChild(l)))}}function S_(r,l){Ou.m(r,l);var m=Io;if(m&&r){var T=l&&typeof l.as=="string"?l.as:"script",I='link[rel="modulepreload"][as="'+kn(T)+'"][href="'+kn(r)+'"]',B=I;switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":B=yh(r)}if(!Zs.has(B)&&(r=K({rel:"modulepreload",href:r},l),Zs.set(B,r),m.querySelector(I)===null)){switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(ef(B)))return}T=m.createElement("link"),qr(T,"link",r),Xn(T),m.head.appendChild(T)}}}function M_(r,l,m){Ou.S(r,l,m);var T=Io;if(T&&r){var I=ss(T).hoistableStyles,B=wc(r);l=l||"default";var J=I.get(B);if(!J){var he={loading:0,preload:null};if(J=T.querySelector(Jd(B)))he.loading=5;else{r=K({rel:"stylesheet",href:r,"data-precedence":l},m),(m=Zs.get(B))&&tf(r,m);var De=J=T.createElement("link");Xn(De),qr(De,"link",r),De._p=new Promise(function(at,yt){De.onload=at,De.onerror=yt}),De.addEventListener("load",function(){he.loading|=1}),De.addEventListener("error",function(){he.loading|=2}),he.loading|=4,rp(J,l,T)}J={type:"stylesheet",instance:J,count:1,state:he},I.set(B,J)}}}function E_(r,l){Ou.X(r,l);var m=Io;if(m&&r){var T=ss(m).hoistableScripts,I=yh(r),B=T.get(I);B||(B=m.querySelector(ef(I)),B||(r=K({src:r,async:!0},l),(l=Zs.get(I))&&nf(r,l),B=m.createElement("script"),Xn(B),qr(B,"link",r),m.head.appendChild(B)),B={type:"script",instance:B,count:1,state:null},T.set(I,B))}}function A_(r,l){Ou.M(r,l);var m=Io;if(m&&r){var T=ss(m).hoistableScripts,I=yh(r),B=T.get(I);B||(B=m.querySelector(ef(I)),B||(r=K({src:r,async:!0,type:"module"},l),(l=Zs.get(I))&&nf(r,l),B=m.createElement("script"),Xn(B),qr(B,"link",r),m.head.appendChild(B)),B={type:"script",instance:B,count:1,state:null},T.set(I,B))}}function mm(r,l,m,T){var I=(I=kt.current)?Kd(I):null;if(!I)throw Error(g(446));switch(r){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(l=wc(m.href),m=ss(I).hoistableStyles,T=m.get(l),T||(T={type:"style",instance:null,count:0,state:null},m.set(l,T)),T):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){r=wc(m.href);var B=ss(I).hoistableStyles,J=B.get(r);if(J||(I=I.ownerDocument||I,J={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},B.set(r,J),(B=I.querySelector(Jd(r)))&&!B._p&&(J.instance=B,J.state.loading=5),Zs.has(r)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Zs.set(r,m),B||Qd(I,r,m,J.state))),l&&T===null)throw Error(g(528,""));return J}if(l&&T!==null)throw Error(g(529,""));return null;case"script":return l=m.async,m=m.src,typeof m=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=yh(m),m=ss(I).hoistableScripts,T=m.get(l),T||(T={type:"script",instance:null,count:0,state:null},m.set(l,T)),T):{type:"void",instance:null,count:0,state:null};default:throw Error(g(444,r))}}function wc(r){return'href="'+kn(r)+'"'}function Jd(r){return'link[rel="stylesheet"]['+r+"]"}function Vg(r){return K({},r,{"data-precedence":r.precedence,precedence:null})}function Qd(r,l,m,T){r.querySelector('link[rel="preload"][as="style"]['+l+"]")?T.loading=1:(l=r.createElement("link"),T.preload=l,l.addEventListener("load",function(){return T.loading|=1}),l.addEventListener("error",function(){return T.loading|=2}),qr(l,"link",m),Xn(l),r.head.appendChild(l))}function yh(r){return'[src="'+kn(r)+'"]'}function ef(r){return"script[async]"+r}function C_(r,l,m){if(l.count++,l.instance===null)switch(l.type){case"style":var T=r.querySelector('style[data-href~="'+kn(m.href)+'"]');if(T)return l.instance=T,Xn(T),T;var I=K({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return T=(r.ownerDocument||r).createElement("style"),Xn(T),qr(T,"style",I),rp(T,m.precedence,r),l.instance=T;case"stylesheet":I=wc(m.href);var B=r.querySelector(Jd(I));if(B)return l.state.loading|=4,l.instance=B,Xn(B),B;T=Vg(m),(I=Zs.get(I))&&tf(T,I),B=(r.ownerDocument||r).createElement("link"),Xn(B);var J=B;return J._p=new Promise(function(he,De){J.onload=he,J.onerror=De}),qr(B,"link",T),l.state.loading|=4,rp(B,m.precedence,r),l.instance=B;case"script":return B=yh(m.src),(I=r.querySelector(ef(B)))?(l.instance=I,Xn(I),I):(T=m,(I=Zs.get(B))&&(T=K({},m),nf(T,I)),r=r.ownerDocument||r,I=r.createElement("script"),Xn(I),qr(I,"link",T),r.head.appendChild(I),l.instance=I);case"void":return null;default:throw Error(g(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(T=l.instance,l.state.loading|=4,rp(T,m.precedence,r));return l.instance}function rp(r,l,m){for(var T=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),I=T.length?T[T.length-1]:null,B=I,J=0;J<T.length;J++){var he=T[J];if(he.dataset.precedence===l)B=he;else if(B!==I)break}B?B.parentNode.insertBefore(r,B.nextSibling):(l=m.nodeType===9?m.head:m,l.insertBefore(r,l.firstChild))}function tf(r,l){r.crossOrigin==null&&(r.crossOrigin=l.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=l.referrerPolicy),r.title==null&&(r.title=l.title)}function nf(r,l){r.crossOrigin==null&&(r.crossOrigin=l.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=l.referrerPolicy),r.integrity==null&&(r.integrity=l.integrity)}var nd=null;function gm(r,l,m){if(nd===null){var T=new Map,I=nd=new Map;I.set(m,T)}else I=nd,T=I.get(m),T||(T=new Map,I.set(m,T));if(T.has(r))return T;for(T.set(r,null),m=m.getElementsByTagName(r),I=0;I<m.length;I++){var B=m[I];if(!(B[_i]||B[vn]||r==="link"&&B.getAttribute("rel")==="stylesheet")&&B.namespaceURI!=="http://www.w3.org/2000/svg"){var J=B.getAttribute(l)||"";J=r+J;var he=T.get(J);he?he.push(B):T.set(J,[B])}}return T}function ym(r,l,m){r=r.ownerDocument||r,r.head.insertBefore(m,l==="title"?r.querySelector("head > title"):null)}function Gg(r,l,m){if(m===1||l.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(r=l.disabled,typeof l.precedence=="string"&&r==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function Zg(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function P_(r,l,m,T){if(m.type==="stylesheet"&&(typeof T.media!="string"||matchMedia(T.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var I=wc(T.href),B=l.querySelector(Jd(I));if(B){l=B._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(r.count++,r=ap.bind(r),l.then(r,r)),m.state.loading|=4,m.instance=B,Xn(B);return}B=l.ownerDocument||l,T=Vg(T),(I=Zs.get(I))&&tf(T,I),B=B.createElement("link"),Xn(B);var J=B;J._p=new Promise(function(he,De){J.onload=he,J.onerror=De}),qr(B,"link",T),m.instance=B}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(m,l),(l=m.state.preload)&&(m.state.loading&3)===0&&(r.count++,m=ap.bind(r),l.addEventListener("load",m),l.addEventListener("error",m))}}var _m=0;function z_(r,l){return r.stylesheets&&r.count===0&&op(r,r.stylesheets),0<r.count||0<r.imgCount?function(m){var T=setTimeout(function(){if(r.stylesheets&&op(r,r.stylesheets),r.unsuspend){var B=r.unsuspend;r.unsuspend=null,B()}},6e4+l);0<r.imgBytes&&_m===0&&(_m=62500*x_());var I=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&op(r,r.stylesheets),r.unsuspend)){var B=r.unsuspend;r.unsuspend=null,B()}},(r.imgBytes>_m?50:800)+l);return r.unsuspend=m,function(){r.unsuspend=null,clearTimeout(T),clearTimeout(I)}}:null}function ap(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)op(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var vm=null;function op(r,l){r.stylesheets=null,r.unsuspend!==null&&(r.count++,vm=new Map,l.forEach(h0,r),vm=null,ap.call(r))}function h0(r,l){if(!(l.state.loading&4)){var m=vm.get(r);if(m)var T=m.get(null);else{m=new Map,vm.set(r,m);for(var I=r.querySelectorAll("link[data-precedence],style[data-precedence]"),B=0;B<I.length;B++){var J=I[B];(J.nodeName==="LINK"||J.getAttribute("media")!=="not all")&&(m.set(J.dataset.precedence,J),T=J)}T&&m.set(null,T)}I=l.instance,J=I.getAttribute("data-precedence"),B=m.get(J)||T,B===T&&m.set(null,I),m.set(J,I),this.count++,T=ap.bind(this),I.addEventListener("load",T),I.addEventListener("error",T),B?B.parentNode.insertBefore(I,B.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(I,r.firstChild)),l.state.loading|=4}}var sp={$$typeof:Ne,Provider:null,Consumer:null,_currentValue:Mt,_currentValue2:Mt,_threadCount:0};function qg(r,l,m,T,I,B,J,he,De){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Er(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Er(0),this.hiddenUpdates=Er(null),this.identifierPrefix=T,this.onUncaughtError=I,this.onCaughtError=B,this.onRecoverableError=J,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=De,this.incompleteTransitions=new Map}function $g(r,l,m,T,I,B,J,he,De,at,yt,St){return r=new qg(r,l,m,J,De,at,yt,St,he),l=1,B===!0&&(l|=24),B=Za(3,null,null,l),r.current=B,B.stateNode=r,l=Su(),l.refCount++,r.pooledCache=l,l.refCount++,B.memoizedState={element:T,isDehydrated:m,cache:l},Cd(B),r}function I_(r){return r?(r=Si,r):Si}function L_(r,l,m,T,I,B){I=I_(I),T.context===null?T.context=I:T.pendingContext=I,T=$i(l),T.payload={element:m},B=B===void 0?null:B,B!==null&&(T.callback=B),m=Zl(r,T,l),m!==null&&(xs(m,r,l),Pu(m,r,l))}function Hg(r,l){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var m=r.retryLane;r.retryLane=m!==0&&m<l?m:l}}function rd(r,l){Hg(r,l),(r=r.alternate)&&Hg(r,l)}function Xg(r){if(r.tag===13||r.tag===31){var l=Ca(r,67108864);l!==null&&xs(l,r,67108864),rd(r,67108864)}}function D_(r){if(r.tag===13||r.tag===31){var l=Tn();l=ha(l);var m=Ca(r,l);m!==null&&xs(m,r,l),rd(r,l)}}var rf=!0;function Yg(r,l,m,T){var I=lt.T;lt.T=null;var B=Pt.p;try{Pt.p=2,_h(r,l,m,T)}finally{Pt.p=B,lt.T=I}}function R_(r,l,m,T){var I=lt.T;lt.T=null;var B=Pt.p;try{Pt.p=8,_h(r,l,m,T)}finally{Pt.p=B,lt.T=I}}function _h(r,l,m,T){if(rf){var I=bm(T);if(I===null)am(r,l,T,xm,m),Kg(r,T);else if(f0(I,r,l,m,T))T.stopPropagation();else if(Kg(r,T),l&4&&-1<d0.indexOf(r)){for(;I!==null;){var B=Ts(I);if(B!==null)switch(B.tag){case 3:if(B=B.stateNode,B.current.memoizedState.isDehydrated){var J=Ze(B.pendingLanes);if(J!==0){var he=B;for(he.pendingLanes|=2,he.entangledLanes|=2;J;){var De=1<<31-mt(J);he.entanglements[1]|=De,J&=~De}tu(B),(wn&6)===0&&(Vf=Rr()+500,td(0))}}break;case 31:case 13:he=Ca(B,2),he!==null&&xs(he,B,2),qf(),rd(B,2)}if(B=bm(T),B===null&&am(r,l,T,xm,m),B===I)break;I=B}I!==null&&T.stopPropagation()}else am(r,l,T,null,m)}}function bm(r){return r=Al(r),ad(r)}var xm=null;function ad(r){if(xm=null,r=Bo(r),r!==null){var l=A(r);if(l===null)r=null;else{var m=l.tag;if(m===13){if(r=w(l),r!==null)return r;r=null}else if(m===31){if(r=c(l),r!==null)return r;r=null}else if(m===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;r=null}else l!==r&&(r=null)}}return xm=r,null}function k_(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Da()){case Ve:return 2;case ne:return 8;case ie:case de:return 32;case Ee:return 268435456;default:return 32}default:return 32}}var Wg=!1,Tc=null,Sc=null,vh=null,lp=new Map,up=new Map,bh=[],d0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Kg(r,l){switch(r){case"focusin":case"focusout":Tc=null;break;case"dragenter":case"dragleave":Sc=null;break;case"mouseover":case"mouseout":vh=null;break;case"pointerover":case"pointerout":lp.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":up.delete(l.pointerId)}}function nu(r,l,m,T,I,B){return r===null||r.nativeEvent!==B?(r={blockedOn:l,domEventName:m,eventSystemFlags:T,nativeEvent:B,targetContainers:[I]},l!==null&&(l=Ts(l),l!==null&&Xg(l)),r):(r.eventSystemFlags|=T,l=r.targetContainers,I!==null&&l.indexOf(I)===-1&&l.push(I),r)}function f0(r,l,m,T,I){switch(l){case"focusin":return Tc=nu(Tc,r,l,m,T,I),!0;case"dragenter":return Sc=nu(Sc,r,l,m,T,I),!0;case"mouseover":return vh=nu(vh,r,l,m,T,I),!0;case"pointerover":var B=I.pointerId;return lp.set(B,nu(lp.get(B)||null,r,l,m,T,I)),!0;case"gotpointercapture":return B=I.pointerId,up.set(B,nu(up.get(B)||null,r,l,m,T,I)),!0}return!1}function af(r){var l=Bo(r.target);if(l!==null){var m=A(l);if(m!==null){if(l=m.tag,l===13){if(l=w(m),l!==null){r.blockedOn=l,ea(r.priority,function(){D_(m)});return}}else if(l===31){if(l=c(m),l!==null){r.blockedOn=l,ea(r.priority,function(){D_(m)});return}}else if(l===3&&m.stateNode.current.memoizedState.isDehydrated){r.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}r.blockedOn=null}function wm(r){if(r.blockedOn!==null)return!1;for(var l=r.targetContainers;0<l.length;){var m=bm(r.nativeEvent);if(m===null){m=r.nativeEvent;var T=new m.constructor(m.type,m);jc=T,m.target.dispatchEvent(T),jc=null}else return l=Ts(m),l!==null&&Xg(l),r.blockedOn=m,!1;l.shift()}return!0}function O_(r,l,m){wm(r)&&m.delete(l)}function p0(){Wg=!1,Tc!==null&&wm(Tc)&&(Tc=null),Sc!==null&&wm(Sc)&&(Sc=null),vh!==null&&wm(vh)&&(vh=null),lp.forEach(O_),up.forEach(O_)}function of(r,l){r.blockedOn===l&&(r.blockedOn=null,Wg||(Wg=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,p0)))}var cp=null;function B_(r){cp!==r&&(cp=r,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){cp===r&&(cp=null);for(var l=0;l<r.length;l+=3){var m=r[l],T=r[l+1],I=r[l+2];if(typeof T!="function"){if(ad(T||m)===null)continue;break}var B=Ts(m);B!==null&&(r.splice(l,3),l-=3,lr(B,{pending:!0,data:I,method:m.method,action:T},T,I))}}))}function sf(r){function l(De){return of(De,r)}Tc!==null&&of(Tc,r),Sc!==null&&of(Sc,r),vh!==null&&of(vh,r),lp.forEach(l),up.forEach(l);for(var m=0;m<bh.length;m++){var T=bh[m];T.blockedOn===r&&(T.blockedOn=null)}for(;0<bh.length&&(m=bh[0],m.blockedOn===null);)af(m),m.blockedOn===null&&bh.shift();if(m=(r.ownerDocument||r).$$reactFormReplay,m!=null)for(T=0;T<m.length;T+=3){var I=m[T],B=m[T+1],J=I[At]||null;if(typeof B=="function")J||B_(m);else if(J){var he=null;if(B&&B.hasAttribute("formAction")){if(I=B,J=B[At]||null)he=J.formAction;else if(ad(I)!==null)continue}else he=J.action;typeof he=="function"?m[T+1]=he:(m.splice(T,3),T-=3),B_(m)}}}function Jg(){function r(B){B.canIntercept&&B.info==="react-transition"&&B.intercept({handler:function(){return new Promise(function(J){return I=J})},focusReset:"manual",scroll:"manual"})}function l(){I!==null&&(I(),I=null),T||setTimeout(m,20)}function m(){if(!T&&!navigation.transition){var B=navigation.currentEntry;B&&B.url!=null&&navigation.navigate(B.url,{state:B.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var T=!1,I=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(m,100),function(){T=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),I!==null&&(I(),I=null)}}}function Tm(r){this._internalRoot=r}Sm.prototype.render=Tm.prototype.render=function(r){var l=this._internalRoot;if(l===null)throw Error(g(409));var m=l.current,T=Tn();L_(m,T,r,l,null,null)},Sm.prototype.unmount=Tm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var l=r.containerInfo;L_(r.current,2,null,r,null,null),qf(),l[yi]=null}};function Sm(r){this._internalRoot=r}Sm.prototype.unstable_scheduleHydration=function(r){if(r){var l=Qr();r={blockedOn:null,target:r,priority:l};for(var m=0;m<bh.length&&l!==0&&l<bh[m].priority;m++);bh.splice(m,0,r),m===0&&af(r)}};var Qg=a.version;if(Qg!=="19.2.3")throw Error(g(527,Qg,"19.2.3"));Pt.findDOMNode=function(r){var l=r._reactInternals;if(l===void 0)throw typeof r.render=="function"?Error(g(188)):(r=Object.keys(r).join(","),Error(g(268,r)));return r=N(l),r=r!==null?H(r):null,r=r===null?null:r.stateNode,r};var F_={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:lt,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mm.isDisabled&&Mm.supportsFiber)try{je=Mm.inject(F_),Re=Mm}catch{}}return ry.createRoot=function(r,l){if(!S(r))throw Error(g(299));var m=!1,T="",I=Lu,B=Jl,J=Pf;return l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(T=l.identifierPrefix),l.onUncaughtError!==void 0&&(I=l.onUncaughtError),l.onCaughtError!==void 0&&(B=l.onCaughtError),l.onRecoverableError!==void 0&&(J=l.onRecoverableError)),l=$g(r,1,!1,null,null,m,T,null,I,B,J,Jg),r[yi]=l.current,rm(r),new Tm(l)},ry.hydrateRoot=function(r,l,m){if(!S(r))throw Error(g(299));var T=!1,I="",B=Lu,J=Jl,he=Pf,De=null;return m!=null&&(m.unstable_strictMode===!0&&(T=!0),m.identifierPrefix!==void 0&&(I=m.identifierPrefix),m.onUncaughtError!==void 0&&(B=m.onUncaughtError),m.onCaughtError!==void 0&&(J=m.onCaughtError),m.onRecoverableError!==void 0&&(he=m.onRecoverableError),m.formState!==void 0&&(De=m.formState)),l=$g(r,1,!0,l,m??null,T,I,De,B,J,he,Jg),l.context=I_(null),m=l.current,T=Tn(),T=ha(T),I=$i(T),I.callback=null,Zl(m,I,T),m=T,l.current.lanes=m,an(l,m),tu(l),r[yi]=l.current,rm(r),new Sm(l)},ry.version="19.2.3",ry}var i1;function IS(){if(i1)return E0.exports;i1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(a){console.error(a)}}return s(),E0.exports=zS(),E0.exports}var LS=IS(),Gw=Vw();const DS=Ry(Gw);function by(){return by=Object.assign?Object.assign.bind():function(s){for(var a=1;a<arguments.length;a++){var h=arguments[a];for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(s[g]=h[g])}return s},by.apply(this,arguments)}var cf;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(cf||(cf={}));const n1="popstate";function RS(s){s===void 0&&(s={});function a(S,A){let{pathname:w="/",search:c="",hash:k=""}=Ip(S.location.hash.substr(1));return!w.startsWith("/")&&!w.startsWith(".")&&(w="/"+w),ib("",{pathname:w,search:c,hash:k},A.state&&A.state.usr||null,A.state&&A.state.key||"default")}function h(S,A){let w=S.document.querySelector("base"),c="";if(w&&w.getAttribute("href")){let k=S.location.href,N=k.indexOf("#");c=N===-1?k:k.slice(0,N)}return c+"#"+(typeof A=="string"?A:cv(A))}function g(S,A){wv(S.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(A)+")")}return OS(a,h,g,s)}function io(s,a){if(s===!1||s===null||typeof s>"u")throw new Error(a)}function wv(s,a){if(!s){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function kS(){return Math.random().toString(36).substr(2,8)}function r1(s,a){return{usr:s.state,key:s.key,idx:a}}function ib(s,a,h,g){return h===void 0&&(h=null),by({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof a=="string"?Ip(a):a,{state:h,key:a&&a.key||g||kS()})}function cv(s){let{pathname:a="/",search:h="",hash:g=""}=s;return h&&h!=="?"&&(a+=h.charAt(0)==="?"?h:"?"+h),g&&g!=="#"&&(a+=g.charAt(0)==="#"?g:"#"+g),a}function Ip(s){let a={};if(s){let h=s.indexOf("#");h>=0&&(a.hash=s.substr(h),s=s.substr(0,h));let g=s.indexOf("?");g>=0&&(a.search=s.substr(g),s=s.substr(0,g)),s&&(a.pathname=s)}return a}function OS(s,a,h,g){g===void 0&&(g={});let{window:S=document.defaultView,v5Compat:A=!1}=g,w=S.history,c=cf.Pop,k=null,N=H();N==null&&(N=0,w.replaceState(by({},w.state,{idx:N}),""));function H(){return(w.state||{idx:null}).idx}function K(){c=cf.Pop;let ce=H(),qe=ce==null?null:ce-N;N=ce,k&&k({action:c,location:fe.location,delta:qe})}function ae(ce,qe){c=cf.Push;let Fe=ib(fe.location,ce,qe);h&&h(Fe,ce),N=H()+1;let Ne=r1(Fe,N),Be=fe.createHref(Fe);try{w.pushState(Ne,"",Be)}catch(Pe){if(Pe instanceof DOMException&&Pe.name==="DataCloneError")throw Pe;S.location.assign(Be)}A&&k&&k({action:c,location:fe.location,delta:1})}function ue(ce,qe){c=cf.Replace;let Fe=ib(fe.location,ce,qe);h&&h(Fe,ce),N=H();let Ne=r1(Fe,N),Be=fe.createHref(Fe);w.replaceState(Ne,"",Be),A&&k&&k({action:c,location:fe.location,delta:0})}function ge(ce){let qe=S.location.origin!=="null"?S.location.origin:S.location.href,Fe=typeof ce=="string"?ce:cv(ce);return Fe=Fe.replace(/ $/,"%20"),io(qe,"No window.location.(origin|href) available to create URL for href: "+Fe),new URL(Fe,qe)}let fe={get action(){return c},get location(){return s(S,w)},listen(ce){if(k)throw new Error("A history only accepts one active listener");return S.addEventListener(n1,K),k=ce,()=>{S.removeEventListener(n1,K),k=null}},createHref(ce){return a(S,ce)},createURL:ge,encodeLocation(ce){let qe=ge(ce);return{pathname:qe.pathname,search:qe.search,hash:qe.hash}},push:ae,replace:ue,go(ce){return w.go(ce)}};return fe}var a1;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(a1||(a1={}));function BS(s,a,h){return h===void 0&&(h="/"),FS(s,a,h)}function FS(s,a,h,g){let S=typeof a=="string"?Ip(a):a,A=Db(S.pathname||"/",h);if(A==null)return null;let w=Zw(s);NS(w);let c=null;for(let k=0;c==null&&k<w.length;++k){let N=KS(A);c=XS(w[k],N)}return c}function Zw(s,a,h,g){a===void 0&&(a=[]),h===void 0&&(h=[]),g===void 0&&(g="");let S=(A,w,c)=>{let k={relativePath:c===void 0?A.path||"":c,caseSensitive:A.caseSensitive===!0,childrenIndex:w,route:A};k.relativePath.startsWith("/")&&(io(k.relativePath.startsWith(g),'Absolute route path "'+k.relativePath+'" nested under path '+('"'+g+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),k.relativePath=k.relativePath.slice(g.length));let N=pf([g,k.relativePath]),H=h.concat(k);A.children&&A.children.length>0&&(io(A.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+N+'".')),Zw(A.children,a,H,N)),!(A.path==null&&!A.index)&&a.push({path:N,score:$S(N,A.index),routesMeta:H})};return s.forEach((A,w)=>{var c;if(A.path===""||!((c=A.path)!=null&&c.includes("?")))S(A,w);else for(let k of qw(A.path))S(A,w,k)}),a}function qw(s){let a=s.split("/");if(a.length===0)return[];let[h,...g]=a,S=h.endsWith("?"),A=h.replace(/\?$/,"");if(g.length===0)return S?[A,""]:[A];let w=qw(g.join("/")),c=[];return c.push(...w.map(k=>k===""?A:[A,k].join("/"))),S&&c.push(...w),c.map(k=>s.startsWith("/")&&k===""?"/":k)}function NS(s){s.sort((a,h)=>a.score!==h.score?h.score-a.score:HS(a.routesMeta.map(g=>g.childrenIndex),h.routesMeta.map(g=>g.childrenIndex)))}const jS=/^:[\w-]+$/,US=3,VS=2,GS=1,ZS=10,qS=-2,o1=s=>s==="*";function $S(s,a){let h=s.split("/"),g=h.length;return h.some(o1)&&(g+=qS),a&&(g+=VS),h.filter(S=>!o1(S)).reduce((S,A)=>S+(jS.test(A)?US:A===""?GS:ZS),g)}function HS(s,a){return s.length===a.length&&s.slice(0,-1).every((g,S)=>g===a[S])?s[s.length-1]-a[a.length-1]:0}function XS(s,a,h){let{routesMeta:g}=s,S={},A="/",w=[];for(let c=0;c<g.length;++c){let k=g[c],N=c===g.length-1,H=A==="/"?a:a.slice(A.length)||"/",K=YS({path:k.relativePath,caseSensitive:k.caseSensitive,end:N},H),ae=k.route;if(!K)return null;Object.assign(S,K.params),w.push({params:S,pathname:pf([A,K.pathname]),pathnameBase:iM(pf([A,K.pathnameBase])),route:ae}),K.pathnameBase!=="/"&&(A=pf([A,K.pathnameBase]))}return w}function YS(s,a){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[h,g]=WS(s.path,s.caseSensitive,s.end),S=a.match(h);if(!S)return null;let A=S[0],w=A.replace(/(.)\/+$/,"$1"),c=S.slice(1);return{params:g.reduce((N,H,K)=>{let{paramName:ae,isOptional:ue}=H;if(ae==="*"){let fe=c[K]||"";w=A.slice(0,A.length-fe.length).replace(/(.)\/+$/,"$1")}const ge=c[K];return ue&&!ge?N[ae]=void 0:N[ae]=(ge||"").replace(/%2F/g,"/"),N},{}),pathname:A,pathnameBase:w,pattern:s}}function WS(s,a,h){a===void 0&&(a=!1),h===void 0&&(h=!0),wv(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let g=[],S="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(w,c,k)=>(g.push({paramName:c,isOptional:k!=null}),k?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(g.push({paramName:"*"}),S+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):h?S+="\\/*$":s!==""&&s!=="/"&&(S+="(?:(?=\\/|$))"),[new RegExp(S,a?void 0:"i"),g]}function KS(s){try{return s.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return wv(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+a+").")),s}}function Db(s,a){if(a==="/")return s;if(!s.toLowerCase().startsWith(a.toLowerCase()))return null;let h=a.endsWith("/")?a.length-1:a.length,g=s.charAt(h);return g&&g!=="/"?null:s.slice(h)||"/"}const JS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,QS=s=>JS.test(s);function eM(s,a){a===void 0&&(a="/");let{pathname:h,search:g="",hash:S=""}=typeof s=="string"?Ip(s):s,A;if(h)if(QS(h))A=h;else{if(h.includes("//")){let w=h;h=h.replace(/\/\/+/g,"/"),wv(!1,"Pathnames cannot have embedded double slashes - normalizing "+(w+" -> "+h))}h.startsWith("/")?A=s1(h.substring(1),"/"):A=s1(h,a)}else A=a;return{pathname:A,search:nM(g),hash:rM(S)}}function s1(s,a){let h=a.replace(/\/+$/,"").split("/");return s.split("/").forEach(S=>{S===".."?h.length>1&&h.pop():S!=="."&&h.push(S)}),h.length>1?h.join("/"):"/"}function z0(s,a,h,g){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+a+"` field ["+JSON.stringify(g)+"].  Please separate it out to the ")+("`to."+h+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function tM(s){return s.filter((a,h)=>h===0||a.route.path&&a.route.path.length>0)}function $w(s,a){let h=tM(s);return a?h.map((g,S)=>S===h.length-1?g.pathname:g.pathnameBase):h.map(g=>g.pathnameBase)}function Hw(s,a,h,g){g===void 0&&(g=!1);let S;typeof s=="string"?S=Ip(s):(S=by({},s),io(!S.pathname||!S.pathname.includes("?"),z0("?","pathname","search",S)),io(!S.pathname||!S.pathname.includes("#"),z0("#","pathname","hash",S)),io(!S.search||!S.search.includes("#"),z0("#","search","hash",S)));let A=s===""||S.pathname==="",w=A?"/":S.pathname,c;if(w==null)c=h;else{let K=a.length-1;if(!g&&w.startsWith("..")){let ae=w.split("/");for(;ae[0]==="..";)ae.shift(),K-=1;S.pathname=ae.join("/")}c=K>=0?a[K]:"/"}let k=eM(S,c),N=w&&w!=="/"&&w.endsWith("/"),H=(A||w===".")&&h.endsWith("/");return!k.pathname.endsWith("/")&&(N||H)&&(k.pathname+="/"),k}const pf=s=>s.join("/").replace(/\/\/+/g,"/"),iM=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),nM=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,rM=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function aM(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const Xw=["post","put","patch","delete"];new Set(Xw);const oM=["get",...Xw];new Set(oM);function xy(){return xy=Object.assign?Object.assign.bind():function(s){for(var a=1;a<arguments.length;a++){var h=arguments[a];for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(s[g]=h[g])}return s},xy.apply(this,arguments)}const Rb=ct.createContext(null),sM=ct.createContext(null),Lp=ct.createContext(null),Tv=ct.createContext(null),Dp=ct.createContext({outlet:null,matches:[],isDataRoute:!1}),Yw=ct.createContext(null);function lM(s,a){let{relative:h}=a===void 0?{}:a;ky()||io(!1);let{basename:g,navigator:S}=ct.useContext(Lp),{hash:A,pathname:w,search:c}=Kw(s,{relative:h}),k=w;return g!=="/"&&(k=w==="/"?g:pf([g,w])),S.createHref({pathname:k,search:c,hash:A})}function ky(){return ct.useContext(Tv)!=null}function Sv(){return ky()||io(!1),ct.useContext(Tv).location}function Ww(s){ct.useContext(Lp).static||ct.useLayoutEffect(s)}function uM(){let{isDataRoute:s}=ct.useContext(Dp);return s?wM():cM()}function cM(){ky()||io(!1);let s=ct.useContext(Rb),{basename:a,future:h,navigator:g}=ct.useContext(Lp),{matches:S}=ct.useContext(Dp),{pathname:A}=Sv(),w=JSON.stringify($w(S,h.v7_relativeSplatPath)),c=ct.useRef(!1);return Ww(()=>{c.current=!0}),ct.useCallback(function(N,H){if(H===void 0&&(H={}),!c.current)return;if(typeof N=="number"){g.go(N);return}let K=Hw(N,JSON.parse(w),A,H.relative==="path");s==null&&a!=="/"&&(K.pathname=K.pathname==="/"?a:pf([a,K.pathname])),(H.replace?g.replace:g.push)(K,H.state,H)},[a,g,w,A,s])}function Kw(s,a){let{relative:h}=a===void 0?{}:a,{future:g}=ct.useContext(Lp),{matches:S}=ct.useContext(Dp),{pathname:A}=Sv(),w=JSON.stringify($w(S,g.v7_relativeSplatPath));return ct.useMemo(()=>Hw(s,JSON.parse(w),A,h==="path"),[s,w,A,h])}function hM(s,a){return dM(s,a)}function dM(s,a,h,g){ky()||io(!1);let{navigator:S}=ct.useContext(Lp),{matches:A}=ct.useContext(Dp),w=A[A.length-1],c=w?w.params:{};w&&w.pathname;let k=w?w.pathnameBase:"/";w&&w.route;let N=Sv(),H;if(a){var K;let ce=typeof a=="string"?Ip(a):a;k==="/"||(K=ce.pathname)!=null&&K.startsWith(k)||io(!1),H=ce}else H=N;let ae=H.pathname||"/",ue=ae;if(k!=="/"){let ce=k.replace(/^\//,"").split("/");ue="/"+ae.replace(/^\//,"").split("/").slice(ce.length).join("/")}let ge=BS(s,{pathname:ue}),fe=yM(ge&&ge.map(ce=>Object.assign({},ce,{params:Object.assign({},c,ce.params),pathname:pf([k,S.encodeLocation?S.encodeLocation(ce.pathname).pathname:ce.pathname]),pathnameBase:ce.pathnameBase==="/"?k:pf([k,S.encodeLocation?S.encodeLocation(ce.pathnameBase).pathname:ce.pathnameBase])})),A,h,g);return a&&fe?ct.createElement(Tv.Provider,{value:{location:xy({pathname:"/",search:"",hash:"",state:null,key:"default"},H),navigationType:cf.Pop}},fe):fe}function fM(){let s=xM(),a=aM(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),h=s instanceof Error?s.stack:null,S={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ct.createElement(ct.Fragment,null,ct.createElement("h2",null,"Unexpected Application Error!"),ct.createElement("h3",{style:{fontStyle:"italic"}},a),h?ct.createElement("pre",{style:S},h):null,null)}const pM=ct.createElement(fM,null);class mM extends ct.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,h){return h.location!==a.location||h.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:h.error,location:h.location,revalidation:a.revalidation||h.revalidation}}componentDidCatch(a,h){console.error("React Router caught the following error during render",a,h)}render(){return this.state.error!==void 0?ct.createElement(Dp.Provider,{value:this.props.routeContext},ct.createElement(Yw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function gM(s){let{routeContext:a,match:h,children:g}=s,S=ct.useContext(Rb);return S&&S.static&&S.staticContext&&(h.route.errorElement||h.route.ErrorBoundary)&&(S.staticContext._deepestRenderedBoundaryId=h.route.id),ct.createElement(Dp.Provider,{value:a},g)}function yM(s,a,h,g){var S;if(a===void 0&&(a=[]),h===void 0&&(h=null),g===void 0&&(g=null),s==null){var A;if(!h)return null;if(h.errors)s=h.matches;else if((A=g)!=null&&A.v7_partialHydration&&a.length===0&&!h.initialized&&h.matches.length>0)s=h.matches;else return null}let w=s,c=(S=h)==null?void 0:S.errors;if(c!=null){let H=w.findIndex(K=>K.route.id&&c?.[K.route.id]!==void 0);H>=0||io(!1),w=w.slice(0,Math.min(w.length,H+1))}let k=!1,N=-1;if(h&&g&&g.v7_partialHydration)for(let H=0;H<w.length;H++){let K=w[H];if((K.route.HydrateFallback||K.route.hydrateFallbackElement)&&(N=H),K.route.id){let{loaderData:ae,errors:ue}=h,ge=K.route.loader&&ae[K.route.id]===void 0&&(!ue||ue[K.route.id]===void 0);if(K.route.lazy||ge){k=!0,N>=0?w=w.slice(0,N+1):w=[w[0]];break}}}return w.reduceRight((H,K,ae)=>{let ue,ge=!1,fe=null,ce=null;h&&(ue=c&&K.route.id?c[K.route.id]:void 0,fe=K.route.errorElement||pM,k&&(N<0&&ae===0?(TM("route-fallback"),ge=!0,ce=null):N===ae&&(ge=!0,ce=K.route.hydrateFallbackElement||null)));let qe=a.concat(w.slice(0,ae+1)),Fe=()=>{let Ne;return ue?Ne=fe:ge?Ne=ce:K.route.Component?Ne=ct.createElement(K.route.Component,null):K.route.element?Ne=K.route.element:Ne=H,ct.createElement(gM,{match:K,routeContext:{outlet:H,matches:qe,isDataRoute:h!=null},children:Ne})};return h&&(K.route.ErrorBoundary||K.route.errorElement||ae===0)?ct.createElement(mM,{location:h.location,revalidation:h.revalidation,component:fe,error:ue,children:Fe(),routeContext:{outlet:null,matches:qe,isDataRoute:!0}}):Fe()},null)}var Jw=(function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s})(Jw||{}),Qw=(function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s})(Qw||{});function _M(s){let a=ct.useContext(Rb);return a||io(!1),a}function vM(s){let a=ct.useContext(sM);return a||io(!1),a}function bM(s){let a=ct.useContext(Dp);return a||io(!1),a}function e2(s){let a=bM(),h=a.matches[a.matches.length-1];return h.route.id||io(!1),h.route.id}function xM(){var s;let a=ct.useContext(Yw),h=vM(Qw.UseRouteError),g=e2();return a!==void 0?a:(s=h.errors)==null?void 0:s[g]}function wM(){let{router:s}=_M(Jw.UseNavigateStable),a=e2(),h=ct.useRef(!1);return Ww(()=>{h.current=!0}),ct.useCallback(function(S,A){A===void 0&&(A={}),h.current&&(typeof S=="number"?s.navigate(S):s.navigate(S,xy({fromRouteId:a},A)))},[s,a])}const l1={};function TM(s,a,h){l1[s]||(l1[s]=!0)}function SM(s,a){s?.v7_startTransition,s?.v7_relativeSplatPath}function tv(s){io(!1)}function MM(s){let{basename:a="/",children:h=null,location:g,navigationType:S=cf.Pop,navigator:A,static:w=!1,future:c}=s;ky()&&io(!1);let k=a.replace(/^\/*/,"/"),N=ct.useMemo(()=>({basename:k,navigator:A,static:w,future:xy({v7_relativeSplatPath:!1},c)}),[k,c,A,w]);typeof g=="string"&&(g=Ip(g));let{pathname:H="/",search:K="",hash:ae="",state:ue=null,key:ge="default"}=g,fe=ct.useMemo(()=>{let ce=Db(H,k);return ce==null?null:{location:{pathname:ce,search:K,hash:ae,state:ue,key:ge},navigationType:S}},[k,H,K,ae,ue,ge,S]);return fe==null?null:ct.createElement(Lp.Provider,{value:N},ct.createElement(Tv.Provider,{children:h,value:fe}))}function EM(s){let{children:a,location:h}=s;return hM(nb(a),h)}new Promise(()=>{});function nb(s,a){a===void 0&&(a=[]);let h=[];return ct.Children.forEach(s,(g,S)=>{if(!ct.isValidElement(g))return;let A=[...a,S];if(g.type===ct.Fragment){h.push.apply(h,nb(g.props.children,A));return}g.type!==tv&&io(!1),!g.props.index||!g.props.children||io(!1);let w={id:g.props.id||A.join("-"),caseSensitive:g.props.caseSensitive,element:g.props.element,Component:g.props.Component,index:g.props.index,path:g.props.path,loader:g.props.loader,action:g.props.action,errorElement:g.props.errorElement,ErrorBoundary:g.props.ErrorBoundary,hasErrorBoundary:g.props.ErrorBoundary!=null||g.props.errorElement!=null,shouldRevalidate:g.props.shouldRevalidate,handle:g.props.handle,lazy:g.props.lazy};g.props.children&&(w.children=nb(g.props.children,A)),h.push(w)}),h}function rb(){return rb=Object.assign?Object.assign.bind():function(s){for(var a=1;a<arguments.length;a++){var h=arguments[a];for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(s[g]=h[g])}return s},rb.apply(this,arguments)}function AM(s,a){if(s==null)return{};var h={},g=Object.keys(s),S,A;for(A=0;A<g.length;A++)S=g[A],!(a.indexOf(S)>=0)&&(h[S]=s[S]);return h}function CM(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function PM(s,a){return s.button===0&&(!a||a==="_self")&&!CM(s)}const zM=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],IM="6";try{window.__reactRouterVersion=IM}catch{}const LM="startTransition",u1=ES[LM];function DM(s){let{basename:a,children:h,future:g,window:S}=s,A=ct.useRef();A.current==null&&(A.current=RS({window:S,v5Compat:!0}));let w=A.current,[c,k]=ct.useState({action:w.action,location:w.location}),{v7_startTransition:N}=g||{},H=ct.useCallback(K=>{N&&u1?u1(()=>k(K)):k(K)},[k,N]);return ct.useLayoutEffect(()=>w.listen(H),[w,H]),ct.useEffect(()=>SM(g),[g]),ct.createElement(MM,{basename:a,children:h,location:c.location,navigationType:c.action,navigator:w,future:g})}const RM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kM=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,c1=ct.forwardRef(function(a,h){let{onClick:g,relative:S,reloadDocument:A,replace:w,state:c,target:k,to:N,preventScrollReset:H,viewTransition:K}=a,ae=AM(a,zM),{basename:ue}=ct.useContext(Lp),ge,fe=!1;if(typeof N=="string"&&kM.test(N)&&(ge=N,RM))try{let Ne=new URL(window.location.href),Be=N.startsWith("//")?new URL(Ne.protocol+N):new URL(N),Pe=Db(Be.pathname,ue);Be.origin===Ne.origin&&Pe!=null?N=Pe+Be.search+Be.hash:fe=!0}catch{}let ce=lM(N,{relative:S}),qe=OM(N,{replace:w,state:c,target:k,preventScrollReset:H,relative:S,viewTransition:K});function Fe(Ne){g&&g(Ne),Ne.defaultPrevented||qe(Ne)}return ct.createElement("a",rb({},ae,{href:ge||ce,onClick:fe||A?g:Fe,ref:h,target:k}))});var h1;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(h1||(h1={}));var d1;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(d1||(d1={}));function OM(s,a){let{target:h,replace:g,state:S,preventScrollReset:A,relative:w,viewTransition:c}=a===void 0?{}:a,k=uM(),N=Sv(),H=Kw(s,{relative:w});return ct.useCallback(K=>{if(PM(K,h)){K.preventDefault();let ae=g!==void 0?g:cv(N)===cv(H);k(s,{replace:ae,state:S,preventScrollReset:A,relative:w,viewTransition:c})}},[N,k,H,g,S,h,s,A,w,c])}function Sh(s){return Object.keys(s)}function I0(s){return s&&typeof s=="object"&&!Array.isArray(s)}function kb(s,a){const h={...s},g=a;return I0(s)&&I0(a)&&Object.keys(a).forEach(S=>{I0(g[S])&&S in s?h[S]=kb(h[S],g[S]):h[S]=g[S]}),h}function BM(s){return s.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`)}function FM(s){return typeof s!="string"||!s.includes("var(--mantine-scale)")?s:s.match(/^calc\((.*?)\)$/)?.[1].split("*")[0].trim()}function NM(s){const a=FM(s);return typeof a=="number"?a:typeof a=="string"?a.includes("calc")||a.includes("var")?a:a.includes("px")?Number(a.replace("px","")):a.includes("rem")?Number(a.replace("rem",""))*16:a.includes("em")?Number(a.replace("em",""))*16:Number(a):NaN}function f1(s){return s==="0rem"?"0rem":`calc(${s} * var(--mantine-scale))`}function t2(s,{shouldScale:a=!1}={}){function h(g){if(g===0||g==="0")return`0${s}`;if(typeof g=="number"){const S=`${g/16}${s}`;return a?f1(S):S}if(typeof g=="string"){if(g===""||g.startsWith("calc(")||g.startsWith("clamp(")||g.includes("rgba("))return g;if(g.includes(","))return g.split(",").map(A=>h(A)).join(",");if(g.includes(" "))return g.split(" ").map(A=>h(A)).join(" ");const S=g.replace("px","");if(!Number.isNaN(Number(S))){const A=`${Number(S)/16}${s}`;return a?f1(A):A}}return g}return h}const Lt=t2("rem",{shouldScale:!0}),p1=t2("em");function Ob(s){return Object.keys(s).reduce((a,h)=>(s[h]!==void 0&&(a[h]=s[h]),a),{})}function i2(s){if(typeof s=="number")return!0;if(typeof s=="string"){if(s.startsWith("calc(")||s.startsWith("var(")||s.includes(" ")&&s.trim()!=="")return!0;const a=/^[+-]?[0-9]+(\.[0-9]+)?(px|em|rem|ex|ch|lh|rlh|vw|vh|vmin|vmax|vb|vi|svw|svh|lvw|lvh|dvw|dvh|cm|mm|in|pt|pc|q|cqw|cqh|cqi|cqb|cqmin|cqmax|%)?$/;return s.trim().split(/\s+/).every(g=>a.test(g))}return!1}function jM(s){const a=ct.createContext(null);return[({children:S,value:A})=>rt.jsx(a.Provider,{value:A,children:S}),()=>{const S=ct.useContext(a);if(S===null)throw new Error(s);return S}]}function n2(s=null){const a=ct.createContext(s);return[({children:S,value:A})=>rt.jsx(a.Provider,{value:A,children:S}),()=>ct.useContext(a)]}function m1(s,a){return h=>{if(typeof h!="string"||h.trim().length===0)throw new Error(a);return`${s}-${h}`}}function ab(s,a){let h=s;for(;(h=h.parentElement)&&!h.matches(a););return h}function UM(s,a,h){for(let g=s-1;g>=0;g-=1)if(!a[g].disabled)return g;if(h){for(let g=a.length-1;g>-1;g-=1)if(!a[g].disabled)return g}return s}function VM(s,a,h){for(let g=s+1;g<a.length;g+=1)if(!a[g].disabled)return g;if(h){for(let g=0;g<a.length;g+=1)if(!a[g].disabled)return g}return s}function GM(s,a,h){return ab(s,h)===ab(a,h)}function ZM({parentSelector:s,siblingSelector:a,onKeyDown:h,loop:g=!0,activateOnFocus:S=!1,dir:A="rtl",orientation:w}){return c=>{h?.(c);const k=Array.from(ab(c.currentTarget,s)?.querySelectorAll(a)||[]).filter(ge=>GM(c.currentTarget,ge,s)),N=k.findIndex(ge=>c.currentTarget===ge),H=VM(N,k,g),K=UM(N,k,g),ae=A==="rtl"?K:H,ue=A==="rtl"?H:K;switch(c.key){case"ArrowRight":{w==="horizontal"&&(c.stopPropagation(),c.preventDefault(),k[ae].focus(),S&&k[ae].click());break}case"ArrowLeft":{w==="horizontal"&&(c.stopPropagation(),c.preventDefault(),k[ue].focus(),S&&k[ue].click());break}case"ArrowUp":{w==="vertical"&&(c.stopPropagation(),c.preventDefault(),k[K].focus(),S&&k[K].click());break}case"ArrowDown":{w==="vertical"&&(c.stopPropagation(),c.preventDefault(),k[H].focus(),S&&k[H].click());break}case"Home":{c.stopPropagation(),c.preventDefault(),!k[0].disabled&&k[0].focus();break}case"End":{c.stopPropagation(),c.preventDefault();const ge=k.length-1;!k[ge].disabled&&k[ge].focus();break}}}}function Ws(s,a="size",h=!0){if(s!==void 0)return i2(s)?h?Lt(s):s:`var(--${a}-${s})`}function Bb(s){return Ws(s,"mantine-spacing")}function fd(s){return s===void 0?"var(--mantine-radius-default)":Ws(s,"mantine-radius")}function Uu(s){return Ws(s,"mantine-font-size")}function qM(s="mantine-"){return`${s}${Math.random().toString(36).slice(2,11)}`}function $M(s,a){try{return s.addEventListener("change",a),()=>s.removeEventListener("change",a)}catch{return s.addListener(a),()=>s.removeListener(a)}}function HM(s,a){return typeof window<"u"&&"matchMedia"in window?window.matchMedia(s).matches:!1}function XM(s,a,{getInitialValueInEffect:h}={getInitialValueInEffect:!0}){const[g,S]=ct.useState(h?a:HM(s));return ct.useEffect(()=>{try{const A=window.matchMedia(s);return S(A.matches),$M(A,w=>S(w.matches))}catch{return}},[s]),g||!1}const Fb=typeof document<"u"?ct.useLayoutEffect:ct.useEffect;function r2(s,a){const h=ct.useRef(!1);ct.useEffect(()=>()=>{h.current=!1},[]),ct.useEffect(()=>{if(h.current)return s();h.current=!0},a)}const YM=Lb.useId||(()=>{});function WM(){const s=YM();return s?`mantine-${s.replace(/:/g,"")}`:""}function Nb(s){const a=WM(),[h,g]=ct.useState(a);return Fb(()=>{g(qM())},[]),typeof s=="string"?s:typeof window>"u"?a:h}function g1(s,a){if(typeof s=="function")return s(a);typeof s=="object"&&s!==null&&"current"in s&&(s.current=a)}function a2(...s){const a=new Map;return h=>{if(s.forEach(g=>{const S=g1(g,h);S&&a.set(g,S)}),a.size>0)return()=>{s.forEach(g=>{const S=a.get(g);S&&typeof S=="function"?S():g1(g,null)}),a.clear()}}}function KM(...s){return ct.useCallback(a2(...s),s)}function JM({value:s,defaultValue:a,finalValue:h,onChange:g=()=>{}}){const[S,A]=ct.useState(a!==void 0?a:h),w=(c,...k)=>{A(c),g?.(c,...k)};return s!==void 0?[s,g,!0]:[S,w,!1]}function o2(s,a){return XM("(prefers-reduced-motion: reduce)",s,a)}function QM(){const[s,a]=ct.useState(!1),h=ct.useRef(null),g=ct.useCallback(()=>{a(!0)},[]),S=ct.useCallback(()=>{a(!1)},[]);return{ref:ct.useCallback(w=>{h.current&&(h.current.removeEventListener("mouseenter",g),h.current.removeEventListener("mouseleave",S)),w&&(w.addEventListener("mouseenter",g),w.addEventListener("mouseleave",S)),h.current=w},[g,S]),hovered:s}}function eE(s,a,h={autoInvoke:!1}){const g=ct.useRef(null),S=ct.useCallback((...w)=>{g.current||(g.current=window.setTimeout(()=>{s(w),g.current=null},a))},[a]),A=ct.useCallback(()=>{g.current&&(window.clearTimeout(g.current),g.current=null)},[]);return ct.useEffect(()=>(h.autoInvoke&&S(),A),[A,S]),{start:S,clear:A}}function tE(s,a,h){const g=ct.useRef(null),S=ct.useRef(null);return ct.useEffect(()=>{const A=typeof h=="function"?h():h;return(A||S.current)&&(g.current=new MutationObserver(s),g.current.observe(A||S.current,a)),()=>{g.current?.disconnect()}},[s,a]),S}var iE={};function nE(){return typeof process<"u"&&iE?"production":"development"}function s2(s){var a,h,g="";if(typeof s=="string"||typeof s=="number")g+=s;else if(typeof s=="object")if(Array.isArray(s)){var S=s.length;for(a=0;a<S;a++)s[a]&&(h=s2(s[a]))&&(g&&(g+=" "),g+=h)}else for(h in s)s[h]&&(g&&(g+=" "),g+=h);return g}function Rp(){for(var s,a,h=0,g="",S=arguments.length;h<S;h++)(s=arguments[h])&&(a=s2(s))&&(g&&(g+=" "),g+=a);return g}const rE={};function aE(s){const a={};return s.forEach(h=>{Object.entries(h).forEach(([g,S])=>{a[g]?a[g]=Rp(a[g],S):a[g]=S})}),a}function Mv({theme:s,classNames:a,props:h,stylesCtx:g}){const A=(Array.isArray(a)?a:[a]).map(w=>typeof w=="function"?w(s,h,g):w||rE);return aE(A)}function hv({theme:s,styles:a,props:h,stylesCtx:g}){return(Array.isArray(a)?a:[a]).reduce((A,w)=>typeof w=="function"?{...A,...w(s,h,g)}:{...A,...w},{})}const l2=ct.createContext(null);function yf(){const s=ct.useContext(l2);if(!s)throw new Error("[@mantine/core] MantineProvider was not found in tree");return s}function oE(){return yf().cssVariablesResolver}function sE(){return yf().classNamesPrefix}function jb(){return yf().getStyleNonce}function lE(){return yf().withStaticClasses}function uE(){return yf().headless}function cE(){return yf().stylesTransform?.sx}function hE(){return yf().stylesTransform?.styles}function dE(){return yf().env||"default"}function fE(s){return/^#?([0-9A-F]{3}){1,2}([0-9A-F]{2})?$/i.test(s)}function pE(s){let a=s.replace("#","");if(a.length===3){const w=a.split("");a=[w[0],w[0],w[1],w[1],w[2],w[2]].join("")}if(a.length===8){const w=parseInt(a.slice(6,8),16)/255;return{r:parseInt(a.slice(0,2),16),g:parseInt(a.slice(2,4),16),b:parseInt(a.slice(4,6),16),a:w}}const h=parseInt(a,16),g=h>>16&255,S=h>>8&255,A=h&255;return{r:g,g:S,b:A,a:1}}function mE(s){const[a,h,g,S]=s.replace(/[^0-9,./]/g,"").split(/[/,]/).map(Number);return{r:a,g:h,b:g,a:S===void 0?1:S}}function gE(s){const a=/^hsla?\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*(,\s*(0?\.\d+|\d+(\.\d+)?))?\s*\)$/i,h=s.match(a);if(!h)return{r:0,g:0,b:0,a:1};const g=parseInt(h[1],10),S=parseInt(h[2],10)/100,A=parseInt(h[3],10)/100,w=h[5]?parseFloat(h[5]):void 0,c=(1-Math.abs(2*A-1))*S,k=g/60,N=c*(1-Math.abs(k%2-1)),H=A-c/2;let K,ae,ue;return k>=0&&k<1?(K=c,ae=N,ue=0):k>=1&&k<2?(K=N,ae=c,ue=0):k>=2&&k<3?(K=0,ae=c,ue=N):k>=3&&k<4?(K=0,ae=N,ue=c):k>=4&&k<5?(K=N,ae=0,ue=c):(K=c,ae=0,ue=N),{r:Math.round((K+H)*255),g:Math.round((ae+H)*255),b:Math.round((ue+H)*255),a:w||1}}function Ub(s){return fE(s)?pE(s):s.startsWith("rgb")?mE(s):s.startsWith("hsl")?gE(s):{r:0,g:0,b:0,a:1}}function V_(s,a){if(s.startsWith("var("))return`color-mix(in srgb, ${s}, black ${a*100}%)`;const{r:h,g,b:S,a:A}=Ub(s),w=1-a,c=k=>Math.round(k*w);return`rgba(${c(h)}, ${c(g)}, ${c(S)}, ${A})`}function wy(s,a){return typeof s.primaryShade=="number"?s.primaryShade:a==="dark"?s.primaryShade.dark:s.primaryShade.light}function L0(s){return s<=.03928?s/12.92:((s+.055)/1.055)**2.4}function yE(s){const a=s.match(/oklch\((.*?)%\s/);return a?parseFloat(a[1]):null}function _E(s){if(s.startsWith("oklch("))return(yE(s)||0)/100;const{r:a,g:h,b:g}=Ub(s),S=a/255,A=h/255,w=g/255,c=L0(S),k=L0(A),N=L0(w);return .2126*c+.7152*k+.0722*N}function ay(s,a=.179){return s.startsWith("var(")?!1:_E(s)>a}function Oy({color:s,theme:a,colorScheme:h}){if(typeof s!="string")throw new Error(`[@mantine/core] Failed to parse color. Expected color to be a string, instead got ${typeof s}`);if(s==="bright")return{color:s,value:h==="dark"?a.white:a.black,shade:void 0,isThemeColor:!1,isLight:ay(h==="dark"?a.white:a.black,a.luminanceThreshold),variable:"--mantine-color-bright"};if(s==="dimmed")return{color:s,value:h==="dark"?a.colors.dark[2]:a.colors.gray[7],shade:void 0,isThemeColor:!1,isLight:ay(h==="dark"?a.colors.dark[2]:a.colors.gray[6],a.luminanceThreshold),variable:"--mantine-color-dimmed"};if(s==="white"||s==="black")return{color:s,value:s==="white"?a.white:a.black,shade:void 0,isThemeColor:!1,isLight:ay(s==="white"?a.white:a.black,a.luminanceThreshold),variable:`--mantine-color-${s}`};const[g,S]=s.split("."),A=S?Number(S):void 0,w=g in a.colors;if(w){const c=A!==void 0?a.colors[g][A]:a.colors[g][wy(a,h||"light")];return{color:g,value:c,shade:A,isThemeColor:w,isLight:ay(c,a.luminanceThreshold),variable:S?`--mantine-color-${g}-${A}`:`--mantine-color-${g}-filled`}}return{color:s,value:s,isThemeColor:w,isLight:ay(s,a.luminanceThreshold),shade:A,variable:void 0}}function Ty(s,a){const h=Oy({color:s||a.primaryColor,theme:a});return h.variable?`var(${h.variable})`:s}function y1(s,a){const h={from:s?.from||a.defaultGradient.from,to:s?.to||a.defaultGradient.to,deg:s?.deg??a.defaultGradient.deg??0},g=Ty(h.from,a),S=Ty(h.to,a);return`linear-gradient(${h.deg}deg, ${g} 0%, ${S} 100%)`}function ld(s,a){if(typeof s!="string"||a>1||a<0)return"rgba(0, 0, 0, 1)";if(s.startsWith("var(")){const A=(1-a)*100;return`color-mix(in srgb, ${s}, transparent ${A}%)`}if(s.startsWith("oklch"))return s.includes("/")?s.replace(/\/\s*[\d.]+\s*\)/,`/ ${a})`):s.replace(")",` / ${a})`);const{r:h,g,b:S}=Ub(s);return`rgba(${h}, ${g}, ${S}, ${a})`}const Pm=ld,vE=({color:s,theme:a,variant:h,gradient:g,autoContrast:S})=>{const A=Oy({color:s,theme:a}),w=typeof S=="boolean"?S:a.autoContrast;if(h==="none")return{background:"transparent",hover:"transparent",color:"inherit",border:"none"};if(h==="filled"){const c=w&&A.isLight?"var(--mantine-color-black)":"var(--mantine-color-white)";return A.isThemeColor?A.shade===void 0?{background:`var(--mantine-color-${s}-filled)`,hover:`var(--mantine-color-${s}-filled-hover)`,color:c,border:`${Lt(1)} solid transparent`}:{background:`var(--mantine-color-${A.color}-${A.shade})`,hover:`var(--mantine-color-${A.color}-${A.shade===9?8:A.shade+1})`,color:c,border:`${Lt(1)} solid transparent`}:{background:s,hover:V_(s,.1),color:c,border:`${Lt(1)} solid transparent`}}if(h==="light"){if(A.isThemeColor){if(A.shade===void 0)return{background:`var(--mantine-color-${s}-light)`,hover:`var(--mantine-color-${s}-light-hover)`,color:`var(--mantine-color-${s}-light-color)`,border:`${Lt(1)} solid transparent`};const c=a.colors[A.color][A.shade];return{background:ld(c,.1),hover:ld(c,.12),color:`var(--mantine-color-${A.color}-${Math.min(A.shade,6)})`,border:`${Lt(1)} solid transparent`}}return{background:ld(s,.1),hover:ld(s,.12),color:s,border:`${Lt(1)} solid transparent`}}if(h==="outline")return A.isThemeColor?A.shade===void 0?{background:"transparent",hover:`var(--mantine-color-${s}-outline-hover)`,color:`var(--mantine-color-${s}-outline)`,border:`${Lt(1)} solid var(--mantine-color-${s}-outline)`}:{background:"transparent",hover:ld(a.colors[A.color][A.shade],.05),color:`var(--mantine-color-${A.color}-${A.shade})`,border:`${Lt(1)} solid var(--mantine-color-${A.color}-${A.shade})`}:{background:"transparent",hover:ld(s,.05),color:s,border:`${Lt(1)} solid ${s}`};if(h==="subtle"){if(A.isThemeColor){if(A.shade===void 0)return{background:"transparent",hover:`var(--mantine-color-${s}-light-hover)`,color:`var(--mantine-color-${s}-light-color)`,border:`${Lt(1)} solid transparent`};const c=a.colors[A.color][A.shade];return{background:"transparent",hover:ld(c,.12),color:`var(--mantine-color-${A.color}-${Math.min(A.shade,6)})`,border:`${Lt(1)} solid transparent`}}return{background:"transparent",hover:ld(s,.12),color:s,border:`${Lt(1)} solid transparent`}}return h==="transparent"?A.isThemeColor?A.shade===void 0?{background:"transparent",hover:"transparent",color:`var(--mantine-color-${s}-light-color)`,border:`${Lt(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:`var(--mantine-color-${A.color}-${Math.min(A.shade,6)})`,border:`${Lt(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:s,border:`${Lt(1)} solid transparent`}:h==="white"?A.isThemeColor?A.shade===void 0?{background:"var(--mantine-color-white)",hover:V_(a.white,.01),color:`var(--mantine-color-${s}-filled)`,border:`${Lt(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:V_(a.white,.01),color:`var(--mantine-color-${A.color}-${A.shade})`,border:`${Lt(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:V_(a.white,.01),color:s,border:`${Lt(1)} solid transparent`}:h==="gradient"?{background:y1(g,a),hover:y1(g,a),color:"var(--mantine-color-white)",border:"none"}:h==="default"?{background:"var(--mantine-color-default)",hover:"var(--mantine-color-default-hover)",color:"var(--mantine-color-default-color)",border:`${Lt(1)} solid var(--mantine-color-default-border)`}:{}},bE={dark:["#C9C9C9","#b8b8b8","#828282","#696969","#424242","#3b3b3b","#2e2e2e","#242424","#1f1f1f","#141414"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]},_1="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",Vb={scale:1,fontSmoothing:!0,focusRing:"auto",white:"#fff",black:"#000",colors:bE,primaryShade:{light:6,dark:8},primaryColor:"blue",variantColorResolver:vE,autoContrast:!1,luminanceThreshold:.3,fontFamily:_1,fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",respectReducedMotion:!1,cursorType:"default",defaultGradient:{from:"blue",to:"cyan",deg:45},defaultRadius:"sm",activeClassName:"mantine-active",focusClassName:"",headings:{fontFamily:_1,fontWeight:"700",textWrap:"wrap",sizes:{h1:{fontSize:Lt(34),lineHeight:"1.3"},h2:{fontSize:Lt(26),lineHeight:"1.35"},h3:{fontSize:Lt(22),lineHeight:"1.4"},h4:{fontSize:Lt(18),lineHeight:"1.45"},h5:{fontSize:Lt(16),lineHeight:"1.5"},h6:{fontSize:Lt(14),lineHeight:"1.5"}}},fontSizes:{xs:Lt(12),sm:Lt(14),md:Lt(16),lg:Lt(18),xl:Lt(20)},lineHeights:{xs:"1.4",sm:"1.45",md:"1.55",lg:"1.6",xl:"1.65"},radius:{xs:Lt(2),sm:Lt(4),md:Lt(8),lg:Lt(16),xl:Lt(32)},spacing:{xs:Lt(10),sm:Lt(12),md:Lt(16),lg:Lt(20),xl:Lt(32)},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},shadows:{xs:`0 ${Lt(1)} ${Lt(3)} rgba(0, 0, 0, 0.05), 0 ${Lt(1)} ${Lt(2)} rgba(0, 0, 0, 0.1)`,sm:`0 ${Lt(1)} ${Lt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Lt(10)} ${Lt(15)} ${Lt(-5)}, rgba(0, 0, 0, 0.04) 0 ${Lt(7)} ${Lt(7)} ${Lt(-5)}`,md:`0 ${Lt(1)} ${Lt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Lt(20)} ${Lt(25)} ${Lt(-5)}, rgba(0, 0, 0, 0.04) 0 ${Lt(10)} ${Lt(10)} ${Lt(-5)}`,lg:`0 ${Lt(1)} ${Lt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Lt(28)} ${Lt(23)} ${Lt(-7)}, rgba(0, 0, 0, 0.04) 0 ${Lt(12)} ${Lt(12)} ${Lt(-7)}`,xl:`0 ${Lt(1)} ${Lt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Lt(36)} ${Lt(28)} ${Lt(-7)}, rgba(0, 0, 0, 0.04) 0 ${Lt(17)} ${Lt(17)} ${Lt(-7)}`},other:{},components:{}};function v1(s){return s==="auto"||s==="dark"||s==="light"}function xE({key:s="mantine-color-scheme-value"}={}){let a;return{get:h=>{if(typeof window>"u")return h;try{const g=window.localStorage.getItem(s);return v1(g)?g:h}catch{return h}},set:h=>{try{window.localStorage.setItem(s,h)}catch(g){console.warn("[@mantine/core] Local storage color scheme manager was unable to save color scheme.",g)}},subscribe:h=>{a=g=>{g.storageArea===window.localStorage&&g.key===s&&v1(g.newValue)&&h(g.newValue)},window.addEventListener("storage",a)},unsubscribe:()=>{window.removeEventListener("storage",a)},clear:()=>{window.localStorage.removeItem(s)}}}const wE="[@mantine/core] MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more  https://mantine.dev/theming/colors/#primary-color",b1="[@mantine/core] MantineProvider: Invalid theme.primaryShade, it accepts only 0-9 integers or an object { light: 0-9, dark: 0-9 }";function D0(s){return s<0||s>9?!1:parseInt(s.toString(),10)===s}function x1(s){if(!(s.primaryColor in s.colors))throw new Error(wE);if(typeof s.primaryShade=="object"&&(!D0(s.primaryShade.dark)||!D0(s.primaryShade.light)))throw new Error(b1);if(typeof s.primaryShade=="number"&&!D0(s.primaryShade))throw new Error(b1)}function TE(s,a){if(!a)return x1(s),s;const h=kb(s,a);return a.fontFamily&&!a.headings?.fontFamily&&(h.headings.fontFamily=a.fontFamily),x1(h),h}const Gb=ct.createContext(null),SE=()=>ct.useContext(Gb)||Vb;function Ph(){const s=ct.useContext(Gb);if(!s)throw new Error("@mantine/core: MantineProvider was not found in component tree, make sure you have it in your app");return s}function u2({theme:s,children:a,inherit:h=!0}){const g=SE(),S=ct.useMemo(()=>TE(h?g:Vb,s),[s,g,h]);return rt.jsx(Gb.Provider,{value:S,children:a})}u2.displayName="@mantine/core/MantineThemeProvider";function ME(){const s=Ph(),a=jb(),h=Sh(s.breakpoints).reduce((g,S)=>{const A=s.breakpoints[S].includes("px"),w=NM(s.breakpoints[S]),c=A?`${w-.1}px`:p1(w-.1),k=A?`${w}px`:p1(w);return`${g}@media (max-width: ${c}) {.mantine-visible-from-${S} {display: none !important;}}@media (min-width: ${k}) {.mantine-hidden-from-${S} {display: none !important;}}`},"");return rt.jsx("style",{"data-mantine-styles":"classes",nonce:a?.(),dangerouslySetInnerHTML:{__html:h}})}function R0(s){return Object.entries(s).map(([a,h])=>`${a}: ${h};`).join("")}function c2(s,a){const h=a?[a]:[":root",":host"],g=R0(s.variables),S=g?`${h.join(", ")}{${g}}`:"",A=R0(s.dark),w=R0(s.light),c=H=>h.map(K=>K===":host"?`${K}([data-mantine-color-scheme="${H}"])`:`${K}[data-mantine-color-scheme="${H}"]`).join(", "),k=A?`${c("dark")}{${A}}`:"",N=w?`${c("light")}{${w}}`:"";return`${S}

${k}

${N}`}function h2({color:s,theme:a,autoContrast:h}){return(typeof h=="boolean"?h:a.autoContrast)&&Oy({color:s||a.primaryColor,theme:a}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function w1(s,a){return h2({color:s.colors[s.primaryColor][wy(s,a)],theme:s,autoContrast:null})}function G_({theme:s,color:a,colorScheme:h,name:g=a,withColorValues:S=!0}){if(!s.colors[a])return{};if(h==="light"){const c=wy(s,"light"),k={[`--mantine-color-${g}-text`]:`var(--mantine-color-${g}-filled)`,[`--mantine-color-${g}-filled`]:`var(--mantine-color-${g}-${c})`,[`--mantine-color-${g}-filled-hover`]:`var(--mantine-color-${g}-${c===9?8:c+1})`,[`--mantine-color-${g}-light`]:Pm(s.colors[a][c],.1),[`--mantine-color-${g}-light-hover`]:Pm(s.colors[a][c],.12),[`--mantine-color-${g}-light-color`]:`var(--mantine-color-${g}-${c})`,[`--mantine-color-${g}-outline`]:`var(--mantine-color-${g}-${c})`,[`--mantine-color-${g}-outline-hover`]:Pm(s.colors[a][c],.05)};return S?{[`--mantine-color-${g}-0`]:s.colors[a][0],[`--mantine-color-${g}-1`]:s.colors[a][1],[`--mantine-color-${g}-2`]:s.colors[a][2],[`--mantine-color-${g}-3`]:s.colors[a][3],[`--mantine-color-${g}-4`]:s.colors[a][4],[`--mantine-color-${g}-5`]:s.colors[a][5],[`--mantine-color-${g}-6`]:s.colors[a][6],[`--mantine-color-${g}-7`]:s.colors[a][7],[`--mantine-color-${g}-8`]:s.colors[a][8],[`--mantine-color-${g}-9`]:s.colors[a][9],...k}:k}const A=wy(s,"dark"),w={[`--mantine-color-${g}-text`]:`var(--mantine-color-${g}-4)`,[`--mantine-color-${g}-filled`]:`var(--mantine-color-${g}-${A})`,[`--mantine-color-${g}-filled-hover`]:`var(--mantine-color-${g}-${A===9?8:A+1})`,[`--mantine-color-${g}-light`]:Pm(s.colors[a][Math.max(0,A-2)],.15),[`--mantine-color-${g}-light-hover`]:Pm(s.colors[a][Math.max(0,A-2)],.2),[`--mantine-color-${g}-light-color`]:`var(--mantine-color-${g}-${Math.max(A-5,0)})`,[`--mantine-color-${g}-outline`]:`var(--mantine-color-${g}-${Math.max(A-4,0)})`,[`--mantine-color-${g}-outline-hover`]:Pm(s.colors[a][Math.max(A-4,0)],.05)};return S?{[`--mantine-color-${g}-0`]:s.colors[a][0],[`--mantine-color-${g}-1`]:s.colors[a][1],[`--mantine-color-${g}-2`]:s.colors[a][2],[`--mantine-color-${g}-3`]:s.colors[a][3],[`--mantine-color-${g}-4`]:s.colors[a][4],[`--mantine-color-${g}-5`]:s.colors[a][5],[`--mantine-color-${g}-6`]:s.colors[a][6],[`--mantine-color-${g}-7`]:s.colors[a][7],[`--mantine-color-${g}-8`]:s.colors[a][8],[`--mantine-color-${g}-9`]:s.colors[a][9],...w}:w}function EE(s){return!!s&&typeof s=="object"&&"mantine-virtual-color"in s}function zm(s,a,h){Sh(a).forEach(g=>Object.assign(s,{[`--mantine-${h}-${g}`]:a[g]}))}const d2=s=>{const a=wy(s,"light"),h=s.defaultRadius in s.radius?s.radius[s.defaultRadius]:Lt(s.defaultRadius),g={variables:{"--mantine-z-index-app":"100","--mantine-z-index-modal":"200","--mantine-z-index-popover":"300","--mantine-z-index-overlay":"400","--mantine-z-index-max":"9999","--mantine-scale":s.scale.toString(),"--mantine-cursor-type":s.cursorType,"--mantine-webkit-font-smoothing":s.fontSmoothing?"antialiased":"unset","--mantine-moz-font-smoothing":s.fontSmoothing?"grayscale":"unset","--mantine-color-white":s.white,"--mantine-color-black":s.black,"--mantine-line-height":s.lineHeights.md,"--mantine-font-family":s.fontFamily,"--mantine-font-family-monospace":s.fontFamilyMonospace,"--mantine-font-family-headings":s.headings.fontFamily,"--mantine-heading-font-weight":s.headings.fontWeight,"--mantine-heading-text-wrap":s.headings.textWrap,"--mantine-radius-default":h,"--mantine-primary-color-filled":`var(--mantine-color-${s.primaryColor}-filled)`,"--mantine-primary-color-filled-hover":`var(--mantine-color-${s.primaryColor}-filled-hover)`,"--mantine-primary-color-light":`var(--mantine-color-${s.primaryColor}-light)`,"--mantine-primary-color-light-hover":`var(--mantine-color-${s.primaryColor}-light-hover)`,"--mantine-primary-color-light-color":`var(--mantine-color-${s.primaryColor}-light-color)`},light:{"--mantine-color-scheme":"light","--mantine-primary-color-contrast":w1(s,"light"),"--mantine-color-bright":"var(--mantine-color-black)","--mantine-color-text":s.black,"--mantine-color-body":s.white,"--mantine-color-error":"var(--mantine-color-red-6)","--mantine-color-placeholder":"var(--mantine-color-gray-5)","--mantine-color-anchor":`var(--mantine-color-${s.primaryColor}-${a})`,"--mantine-color-default":"var(--mantine-color-white)","--mantine-color-default-hover":"var(--mantine-color-gray-0)","--mantine-color-default-color":"var(--mantine-color-black)","--mantine-color-default-border":"var(--mantine-color-gray-4)","--mantine-color-dimmed":"var(--mantine-color-gray-6)","--mantine-color-disabled":"var(--mantine-color-gray-2)","--mantine-color-disabled-color":"var(--mantine-color-gray-5)","--mantine-color-disabled-border":"var(--mantine-color-gray-3)"},dark:{"--mantine-color-scheme":"dark","--mantine-primary-color-contrast":w1(s,"dark"),"--mantine-color-bright":"var(--mantine-color-white)","--mantine-color-text":"var(--mantine-color-dark-0)","--mantine-color-body":"var(--mantine-color-dark-7)","--mantine-color-error":"var(--mantine-color-red-8)","--mantine-color-placeholder":"var(--mantine-color-dark-3)","--mantine-color-anchor":`var(--mantine-color-${s.primaryColor}-4)`,"--mantine-color-default":"var(--mantine-color-dark-6)","--mantine-color-default-hover":"var(--mantine-color-dark-5)","--mantine-color-default-color":"var(--mantine-color-white)","--mantine-color-default-border":"var(--mantine-color-dark-4)","--mantine-color-dimmed":"var(--mantine-color-dark-2)","--mantine-color-disabled":"var(--mantine-color-dark-6)","--mantine-color-disabled-color":"var(--mantine-color-dark-3)","--mantine-color-disabled-border":"var(--mantine-color-dark-4)"}};zm(g.variables,s.breakpoints,"breakpoint"),zm(g.variables,s.spacing,"spacing"),zm(g.variables,s.fontSizes,"font-size"),zm(g.variables,s.lineHeights,"line-height"),zm(g.variables,s.shadows,"shadow"),zm(g.variables,s.radius,"radius"),s.colors[s.primaryColor].forEach((A,w)=>{g.variables[`--mantine-primary-color-${w}`]=`var(--mantine-color-${s.primaryColor}-${w})`}),Sh(s.colors).forEach(A=>{const w=s.colors[A];if(EE(w)){Object.assign(g.light,G_({theme:s,name:w.name,color:w.light,colorScheme:"light",withColorValues:!0})),Object.assign(g.dark,G_({theme:s,name:w.name,color:w.dark,colorScheme:"dark",withColorValues:!0}));return}w.forEach((c,k)=>{g.variables[`--mantine-color-${A}-${k}`]=c}),Object.assign(g.light,G_({theme:s,color:A,colorScheme:"light",withColorValues:!1})),Object.assign(g.dark,G_({theme:s,color:A,colorScheme:"dark",withColorValues:!1}))});const S=s.headings.sizes;return Sh(S).forEach(A=>{g.variables[`--mantine-${A}-font-size`]=S[A].fontSize,g.variables[`--mantine-${A}-line-height`]=S[A].lineHeight,g.variables[`--mantine-${A}-font-weight`]=S[A].fontWeight||s.headings.fontWeight}),g};function AE({theme:s,generator:a}){const h=d2(s),g=a?.(s);return g?kb(h,g):h}const k0=d2(Vb);function CE(s){const a={variables:{},light:{},dark:{}};return Sh(s.variables).forEach(h=>{k0.variables[h]!==s.variables[h]&&(a.variables[h]=s.variables[h])}),Sh(s.light).forEach(h=>{k0.light[h]!==s.light[h]&&(a.light[h]=s.light[h])}),Sh(s.dark).forEach(h=>{k0.dark[h]!==s.dark[h]&&(a.dark[h]=s.dark[h])}),a}function PE(s){return c2({variables:{},dark:{"--mantine-color-scheme":"dark"},light:{"--mantine-color-scheme":"light"}},s)}function f2({cssVariablesSelector:s,deduplicateCssVariables:a}){const h=Ph(),g=jb(),S=oE(),A=AE({theme:h,generator:S}),w=(s===void 0||s===":root"||s===":host")&&a,c=w?CE(A):A,k=c2(c,s);return k?rt.jsx("style",{"data-mantine-styles":!0,nonce:g?.(),dangerouslySetInnerHTML:{__html:`${k}${w?"":PE(s)}`}}):null}f2.displayName="@mantine/CssVariables";function Im(s,a){const h=typeof window<"u"&&"matchMedia"in window&&window.matchMedia("(prefers-color-scheme: dark)")?.matches,g=s!=="auto"?s:h?"dark":"light";a()?.setAttribute("data-mantine-color-scheme",g)}function zE({manager:s,defaultColorScheme:a,getRootElement:h,forceColorScheme:g}){const S=ct.useRef(null),[A,w]=ct.useState(()=>s.get(a)),c=g||A,k=ct.useCallback(H=>{g||(Im(H,h),w(H),s.set(H))},[s.set,c,g]),N=ct.useCallback(()=>{w(a),Im(a,h),s.clear()},[s.clear,a]);return ct.useEffect(()=>(s.subscribe(k),s.unsubscribe),[s.subscribe,s.unsubscribe]),Fb(()=>{Im(s.get(a),h)},[]),ct.useEffect(()=>{if(g)return Im(g,h),()=>{};g===void 0&&Im(A,h),typeof window<"u"&&"matchMedia"in window&&(S.current=window.matchMedia("(prefers-color-scheme: dark)"));const H=K=>{A==="auto"&&Im(K.matches?"dark":"light",h)};return S.current?.addEventListener("change",H),()=>S.current?.removeEventListener("change",H)},[A,g]),{colorScheme:c,setColorScheme:k,clearColorScheme:N}}function IE({respectReducedMotion:s,getRootElement:a}){Fb(()=>{s&&a()?.setAttribute("data-respect-reduced-motion","true")},[s])}function p2({theme:s,children:a,getStyleNonce:h,withStaticClasses:g=!0,withGlobalClasses:S=!0,deduplicateCssVariables:A=!0,withCssVariables:w=!0,cssVariablesSelector:c,classNamesPrefix:k="mantine",colorSchemeManager:N=xE(),defaultColorScheme:H="light",getRootElement:K=()=>document.documentElement,cssVariablesResolver:ae,forceColorScheme:ue,stylesTransform:ge,env:fe}){const{colorScheme:ce,setColorScheme:qe,clearColorScheme:Fe}=zE({defaultColorScheme:H,forceColorScheme:ue,manager:N,getRootElement:K});return IE({respectReducedMotion:s?.respectReducedMotion||!1,getRootElement:K}),rt.jsx(l2.Provider,{value:{colorScheme:ce,setColorScheme:qe,clearColorScheme:Fe,getRootElement:K,classNamesPrefix:k,getStyleNonce:h,cssVariablesResolver:ae,cssVariablesSelector:c??":root",withStaticClasses:g,stylesTransform:ge,env:fe},children:rt.jsxs(u2,{theme:s,children:[w&&rt.jsx(f2,{cssVariablesSelector:c,deduplicateCssVariables:A}),S&&rt.jsx(ME,{}),a]})})}p2.displayName="@mantine/core/MantineProvider";function LE({classNames:s,styles:a,props:h,stylesCtx:g}){const S=Ph();return{resolvedClassNames:Mv({theme:S,classNames:s,props:h,stylesCtx:g||void 0}),resolvedStyles:hv({theme:S,styles:a,props:h,stylesCtx:g||void 0})}}const DE={always:"mantine-focus-always",auto:"mantine-focus-auto",never:"mantine-focus-never"};function RE({theme:s,options:a,unstyled:h}){return Rp(a?.focusable&&!h&&(s.focusClassName||DE[s.focusRing]),a?.active&&!h&&s.activeClassName)}function kE({selector:s,stylesCtx:a,options:h,props:g,theme:S}){return Mv({theme:S,classNames:h?.classNames,props:h?.props||g,stylesCtx:a})[s]}function T1({selector:s,stylesCtx:a,theme:h,classNames:g,props:S}){return Mv({theme:h,classNames:g,props:S,stylesCtx:a})[s]}function OE({rootSelector:s,selector:a,className:h}){return s===a?h:void 0}function BE({selector:s,classes:a,unstyled:h}){return h?void 0:a[s]}function FE({themeName:s,classNamesPrefix:a,selector:h,withStaticClass:g}){return g===!1?[]:s.map(S=>`${a}-${S}-${h}`)}function NE({themeName:s,theme:a,selector:h,props:g,stylesCtx:S}){return s.map(A=>Mv({theme:a,classNames:a.components[A]?.classNames,props:g,stylesCtx:S})?.[h])}function jE({options:s,classes:a,selector:h,unstyled:g}){return s?.variant&&!g?a[`${h}--${s.variant}`]:void 0}function UE({theme:s,options:a,themeName:h,selector:g,classNamesPrefix:S,classNames:A,classes:w,unstyled:c,className:k,rootSelector:N,props:H,stylesCtx:K,withStaticClasses:ae,headless:ue,transformedStyles:ge}){return Rp(RE({theme:s,options:a,unstyled:c||ue}),NE({theme:s,themeName:h,selector:g,props:H,stylesCtx:K}),jE({options:a,classes:w,selector:g,unstyled:c}),T1({selector:g,stylesCtx:K,theme:s,classNames:A,props:H}),T1({selector:g,stylesCtx:K,theme:s,classNames:ge,props:H}),kE({selector:g,stylesCtx:K,options:a,props:H,theme:s}),OE({rootSelector:N,selector:g,className:k}),BE({selector:g,classes:w,unstyled:c||ue}),ae&&!ue&&FE({themeName:h,classNamesPrefix:S,selector:g,withStaticClass:a?.withStaticClass}),a?.className)}function VE({theme:s,themeName:a,props:h,stylesCtx:g,selector:S}){return a.map(A=>hv({theme:s,styles:s.components[A]?.styles,props:h,stylesCtx:g})[S]).reduce((A,w)=>({...A,...w}),{})}function ob({style:s,theme:a}){return Array.isArray(s)?[...s].reduce((h,g)=>({...h,...ob({style:g,theme:a})}),{}):typeof s=="function"?s(a):s??{}}function GE(s){return s.reduce((a,h)=>(h&&Object.keys(h).forEach(g=>{a[g]={...a[g],...Ob(h[g])}}),a),{})}function ZE({vars:s,varsResolver:a,theme:h,props:g,stylesCtx:S,selector:A,themeName:w,headless:c}){return GE([c?{}:a?.(h,g,S),...w.map(k=>h.components?.[k]?.vars?.(h,g,S)),s?.(h,g,S)])?.[A]}function qE({theme:s,themeName:a,selector:h,options:g,props:S,stylesCtx:A,rootSelector:w,styles:c,style:k,vars:N,varsResolver:H,headless:K,withStylesTransform:ae}){return{...!ae&&VE({theme:s,themeName:a,props:S,stylesCtx:A,selector:h}),...!ae&&hv({theme:s,styles:c,props:S,stylesCtx:A})[h],...!ae&&hv({theme:s,styles:g?.styles,props:g?.props||S,stylesCtx:A})[h],...ZE({theme:s,props:S,stylesCtx:A,vars:N,varsResolver:H,selector:h,themeName:a,headless:K}),...w===h?ob({style:k,theme:s}):null,...ob({style:g?.style,theme:s})}}function $E({props:s,stylesCtx:a,themeName:h}){const g=Ph(),S=hE()?.();return{getTransformedStyles:w=>S?[...w.map(k=>S(k,{props:s,theme:g,ctx:a})),...h.map(k=>S(g.components[k]?.styles,{props:s,theme:g,ctx:a}))].filter(Boolean):[],withStylesTransform:!!S}}function ca({name:s,classes:a,props:h,stylesCtx:g,className:S,style:A,rootSelector:w="root",unstyled:c,classNames:k,styles:N,vars:H,varsResolver:K,attributes:ae}){const ue=Ph(),ge=sE(),fe=lE(),ce=uE(),qe=(Array.isArray(s)?s:[s]).filter(Be=>Be),{withStylesTransform:Fe,getTransformedStyles:Ne}=$E({props:h,stylesCtx:g,themeName:qe});return(Be,Pe)=>({className:UE({theme:ue,options:Pe,themeName:qe,selector:Be,classNamesPrefix:ge,classNames:k,classes:a,unstyled:c,className:S,rootSelector:w,props:h,stylesCtx:g,withStaticClasses:fe,headless:ce,transformedStyles:Ne([Pe?.styles,N])}),style:qE({theme:ue,themeName:qe,selector:Be,options:Pe,props:h,stylesCtx:g,rootSelector:w,styles:N,style:A,vars:H,varsResolver:K,headless:ce,withStylesTransform:Fe}),...ae?.[Be]})}function HE(s,a){return typeof s=="boolean"?s:a.autoContrast}function bn(s,a,h){const g=Ph(),S=g.components[s]?.defaultProps,A=typeof S=="function"?S(g):S;return{...a,...A,...Ob(h)}}function O0(s){return Sh(s).reduce((a,h)=>s[h]!==void 0?`${a}${BM(h)}:${s[h]};`:a,"").trim()}function XE({selector:s,styles:a,media:h,container:g}){const S=a?O0(a):"",A=Array.isArray(h)?h.map(c=>`@media${c.query}{${s}{${O0(c.styles)}}}`):[],w=Array.isArray(g)?g.map(c=>`@container ${c.query}{${s}{${O0(c.styles)}}}`):[];return`${S?`${s}{${S}}`:""}${A.join("")}${w.join("")}`.trim()}function YE(s){const a=jb();return rt.jsx("style",{"data-mantine-styles":"inline",nonce:a?.(),dangerouslySetInnerHTML:{__html:XE(s)}})}function Zb(s){const{m:a,mx:h,my:g,mt:S,mb:A,ml:w,mr:c,me:k,ms:N,p:H,px:K,py:ae,pt:ue,pb:ge,pl:fe,pr:ce,pe:qe,ps:Fe,bd:Ne,bdrs:Be,bg:Pe,c:$e,opacity:Qe,ff:Et,fz:Ut,fw:$t,lts:hi,ta:li,lh:nn,fs:Ci,tt:Qi,td:lt,w:Pt,miw:Mt,maw:ei,h:Nt,mih:ze,mah:dt,bgsz:It,bgp:zt,bgr:Dt,bga:kt,pos:fi,top:Ei,left:rn,bottom:hr,right:_o,inset:Mr,display:as,flex:Rn,hiddenFrom:Jr,visibleFrom:wa,lightHidden:Cn,darkHidden:La,sx:ko,...Oo}=s;return{styleProps:Ob({m:a,mx:h,my:g,mt:S,mb:A,ml:w,mr:c,me:k,ms:N,p:H,px:K,py:ae,pt:ue,pb:ge,pl:fe,pr:ce,pe:qe,ps:Fe,bd:Ne,bg:Pe,c:$e,opacity:Qe,ff:Et,fz:Ut,fw:$t,lts:hi,ta:li,lh:nn,fs:Ci,tt:Qi,td:lt,w:Pt,miw:Mt,maw:ei,h:Nt,mih:ze,mah:dt,bgsz:It,bgp:zt,bgr:Dt,bga:kt,pos:fi,top:Ei,left:rn,bottom:hr,right:_o,inset:Mr,display:as,flex:Rn,bdrs:Be,hiddenFrom:Jr,visibleFrom:wa,lightHidden:Cn,darkHidden:La,sx:ko}),rest:Oo}}const WE={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},ms:{type:"spacing",property:"marginInlineStart"},me:{type:"spacing",property:"marginInlineEnd"},mx:{type:"spacing",property:"marginInline"},my:{type:"spacing",property:"marginBlock"},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},ps:{type:"spacing",property:"paddingInlineStart"},pe:{type:"spacing",property:"paddingInlineEnd"},px:{type:"spacing",property:"paddingInline"},py:{type:"spacing",property:"paddingBlock"},bd:{type:"border",property:"border"},bdrs:{type:"radius",property:"borderRadius"},bg:{type:"color",property:"background"},c:{type:"textColor",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"fontFamily",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"lineHeight",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"size",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"},flex:{type:"identity",property:"flex"}};function qb(s,a){const h=Oy({color:s,theme:a});return h.color==="dimmed"?"var(--mantine-color-dimmed)":h.color==="bright"?"var(--mantine-color-bright)":h.variable?`var(${h.variable})`:h.color}function KE(s,a){const h=Oy({color:s,theme:a});return h.isThemeColor&&h.shade===void 0?`var(--mantine-color-${h.color}-text)`:qb(s,a)}function JE(s,a){if(typeof s=="number")return Lt(s);if(typeof s=="string"){const[h,g,...S]=s.split(" ").filter(w=>w.trim()!=="");let A=`${Lt(h)}`;return g&&(A+=` ${g}`),S.length>0&&(A+=` ${qb(S.join(" "),a)}`),A.trim()}return s}const S1={text:"var(--mantine-font-family)",mono:"var(--mantine-font-family-monospace)",monospace:"var(--mantine-font-family-monospace)",heading:"var(--mantine-font-family-headings)",headings:"var(--mantine-font-family-headings)"};function QE(s){return typeof s=="string"&&s in S1?S1[s]:s}const eA=["h1","h2","h3","h4","h5","h6"];function tA(s,a){return typeof s=="string"&&s in a.fontSizes?`var(--mantine-font-size-${s})`:typeof s=="string"&&eA.includes(s)?`var(--mantine-${s}-font-size)`:typeof s=="number"||typeof s=="string"?Lt(s):s}function iA(s){return s}const nA=["h1","h2","h3","h4","h5","h6"];function rA(s,a){return typeof s=="string"&&s in a.lineHeights?`var(--mantine-line-height-${s})`:typeof s=="string"&&nA.includes(s)?`var(--mantine-${s}-line-height)`:s}function aA(s,a){return typeof s=="string"&&s in a.radius?`var(--mantine-radius-${s})`:typeof s=="number"||typeof s=="string"?Lt(s):s}function oA(s){return typeof s=="number"?Lt(s):s}function sA(s,a){if(typeof s=="number")return Lt(s);if(typeof s=="string"){const h=s.replace("-","");if(!(h in a.spacing))return Lt(s);const g=`--mantine-spacing-${h}`;return s.startsWith("-")?`calc(var(${g}) * -1)`:`var(${g})`}return s}const B0={color:qb,textColor:KE,fontSize:tA,spacing:sA,radius:aA,identity:iA,size:oA,lineHeight:rA,fontFamily:QE,border:JE};function M1(s){return s.replace("(min-width: ","").replace("em)","")}function lA({media:s,...a}){const g=Object.keys(s).sort((S,A)=>Number(M1(S))-Number(M1(A))).map(S=>({query:S,styles:s[S]}));return{...a,media:g}}function uA(s){if(typeof s!="object"||s===null)return!1;const a=Object.keys(s);return!(a.length===1&&a[0]==="base")}function cA(s){return typeof s=="object"&&s!==null?"base"in s?s.base:void 0:s}function hA(s){return typeof s=="object"&&s!==null?Sh(s).filter(a=>a!=="base"):[]}function dA(s,a){return typeof s=="object"&&s!==null&&a in s?s[a]:s}function fA({styleProps:s,data:a,theme:h}){return lA(Sh(s).reduce((g,S)=>{if(S==="hiddenFrom"||S==="visibleFrom"||S==="sx")return g;const A=a[S],w=Array.isArray(A.property)?A.property:[A.property],c=cA(s[S]);if(!uA(s[S]))return w.forEach(N=>{g.inlineStyles[N]=B0[A.type](c,h)}),g;g.hasResponsiveStyles=!0;const k=hA(s[S]);return w.forEach(N=>{c!=null&&(g.styles[N]=B0[A.type](c,h)),k.forEach(H=>{const K=`(min-width: ${h.breakpoints[H]})`;g.media[K]={...g.media[K],[N]:B0[A.type](dA(s[S],H),h)}})}),g},{hasResponsiveStyles:!1,styles:{},inlineStyles:{},media:{}}))}function pA(){return`__m__-${ct.useId().replace(/[:]/g,"")}`}function m2(s,a){return Array.isArray(s)?[...s].reduce((h,g)=>({...h,...m2(g,a)}),{}):typeof s=="function"?s(a):s??{}}function g2(s){return s.startsWith("data-")?s:`data-${s}`}function mA(s){return Object.keys(s).reduce((a,h)=>{const g=s[h];return g===void 0||g===""||g===!1||g===null||(a[g2(h)]=s[h]),a},{})}function y2(s){return s?typeof s=="string"?{[g2(s)]:!0}:Array.isArray(s)?[...s].reduce((a,h)=>({...a,...y2(h)}),{}):mA(s):null}function sb(s,a){return Array.isArray(s)?[...s].reduce((h,g)=>({...h,...sb(g,a)}),{}):typeof s=="function"?s(a):s??{}}function gA({theme:s,style:a,vars:h,styleProps:g}){const S=sb(a,s),A=sb(h,s);return{...S,...A,...g}}const _2=ct.forwardRef(({component:s,style:a,__vars:h,className:g,variant:S,mod:A,size:w,hiddenFrom:c,visibleFrom:k,lightHidden:N,darkHidden:H,renderRoot:K,__size:ae,...ue},ge)=>{const fe=Ph(),ce=s||"div",{styleProps:qe,rest:Fe}=Zb(ue),Be=cE()?.()?.(qe.sx),Pe=pA(),$e=fA({styleProps:qe,theme:fe,data:WE}),Qe={ref:ge,style:gA({theme:fe,style:a,vars:h,styleProps:$e.inlineStyles}),className:Rp(g,Be,{[Pe]:$e.hasResponsiveStyles,"mantine-light-hidden":N,"mantine-dark-hidden":H,[`mantine-hidden-from-${c}`]:c,[`mantine-visible-from-${k}`]:k}),"data-variant":S,"data-size":i2(w)?void 0:w||void 0,size:ae,...y2(A),...Fe};return rt.jsxs(rt.Fragment,{children:[$e.hasResponsiveStyles&&rt.jsx(YE,{selector:`.${Pe}`,styles:$e.styles,media:$e.media}),typeof K=="function"?K(Qe):rt.jsx(ce,{...Qe})]})});_2.displayName="@mantine/core/Box";const Ui=_2;function v2(s){return s}function Kr(s){const a=ct.forwardRef(s);return a.extend=v2,a.withProps=h=>{const g=ct.forwardRef((S,A)=>rt.jsx(a,{...h,...S,ref:A}));return g.extend=a.extend,g.displayName=`WithProps(${a.displayName})`,g},a}function kp(s){const a=ct.forwardRef(s);return a.withProps=h=>{const g=ct.forwardRef((S,A)=>rt.jsx(a,{...h,...S,ref:A}));return g.extend=a.extend,g.displayName=`WithProps(${a.displayName})`,g},a.extend=v2,a}const yA=ct.createContext({dir:"ltr",toggleDirection:()=>{},setDirection:()=>{}});function _A(){return ct.useContext(yA)}function vA(s){if(!s||typeof s=="string")return 0;const a=s/36;return Math.round((4+15*a**.25+a/5)*10)}function F0(s){return s?.current?s.current.scrollHeight:"auto"}const oy=typeof window<"u"&&window.requestAnimationFrame,E1=0,bA=s=>({height:0,overflow:"hidden",...s?{}:{display:"none"}});function xA({transitionDuration:s,transitionTimingFunction:a="ease",onTransitionEnd:h=()=>{},opened:g,keepMounted:S=!1}){const A=ct.useRef(null),w=bA(S),[c,k]=ct.useState(g?{}:w),N=ge=>{Gw.flushSync(()=>k(ge))},H=ge=>{N(fe=>({...fe,...ge}))};function K(ge){const fe=s||vA(ge);return{transition:`height ${fe}ms ${a}, opacity ${fe}ms ${a}`}}r2(()=>{typeof oy=="function"&&oy(g?()=>{H({willChange:"height",display:"block",overflow:"hidden"}),oy(()=>{const ge=F0(A);H({...K(ge),height:ge})})}:()=>{const ge=F0(A);H({...K(ge),willChange:"height",height:ge}),oy(()=>H({height:E1,overflow:"hidden"}))})},[g]);const ae=ge=>{if(!(ge.target!==A.current||ge.propertyName!=="height"))if(g){const fe=F0(A);fe===c.height?N({}):H({height:fe}),h()}else c.height===E1&&(N(w),h())};function ue({style:ge={},refKey:fe="ref",...ce}={}){const qe=ce[fe],Fe={"aria-hidden":!g,...ce,[fe]:a2(A,qe),onTransitionEnd:ae,style:{boxSizing:"border-box",...ge,...c}};return Lb.version.startsWith("18")?g||(Fe.inert=""):Fe.inert=!g,Fe}return ue}const wA={transitionDuration:200,transitionTimingFunction:"ease",animateOpacity:!0},b2=Kr((s,a)=>{const{children:h,in:g,transitionDuration:S,transitionTimingFunction:A,style:w,onTransitionEnd:c,animateOpacity:k,keepMounted:N,...H}=bn("Collapse",wA,s),K=Ph(),ae=o2(),ge=(K.respectReducedMotion?ae:!1)?0:S,fe=xA({opened:g,transitionDuration:ge,transitionTimingFunction:A,onTransitionEnd:c,keepMounted:N});return ge===0?g?rt.jsx(Ui,{...H,children:h}):null:rt.jsx(Ui,{...fe({style:{opacity:g||!k?1:0,transition:k?`opacity ${ge}ms ${A}`:"none",...m2(w,K)},ref:a,...H}),children:h})});b2.displayName="@mantine/core/Collapse";function Z_(s){return s?parseInt(s,10):0}var x2={root:"m_87cf2631"};const TA={__staticSelector:"UnstyledButton"},qm=kp((s,a)=>{const h=bn("UnstyledButton",TA,s),{className:g,component:S="button",__staticSelector:A,unstyled:w,classNames:c,styles:k,style:N,attributes:H,...K}=h,ae=ca({name:A,props:h,classes:x2,className:g,style:N,classNames:c,styles:k,unstyled:w,attributes:H});return rt.jsx(Ui,{...ae("root",{focusable:!0}),component:S,ref:a,type:S==="button"?"button":void 0,...K})});qm.classes=x2;qm.displayName="@mantine/core/UnstyledButton";const sy=s=>({in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${s==="bottom"?10:-10}px)`},transitionProperty:"transform, opacity"}),q_={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},"fade-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(30px)"},transitionProperty:"opacity, transform"},"fade-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-30px)"},transitionProperty:"opacity, transform"},"fade-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(30px)"},transitionProperty:"opacity, transform"},"fade-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-30px)"},transitionProperty:"opacity, transform"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(-20px) skew(-10deg, -5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(20px) skew(-10deg, -5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(-5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:{...sy("bottom"),common:{transformOrigin:"center center"}},"pop-bottom-left":{...sy("bottom"),common:{transformOrigin:"bottom left"}},"pop-bottom-right":{...sy("bottom"),common:{transformOrigin:"bottom right"}},"pop-top-left":{...sy("top"),common:{transformOrigin:"top left"}},"pop-top-right":{...sy("top"),common:{transformOrigin:"top right"}}},A1={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function SA({transition:s,state:a,duration:h,timingFunction:g}){const S={WebkitBackfaceVisibility:"hidden",transitionDuration:`${h}ms`,transitionTimingFunction:g};return typeof s=="string"?s in q_?{transitionProperty:q_[s].transitionProperty,...S,...q_[s].common,...q_[s][A1[a]]}:{}:{transitionProperty:s.transitionProperty,...S,...s.common,...s[A1[a]]}}function MA({duration:s,exitDuration:a,timingFunction:h,mounted:g,onEnter:S,onExit:A,onEntered:w,onExited:c,enterDelay:k,exitDelay:N}){const H=Ph(),K=o2(),ae=H.respectReducedMotion?K:!1,[ue,ge]=ct.useState(ae?0:s),[fe,ce]=ct.useState(g?"entered":"exited"),qe=ct.useRef(-1),Fe=ct.useRef(-1),Ne=ct.useRef(-1);function Be(){window.clearTimeout(qe.current),window.clearTimeout(Fe.current),cancelAnimationFrame(Ne.current)}const Pe=Qe=>{Be();const Et=Qe?S:A,Ut=Qe?w:c,$t=ae?0:Qe?s:a;ge($t),$t===0?(typeof Et=="function"&&Et(),typeof Ut=="function"&&Ut(),ce(Qe?"entered":"exited")):Ne.current=requestAnimationFrame(()=>{DS.flushSync(()=>{ce(Qe?"pre-entering":"pre-exiting")}),Ne.current=requestAnimationFrame(()=>{typeof Et=="function"&&Et(),ce(Qe?"entering":"exiting"),qe.current=window.setTimeout(()=>{typeof Ut=="function"&&Ut(),ce(Qe?"entered":"exited")},$t)})})},$e=Qe=>{if(Be(),typeof(Qe?k:N)!="number"){Pe(Qe);return}Fe.current=window.setTimeout(()=>{Pe(Qe)},Qe?k:N)};return r2(()=>{$e(g)},[g]),ct.useEffect(()=>()=>{Be()},[]),{transitionDuration:ue,transitionStatus:fe,transitionTimingFunction:h||"ease"}}function $b({keepMounted:s,transition:a="fade",duration:h=250,exitDuration:g=h,mounted:S,children:A,timingFunction:w="ease",onExit:c,onEntered:k,onEnter:N,onExited:H,enterDelay:K,exitDelay:ae}){const ue=dE(),{transitionDuration:ge,transitionStatus:fe,transitionTimingFunction:ce}=MA({mounted:S,exitDuration:g,duration:h,timingFunction:w,onExit:c,onEntered:k,onEnter:N,onExited:H,enterDelay:K,exitDelay:ae});return ge===0||ue==="test"?S?rt.jsx(rt.Fragment,{children:A({})}):s?A({display:"none"}):null:fe==="exited"?s?A({display:"none"}):null:rt.jsx(rt.Fragment,{children:A(SA({transition:a,duration:ge,state:fe,timingFunction:ce}))})}$b.displayName="@mantine/core/Transition";var Ic={root:"m_5ae2e3c",barsLoader:"m_7a2bd4cd",bar:"m_870bb79","bars-loader-animation":"m_5d2b3b9d",dotsLoader:"m_4e3f22d7",dot:"m_870c4af","loader-dots-animation":"m_aac34a1",ovalLoader:"m_b34414df","oval-loader-animation":"m_f8e89c4b"};const w2=ct.forwardRef(({className:s,...a},h)=>rt.jsxs(Ui,{component:"span",className:Rp(Ic.barsLoader,s),...a,ref:h,children:[rt.jsx("span",{className:Ic.bar}),rt.jsx("span",{className:Ic.bar}),rt.jsx("span",{className:Ic.bar})]}));w2.displayName="@mantine/core/Bars";const T2=ct.forwardRef(({className:s,...a},h)=>rt.jsxs(Ui,{component:"span",className:Rp(Ic.dotsLoader,s),...a,ref:h,children:[rt.jsx("span",{className:Ic.dot}),rt.jsx("span",{className:Ic.dot}),rt.jsx("span",{className:Ic.dot})]}));T2.displayName="@mantine/core/Dots";const S2=ct.forwardRef(({className:s,...a},h)=>rt.jsx(Ui,{component:"span",className:Rp(Ic.ovalLoader,s),...a,ref:h}));S2.displayName="@mantine/core/Oval";const M2={bars:w2,oval:S2,dots:T2},EA={loaders:M2,type:"oval"},AA=(s,{size:a,color:h})=>({root:{"--loader-size":Ws(a,"loader-size"),"--loader-color":h?Ty(h,s):void 0}}),By=Kr((s,a)=>{const h=bn("Loader",EA,s),{size:g,color:S,type:A,vars:w,className:c,style:k,classNames:N,styles:H,unstyled:K,loaders:ae,variant:ue,children:ge,attributes:fe,...ce}=h,qe=ca({name:"Loader",props:h,classes:Ic,className:c,style:k,classNames:N,styles:H,unstyled:K,attributes:fe,vars:w,varsResolver:AA});return ge?rt.jsx(Ui,{...qe("root"),ref:a,...ce,children:ge}):rt.jsx(Ui,{...qe("root"),ref:a,component:ae[A],variant:ue,size:g,...ce})});By.defaultLoaders=M2;By.classes=Ic;By.displayName="@mantine/core/Loader";var $m={root:"m_8d3f4000",icon:"m_8d3afb97",loader:"m_302b9fb1",group:"m_1a0f1b21",groupSection:"m_437b6484"};const C1={orientation:"horizontal"},CA=(s,{borderWidth:a})=>({group:{"--ai-border-width":Lt(a)}}),Hb=Kr((s,a)=>{const h=bn("ActionIconGroup",C1,s),{className:g,style:S,classNames:A,styles:w,unstyled:c,orientation:k,vars:N,borderWidth:H,variant:K,mod:ae,attributes:ue,...ge}=bn("ActionIconGroup",C1,s),fe=ca({name:"ActionIconGroup",props:h,classes:$m,className:g,style:S,classNames:A,styles:w,unstyled:c,attributes:ue,vars:N,varsResolver:CA,rootSelector:"group"});return rt.jsx(Ui,{...fe("group"),ref:a,variant:K,mod:[{"data-orientation":k},ae],role:"group",...ge})});Hb.classes=$m;Hb.displayName="@mantine/core/ActionIconGroup";const PA=(s,{radius:a,color:h,gradient:g,variant:S,autoContrast:A,size:w})=>{const c=s.variantColorResolver({color:h||s.primaryColor,theme:s,gradient:g,variant:S||"filled",autoContrast:A});return{groupSection:{"--section-height":Ws(w,"section-height"),"--section-padding-x":Ws(w,"section-padding-x"),"--section-fz":Uu(w),"--section-radius":a===void 0?void 0:fd(a),"--section-bg":h||S?c.background:void 0,"--section-color":c.color,"--section-bd":h||S?c.border:void 0}}},Xb=Kr((s,a)=>{const h=bn("ActionIconGroupSection",null,s),{className:g,style:S,classNames:A,styles:w,unstyled:c,vars:k,variant:N,gradient:H,radius:K,autoContrast:ae,attributes:ue,...ge}=h,fe=ca({name:"ActionIconGroupSection",props:h,classes:$m,className:g,style:S,classNames:A,styles:w,unstyled:c,attributes:ue,vars:k,varsResolver:PA,rootSelector:"groupSection"});return rt.jsx(Ui,{...fe("groupSection"),ref:a,variant:N,...ge})});Xb.classes=$m;Xb.displayName="@mantine/core/ActionIconGroupSection";const zA=(s,{size:a,radius:h,variant:g,gradient:S,color:A,autoContrast:w})=>{const c=s.variantColorResolver({color:A||s.primaryColor,theme:s,gradient:S,variant:g||"filled",autoContrast:w});return{root:{"--ai-size":Ws(a,"ai-size"),"--ai-radius":h===void 0?void 0:fd(h),"--ai-bg":A||g?c.background:void 0,"--ai-hover":A||g?c.hover:void 0,"--ai-hover-color":A||g?c.hoverColor:void 0,"--ai-color":c.color,"--ai-bd":A||g?c.border:void 0}}},hf=kp((s,a)=>{const h=bn("ActionIcon",null,s),{className:g,unstyled:S,variant:A,classNames:w,styles:c,style:k,loading:N,loaderProps:H,size:K,color:ae,radius:ue,__staticSelector:ge,gradient:fe,vars:ce,children:qe,disabled:Fe,"data-disabled":Ne,autoContrast:Be,mod:Pe,attributes:$e,...Qe}=h,Et=ca({name:["ActionIcon",ge],props:h,className:g,style:k,classes:$m,classNames:w,styles:c,unstyled:S,attributes:$e,vars:ce,varsResolver:zA});return rt.jsxs(qm,{...Et("root",{active:!Fe&&!N&&!Ne}),...Qe,unstyled:S,variant:A,size:K,disabled:Fe||N,ref:a,mod:[{loading:N,disabled:Fe||Ne},Pe],children:[typeof N=="boolean"&&rt.jsx($b,{mounted:N,transition:"slide-down",duration:150,children:Ut=>rt.jsx(Ui,{component:"span",...Et("loader",{style:Ut}),"aria-hidden":!0,children:rt.jsx(By,{color:"var(--ai-color)",size:"calc(var(--ai-size) * 0.55)",...H})})}),rt.jsx(Ui,{component:"span",mod:{loading:N},...Et("icon"),children:qe})]})});hf.classes=$m;hf.displayName="@mantine/core/ActionIcon";hf.Group=Hb;hf.GroupSection=Xb;const E2=ct.forwardRef(({size:s="var(--cb-icon-size, 70%)",style:a,...h},g)=>rt.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...a,width:s,height:s},ref:g,...h,children:rt.jsx("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}));E2.displayName="@mantine/core/CloseIcon";var A2={root:"m_86a44da5","root--subtle":"m_220c80f2"};const IA={variant:"subtle"},LA=(s,{size:a,radius:h,iconSize:g})=>({root:{"--cb-size":Ws(a,"cb-size"),"--cb-radius":h===void 0?void 0:fd(h),"--cb-icon-size":Lt(g)}}),Ev=kp((s,a)=>{const h=bn("CloseButton",IA,s),{iconSize:g,children:S,vars:A,radius:w,className:c,classNames:k,style:N,styles:H,unstyled:K,"data-disabled":ae,disabled:ue,variant:ge,icon:fe,mod:ce,attributes:qe,__staticSelector:Fe,...Ne}=h,Be=ca({name:Fe||"CloseButton",props:h,className:c,style:N,classes:A2,classNames:k,styles:H,unstyled:K,attributes:qe,vars:A,varsResolver:LA});return rt.jsxs(qm,{ref:a,...Ne,unstyled:K,variant:ge,disabled:ue,mod:[{disabled:ue||ae},ce],...Be("root",{variant:ge,active:!ue&&!ae}),children:[fe||rt.jsx(E2,{}),S]})});Ev.classes=A2;Ev.displayName="@mantine/core/CloseButton";function DA(s){return ct.Children.toArray(s).filter(Boolean)}var C2={root:"m_4081bf90"};const RA={preventGrowOverflow:!0,gap:"md",align:"center",justify:"flex-start",wrap:"wrap"},kA=(s,{grow:a,preventGrowOverflow:h,gap:g,align:S,justify:A,wrap:w},{childWidth:c})=>({root:{"--group-child-width":a&&h?c:void 0,"--group-gap":Bb(g),"--group-align":S,"--group-justify":A,"--group-wrap":w}}),Yb=Kr((s,a)=>{const h=bn("Group",RA,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,children:k,gap:N,align:H,justify:K,wrap:ae,grow:ue,preventGrowOverflow:ge,vars:fe,variant:ce,__size:qe,mod:Fe,attributes:Ne,...Be}=h,Pe=DA(k),$e=Pe.length,Qe=Bb(N??"md"),Ut={childWidth:`calc(${100/$e}% - (${Qe} - ${Qe} / ${$e}))`},$t=ca({name:"Group",props:h,stylesCtx:Ut,className:S,style:A,classes:C2,classNames:g,styles:w,unstyled:c,attributes:Ne,vars:fe,varsResolver:kA});return rt.jsx(Ui,{...$t("root"),ref:a,variant:ce,mod:[{grow:ue},Fe],size:qe,...Be,children:Pe})});Yb.classes=C2;Yb.displayName="@mantine/core/Group";const[OA,BA]=n2({size:"sm"});var Gu={wrapper:"m_6c018570",input:"m_8fb7ebe7",section:"m_82577fc2",placeholder:"m_88bacfd0",root:"m_46b77525",label:"m_8fdc1311",required:"m_78a94662",error:"m_8f816625",description:"m_fe47ce59"};const P2=Kr((s,a)=>{const h=bn("InputClearButton",null,s),{size:g,variant:S,vars:A,classNames:w,styles:c,...k}=h,N=BA(),{resolvedClassNames:H,resolvedStyles:K}=LE({classNames:w,styles:c,props:h});return rt.jsx(Ev,{variant:S||"transparent",ref:a,size:g||N?.size||"sm",classNames:H,styles:K,__staticSelector:"InputClearButton",style:{pointerEvents:"all",background:"var(--input-bg)",...k.style},...k})});P2.displayName="@mantine/core/InputClearButton";const FA={xs:7,sm:8,md:10,lg:12,xl:15};function NA({__clearable:s,__clearSection:a,rightSection:h,__defaultRightSection:g,size:S="sm"}){const A=s&&a;return A&&(h||g)?rt.jsxs("div",{"data-combined-clear-section":!0,style:{display:"flex",gap:2,alignItems:"center",paddingInlineEnd:FA[S]},children:[A,h||g]}):h===null?null:h||A||g}const[jA,Av]=n2({offsetBottom:!1,offsetTop:!1,describedBy:void 0,getStyles:null,inputId:void 0,labelId:void 0}),UA=(s,{size:a})=>({description:{"--input-description-size":a===void 0?void 0:`calc(${Uu(a)} - ${Lt(2)})`}}),Cv=Kr((s,a)=>{const h=bn("InputDescription",null,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,vars:k,size:N,__staticSelector:H,__inheritStyles:K=!0,attributes:ae,variant:ue,...ge}=bn("InputDescription",null,h),fe=Av(),ce=ca({name:["InputWrapper",H],props:h,classes:Gu,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:ae,rootSelector:"description",vars:k,varsResolver:UA}),qe=K&&fe?.getStyles||ce;return rt.jsx(Ui,{component:"p",ref:a,variant:ue,size:N,...qe("description",fe?.getStyles?{className:S,style:A}:void 0),...ge})});Cv.classes=Gu;Cv.displayName="@mantine/core/InputDescription";const VA=(s,{size:a})=>({error:{"--input-error-size":a===void 0?void 0:`calc(${Uu(a)} - ${Lt(2)})`}}),Pv=Kr((s,a)=>{const h=bn("InputError",null,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,vars:k,size:N,attributes:H,__staticSelector:K,__inheritStyles:ae=!0,variant:ue,...ge}=h,fe=ca({name:["InputWrapper",K],props:h,classes:Gu,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:H,rootSelector:"error",vars:k,varsResolver:VA}),ce=Av(),qe=ae&&ce?.getStyles||fe;return rt.jsx(Ui,{component:"p",ref:a,variant:ue,size:N,...qe("error",ce?.getStyles?{className:S,style:A}:void 0),...ge})});Pv.classes=Gu;Pv.displayName="@mantine/core/InputError";const P1={labelElement:"label"},GA=(s,{size:a})=>({label:{"--input-label-size":Uu(a),"--input-asterisk-color":void 0}}),zv=Kr((s,a)=>{const h=bn("InputLabel",P1,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,vars:k,labelElement:N,size:H,required:K,htmlFor:ae,onMouseDown:ue,children:ge,__staticSelector:fe,variant:ce,mod:qe,attributes:Fe,...Ne}=bn("InputLabel",P1,h),Be=ca({name:["InputWrapper",fe],props:h,classes:Gu,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:Fe,rootSelector:"label",vars:k,varsResolver:GA}),Pe=Av(),$e=Pe?.getStyles||Be;return rt.jsxs(Ui,{...$e("label",Pe?.getStyles?{className:S,style:A}:void 0),component:N,variant:ce,size:H,ref:a,htmlFor:N==="label"?ae:void 0,mod:[{required:K},qe],onMouseDown:Qe=>{ue?.(Qe),!Qe.defaultPrevented&&Qe.detail>1&&Qe.preventDefault()},...Ne,children:[ge,K&&rt.jsx("span",{...$e("required"),"aria-hidden":!0,children:" *"})]})});zv.classes=Gu;zv.displayName="@mantine/core/InputLabel";const Wb=Kr((s,a)=>{const h=bn("InputPlaceholder",null,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,vars:k,__staticSelector:N,variant:H,error:K,mod:ae,attributes:ue,...ge}=h,fe=ca({name:["InputPlaceholder",N],props:h,classes:Gu,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:ue,rootSelector:"placeholder"});return rt.jsx(Ui,{...fe("placeholder"),mod:[{error:!!K},ae],component:"span",variant:H,ref:a,...ge})});Wb.classes=Gu;Wb.displayName="@mantine/core/InputPlaceholder";function ZA(s,{hasDescription:a,hasError:h}){const g=s.findIndex(k=>k==="input"),S=s.slice(0,g),A=s.slice(g+1),w=a&&S.includes("description")||h&&S.includes("error");return{offsetBottom:a&&A.includes("description")||h&&A.includes("error"),offsetTop:w}}const qA={labelElement:"label",inputContainer:s=>s,inputWrapperOrder:["label","description","input","error"]},$A=(s,{size:a})=>({label:{"--input-label-size":Uu(a),"--input-asterisk-color":void 0},error:{"--input-error-size":a===void 0?void 0:`calc(${Uu(a)} - ${Lt(2)})`},description:{"--input-description-size":a===void 0?void 0:`calc(${Uu(a)} - ${Lt(2)})`}}),Kb=Kr((s,a)=>{const h=bn("InputWrapper",qA,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,vars:k,size:N,variant:H,__staticSelector:K,inputContainer:ae,inputWrapperOrder:ue,label:ge,error:fe,description:ce,labelProps:qe,descriptionProps:Fe,errorProps:Ne,labelElement:Be,children:Pe,withAsterisk:$e,id:Qe,required:Et,__stylesApiProps:Ut,mod:$t,attributes:hi,...li}=h,nn=ca({name:["InputWrapper",K],props:Ut||h,classes:Gu,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:hi,vars:k,varsResolver:$A}),Ci={size:N,variant:H,__staticSelector:K},Qi=Nb(Qe),lt=typeof $e=="boolean"?$e:Et,Pt=Ne?.id||`${Qi}-error`,Mt=Fe?.id||`${Qi}-description`,ei=Qi,Nt=!!fe&&typeof fe!="boolean",ze=!!ce,dt=`${Nt?Pt:""} ${ze?Mt:""}`,It=dt.trim().length>0?dt.trim():void 0,zt=qe?.id||`${Qi}-label`,Dt=ge&&rt.jsx(zv,{labelElement:Be,id:zt,htmlFor:ei,required:lt,...Ci,...qe,children:ge},"label"),kt=ze&&rt.jsx(Cv,{...Fe,...Ci,size:Fe?.size||Ci.size,id:Fe?.id||Mt,children:ce},"description"),fi=rt.jsx(ct.Fragment,{children:ae(Pe)},"input"),Ei=Nt&&ct.createElement(Pv,{...Ne,...Ci,size:Ne?.size||Ci.size,key:"error",id:Ne?.id||Pt},fe),rn=ue.map(hr=>{switch(hr){case"label":return Dt;case"input":return fi;case"description":return kt;case"error":return Ei;default:return null}});return rt.jsx(jA,{value:{getStyles:nn,describedBy:It,inputId:ei,labelId:zt,...ZA(ue,{hasDescription:ze,hasError:Nt})},children:rt.jsx(Ui,{ref:a,variant:H,size:N,mod:[{error:!!fe},$t],...nn("root"),...li,children:rn})})});Kb.classes=Gu;Kb.displayName="@mantine/core/InputWrapper";const HA={variant:"default",leftSectionPointerEvents:"none",rightSectionPointerEvents:"none",withAria:!0,withErrorStyles:!0,size:"sm"},XA=(s,a,h)=>({wrapper:{"--input-margin-top":h.offsetTop?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-margin-bottom":h.offsetBottom?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-height":Ws(a.size,"input-height"),"--input-fz":Uu(a.size),"--input-radius":a.radius===void 0?void 0:fd(a.radius),"--input-left-section-width":a.leftSectionWidth!==void 0?Lt(a.leftSectionWidth):void 0,"--input-right-section-width":a.rightSectionWidth!==void 0?Lt(a.rightSectionWidth):void 0,"--input-padding-y":a.multiline?Ws(a.size,"input-padding-y"):void 0,"--input-left-section-pointer-events":a.leftSectionPointerEvents,"--input-right-section-pointer-events":a.rightSectionPointerEvents}}),Vu=kp((s,a)=>{const h=bn("Input",HA,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,required:k,__staticSelector:N,__stylesApiProps:H,size:K,wrapperProps:ae,error:ue,disabled:ge,leftSection:fe,leftSectionProps:ce,leftSectionWidth:qe,rightSection:Fe,rightSectionProps:Ne,rightSectionWidth:Be,rightSectionPointerEvents:Pe,leftSectionPointerEvents:$e,variant:Qe,vars:Et,pointer:Ut,multiline:$t,radius:hi,id:li,withAria:nn,withErrorStyles:Ci,mod:Qi,inputSize:lt,attributes:Pt,__clearSection:Mt,__clearable:ei,__defaultRightSection:Nt,...ze}=h,{styleProps:dt,rest:It}=Zb(ze),zt=Av(),Dt={offsetBottom:zt?.offsetBottom,offsetTop:zt?.offsetTop},kt=ca({name:["Input",N],props:H||h,classes:Gu,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:Pt,stylesCtx:Dt,rootSelector:"wrapper",vars:Et,varsResolver:XA}),fi=nn?{required:k,disabled:ge,"aria-invalid":!!ue,"aria-describedby":zt?.describedBy,id:zt?.inputId||li}:{},Ei=NA({__clearable:ei,__clearSection:Mt,rightSection:Fe,__defaultRightSection:Nt,size:K});return rt.jsx(OA,{value:{size:K||"sm"},children:rt.jsxs(Ui,{...kt("wrapper"),...dt,...ae,mod:[{error:!!ue&&Ci,pointer:Ut,disabled:ge,multiline:$t,"data-with-right-section":!!Ei,"data-with-left-section":!!fe},Qi],variant:Qe,size:K,children:[fe&&rt.jsx("div",{...ce,"data-position":"left",...kt("section",{className:ce?.className,style:ce?.style}),children:fe}),rt.jsx(Ui,{component:"input",...It,...fi,ref:a,required:k,mod:{disabled:ge,error:!!ue&&Ci},variant:Qe,__size:lt,...kt("input")}),Ei&&rt.jsx("div",{...Ne,"data-position":"right",...kt("section",{className:Ne?.className,style:Ne?.style}),children:Ei})]})})});Vu.classes=Gu;Vu.Wrapper=Kb;Vu.Label=zv;Vu.Error=Pv;Vu.Description=Cv;Vu.Placeholder=Wb;Vu.ClearButton=P2;Vu.displayName="@mantine/core/Input";function YA(s,a,h){const g=bn(s,a,h),{label:S,description:A,error:w,required:c,classNames:k,styles:N,className:H,unstyled:K,__staticSelector:ae,__stylesApiProps:ue,errorProps:ge,labelProps:fe,descriptionProps:ce,wrapperProps:qe,id:Fe,size:Ne,style:Be,inputContainer:Pe,inputWrapperOrder:$e,withAsterisk:Qe,variant:Et,vars:Ut,mod:$t,attributes:hi,...li}=g,{styleProps:nn,rest:Ci}=Zb(li),Qi={label:S,description:A,error:w,required:c,classNames:k,className:H,__staticSelector:ae,__stylesApiProps:ue||g,errorProps:ge,labelProps:fe,descriptionProps:ce,unstyled:K,styles:N,size:Ne,style:Be,inputContainer:Pe,inputWrapperOrder:$e,withAsterisk:Qe,variant:Et,id:Fe,mod:$t,attributes:hi,...qe};return{...Ci,classNames:k,styles:N,unstyled:K,wrapperProps:{...Qi,...nn},inputProps:{required:c,classNames:k,styles:N,unstyled:K,size:Ne,__staticSelector:ae,__stylesApiProps:ue||g,error:w,variant:Et,id:Fe,attributes:hi}}}const WA={__staticSelector:"InputBase",withAria:!0,size:"sm"},Iv=kp((s,a)=>{const{inputProps:h,wrapperProps:g,...S}=YA("InputBase",WA,s);return rt.jsx(Vu.Wrapper,{...g,children:rt.jsx(Vu,{...h,...S,ref:a})})});Iv.classes={...Vu.classes,...Vu.Wrapper.classes};Iv.displayName="@mantine/core/InputBase";var z2={root:"m_96b553a6"};function KA(s,a){if(!a||!s)return!1;let h=a.parentNode;for(;h!=null;){if(h===s)return!0;h=h.parentNode}return!1}function JA({target:s,parent:a,ref:h,displayAfterTransitionEnd:g}){const S=ct.useRef(-1),[A,w]=ct.useState(!1),[c,k]=ct.useState(typeof g=="boolean"?g:!1),N=()=>{if(!s||!a||!h.current)return;const ue=s.getBoundingClientRect(),ge=a.getBoundingClientRect(),fe=window.getComputedStyle(s),ce=window.getComputedStyle(a),qe=Z_(fe.borderTopWidth)+Z_(ce.borderTopWidth),Fe=Z_(fe.borderLeftWidth)+Z_(ce.borderLeftWidth),Ne={top:ue.top-ge.top-qe,left:ue.left-ge.left-Fe,width:ue.width,height:ue.height};h.current.style.transform=`translateY(${Ne.top}px) translateX(${Ne.left}px)`,h.current.style.width=`${Ne.width}px`,h.current.style.height=`${Ne.height}px`},H=()=>{window.clearTimeout(S.current),h.current&&(h.current.style.transitionDuration="0ms"),N(),S.current=window.setTimeout(()=>{h.current&&(h.current.style.transitionDuration="")},30)},K=ct.useRef(null),ae=ct.useRef(null);return ct.useEffect(()=>{if(N(),s)return K.current=new ResizeObserver(H),K.current.observe(s),a&&(ae.current=new ResizeObserver(H),ae.current.observe(a)),()=>{K.current?.disconnect(),ae.current?.disconnect()}},[a,s]),ct.useEffect(()=>{if(a){const ue=ge=>{KA(ge.target,a)&&(H(),k(!1))};return a.addEventListener("transitionend",ue),()=>{a.removeEventListener("transitionend",ue)}}},[a]),eE(()=>{nE()!=="test"&&w(!0)},20,{autoInvoke:!0}),tE(ue=>{ue.forEach(ge=>{ge.type==="attributes"&&ge.attributeName==="dir"&&H()})},{attributes:!0,attributeFilter:["dir"]},()=>document.documentElement),{initialized:A,hidden:c}}const QA=(s,{transitionDuration:a})=>({root:{"--transition-duration":typeof a=="number"?`${a}ms`:a}}),Jb=Kr((s,a)=>{const h=bn("FloatingIndicator",null,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,vars:k,target:N,parent:H,transitionDuration:K,mod:ae,displayAfterTransitionEnd:ue,attributes:ge,...fe}=h,ce=ca({name:"FloatingIndicator",classes:z2,props:h,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:ge,vars:k,varsResolver:QA}),qe=ct.useRef(null),{initialized:Fe,hidden:Ne}=JA({target:N,parent:H,ref:qe,displayAfterTransitionEnd:ue}),Be=KM(a,qe);return!N||!H?null:rt.jsx(Ui,{ref:Be,mod:[{initialized:Fe,hidden:Ne},ae],...ce("root"),...fe})});Jb.displayName="@mantine/core/FloatingIndicator";Jb.classes=z2;var I2={root:"m_66836ed3",wrapper:"m_a5d60502",body:"m_667c2793",title:"m_6a03f287",label:"m_698f4f23",icon:"m_667f2a6a",message:"m_7fa78076",closeButton:"m_87f54839"};const eC=(s,{radius:a,color:h,variant:g,autoContrast:S})=>{const A=s.variantColorResolver({color:h||s.primaryColor,theme:s,variant:g||"light",autoContrast:S});return{root:{"--alert-radius":a===void 0?void 0:fd(a),"--alert-bg":h||g?A.background:void 0,"--alert-color":A.color,"--alert-bd":h||g?A.border:void 0}}},Qb=Kr((s,a)=>{const h=bn("Alert",null,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,vars:k,radius:N,color:H,title:K,children:ae,id:ue,icon:ge,withCloseButton:fe,onClose:ce,closeButtonLabel:qe,variant:Fe,autoContrast:Ne,role:Be,attributes:Pe,...$e}=h,Qe=ca({name:"Alert",classes:I2,props:h,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:Pe,vars:k,varsResolver:eC}),Et=Nb(ue),Ut=K&&`${Et}-title`||void 0,$t=`${Et}-body`;return rt.jsx(Ui,{id:Et,...Qe("root",{variant:Fe}),variant:Fe,ref:a,role:Be||"alert",...$e,"aria-describedby":ae?$t:void 0,"aria-labelledby":K?Ut:void 0,children:rt.jsxs("div",{...Qe("wrapper"),children:[ge&&rt.jsx("div",{...Qe("icon"),children:ge}),rt.jsxs("div",{...Qe("body"),children:[K&&rt.jsx("div",{...Qe("title"),"data-with-close-button":fe||void 0,children:rt.jsx("span",{id:Ut,...Qe("label"),children:K})}),ae&&rt.jsx("div",{id:$t,...Qe("message"),"data-variant":Fe,children:ae})]}),fe&&rt.jsx(Ev,{...Qe("closeButton"),onClick:ce,variant:"transparent",size:16,iconSize:16,"aria-label":qe,unstyled:c})]})})});Qb.classes=I2;Qb.displayName="@mantine/core/Alert";var Hm={root:"m_77c9d27d",inner:"m_80f1301b",label:"m_811560b9",section:"m_a74036a",loader:"m_a25b86ee",group:"m_80d6d844",groupSection:"m_70be2a01"};const z1={orientation:"horizontal"},tC=(s,{borderWidth:a})=>({group:{"--button-border-width":Lt(a)}}),ex=Kr((s,a)=>{const h=bn("ButtonGroup",z1,s),{className:g,style:S,classNames:A,styles:w,unstyled:c,orientation:k,vars:N,borderWidth:H,variant:K,mod:ae,attributes:ue,...ge}=bn("ButtonGroup",z1,s),fe=ca({name:"ButtonGroup",props:h,classes:Hm,className:g,style:S,classNames:A,styles:w,unstyled:c,attributes:ue,vars:N,varsResolver:tC,rootSelector:"group"});return rt.jsx(Ui,{...fe("group"),ref:a,variant:K,mod:[{"data-orientation":k},ae],role:"group",...ge})});ex.classes=Hm;ex.displayName="@mantine/core/ButtonGroup";const iC=(s,{radius:a,color:h,gradient:g,variant:S,autoContrast:A,size:w})=>{const c=s.variantColorResolver({color:h||s.primaryColor,theme:s,gradient:g,variant:S||"filled",autoContrast:A});return{groupSection:{"--section-height":Ws(w,"section-height"),"--section-padding-x":Ws(w,"section-padding-x"),"--section-fz":w?.includes("compact")?Uu(w.replace("compact-","")):Uu(w),"--section-radius":a===void 0?void 0:fd(a),"--section-bg":h||S?c.background:void 0,"--section-color":c.color,"--section-bd":h||S?c.border:void 0}}},tx=Kr((s,a)=>{const h=bn("ButtonGroupSection",null,s),{className:g,style:S,classNames:A,styles:w,unstyled:c,vars:k,variant:N,gradient:H,radius:K,autoContrast:ae,attributes:ue,...ge}=h,fe=ca({name:"ButtonGroupSection",props:h,classes:Hm,className:g,style:S,classNames:A,styles:w,unstyled:c,attributes:ue,vars:k,varsResolver:iC,rootSelector:"groupSection"});return rt.jsx(Ui,{...fe("groupSection"),ref:a,variant:N,...ge})});tx.classes=Hm;tx.displayName="@mantine/core/ButtonGroupSection";const nC={in:{opacity:1,transform:`translate(-50%, calc(-50% + ${Lt(1)}))`},out:{opacity:0,transform:"translate(-50%, -200%)"},common:{transformOrigin:"center"},transitionProperty:"transform, opacity"},rC=(s,{radius:a,color:h,gradient:g,variant:S,size:A,justify:w,autoContrast:c})=>{const k=s.variantColorResolver({color:h||s.primaryColor,theme:s,gradient:g,variant:S||"filled",autoContrast:c});return{root:{"--button-justify":w,"--button-height":Ws(A,"button-height"),"--button-padding-x":Ws(A,"button-padding-x"),"--button-fz":A?.includes("compact")?Uu(A.replace("compact-","")):Uu(A),"--button-radius":a===void 0?void 0:fd(a),"--button-bg":h||S?k.background:void 0,"--button-hover":h||S?k.hover:void 0,"--button-color":k.color,"--button-bd":h||S?k.border:void 0,"--button-hover-color":h||S?k.hoverColor:void 0}}},Fy=kp((s,a)=>{const h=bn("Button",null,s),{style:g,vars:S,className:A,color:w,disabled:c,children:k,leftSection:N,rightSection:H,fullWidth:K,variant:ae,radius:ue,loading:ge,loaderProps:fe,gradient:ce,classNames:qe,styles:Fe,unstyled:Ne,"data-disabled":Be,autoContrast:Pe,mod:$e,attributes:Qe,...Et}=h,Ut=ca({name:"Button",props:h,classes:Hm,className:A,style:g,classNames:qe,styles:Fe,unstyled:Ne,attributes:Qe,vars:S,varsResolver:rC}),$t=!!N,hi=!!H;return rt.jsxs(qm,{ref:a,...Ut("root",{active:!c&&!ge&&!Be}),unstyled:Ne,variant:ae,disabled:c||ge,mod:[{disabled:c||Be,loading:ge,block:K,"with-left-section":$t,"with-right-section":hi},$e],...Et,children:[typeof ge=="boolean"&&rt.jsx($b,{mounted:ge,transition:nC,duration:150,children:li=>rt.jsx(Ui,{component:"span",...Ut("loader",{style:li}),"aria-hidden":!0,children:rt.jsx(By,{color:"var(--button-color)",size:"calc(var(--button-height) / 1.8)",...fe})})}),rt.jsxs("span",{...Ut("inner"),children:[N&&rt.jsx(Ui,{component:"span",...Ut("section"),mod:{position:"left"},children:N}),rt.jsx(Ui,{component:"span",mod:{loading:ge},...Ut("label"),children:k}),H&&rt.jsx(Ui,{component:"span",...Ut("section"),mod:{position:"right"},children:H})]})]})});Fy.classes=Hm;Fy.displayName="@mantine/core/Button";Fy.Group=ex;Fy.GroupSection=tx;var L2={root:"m_4451eb3a"};const ix=kp((s,a)=>{const h=bn("Center",null,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,vars:k,inline:N,mod:H,attributes:K,...ae}=h,ue=ca({name:"Center",props:h,classes:L2,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:K,vars:k});return rt.jsx(Ui,{ref:a,mod:[{inline:N},H],...ue("root"),...ae})});ix.classes=L2;ix.displayName="@mantine/core/Center";const Fm=Kr((s,a)=>{const{w:h,h:g,miw:S,mih:A,...w}=bn("Space",null,s);return rt.jsx(Ui,{ref:a,...w,w:h,miw:S??h,h:g,mih:A??g})});Fm.displayName="@mantine/core/Space";var D2={root:"m_6d731127"};const aC={gap:"md",align:"stretch",justify:"flex-start"},oC=(s,{gap:a,align:h,justify:g})=>({root:{"--stack-gap":Bb(a),"--stack-align":h,"--stack-justify":g}}),Xm=Kr((s,a)=>{const h=bn("Stack",aC,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,vars:k,align:N,justify:H,gap:K,variant:ae,attributes:ue,...ge}=h,fe=ca({name:"Stack",props:h,classes:D2,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:ue,vars:k,varsResolver:oC});return rt.jsx(Ui,{ref:a,...fe("root"),variant:ae,...ge})});Xm.classes=D2;Xm.displayName="@mantine/core/Stack";const[sC,nx]=jM("Tabs component was not found in the tree");var Ny={root:"m_89d60db1","list--default":"m_576c9d4",list:"m_89d33d6d",tab:"m_4ec4dce6",panel:"m_b0c91715",tabSection:"m_fc420b1f",tabLabel:"m_42bbd1ae","tab--default":"m_539e827b","list--outline":"m_6772fbd5","tab--outline":"m_b59ab47c","tab--pills":"m_c3381914"};const rx=Kr((s,a)=>{const h=bn("TabsList",null,s),{children:g,className:S,grow:A,justify:w,classNames:c,styles:k,style:N,mod:H,...K}=h,ae=nx();return rt.jsx(Ui,{...K,...ae.getStyles("list",{className:S,style:N,classNames:c,styles:k,props:h,variant:ae.variant}),ref:a,role:"tablist",variant:ae.variant,mod:[{grow:A,orientation:ae.orientation,placement:ae.orientation==="vertical"&&ae.placement,inverted:ae.inverted},H],"aria-orientation":ae.orientation,__vars:{"--tabs-justify":w},children:g})});rx.classes=Ny;rx.displayName="@mantine/core/TabsList";const ax=Kr((s,a)=>{const h=bn("TabsPanel",null,s),{children:g,className:S,value:A,classNames:w,styles:c,style:k,mod:N,keepMounted:H,...K}=h,ae=nx(),ue=ae.value===A,ge=ae.keepMounted||H||ue?g:null;return rt.jsx(Ui,{...ae.getStyles("panel",{className:S,classNames:w,styles:c,style:[k,ue?void 0:{display:"none"}],props:h}),ref:a,mod:[{orientation:ae.orientation},N],role:"tabpanel",id:ae.getPanelId(A),"aria-labelledby":ae.getTabId(A),...K,children:ge})});ax.classes=Ny;ax.displayName="@mantine/core/TabsPanel";const ox=Kr((s,a)=>{const h=bn("TabsTab",null,s),{className:g,children:S,rightSection:A,leftSection:w,value:c,onClick:k,onKeyDown:N,disabled:H,color:K,style:ae,classNames:ue,styles:ge,vars:fe,mod:ce,tabIndex:qe,...Fe}=h,Ne=Ph(),{dir:Be}=_A(),Pe=nx(),$e=c===Pe.value,Qe=Ut=>{Pe.onChange(Pe.allowTabDeactivation&&c===Pe.value?null:c),k?.(Ut)},Et={classNames:ue,styles:ge,props:h};return rt.jsxs(qm,{...Pe.getStyles("tab",{className:g,style:ae,variant:Pe.variant,...Et}),disabled:H,unstyled:Pe.unstyled,variant:Pe.variant,mod:[{active:$e,disabled:H,orientation:Pe.orientation,inverted:Pe.inverted,placement:Pe.orientation==="vertical"&&Pe.placement},ce],ref:a,role:"tab",id:Pe.getTabId(c),"aria-selected":$e,tabIndex:qe!==void 0?qe:$e||Pe.value===null?0:-1,"aria-controls":Pe.getPanelId(c),onClick:Qe,__vars:{"--tabs-color":K?Ty(K,Ne):void 0},onKeyDown:ZM({siblingSelector:'[role="tab"]',parentSelector:'[role="tablist"]',activateOnFocus:Pe.activateTabWithKeyboard,loop:Pe.loop,orientation:Pe.orientation||"horizontal",dir:Be,onKeyDown:N}),...Fe,children:[w&&rt.jsx("span",{...Pe.getStyles("tabSection",Et),"data-position":"left",children:w}),S&&rt.jsx("span",{...Pe.getStyles("tabLabel",Et),children:S}),A&&rt.jsx("span",{...Pe.getStyles("tabSection",Et),"data-position":"right",children:A})]})});ox.classes=Ny;ox.displayName="@mantine/core/TabsTab";const I1="Tabs.Tab or Tabs.Panel component was rendered with invalid value or without value",lC={keepMounted:!0,orientation:"horizontal",loop:!0,activateTabWithKeyboard:!0,variant:"default",placement:"left"},uC=(s,{radius:a,color:h,autoContrast:g})=>({root:{"--tabs-radius":fd(a),"--tabs-color":Ty(h,s),"--tabs-text-color":HE(g,s)?h2({color:h,theme:s,autoContrast:g}):void 0}}),Xs=Kr((s,a)=>{const h=bn("Tabs",lC,s),{defaultValue:g,value:S,onChange:A,orientation:w,children:c,loop:k,id:N,activateTabWithKeyboard:H,allowTabDeactivation:K,variant:ae,color:ue,radius:ge,inverted:fe,placement:ce,keepMounted:qe,classNames:Fe,styles:Ne,unstyled:Be,className:Pe,style:$e,vars:Qe,autoContrast:Et,mod:Ut,attributes:$t,...hi}=h,li=Nb(N),[nn,Ci]=JM({value:S,defaultValue:g,finalValue:null,onChange:A}),Qi=ca({name:"Tabs",props:h,classes:Ny,className:Pe,style:$e,classNames:Fe,styles:Ne,unstyled:Be,attributes:$t,vars:Qe,varsResolver:uC});return rt.jsx(sC,{value:{placement:ce,value:nn,orientation:w,id:li,loop:k,activateTabWithKeyboard:H,getTabId:m1(`${li}-tab`,I1),getPanelId:m1(`${li}-panel`,I1),onChange:Ci,allowTabDeactivation:K,variant:ae,color:ue,radius:ge,inverted:fe,keepMounted:qe,unstyled:Be,getStyles:Qi},children:rt.jsx(Ui,{ref:a,id:li,variant:ae,mod:[{orientation:w,inverted:w==="horizontal"&&fe,placement:w==="vertical"&&ce},Ut],...Qi("root"),...hi,children:c})})});Xs.classes=Ny;Xs.displayName="@mantine/core/Tabs";Xs.Tab=ox;Xs.Panel=ax;Xs.List=rx;const my=Kr((s,a)=>{const h=bn("TextInput",null,s);return rt.jsx(Iv,{component:"input",ref:a,...h,__staticSelector:"TextInput"})});my.classes=Iv.classes;my.displayName="@mantine/core/TextInput";var R2={root:"m_7341320d"};const cC=(s,{size:a,radius:h,variant:g,gradient:S,color:A,autoContrast:w})=>{const c=s.variantColorResolver({color:A||s.primaryColor,theme:s,gradient:S,variant:g||"filled",autoContrast:w});return{root:{"--ti-size":Ws(a,"ti-size"),"--ti-radius":h===void 0?void 0:fd(h),"--ti-bg":A||g?c.background:void 0,"--ti-color":A||g?c.color:void 0,"--ti-bd":A||g?c.border:void 0}}},Om=Kr((s,a)=>{const h=bn("ThemeIcon",null,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,vars:k,autoContrast:N,attributes:H,...K}=h,ae=ca({name:"ThemeIcon",classes:R2,props:h,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:H,vars:k,varsResolver:cC});return rt.jsx(Ui,{ref:a,...ae("root"),...K})});Om.classes=R2;Om.displayName="@mantine/core/ThemeIcon";const hC=["h1","h2","h3","h4","h5","h6"],dC=["xs","sm","md","lg","xl"];function fC(s,a){const h=a!==void 0?a:`h${s}`;return hC.includes(h)?{fontSize:`var(--mantine-${h}-font-size)`,fontWeight:`var(--mantine-${h}-font-weight)`,lineHeight:`var(--mantine-${h}-line-height)`}:dC.includes(h)?{fontSize:`var(--mantine-font-size-${h})`,fontWeight:`var(--mantine-h${s}-font-weight)`,lineHeight:`var(--mantine-h${s}-line-height)`}:{fontSize:Lt(h),fontWeight:`var(--mantine-h${s}-font-weight)`,lineHeight:`var(--mantine-h${s}-line-height)`}}var k2={root:"m_8a5d1357"};const pC={order:1},mC=(s,{order:a,size:h,lineClamp:g,textWrap:S})=>{const A=fC(a||1,h);return{root:{"--title-fw":A.fontWeight,"--title-lh":A.lineHeight,"--title-fz":A.fontSize,"--title-line-clamp":typeof g=="number"?g.toString():void 0,"--title-text-wrap":S}}},sx=Kr((s,a)=>{const h=bn("Title",pC,s),{classNames:g,className:S,style:A,styles:w,unstyled:c,order:k,vars:N,size:H,variant:K,lineClamp:ae,textWrap:ue,mod:ge,attributes:fe,...ce}=h,qe=ca({name:"Title",props:h,classes:k2,className:S,style:A,classNames:g,styles:w,unstyled:c,attributes:fe,vars:N,varsResolver:mC});return[1,2,3,4,5,6].includes(k)?rt.jsx(Ui,{...qe("root"),component:`h${k}`,variant:K,ref:a,mod:[{order:k,"data-line-clamp":typeof ae=="number"},ge],size:H,...ce}):null});sx.classes=k2;sx.displayName="@mantine/core/Title";var gC={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};const Ym=(s,a,h,g)=>{const S=ct.forwardRef(({color:A="currentColor",size:w=24,stroke:c=2,title:k,className:N,children:H,...K},ae)=>ct.createElement("svg",{ref:ae,...gC[s],width:w,height:w,className:["tabler-icon",`tabler-icon-${a}`,N].join(" "),strokeWidth:c,stroke:A,...K},[k&&ct.createElement("title",{key:"svg-title"},k),...g.map(([ue,ge])=>ct.createElement(ue,ge)),...Array.isArray(H)?H:[H]]));return S.displayName=`${h}`,S};const yC=[["path",{d:"M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5",key:"svg-0"}]],_C=Ym("outline","brand-github","BrandGithub",yC);const vC=[["path",{d:"M16 20h3a1 1 0 0 0 1 -1v-14a1 1 0 0 0 -1 -1h-3v16",key:"svg-0"}],["path",{d:"M5 20h3v-16h-3a1 1 0 0 0 -1 1v14a1 1 0 0 0 1 1",key:"svg-1"}],["path",{d:"M16 4l-4 4l-4 -4",key:"svg-2"}],["path",{d:"M4 6.5l8 7.5l8 -7.5",key:"svg-3"}]],bC=Ym("outline","brand-gmail","BrandGmail",vC);const xC=[["path",{d:"M8 11v5",key:"svg-0"}],["path",{d:"M8 8v.01",key:"svg-1"}],["path",{d:"M12 16v-5",key:"svg-2"}],["path",{d:"M16 16v-3a2 2 0 1 0 -4 0",key:"svg-3"}],["path",{d:"M3 7a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v10a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4l0 -10",key:"svg-4"}]],wC=Ym("outline","brand-linkedin","BrandLinkedin",xC);const TC=[["path",{d:"M7 8l-4 4l4 4",key:"svg-0"}],["path",{d:"M17 8l4 4l-4 4",key:"svg-1"}],["path",{d:"M14 4l-4 16",key:"svg-2"}]],SC=Ym("outline","code","Code",TC);const MC=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 9h.01",key:"svg-1"}],["path",{d:"M11 12h1v4h1",key:"svg-2"}]],EC=Ym("outline","info-circle","InfoCircle",MC);const AC=[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]],CC=Ym("outline","send","Send",AC);function $_(s,a){const{hovered:h,ref:g}=QM();return rt.jsxs(Ui,{ref:g,children:[s,rt.jsx(b2,{in:h,children:a})]})}function PC(){const s=c=>new Promise(k=>setTimeout(k,c)),a=["Hello, I'm Luke Chen.","Welcome to my portfolio website.","Feel free to explore my works and projects.","Connect with me on GitHub and LinkedIn.","Enjoy your stay!"],[h,g]=ct.useState(0),[S,A]=ct.useState(!0),w=()=>{A(!S),g(0)};return ct.useEffect(()=>{(async()=>(await s(5e3),g(k=>(k+1)%a.length)))()},[h,a.length]),rt.jsx(ix,{maw:"80vw",children:rt.jsxs(Xm,{bg:"var(--mantine-color-body)",align:"stretch",justify:"flex-start",gap:"xs",children:[rt.jsx(Ui,{onClick:w,style:{cursor:"pointer"},children:rt.jsx(sx,{order:1,children:S?a[h]:a.join(" ")})}),rt.jsx(Fm,{h:"md"}),$_(rt.jsx(hf,{component:c1,to:"/works",variant:"filled",size:"xl",radius:"xl","aria-label":"Works",children:rt.jsx(Om,{radius:"lg",size:"xl",children:rt.jsx(SC,{style:{width:"80%",height:"80%"}})})}),rt.jsx(Ui,{p:"xs",children:"Explore my projects and works here!"})),$_(rt.jsx(hf,{variant:"filled",size:"xl",radius:"xl","aria-label":"GitHub",component:"a",href:"https://github.com/lukechn99",target:"_blank",rel:"noopener noreferrer",children:rt.jsx(Om,{radius:"lg",size:"xl",children:rt.jsx(_C,{style:{width:"80%",height:"80%"}})})}),rt.jsx(Ui,{p:"xs",children:"Check out my GitHub"})),$_(rt.jsx(hf,{variant:"filled",size:"xl",radius:"xl","aria-label":"LinkedIn",component:"a",href:"https://www.linkedin.com/in/chen-luke",target:"_blank",rel:"noopener noreferrer",children:rt.jsx(Om,{radius:"lg",size:"xl",children:rt.jsx(wC,{style:{width:"80%",height:"80%"}})})}),rt.jsx(Ui,{p:"xs",children:"Connect with me on LinkedIn"})),$_(rt.jsx(hf,{component:c1,to:"/contact",variant:"filled",size:"xl",radius:"xl","aria-label":"Works",children:rt.jsx(Om,{radius:"lg",size:"xl",children:rt.jsx(bC,{style:{width:"80%",height:"80%"}})})}),rt.jsx(Ui,{p:"xs",children:"Send me a message!"})),rt.jsx(Fm,{h:"sm"})]})})}const zC="_list_7vhnr_1",IC="_indicator_7vhnr_6",LC="_tab_7vhnr_18",Lm={list:zC,indicator:IC,tab:LC};var cy={exports:{}};var DC=cy.exports,L1;function RC(){return L1||(L1=1,(function(s,a){(function(h,g){g(a)})(DC,(function(h){var g="1.9.4";function S(d){var x,z,j,Y;for(z=1,j=arguments.length;z<j;z++){Y=arguments[z];for(x in Y)d[x]=Y[x]}return d}var A=Object.create||(function(){function d(){}return function(x){return d.prototype=x,new d}})();function w(d,x){var z=Array.prototype.slice;if(d.bind)return d.bind.apply(d,z.call(arguments,1));var j=z.call(arguments,2);return function(){return d.apply(x,j.length?j.concat(z.call(arguments)):arguments)}}var c=0;function k(d){return"_leaflet_id"in d||(d._leaflet_id=++c),d._leaflet_id}function N(d,x,z){var j,Y,se,Ae;return Ae=function(){j=!1,Y&&(se.apply(z,Y),Y=!1)},se=function(){j?Y=arguments:(d.apply(z,arguments),setTimeout(Ae,x),j=!0)},se}function H(d,x,z){var j=x[1],Y=x[0],se=j-Y;return d===j&&z?d:((d-Y)%se+se)%se+Y}function K(){return!1}function ae(d,x){if(x===!1)return d;var z=Math.pow(10,x===void 0?6:x);return Math.round(d*z)/z}function ue(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")}function ge(d){return ue(d).split(/\s+/)}function fe(d,x){Object.prototype.hasOwnProperty.call(d,"options")||(d.options=d.options?A(d.options):{});for(var z in x)d.options[z]=x[z];return d.options}function ce(d,x,z){var j=[];for(var Y in d)j.push(encodeURIComponent(z?Y.toUpperCase():Y)+"="+encodeURIComponent(d[Y]));return(!x||x.indexOf("?")===-1?"?":"&")+j.join("&")}var qe=/\{ *([\w_ -]+) *\}/g;function Fe(d,x){return d.replace(qe,function(z,j){var Y=x[j];if(Y===void 0)throw new Error("No value provided for variable "+z);return typeof Y=="function"&&(Y=Y(x)),Y})}var Ne=Array.isArray||function(d){return Object.prototype.toString.call(d)==="[object Array]"};function Be(d,x){for(var z=0;z<d.length;z++)if(d[z]===x)return z;return-1}var Pe="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function $e(d){return window["webkit"+d]||window["moz"+d]||window["ms"+d]}var Qe=0;function Et(d){var x=+new Date,z=Math.max(0,16-(x-Qe));return Qe=x+z,window.setTimeout(d,z)}var Ut=window.requestAnimationFrame||$e("RequestAnimationFrame")||Et,$t=window.cancelAnimationFrame||$e("CancelAnimationFrame")||$e("CancelRequestAnimationFrame")||function(d){window.clearTimeout(d)};function hi(d,x,z){if(z&&Ut===Et)d.call(x);else return Ut.call(window,w(d,x))}function li(d){d&&$t.call(window,d)}var nn={__proto__:null,extend:S,create:A,bind:w,get lastId(){return c},stamp:k,throttle:N,wrapNum:H,falseFn:K,formatNum:ae,trim:ue,splitWords:ge,setOptions:fe,getParamString:ce,template:Fe,isArray:Ne,indexOf:Be,emptyImageUrl:Pe,requestFn:Ut,cancelFn:$t,requestAnimFrame:hi,cancelAnimFrame:li};function Ci(){}Ci.extend=function(d){var x=function(){fe(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},z=x.__super__=this.prototype,j=A(z);j.constructor=x,x.prototype=j;for(var Y in this)Object.prototype.hasOwnProperty.call(this,Y)&&Y!=="prototype"&&Y!=="__super__"&&(x[Y]=this[Y]);return d.statics&&S(x,d.statics),d.includes&&(Qi(d.includes),S.apply(null,[j].concat(d.includes))),S(j,d),delete j.statics,delete j.includes,j.options&&(j.options=z.options?A(z.options):{},S(j.options,d.options)),j._initHooks=[],j.callInitHooks=function(){if(!this._initHooksCalled){z.callInitHooks&&z.callInitHooks.call(this),this._initHooksCalled=!0;for(var se=0,Ae=j._initHooks.length;se<Ae;se++)j._initHooks[se].call(this)}},x},Ci.include=function(d){var x=this.prototype.options;return S(this.prototype,d),d.options&&(this.prototype.options=x,this.mergeOptions(d.options)),this},Ci.mergeOptions=function(d){return S(this.prototype.options,d),this},Ci.addInitHook=function(d){var x=Array.prototype.slice.call(arguments,1),z=typeof d=="function"?d:function(){this[d].apply(this,x)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(z),this};function Qi(d){if(!(typeof L>"u"||!L||!L.Mixin)){d=Ne(d)?d:[d];for(var x=0;x<d.length;x++)d[x]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var lt={on:function(d,x,z){if(typeof d=="object")for(var j in d)this._on(j,d[j],x);else{d=ge(d);for(var Y=0,se=d.length;Y<se;Y++)this._on(d[Y],x,z)}return this},off:function(d,x,z){if(!arguments.length)delete this._events;else if(typeof d=="object")for(var j in d)this._off(j,d[j],x);else{d=ge(d);for(var Y=arguments.length===1,se=0,Ae=d.length;se<Ae;se++)Y?this._off(d[se]):this._off(d[se],x,z)}return this},_on:function(d,x,z,j){if(typeof x!="function"){console.warn("wrong listener type: "+typeof x);return}if(this._listens(d,x,z)===!1){z===this&&(z=void 0);var Y={fn:x,ctx:z};j&&(Y.once=!0),this._events=this._events||{},this._events[d]=this._events[d]||[],this._events[d].push(Y)}},_off:function(d,x,z){var j,Y,se;if(this._events&&(j=this._events[d],!!j)){if(arguments.length===1){if(this._firingCount)for(Y=0,se=j.length;Y<se;Y++)j[Y].fn=K;delete this._events[d];return}if(typeof x!="function"){console.warn("wrong listener type: "+typeof x);return}var Ae=this._listens(d,x,z);if(Ae!==!1){var Ue=j[Ae];this._firingCount&&(Ue.fn=K,this._events[d]=j=j.slice()),j.splice(Ae,1)}}},fire:function(d,x,z){if(!this.listens(d,z))return this;var j=S({},x,{type:d,target:this,sourceTarget:x&&x.sourceTarget||this});if(this._events){var Y=this._events[d];if(Y){this._firingCount=this._firingCount+1||1;for(var se=0,Ae=Y.length;se<Ae;se++){var Ue=Y[se],ot=Ue.fn;Ue.once&&this.off(d,ot,Ue.ctx),ot.call(Ue.ctx||this,j)}this._firingCount--}}return z&&this._propagateEvent(j),this},listens:function(d,x,z,j){typeof d!="string"&&console.warn('"string" type argument expected');var Y=x;typeof x!="function"&&(j=!!x,Y=void 0,z=void 0);var se=this._events&&this._events[d];if(se&&se.length&&this._listens(d,Y,z)!==!1)return!0;if(j){for(var Ae in this._eventParents)if(this._eventParents[Ae].listens(d,x,z,j))return!0}return!1},_listens:function(d,x,z){if(!this._events)return!1;var j=this._events[d]||[];if(!x)return!!j.length;z===this&&(z=void 0);for(var Y=0,se=j.length;Y<se;Y++)if(j[Y].fn===x&&j[Y].ctx===z)return Y;return!1},once:function(d,x,z){if(typeof d=="object")for(var j in d)this._on(j,d[j],x,!0);else{d=ge(d);for(var Y=0,se=d.length;Y<se;Y++)this._on(d[Y],x,z,!0)}return this},addEventParent:function(d){return this._eventParents=this._eventParents||{},this._eventParents[k(d)]=d,this},removeEventParent:function(d){return this._eventParents&&delete this._eventParents[k(d)],this},_propagateEvent:function(d){for(var x in this._eventParents)this._eventParents[x].fire(d.type,S({layer:d.target,propagatedFrom:d.target},d),!0)}};lt.addEventListener=lt.on,lt.removeEventListener=lt.clearAllEventListeners=lt.off,lt.addOneTimeEventListener=lt.once,lt.fireEvent=lt.fire,lt.hasEventListeners=lt.listens;var Pt=Ci.extend(lt);function Mt(d,x,z){this.x=z?Math.round(d):d,this.y=z?Math.round(x):x}var ei=Math.trunc||function(d){return d>0?Math.floor(d):Math.ceil(d)};Mt.prototype={clone:function(){return new Mt(this.x,this.y)},add:function(d){return this.clone()._add(Nt(d))},_add:function(d){return this.x+=d.x,this.y+=d.y,this},subtract:function(d){return this.clone()._subtract(Nt(d))},_subtract:function(d){return this.x-=d.x,this.y-=d.y,this},divideBy:function(d){return this.clone()._divideBy(d)},_divideBy:function(d){return this.x/=d,this.y/=d,this},multiplyBy:function(d){return this.clone()._multiplyBy(d)},_multiplyBy:function(d){return this.x*=d,this.y*=d,this},scaleBy:function(d){return new Mt(this.x*d.x,this.y*d.y)},unscaleBy:function(d){return new Mt(this.x/d.x,this.y/d.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ei(this.x),this.y=ei(this.y),this},distanceTo:function(d){d=Nt(d);var x=d.x-this.x,z=d.y-this.y;return Math.sqrt(x*x+z*z)},equals:function(d){return d=Nt(d),d.x===this.x&&d.y===this.y},contains:function(d){return d=Nt(d),Math.abs(d.x)<=Math.abs(this.x)&&Math.abs(d.y)<=Math.abs(this.y)},toString:function(){return"Point("+ae(this.x)+", "+ae(this.y)+")"}};function Nt(d,x,z){return d instanceof Mt?d:Ne(d)?new Mt(d[0],d[1]):d==null?d:typeof d=="object"&&"x"in d&&"y"in d?new Mt(d.x,d.y):new Mt(d,x,z)}function ze(d,x){if(d)for(var z=x?[d,x]:d,j=0,Y=z.length;j<Y;j++)this.extend(z[j])}ze.prototype={extend:function(d){var x,z;if(!d)return this;if(d instanceof Mt||typeof d[0]=="number"||"x"in d)x=z=Nt(d);else if(d=dt(d),x=d.min,z=d.max,!x||!z)return this;return!this.min&&!this.max?(this.min=x.clone(),this.max=z.clone()):(this.min.x=Math.min(x.x,this.min.x),this.max.x=Math.max(z.x,this.max.x),this.min.y=Math.min(x.y,this.min.y),this.max.y=Math.max(z.y,this.max.y)),this},getCenter:function(d){return Nt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,d)},getBottomLeft:function(){return Nt(this.min.x,this.max.y)},getTopRight:function(){return Nt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(d){var x,z;return typeof d[0]=="number"||d instanceof Mt?d=Nt(d):d=dt(d),d instanceof ze?(x=d.min,z=d.max):x=z=d,x.x>=this.min.x&&z.x<=this.max.x&&x.y>=this.min.y&&z.y<=this.max.y},intersects:function(d){d=dt(d);var x=this.min,z=this.max,j=d.min,Y=d.max,se=Y.x>=x.x&&j.x<=z.x,Ae=Y.y>=x.y&&j.y<=z.y;return se&&Ae},overlaps:function(d){d=dt(d);var x=this.min,z=this.max,j=d.min,Y=d.max,se=Y.x>x.x&&j.x<z.x,Ae=Y.y>x.y&&j.y<z.y;return se&&Ae},isValid:function(){return!!(this.min&&this.max)},pad:function(d){var x=this.min,z=this.max,j=Math.abs(x.x-z.x)*d,Y=Math.abs(x.y-z.y)*d;return dt(Nt(x.x-j,x.y-Y),Nt(z.x+j,z.y+Y))},equals:function(d){return d?(d=dt(d),this.min.equals(d.getTopLeft())&&this.max.equals(d.getBottomRight())):!1}};function dt(d,x){return!d||d instanceof ze?d:new ze(d,x)}function It(d,x){if(d)for(var z=x?[d,x]:d,j=0,Y=z.length;j<Y;j++)this.extend(z[j])}It.prototype={extend:function(d){var x=this._southWest,z=this._northEast,j,Y;if(d instanceof Dt)j=d,Y=d;else if(d instanceof It){if(j=d._southWest,Y=d._northEast,!j||!Y)return this}else return d?this.extend(kt(d)||zt(d)):this;return!x&&!z?(this._southWest=new Dt(j.lat,j.lng),this._northEast=new Dt(Y.lat,Y.lng)):(x.lat=Math.min(j.lat,x.lat),x.lng=Math.min(j.lng,x.lng),z.lat=Math.max(Y.lat,z.lat),z.lng=Math.max(Y.lng,z.lng)),this},pad:function(d){var x=this._southWest,z=this._northEast,j=Math.abs(x.lat-z.lat)*d,Y=Math.abs(x.lng-z.lng)*d;return new It(new Dt(x.lat-j,x.lng-Y),new Dt(z.lat+j,z.lng+Y))},getCenter:function(){return new Dt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Dt(this.getNorth(),this.getWest())},getSouthEast:function(){return new Dt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(d){typeof d[0]=="number"||d instanceof Dt||"lat"in d?d=kt(d):d=zt(d);var x=this._southWest,z=this._northEast,j,Y;return d instanceof It?(j=d.getSouthWest(),Y=d.getNorthEast()):j=Y=d,j.lat>=x.lat&&Y.lat<=z.lat&&j.lng>=x.lng&&Y.lng<=z.lng},intersects:function(d){d=zt(d);var x=this._southWest,z=this._northEast,j=d.getSouthWest(),Y=d.getNorthEast(),se=Y.lat>=x.lat&&j.lat<=z.lat,Ae=Y.lng>=x.lng&&j.lng<=z.lng;return se&&Ae},overlaps:function(d){d=zt(d);var x=this._southWest,z=this._northEast,j=d.getSouthWest(),Y=d.getNorthEast(),se=Y.lat>x.lat&&j.lat<z.lat,Ae=Y.lng>x.lng&&j.lng<z.lng;return se&&Ae},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(d,x){return d?(d=zt(d),this._southWest.equals(d.getSouthWest(),x)&&this._northEast.equals(d.getNorthEast(),x)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function zt(d,x){return d instanceof It?d:new It(d,x)}function Dt(d,x,z){if(isNaN(d)||isNaN(x))throw new Error("Invalid LatLng object: ("+d+", "+x+")");this.lat=+d,this.lng=+x,z!==void 0&&(this.alt=+z)}Dt.prototype={equals:function(d,x){if(!d)return!1;d=kt(d);var z=Math.max(Math.abs(this.lat-d.lat),Math.abs(this.lng-d.lng));return z<=(x===void 0?1e-9:x)},toString:function(d){return"LatLng("+ae(this.lat,d)+", "+ae(this.lng,d)+")"},distanceTo:function(d){return Ei.distance(this,kt(d))},wrap:function(){return Ei.wrapLatLng(this)},toBounds:function(d){var x=180*d/40075017,z=x/Math.cos(Math.PI/180*this.lat);return zt([this.lat-x,this.lng-z],[this.lat+x,this.lng+z])},clone:function(){return new Dt(this.lat,this.lng,this.alt)}};function kt(d,x,z){return d instanceof Dt?d:Ne(d)&&typeof d[0]!="object"?d.length===3?new Dt(d[0],d[1],d[2]):d.length===2?new Dt(d[0],d[1]):null:d==null?d:typeof d=="object"&&"lat"in d?new Dt(d.lat,"lng"in d?d.lng:d.lon,d.alt):x===void 0?null:new Dt(d,x,z)}var fi={latLngToPoint:function(d,x){var z=this.projection.project(d),j=this.scale(x);return this.transformation._transform(z,j)},pointToLatLng:function(d,x){var z=this.scale(x),j=this.transformation.untransform(d,z);return this.projection.unproject(j)},project:function(d){return this.projection.project(d)},unproject:function(d){return this.projection.unproject(d)},scale:function(d){return 256*Math.pow(2,d)},zoom:function(d){return Math.log(d/256)/Math.LN2},getProjectedBounds:function(d){if(this.infinite)return null;var x=this.projection.bounds,z=this.scale(d),j=this.transformation.transform(x.min,z),Y=this.transformation.transform(x.max,z);return new ze(j,Y)},infinite:!1,wrapLatLng:function(d){var x=this.wrapLng?H(d.lng,this.wrapLng,!0):d.lng,z=this.wrapLat?H(d.lat,this.wrapLat,!0):d.lat,j=d.alt;return new Dt(z,x,j)},wrapLatLngBounds:function(d){var x=d.getCenter(),z=this.wrapLatLng(x),j=x.lat-z.lat,Y=x.lng-z.lng;if(j===0&&Y===0)return d;var se=d.getSouthWest(),Ae=d.getNorthEast(),Ue=new Dt(se.lat-j,se.lng-Y),ot=new Dt(Ae.lat-j,Ae.lng-Y);return new It(Ue,ot)}},Ei=S({},fi,{wrapLng:[-180,180],R:6371e3,distance:function(d,x){var z=Math.PI/180,j=d.lat*z,Y=x.lat*z,se=Math.sin((x.lat-d.lat)*z/2),Ae=Math.sin((x.lng-d.lng)*z/2),Ue=se*se+Math.cos(j)*Math.cos(Y)*Ae*Ae,ot=2*Math.atan2(Math.sqrt(Ue),Math.sqrt(1-Ue));return this.R*ot}}),rn=6378137,hr={R:rn,MAX_LATITUDE:85.0511287798,project:function(d){var x=Math.PI/180,z=this.MAX_LATITUDE,j=Math.max(Math.min(z,d.lat),-z),Y=Math.sin(j*x);return new Mt(this.R*d.lng*x,this.R*Math.log((1+Y)/(1-Y))/2)},unproject:function(d){var x=180/Math.PI;return new Dt((2*Math.atan(Math.exp(d.y/this.R))-Math.PI/2)*x,d.x*x/this.R)},bounds:(function(){var d=rn*Math.PI;return new ze([-d,-d],[d,d])})()};function _o(d,x,z,j){if(Ne(d)){this._a=d[0],this._b=d[1],this._c=d[2],this._d=d[3];return}this._a=d,this._b=x,this._c=z,this._d=j}_o.prototype={transform:function(d,x){return this._transform(d.clone(),x)},_transform:function(d,x){return x=x||1,d.x=x*(this._a*d.x+this._b),d.y=x*(this._c*d.y+this._d),d},untransform:function(d,x){return x=x||1,new Mt((d.x/x-this._b)/this._a,(d.y/x-this._d)/this._c)}};function Mr(d,x,z,j){return new _o(d,x,z,j)}var as=S({},Ei,{code:"EPSG:3857",projection:hr,transformation:(function(){var d=.5/(Math.PI*hr.R);return Mr(d,.5,-d,.5)})()}),Rn=S({},as,{code:"EPSG:900913"});function Jr(d){return document.createElementNS("http://www.w3.org/2000/svg",d)}function wa(d,x){var z="",j,Y,se,Ae,Ue,ot;for(j=0,se=d.length;j<se;j++){for(Ue=d[j],Y=0,Ae=Ue.length;Y<Ae;Y++)ot=Ue[Y],z+=(Y?"L":"M")+ot.x+" "+ot.y;z+=x?et.svg?"z":"x":""}return z||"M0 0"}var Cn=document.documentElement.style,La="ActiveXObject"in window,ko=La&&!document.addEventListener,Oo="msLaunchUri"in navigator&&!("documentMode"in document),no=ha("webkit"),vo=ha("android"),wl=ha("android 2")||ha("android 3"),Rr=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Da=vo&&ha("Google")&&Rr<537&&!("AudioNode"in window),Ve=!!window.opera,ne=!Oo&&ha("chrome"),ie=ha("gecko")&&!no&&!Ve&&!La,de=!ne&&ha("safari"),Ee=ha("phantom"),Le="OTransition"in Cn,Ye=navigator.platform.indexOf("Win")===0,je=La&&"transition"in Cn,Re="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!wl,We="MozPerspective"in Cn,mt=!window.L_DISABLE_3D&&(je||Re||We)&&!Le&&!Ee,pt=typeof orientation<"u"||ha("mobile"),Vt=pt&&no,Kt=pt&&Re,di=!window.PointerEvent&&window.MSPointerEvent,en=!!(window.PointerEvent||di),Fi="ontouchstart"in window||!!window.TouchEvent,Ze=!window.L_NO_TOUCH&&(Fi||en),ln=pt&&Ve,dr=pt&&ie,gi=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,un=(function(){var d=!1;try{var x=Object.defineProperty({},"passive",{get:function(){d=!0}});window.addEventListener("testPassiveEventSupport",K,x),window.removeEventListener("testPassiveEventSupport",K,x)}catch{}return d})(),Er=(function(){return!!document.createElement("canvas").getContext})(),an=!!(document.createElementNS&&Jr("svg").createSVGRect),nr=!!an&&(function(){var d=document.createElement("div");return d.innerHTML="<svg/>",(d.firstChild&&d.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),_n=!an&&(function(){try{var d=document.createElement("div");d.innerHTML='<v:shape adj="1"/>';var x=d.firstChild;return x.style.behavior="url(#default#VML)",x&&typeof x.adj=="object"}catch{return!1}})(),fr=navigator.platform.indexOf("Mac")===0,du=navigator.platform.indexOf("Linux")===0;function ha(d){return navigator.userAgent.toLowerCase().indexOf(d)>=0}var et={ie:La,ielt9:ko,edge:Oo,webkit:no,android:vo,android23:wl,androidStock:Da,opera:Ve,chrome:ne,gecko:ie,safari:de,phantom:Ee,opera12:Le,win:Ye,ie3d:je,webkit3d:Re,gecko3d:We,any3d:mt,mobile:pt,mobileWebkit:Vt,mobileWebkit3d:Kt,msPointer:di,pointer:en,touch:Ze,touchNative:Fi,mobileOpera:ln,mobileGecko:dr,retina:gi,passiveEvents:un,canvas:Er,svg:an,vml:_n,inlineSvg:nr,mac:fr,linux:du},Qr=et.msPointer?"MSPointerDown":"pointerdown",ea=et.msPointer?"MSPointerMove":"pointermove",bo=et.msPointer?"MSPointerUp":"pointerup",vn=et.msPointer?"MSPointerCancel":"pointercancel",At={touchstart:Qr,touchmove:ea,touchend:bo,touchcancel:vn},yi={touchstart:ss,touchmove:ro,touchend:ro,touchcancel:ro},pi={},Ra=!1;function Bc(d,x,z){return x==="touchstart"&&Ts(),yi[x]?(z=yi[x].bind(this,z),d.addEventListener(At[x],z,!1),z):(console.warn("wrong event specified:",x),K)}function os(d,x,z){if(!At[x]){console.warn("wrong event specified:",x);return}d.removeEventListener(At[x],z,!1)}function _i(d){pi[d.pointerId]=d}function Tl(d){pi[d.pointerId]&&(pi[d.pointerId]=d)}function Bo(d){delete pi[d.pointerId]}function Ts(){Ra||(document.addEventListener(Qr,_i,!0),document.addEventListener(ea,Tl,!0),document.addEventListener(bo,Bo,!0),document.addEventListener(vn,Bo,!0),Ra=!0)}function ro(d,x){if(x.pointerType!==(x.MSPOINTER_TYPE_MOUSE||"mouse")){x.touches=[];for(var z in pi)x.touches.push(pi[z]);x.changedTouches=[x],d(x)}}function ss(d,x){x.MSPOINTER_TYPE_TOUCH&&x.pointerType===x.MSPOINTER_TYPE_TOUCH&&Ai(x),ro(d,x)}function Xn(d){var x={},z,j;for(j in d)z=d[j],x[j]=z&&z.bind?z.bind(d):z;return d=x,x.type="dblclick",x.detail=2,x.isTrusted=!1,x._simulated=!0,x}var fu=200;function da(d,x){d.addEventListener("dblclick",x);var z=0,j;function Y(se){if(se.detail!==1){j=se.detail;return}if(!(se.pointerType==="mouse"||se.sourceCapabilities&&!se.sourceCapabilities.firesTouchEvents)){var Ae=Na(se);if(!(Ae.some(function(ot){return ot instanceof HTMLLabelElement&&ot.attributes.for})&&!Ae.some(function(ot){return ot instanceof HTMLInputElement||ot instanceof HTMLSelectElement}))){var Ue=Date.now();Ue-z<=fu?(j++,j===2&&x(Xn(se))):j=1,z=Ue}}}return d.addEventListener("click",Y),{dblclick:x,simDblclick:Y}}function Vi(d,x){d.removeEventListener("dblclick",x.dblclick),d.removeEventListener("click",x.simDblclick)}var Fo=El(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ls=El(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Sl=ls==="webkitTransition"||ls==="OTransition"?ls+"End":"transitionend";function Ss(d){return typeof d=="string"?document.getElementById(d):d}function Ta(d,x){var z=d.style[x]||d.currentStyle&&d.currentStyle[x];if((!z||z==="auto")&&document.defaultView){var j=document.defaultView.getComputedStyle(d,null);z=j?j[x]:null}return z==="auto"?null:z}function Gi(d,x,z){var j=document.createElement(d);return j.className=x||"",z&&z.appendChild(j),j}function on(d){var x=d.parentNode;x&&x.removeChild(d)}function Sa(d){for(;d.firstChild;)d.removeChild(d.firstChild)}function Li(d){var x=d.parentNode;x&&x.lastChild!==d&&x.appendChild(d)}function Ks(d){var x=d.parentNode;x&&x.firstChild!==d&&x.insertBefore(d,x.firstChild)}function Fc(d,x){if(d.classList!==void 0)return d.classList.contains(x);var z=Zu(d);return z.length>0&&new RegExp("(^|\\s)"+x+"(\\s|$)").test(z)}function Ti(d,x){if(d.classList!==void 0)for(var z=ge(x),j=0,Y=z.length;j<Y;j++)d.classList.add(z[j]);else if(!Fc(d,x)){var se=Zu(d);Ml(d,(se?se+" ":"")+x)}}function Yn(d,x){d.classList!==void 0?d.classList.remove(x):Ml(d,ue((" "+Zu(d)+" ").replace(" "+x+" "," ")))}function Ml(d,x){d.className.baseVal===void 0?d.className=x:d.className.baseVal=x}function Zu(d){return d.correspondingElement&&(d=d.correspondingElement),d.className.baseVal===void 0?d.className:d.className.baseVal}function kn(d,x){"opacity"in d.style?d.style.opacity=x:"filter"in d.style&&qu(d,x)}function qu(d,x){var z=!1,j="DXImageTransform.Microsoft.Alpha";try{z=d.filters.item(j)}catch{if(x===1)return}x=Math.round(x*100),z?(z.Enabled=x!==100,z.Opacity=x):d.style.filter+=" progid:"+j+"(opacity="+x+")"}function El(d){for(var x=document.documentElement.style,z=0;z<d.length;z++)if(d[z]in x)return d[z];return!1}function No(d,x,z){var j=x||new Mt(0,0);d.style[Fo]=(et.ie3d?"translate("+j.x+"px,"+j.y+"px)":"translate3d("+j.x+"px,"+j.y+"px,0)")+(z?" scale("+z+")":"")}function Pn(d,x){d._leaflet_pos=x,et.any3d?No(d,x):(d.style.left=x.x+"px",d.style.top=x.y+"px")}function Js(d){return d._leaflet_pos||new Mt(0,0)}var us,ao,Nc;if("onselectstart"in document)us=function(){ii(window,"selectstart",Ai)},ao=function(){Zt(window,"selectstart",Ai)};else{var jo=El(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);us=function(){if(jo){var d=document.documentElement.style;Nc=d[jo],d[jo]="none"}},ao=function(){jo&&(document.documentElement.style[jo]=Nc,Nc=void 0)}}function pu(){ii(window,"dragstart",Ai)}function Ms(){Zt(window,"dragstart",Ai)}var Uo,Qs;function xi(d){for(;d.tabIndex===-1;)d=d.parentNode;d.style&&(ka(),Uo=d,Qs=d.style.outlineStyle,d.style.outlineStyle="none",ii(window,"keydown",ka))}function ka(){Uo&&(Uo.style.outlineStyle=Qs,Uo=void 0,Qs=void 0,Zt(window,"keydown",ka))}function jc(d){do d=d.parentNode;while((!d.offsetWidth||!d.offsetHeight)&&d!==document.body);return d}function Al(d){var x=d.getBoundingClientRect();return{x:x.width/d.offsetWidth||1,y:x.height/d.offsetHeight||1,boundingClientRect:x}}var Ar={__proto__:null,TRANSFORM:Fo,TRANSITION:ls,TRANSITION_END:Sl,get:Ss,getStyle:Ta,create:Gi,remove:on,empty:Sa,toFront:Li,toBack:Ks,hasClass:Fc,addClass:Ti,removeClass:Yn,setClass:Ml,getClass:Zu,setOpacity:kn,testProp:El,setTransform:No,setPosition:Pn,getPosition:Js,get disableTextSelection(){return us},get enableTextSelection(){return ao},disableImageDrag:pu,enableImageDrag:Ms,preventOutline:xi,restoreOutline:ka,getSizedParentNode:jc,getScale:Al};function ii(d,x,z,j){if(x&&typeof x=="object")for(var Y in x)Bn(d,Y,x[Y],z);else{x=ge(x);for(var se=0,Ae=x.length;se<Ae;se++)Bn(d,x[se],z,j)}return this}var Xi="_leaflet_events";function Zt(d,x,z,j){if(arguments.length===1)fn(d),delete d[Xi];else if(x&&typeof x=="object")for(var Y in x)ta(d,Y,x[Y],z);else if(x=ge(x),arguments.length===2)fn(d,function(Ue){return Be(x,Ue)!==-1});else for(var se=0,Ae=x.length;se<Ae;se++)ta(d,x[se],z,j);return this}function fn(d,x){for(var z in d[Xi]){var j=z.split(/\d/)[0];(!x||x(j))&&ta(d,j,null,null,z)}}var Oa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Bn(d,x,z,j){var Y=x+k(z)+(j?"_"+k(j):"");if(d[Xi]&&d[Xi][Y])return this;var se=function(Ue){return z.call(j||d,Ue||window.event)},Ae=se;!et.touchNative&&et.pointer&&x.indexOf("touch")===0?se=Bc(d,x,se):et.touch&&x==="dblclick"?se=da(d,se):"addEventListener"in d?x==="touchstart"||x==="touchmove"||x==="wheel"||x==="mousewheel"?d.addEventListener(Oa[x]||x,se,et.passiveEvents?{passive:!1}:!1):x==="mouseenter"||x==="mouseleave"?(se=function(Ue){Ue=Ue||window.event,ia(d,Ue)&&Ae(Ue)},d.addEventListener(Oa[x],se,!1)):d.addEventListener(x,Ae,!1):d.attachEvent("on"+x,se),d[Xi]=d[Xi]||{},d[Xi][Y]=se}function ta(d,x,z,j,Y){Y=Y||x+k(z)+(j?"_"+k(j):"");var se=d[Xi]&&d[Xi][Y];if(!se)return this;!et.touchNative&&et.pointer&&x.indexOf("touch")===0?os(d,x,se):et.touch&&x==="dblclick"?Vi(d,se):"removeEventListener"in d?d.removeEventListener(Oa[x]||x,se,!1):d.detachEvent("on"+x,se),d[Xi][Y]=null}function Fn(d){return d.stopPropagation?d.stopPropagation():d.originalEvent?d.originalEvent._stopped=!0:d.cancelBubble=!0,this}function Ma(d){return Bn(d,"wheel",Fn),this}function Ba(d){return ii(d,"mousedown touchstart dblclick contextmenu",Fn),d._leaflet_disable_click=!0,this}function Ai(d){return d.preventDefault?d.preventDefault():d.returnValue=!1,this}function Fa(d){return Ai(d),Fn(d),this}function Na(d){if(d.composedPath)return d.composedPath();for(var x=[],z=d.target;z;)x.push(z),z=z.parentNode;return x}function el(d,x){if(!x)return new Mt(d.clientX,d.clientY);var z=Al(x),j=z.boundingClientRect;return new Mt((d.clientX-j.left)/z.x-x.clientLeft,(d.clientY-j.top)/z.y-x.clientTop)}var Ea=et.linux&&et.chrome?window.devicePixelRatio:et.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function pr(d){return et.edge?d.wheelDeltaY/2:d.deltaY&&d.deltaMode===0?-d.deltaY/Ea:d.deltaY&&d.deltaMode===1?-d.deltaY*20:d.deltaY&&d.deltaMode===2?-d.deltaY*60:d.deltaX||d.deltaZ?0:d.wheelDelta?(d.wheelDeltaY||d.wheelDelta)/2:d.detail&&Math.abs(d.detail)<32765?-d.detail*20:d.detail?d.detail/-32765*60:0}function ia(d,x){var z=x.relatedTarget;if(!z)return!0;try{for(;z&&z!==d;)z=z.parentNode}catch{return!1}return z!==d}var $u={__proto__:null,on:ii,off:Zt,stopPropagation:Fn,disableScrollPropagation:Ma,disableClickPropagation:Ba,preventDefault:Ai,stop:Fa,getPropagationPath:Na,getMousePosition:el,getWheelDelta:pr,isExternalTarget:ia,addListener:ii,removeListener:Zt},tl=Pt.extend({run:function(d,x,z,j){this.stop(),this._el=d,this._inProgress=!0,this._duration=z||.25,this._easeOutPower=1/Math.max(j||.5,.2),this._startPos=Js(d),this._offset=x.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=hi(this._animate,this),this._step()},_step:function(d){var x=+new Date-this._startTime,z=this._duration*1e3;x<z?this._runFrame(this._easeOut(x/z),d):(this._runFrame(1),this._complete())},_runFrame:function(d,x){var z=this._startPos.add(this._offset.multiplyBy(d));x&&z._round(),Pn(this._el,z),this.fire("step")},_complete:function(){li(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(d){return 1-Math.pow(1-d,this._easeOutPower)}}),Pi=Pt.extend({options:{crs:as,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(d,x){x=fe(this,x),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(d),this._initLayout(),this._onResize=w(this._onResize,this),this._initEvents(),x.maxBounds&&this.setMaxBounds(x.maxBounds),x.zoom!==void 0&&(this._zoom=this._limitZoom(x.zoom)),x.center&&x.zoom!==void 0&&this.setView(kt(x.center),x.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ls&&et.any3d&&!et.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ii(this._proxy,Sl,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(d,x,z){if(x=x===void 0?this._zoom:this._limitZoom(x),d=this._limitCenter(kt(d),x,this.options.maxBounds),z=z||{},this._stop(),this._loaded&&!z.reset&&z!==!0){z.animate!==void 0&&(z.zoom=S({animate:z.animate},z.zoom),z.pan=S({animate:z.animate,duration:z.duration},z.pan));var j=this._zoom!==x?this._tryAnimatedZoom&&this._tryAnimatedZoom(d,x,z.zoom):this._tryAnimatedPan(d,z.pan);if(j)return clearTimeout(this._sizeTimer),this}return this._resetView(d,x,z.pan&&z.pan.noMoveStart),this},setZoom:function(d,x){return this._loaded?this.setView(this.getCenter(),d,{zoom:x}):(this._zoom=d,this)},zoomIn:function(d,x){return d=d||(et.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+d,x)},zoomOut:function(d,x){return d=d||(et.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-d,x)},setZoomAround:function(d,x,z){var j=this.getZoomScale(x),Y=this.getSize().divideBy(2),se=d instanceof Mt?d:this.latLngToContainerPoint(d),Ae=se.subtract(Y).multiplyBy(1-1/j),Ue=this.containerPointToLatLng(Y.add(Ae));return this.setView(Ue,x,{zoom:z})},_getBoundsCenterZoom:function(d,x){x=x||{},d=d.getBounds?d.getBounds():zt(d);var z=Nt(x.paddingTopLeft||x.padding||[0,0]),j=Nt(x.paddingBottomRight||x.padding||[0,0]),Y=this.getBoundsZoom(d,!1,z.add(j));if(Y=typeof x.maxZoom=="number"?Math.min(x.maxZoom,Y):Y,Y===1/0)return{center:d.getCenter(),zoom:Y};var se=j.subtract(z).divideBy(2),Ae=this.project(d.getSouthWest(),Y),Ue=this.project(d.getNorthEast(),Y),ot=this.unproject(Ae.add(Ue).divideBy(2).add(se),Y);return{center:ot,zoom:Y}},fitBounds:function(d,x){if(d=zt(d),!d.isValid())throw new Error("Bounds are not valid.");var z=this._getBoundsCenterZoom(d,x);return this.setView(z.center,z.zoom,x)},fitWorld:function(d){return this.fitBounds([[-90,-180],[90,180]],d)},panTo:function(d,x){return this.setView(d,this._zoom,{pan:x})},panBy:function(d,x){if(d=Nt(d).round(),x=x||{},!d.x&&!d.y)return this.fire("moveend");if(x.animate!==!0&&!this.getSize().contains(d))return this._resetView(this.unproject(this.project(this.getCenter()).add(d)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new tl,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),x.noMoveStart||this.fire("movestart"),x.animate!==!1){Ti(this._mapPane,"leaflet-pan-anim");var z=this._getMapPanePos().subtract(d).round();this._panAnim.run(this._mapPane,z,x.duration||.25,x.easeLinearity)}else this._rawPanBy(d),this.fire("move").fire("moveend");return this},flyTo:function(d,x,z){if(z=z||{},z.animate===!1||!et.any3d)return this.setView(d,x,z);this._stop();var j=this.project(this.getCenter()),Y=this.project(d),se=this.getSize(),Ae=this._zoom;d=kt(d),x=x===void 0?Ae:x;var Ue=Math.max(se.x,se.y),ot=Ue*this.getZoomScale(Ae,x),Tt=Y.distanceTo(j)||1,jt=1.42,ui=jt*jt;function zi(Zn){var lo=Zn?-1:1,ps=Zn?ot:Ue,ms=ot*ot-Ue*Ue+lo*ui*ui*Tt*Tt,Rs=2*ps*ui*Tt,Xo=ms/Rs,uo=Math.sqrt(Xo*Xo+1)-Xo,gs=uo<1e-9?-18:Math.log(uo);return gs}function mr(Zn){return(Math.exp(Zn)-Math.exp(-Zn))/2}function Kn(Zn){return(Math.exp(Zn)+Math.exp(-Zn))/2}function $a(Zn){return mr(Zn)/Kn(Zn)}var cn=zi(0);function Wi(Zn){return Ue*(Kn(cn)/Kn(cn+jt*Zn))}function Ri(Zn){return Ue*(Kn(cn)*$a(cn+jt*Zn)-mr(cn))/ui}function Ds(Zn){return 1-Math.pow(1-Zn,1.5)}var so=Date.now(),Nn=(zi(1)-cn)/jt,Ha=z.duration?1e3*z.duration:1e3*Nn*.8;function Xa(){var Zn=(Date.now()-so)/Ha,lo=Ds(Zn)*Nn;Zn<=1?(this._flyToFrame=hi(Xa,this),this._move(this.unproject(j.add(Y.subtract(j).multiplyBy(Ri(lo)/Tt)),Ae),this.getScaleZoom(Ue/Wi(lo),Ae),{flyTo:!0})):this._move(d,x)._moveEnd(!0)}return this._moveStart(!0,z.noMoveStart),Xa.call(this),this},flyToBounds:function(d,x){var z=this._getBoundsCenterZoom(d,x);return this.flyTo(z.center,z.zoom,x)},setMaxBounds:function(d){return d=zt(d),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),d.isValid()?(this.options.maxBounds=d,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(d){var x=this.options.minZoom;return this.options.minZoom=d,this._loaded&&x!==d&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(d):this},setMaxZoom:function(d){var x=this.options.maxZoom;return this.options.maxZoom=d,this._loaded&&x!==d&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(d):this},panInsideBounds:function(d,x){this._enforcingBounds=!0;var z=this.getCenter(),j=this._limitCenter(z,this._zoom,zt(d));return z.equals(j)||this.panTo(j,x),this._enforcingBounds=!1,this},panInside:function(d,x){x=x||{};var z=Nt(x.paddingTopLeft||x.padding||[0,0]),j=Nt(x.paddingBottomRight||x.padding||[0,0]),Y=this.project(this.getCenter()),se=this.project(d),Ae=this.getPixelBounds(),Ue=dt([Ae.min.add(z),Ae.max.subtract(j)]),ot=Ue.getSize();if(!Ue.contains(se)){this._enforcingBounds=!0;var Tt=se.subtract(Ue.getCenter()),jt=Ue.extend(se).getSize().subtract(ot);Y.x+=Tt.x<0?-jt.x:jt.x,Y.y+=Tt.y<0?-jt.y:jt.y,this.panTo(this.unproject(Y),x),this._enforcingBounds=!1}return this},invalidateSize:function(d){if(!this._loaded)return this;d=S({animate:!1,pan:!0},d===!0?{animate:!0}:d);var x=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var z=this.getSize(),j=x.divideBy(2).round(),Y=z.divideBy(2).round(),se=j.subtract(Y);return!se.x&&!se.y?this:(d.animate&&d.pan?this.panBy(se):(d.pan&&this._rawPanBy(se),this.fire("move"),d.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(w(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:x,newSize:z}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(d){if(d=this._locateOptions=S({timeout:1e4,watch:!1},d),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var x=w(this._handleGeolocationResponse,this),z=w(this._handleGeolocationError,this);return d.watch?this._locationWatchId=navigator.geolocation.watchPosition(x,z,d):navigator.geolocation.getCurrentPosition(x,z,d),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(d){if(this._container._leaflet_id){var x=d.code,z=d.message||(x===1?"permission denied":x===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:x,message:"Geolocation error: "+z+"."})}},_handleGeolocationResponse:function(d){if(this._container._leaflet_id){var x=d.coords.latitude,z=d.coords.longitude,j=new Dt(x,z),Y=j.toBounds(d.coords.accuracy*2),se=this._locateOptions;if(se.setView){var Ae=this.getBoundsZoom(Y);this.setView(j,se.maxZoom?Math.min(Ae,se.maxZoom):Ae)}var Ue={latlng:j,bounds:Y,timestamp:d.timestamp};for(var ot in d.coords)typeof d.coords[ot]=="number"&&(Ue[ot]=d.coords[ot]);this.fire("locationfound",Ue)}},addHandler:function(d,x){if(!x)return this;var z=this[d]=new x(this);return this._handlers.push(z),this.options[d]&&z.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),on(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(li(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var d;for(d in this._layers)this._layers[d].remove();for(d in this._panes)on(this._panes[d]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(d,x){var z="leaflet-pane"+(d?" leaflet-"+d.replace("Pane","")+"-pane":""),j=Gi("div",z,x||this._mapPane);return d&&(this._panes[d]=j),j},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var d=this.getPixelBounds(),x=this.unproject(d.getBottomLeft()),z=this.unproject(d.getTopRight());return new It(x,z)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(d,x,z){d=zt(d),z=Nt(z||[0,0]);var j=this.getZoom()||0,Y=this.getMinZoom(),se=this.getMaxZoom(),Ae=d.getNorthWest(),Ue=d.getSouthEast(),ot=this.getSize().subtract(z),Tt=dt(this.project(Ue,j),this.project(Ae,j)).getSize(),jt=et.any3d?this.options.zoomSnap:1,ui=ot.x/Tt.x,zi=ot.y/Tt.y,mr=x?Math.max(ui,zi):Math.min(ui,zi);return j=this.getScaleZoom(mr,j),jt&&(j=Math.round(j/(jt/100))*(jt/100),j=x?Math.ceil(j/jt)*jt:Math.floor(j/jt)*jt),Math.max(Y,Math.min(se,j))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Mt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(d,x){var z=this._getTopLeftPoint(d,x);return new ze(z,z.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(d){return this.options.crs.getProjectedBounds(d===void 0?this.getZoom():d)},getPane:function(d){return typeof d=="string"?this._panes[d]:d},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(d,x){var z=this.options.crs;return x=x===void 0?this._zoom:x,z.scale(d)/z.scale(x)},getScaleZoom:function(d,x){var z=this.options.crs;x=x===void 0?this._zoom:x;var j=z.zoom(d*z.scale(x));return isNaN(j)?1/0:j},project:function(d,x){return x=x===void 0?this._zoom:x,this.options.crs.latLngToPoint(kt(d),x)},unproject:function(d,x){return x=x===void 0?this._zoom:x,this.options.crs.pointToLatLng(Nt(d),x)},layerPointToLatLng:function(d){var x=Nt(d).add(this.getPixelOrigin());return this.unproject(x)},latLngToLayerPoint:function(d){var x=this.project(kt(d))._round();return x._subtract(this.getPixelOrigin())},wrapLatLng:function(d){return this.options.crs.wrapLatLng(kt(d))},wrapLatLngBounds:function(d){return this.options.crs.wrapLatLngBounds(zt(d))},distance:function(d,x){return this.options.crs.distance(kt(d),kt(x))},containerPointToLayerPoint:function(d){return Nt(d).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(d){return Nt(d).add(this._getMapPanePos())},containerPointToLatLng:function(d){var x=this.containerPointToLayerPoint(Nt(d));return this.layerPointToLatLng(x)},latLngToContainerPoint:function(d){return this.layerPointToContainerPoint(this.latLngToLayerPoint(kt(d)))},mouseEventToContainerPoint:function(d){return el(d,this._container)},mouseEventToLayerPoint:function(d){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(d))},mouseEventToLatLng:function(d){return this.layerPointToLatLng(this.mouseEventToLayerPoint(d))},_initContainer:function(d){var x=this._container=Ss(d);if(x){if(x._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ii(x,"scroll",this._onScroll,this),this._containerId=k(x)},_initLayout:function(){var d=this._container;this._fadeAnimated=this.options.fadeAnimation&&et.any3d,Ti(d,"leaflet-container"+(et.touch?" leaflet-touch":"")+(et.retina?" leaflet-retina":"")+(et.ielt9?" leaflet-oldie":"")+(et.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var x=Ta(d,"position");x!=="absolute"&&x!=="relative"&&x!=="fixed"&&x!=="sticky"&&(d.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var d=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Pn(this._mapPane,new Mt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ti(d.markerPane,"leaflet-zoom-hide"),Ti(d.shadowPane,"leaflet-zoom-hide"))},_resetView:function(d,x,z){Pn(this._mapPane,new Mt(0,0));var j=!this._loaded;this._loaded=!0,x=this._limitZoom(x),this.fire("viewprereset");var Y=this._zoom!==x;this._moveStart(Y,z)._move(d,x)._moveEnd(Y),this.fire("viewreset"),j&&this.fire("load")},_moveStart:function(d,x){return d&&this.fire("zoomstart"),x||this.fire("movestart"),this},_move:function(d,x,z,j){x===void 0&&(x=this._zoom);var Y=this._zoom!==x;return this._zoom=x,this._lastCenter=d,this._pixelOrigin=this._getNewPixelOrigin(d),j?z&&z.pinch&&this.fire("zoom",z):((Y||z&&z.pinch)&&this.fire("zoom",z),this.fire("move",z)),this},_moveEnd:function(d){return d&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return li(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(d){Pn(this._mapPane,this._getMapPanePos().subtract(d))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(d){this._targets={},this._targets[k(this._container)]=this;var x=d?Zt:ii;x(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&x(window,"resize",this._onResize,this),et.any3d&&this.options.transform3DLimit&&(d?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){li(this._resizeRequest),this._resizeRequest=hi(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var d=this._getMapPanePos();Math.max(Math.abs(d.x),Math.abs(d.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(d,x){for(var z=[],j,Y=x==="mouseout"||x==="mouseover",se=d.target||d.srcElement,Ae=!1;se;){if(j=this._targets[k(se)],j&&(x==="click"||x==="preclick")&&this._draggableMoved(j)){Ae=!0;break}if(j&&j.listens(x,!0)&&(Y&&!ia(se,d)||(z.push(j),Y))||se===this._container)break;se=se.parentNode}return!z.length&&!Ae&&!Y&&this.listens(x,!0)&&(z=[this]),z},_isClickDisabled:function(d){for(;d&&d!==this._container;){if(d._leaflet_disable_click)return!0;d=d.parentNode}},_handleDOMEvent:function(d){var x=d.target||d.srcElement;if(!(!this._loaded||x._leaflet_disable_events||d.type==="click"&&this._isClickDisabled(x))){var z=d.type;z==="mousedown"&&xi(x),this._fireDOMEvent(d,z)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(d,x,z){if(d.type==="click"){var j=S({},d);j.type="preclick",this._fireDOMEvent(j,j.type,z)}var Y=this._findEventTargets(d,x);if(z){for(var se=[],Ae=0;Ae<z.length;Ae++)z[Ae].listens(x,!0)&&se.push(z[Ae]);Y=se.concat(Y)}if(Y.length){x==="contextmenu"&&Ai(d);var Ue=Y[0],ot={originalEvent:d};if(d.type!=="keypress"&&d.type!=="keydown"&&d.type!=="keyup"){var Tt=Ue.getLatLng&&(!Ue._radius||Ue._radius<=10);ot.containerPoint=Tt?this.latLngToContainerPoint(Ue.getLatLng()):this.mouseEventToContainerPoint(d),ot.layerPoint=this.containerPointToLayerPoint(ot.containerPoint),ot.latlng=Tt?Ue.getLatLng():this.layerPointToLatLng(ot.layerPoint)}for(Ae=0;Ae<Y.length;Ae++)if(Y[Ae].fire(x,ot,!0),ot.originalEvent._stopped||Y[Ae].options.bubblingMouseEvents===!1&&Be(this._mouseEvents,x)!==-1)return}},_draggableMoved:function(d){return d=d.dragging&&d.dragging.enabled()?d:this,d.dragging&&d.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var d=0,x=this._handlers.length;d<x;d++)this._handlers[d].disable()},whenReady:function(d,x){return this._loaded?d.call(x||this,{target:this}):this.on("load",d,x),this},_getMapPanePos:function(){return Js(this._mapPane)||new Mt(0,0)},_moved:function(){var d=this._getMapPanePos();return d&&!d.equals([0,0])},_getTopLeftPoint:function(d,x){var z=d&&x!==void 0?this._getNewPixelOrigin(d,x):this.getPixelOrigin();return z.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(d,x){var z=this.getSize()._divideBy(2);return this.project(d,x)._subtract(z)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(d,x,z){var j=this._getNewPixelOrigin(z,x);return this.project(d,x)._subtract(j)},_latLngBoundsToNewLayerBounds:function(d,x,z){var j=this._getNewPixelOrigin(z,x);return dt([this.project(d.getSouthWest(),x)._subtract(j),this.project(d.getNorthWest(),x)._subtract(j),this.project(d.getSouthEast(),x)._subtract(j),this.project(d.getNorthEast(),x)._subtract(j)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(d){return this.latLngToLayerPoint(d).subtract(this._getCenterLayerPoint())},_limitCenter:function(d,x,z){if(!z)return d;var j=this.project(d,x),Y=this.getSize().divideBy(2),se=new ze(j.subtract(Y),j.add(Y)),Ae=this._getBoundsOffset(se,z,x);return Math.abs(Ae.x)<=1&&Math.abs(Ae.y)<=1?d:this.unproject(j.add(Ae),x)},_limitOffset:function(d,x){if(!x)return d;var z=this.getPixelBounds(),j=new ze(z.min.add(d),z.max.add(d));return d.add(this._getBoundsOffset(j,x))},_getBoundsOffset:function(d,x,z){var j=dt(this.project(x.getNorthEast(),z),this.project(x.getSouthWest(),z)),Y=j.min.subtract(d.min),se=j.max.subtract(d.max),Ae=this._rebound(Y.x,-se.x),Ue=this._rebound(Y.y,-se.y);return new Mt(Ae,Ue)},_rebound:function(d,x){return d+x>0?Math.round(d-x)/2:Math.max(0,Math.ceil(d))-Math.max(0,Math.floor(x))},_limitZoom:function(d){var x=this.getMinZoom(),z=this.getMaxZoom(),j=et.any3d?this.options.zoomSnap:1;return j&&(d=Math.round(d/j)*j),Math.max(x,Math.min(z,d))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Yn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(d,x){var z=this._getCenterOffset(d)._trunc();return(x&&x.animate)!==!0&&!this.getSize().contains(z)?!1:(this.panBy(z,x),!0)},_createAnimProxy:function(){var d=this._proxy=Gi("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(d),this.on("zoomanim",function(x){var z=Fo,j=this._proxy.style[z];No(this._proxy,this.project(x.center,x.zoom),this.getZoomScale(x.zoom,1)),j===this._proxy.style[z]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){on(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var d=this.getCenter(),x=this.getZoom();No(this._proxy,this.project(d,x),this.getZoomScale(x,1))},_catchTransitionEnd:function(d){this._animatingZoom&&d.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(d,x,z){if(this._animatingZoom)return!0;if(z=z||{},!this._zoomAnimated||z.animate===!1||this._nothingToAnimate()||Math.abs(x-this._zoom)>this.options.zoomAnimationThreshold)return!1;var j=this.getZoomScale(x),Y=this._getCenterOffset(d)._divideBy(1-1/j);return z.animate!==!0&&!this.getSize().contains(Y)?!1:(hi(function(){this._moveStart(!0,z.noMoveStart||!1)._animateZoom(d,x,!0)},this),!0)},_animateZoom:function(d,x,z,j){this._mapPane&&(z&&(this._animatingZoom=!0,this._animateToCenter=d,this._animateToZoom=x,Ti(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:d,zoom:x,noUpdate:j}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(w(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Yn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function pn(d,x){return new Pi(d,x)}var kr=Ci.extend({options:{position:"topright"},initialize:function(d){fe(this,d)},getPosition:function(){return this.options.position},setPosition:function(d){var x=this._map;return x&&x.removeControl(this),this.options.position=d,x&&x.addControl(this),this},getContainer:function(){return this._container},addTo:function(d){this.remove(),this._map=d;var x=this._container=this.onAdd(d),z=this.getPosition(),j=d._controlCorners[z];return Ti(x,"leaflet-control"),z.indexOf("bottom")!==-1?j.insertBefore(x,j.firstChild):j.appendChild(x),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(on(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(d){this._map&&d&&d.screenX>0&&d.screenY>0&&this._map.getContainer().focus()}}),Mi=function(d){return new kr(d)};Pi.include({addControl:function(d){return d.addTo(this),this},removeControl:function(d){return d.remove(),this},_initControlPos:function(){var d=this._controlCorners={},x="leaflet-",z=this._controlContainer=Gi("div",x+"control-container",this._container);function j(Y,se){var Ae=x+Y+" "+x+se;d[Y+se]=Gi("div",Ae,z)}j("top","left"),j("top","right"),j("bottom","left"),j("bottom","right")},_clearControlPos:function(){for(var d in this._controlCorners)on(this._controlCorners[d]);on(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var vi=kr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(d,x,z,j){return z<j?-1:j<z?1:0}},initialize:function(d,x,z){fe(this,z),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var j in d)this._addLayer(d[j],j);for(j in x)this._addLayer(x[j],j,!0)},onAdd:function(d){this._initLayout(),this._update(),this._map=d,d.on("zoomend",this._checkDisabledLayers,this);for(var x=0;x<this._layers.length;x++)this._layers[x].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(d){return kr.prototype.addTo.call(this,d),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(d,x){return this._addLayer(d,x),this._map?this._update():this},addOverlay:function(d,x){return this._addLayer(d,x,!0),this._map?this._update():this},removeLayer:function(d){d.off("add remove",this._onLayerChange,this);var x=this._getLayer(k(d));return x&&this._layers.splice(this._layers.indexOf(x),1),this._map?this._update():this},expand:function(){Ti(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var d=this._map.getSize().y-(this._container.offsetTop+50);return d<this._section.clientHeight?(Ti(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=d+"px"):Yn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Yn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var d="leaflet-control-layers",x=this._container=Gi("div",d),z=this.options.collapsed;x.setAttribute("aria-haspopup",!0),Ba(x),Ma(x);var j=this._section=Gi("section",d+"-list");z&&(this._map.on("click",this.collapse,this),ii(x,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Y=this._layersLink=Gi("a",d+"-toggle",x);Y.href="#",Y.title="Layers",Y.setAttribute("role","button"),ii(Y,{keydown:function(se){se.keyCode===13&&this._expandSafely()},click:function(se){Ai(se),this._expandSafely()}},this),z||this.expand(),this._baseLayersList=Gi("div",d+"-base",j),this._separator=Gi("div",d+"-separator",j),this._overlaysList=Gi("div",d+"-overlays",j),x.appendChild(j)},_getLayer:function(d){for(var x=0;x<this._layers.length;x++)if(this._layers[x]&&k(this._layers[x].layer)===d)return this._layers[x]},_addLayer:function(d,x,z){this._map&&d.on("add remove",this._onLayerChange,this),this._layers.push({layer:d,name:x,overlay:z}),this.options.sortLayers&&this._layers.sort(w(function(j,Y){return this.options.sortFunction(j.layer,Y.layer,j.name,Y.name)},this)),this.options.autoZIndex&&d.setZIndex&&(this._lastZIndex++,d.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Sa(this._baseLayersList),Sa(this._overlaysList),this._layerControlInputs=[];var d,x,z,j,Y=0;for(z=0;z<this._layers.length;z++)j=this._layers[z],this._addItem(j),x=x||j.overlay,d=d||!j.overlay,Y+=j.overlay?0:1;return this.options.hideSingleBase&&(d=d&&Y>1,this._baseLayersList.style.display=d?"":"none"),this._separator.style.display=x&&d?"":"none",this},_onLayerChange:function(d){this._handlingClick||this._update();var x=this._getLayer(k(d.target)),z=x.overlay?d.type==="add"?"overlayadd":"overlayremove":d.type==="add"?"baselayerchange":null;z&&this._map.fire(z,x)},_createRadioElement:function(d,x){var z='<input type="radio" class="leaflet-control-layers-selector" name="'+d+'"'+(x?' checked="checked"':"")+"/>",j=document.createElement("div");return j.innerHTML=z,j.firstChild},_addItem:function(d){var x=document.createElement("label"),z=this._map.hasLayer(d.layer),j;d.overlay?(j=document.createElement("input"),j.type="checkbox",j.className="leaflet-control-layers-selector",j.defaultChecked=z):j=this._createRadioElement("leaflet-base-layers_"+k(this),z),this._layerControlInputs.push(j),j.layerId=k(d.layer),ii(j,"click",this._onInputClick,this);var Y=document.createElement("span");Y.innerHTML=" "+d.name;var se=document.createElement("span");x.appendChild(se),se.appendChild(j),se.appendChild(Y);var Ae=d.overlay?this._overlaysList:this._baseLayersList;return Ae.appendChild(x),this._checkDisabledLayers(),x},_onInputClick:function(){if(!this._preventClick){var d=this._layerControlInputs,x,z,j=[],Y=[];this._handlingClick=!0;for(var se=d.length-1;se>=0;se--)x=d[se],z=this._getLayer(x.layerId).layer,x.checked?j.push(z):x.checked||Y.push(z);for(se=0;se<Y.length;se++)this._map.hasLayer(Y[se])&&this._map.removeLayer(Y[se]);for(se=0;se<j.length;se++)this._map.hasLayer(j[se])||this._map.addLayer(j[se]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var d=this._layerControlInputs,x,z,j=this._map.getZoom(),Y=d.length-1;Y>=0;Y--)x=d[Y],z=this._getLayer(x.layerId).layer,x.disabled=z.options.minZoom!==void 0&&j<z.options.minZoom||z.options.maxZoom!==void 0&&j>z.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var d=this._section;this._preventClick=!0,ii(d,"click",Ai),this.expand();var x=this;setTimeout(function(){Zt(d,"click",Ai),x._preventClick=!1})}}),Cl=function(d,x,z){return new vi(d,x,z)},Di=kr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(d){var x="leaflet-control-zoom",z=Gi("div",x+" leaflet-bar"),j=this.options;return this._zoomInButton=this._createButton(j.zoomInText,j.zoomInTitle,x+"-in",z,this._zoomIn),this._zoomOutButton=this._createButton(j.zoomOutText,j.zoomOutTitle,x+"-out",z,this._zoomOut),this._updateDisabled(),d.on("zoomend zoomlevelschange",this._updateDisabled,this),z},onRemove:function(d){d.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(d){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(d.shiftKey?3:1))},_zoomOut:function(d){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(d.shiftKey?3:1))},_createButton:function(d,x,z,j,Y){var se=Gi("a",z,j);return se.innerHTML=d,se.href="#",se.title=x,se.setAttribute("role","button"),se.setAttribute("aria-label",x),Ba(se),ii(se,"click",Fa),ii(se,"click",Y,this),ii(se,"click",this._refocusOnMap,this),se},_updateDisabled:function(){var d=this._map,x="leaflet-disabled";Yn(this._zoomInButton,x),Yn(this._zoomOutButton,x),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||d._zoom===d.getMinZoom())&&(Ti(this._zoomOutButton,x),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||d._zoom===d.getMaxZoom())&&(Ti(this._zoomInButton,x),this._zoomInButton.setAttribute("aria-disabled","true"))}});Pi.mergeOptions({zoomControl:!0}),Pi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Di,this.addControl(this.zoomControl))});var Hu=function(d){return new Di(d)},oo=kr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(d){var x="leaflet-control-scale",z=Gi("div",x),j=this.options;return this._addScales(j,x+"-line",z),d.on(j.updateWhenIdle?"moveend":"move",this._update,this),d.whenReady(this._update,this),z},onRemove:function(d){d.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(d,x,z){d.metric&&(this._mScale=Gi("div",x,z)),d.imperial&&(this._iScale=Gi("div",x,z))},_update:function(){var d=this._map,x=d.getSize().y/2,z=d.distance(d.containerPointToLatLng([0,x]),d.containerPointToLatLng([this.options.maxWidth,x]));this._updateScales(z)},_updateScales:function(d){this.options.metric&&d&&this._updateMetric(d),this.options.imperial&&d&&this._updateImperial(d)},_updateMetric:function(d){var x=this._getRoundNum(d),z=x<1e3?x+" m":x/1e3+" km";this._updateScale(this._mScale,z,x/d)},_updateImperial:function(d){var x=d*3.2808399,z,j,Y;x>5280?(z=x/5280,j=this._getRoundNum(z),this._updateScale(this._iScale,j+" mi",j/z)):(Y=this._getRoundNum(x),this._updateScale(this._iScale,Y+" ft",Y/x))},_updateScale:function(d,x,z){d.style.width=Math.round(this.options.maxWidth*z)+"px",d.innerHTML=x},_getRoundNum:function(d){var x=Math.pow(10,(Math.floor(d)+"").length-1),z=d/x;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:1,x*z}}),il=function(d){return new oo(d)},nl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Uc=kr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(et.inlineSvg?nl+" ":"")+"Leaflet</a>"},initialize:function(d){fe(this,d),this._attributions={}},onAdd:function(d){d.attributionControl=this,this._container=Gi("div","leaflet-control-attribution"),Ba(this._container);for(var x in d._layers)d._layers[x].getAttribution&&this.addAttribution(d._layers[x].getAttribution());return this._update(),d.on("layeradd",this._addAttribution,this),this._container},onRemove:function(d){d.off("layeradd",this._addAttribution,this)},_addAttribution:function(d){d.layer.getAttribution&&(this.addAttribution(d.layer.getAttribution()),d.layer.once("remove",function(){this.removeAttribution(d.layer.getAttribution())},this))},setPrefix:function(d){return this.options.prefix=d,this._update(),this},addAttribution:function(d){return d?(this._attributions[d]||(this._attributions[d]=0),this._attributions[d]++,this._update(),this):this},removeAttribution:function(d){return d?(this._attributions[d]&&(this._attributions[d]--,this._update()),this):this},_update:function(){if(this._map){var d=[];for(var x in this._attributions)this._attributions[x]&&d.push(x);var z=[];this.options.prefix&&z.push(this.options.prefix),d.length&&z.push(d.join(", ")),this._container.innerHTML=z.join(' <span aria-hidden="true">|</span> ')}}});Pi.mergeOptions({attributionControl:!0}),Pi.addInitHook(function(){this.options.attributionControl&&new Uc().addTo(this)});var Xu=function(d){return new Uc(d)};kr.Layers=vi,kr.Zoom=Di,kr.Scale=oo,kr.Attribution=Uc,Mi.layers=Cl,Mi.zoom=Hu,Mi.scale=il,Mi.attribution=Xu;var xo=Ci.extend({initialize:function(d){this._map=d},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});xo.addTo=function(d,x){return d.addHandler(x,this),this};var vf={Events:lt},Vc=et.touch?"touchstart mousedown":"mousedown",rr=Pt.extend({options:{clickTolerance:3},initialize:function(d,x,z,j){fe(this,j),this._element=d,this._dragStartTarget=x||d,this._preventOutline=z},enable:function(){this._enabled||(ii(this._dragStartTarget,Vc,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(rr._dragging===this&&this.finishDrag(!0),Zt(this._dragStartTarget,Vc,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(d){if(this._enabled&&(this._moved=!1,!Fc(this._element,"leaflet-zoom-anim"))){if(d.touches&&d.touches.length!==1){rr._dragging===this&&this.finishDrag();return}if(!(rr._dragging||d.shiftKey||d.which!==1&&d.button!==1&&!d.touches)&&(rr._dragging=this,this._preventOutline&&xi(this._element),pu(),us(),!this._moving)){this.fire("down");var x=d.touches?d.touches[0]:d,z=jc(this._element);this._startPoint=new Mt(x.clientX,x.clientY),this._startPos=Js(this._element),this._parentScale=Al(z);var j=d.type==="mousedown";ii(document,j?"mousemove":"touchmove",this._onMove,this),ii(document,j?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(d){if(this._enabled){if(d.touches&&d.touches.length>1){this._moved=!0;return}var x=d.touches&&d.touches.length===1?d.touches[0]:d,z=new Mt(x.clientX,x.clientY)._subtract(this._startPoint);!z.x&&!z.y||Math.abs(z.x)+Math.abs(z.y)<this.options.clickTolerance||(z.x/=this._parentScale.x,z.y/=this._parentScale.y,Ai(d),this._moved||(this.fire("dragstart"),this._moved=!0,Ti(document.body,"leaflet-dragging"),this._lastTarget=d.target||d.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ti(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(z),this._moving=!0,this._lastEvent=d,this._updatePosition())}},_updatePosition:function(){var d={originalEvent:this._lastEvent};this.fire("predrag",d),Pn(this._element,this._newPos),this.fire("drag",d)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(d){Yn(document.body,"leaflet-dragging"),this._lastTarget&&(Yn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Zt(document,"mousemove touchmove",this._onMove,this),Zt(document,"mouseup touchend touchcancel",this._onUp,this),Ms(),ao();var x=this._moved&&this._moving;this._moving=!1,rr._dragging=!1,x&&this.fire("dragend",{noInertia:d,distance:this._newPos.distanceTo(this._startPos)})}});function Vo(d,x,z){var j,Y=[1,4,2,8],se,Ae,Ue,ot,Tt,jt,ui,zi;for(se=0,jt=d.length;se<jt;se++)d[se]._code=Cs(d[se],x);for(Ue=0;Ue<4;Ue++){for(ui=Y[Ue],j=[],se=0,jt=d.length,Ae=jt-1;se<jt;Ae=se++)ot=d[se],Tt=d[Ae],ot._code&ui?Tt._code&ui||(zi=As(Tt,ot,ui,x,z),zi._code=Cs(zi,x),j.push(zi)):(Tt._code&ui&&(zi=As(Tt,ot,ui,x,z),zi._code=Cs(zi,x),j.push(zi)),j.push(ot));d=j}return d}function On(d,x){var z,j,Y,se,Ae,Ue,ot,Tt,jt;if(!d||d.length===0)throw new Error("latlngs not passed");na(d)||(console.warn("latlngs are not flat! Only the first ring will be used"),d=d[0]);var ui=kt([0,0]),zi=zt(d),mr=zi.getNorthWest().distanceTo(zi.getSouthWest())*zi.getNorthEast().distanceTo(zi.getNorthWest());mr<1700&&(ui=Es(d));var Kn=d.length,$a=[];for(z=0;z<Kn;z++){var cn=kt(d[z]);$a.push(x.project(kt([cn.lat-ui.lat,cn.lng-ui.lng])))}for(Ue=ot=Tt=0,z=0,j=Kn-1;z<Kn;j=z++)Y=$a[z],se=$a[j],Ae=Y.y*se.x-se.y*Y.x,ot+=(Y.x+se.x)*Ae,Tt+=(Y.y+se.y)*Ae,Ue+=Ae*3;Ue===0?jt=$a[0]:jt=[ot/Ue,Tt/Ue];var Wi=x.unproject(Nt(jt));return kt([Wi.lat+ui.lat,Wi.lng+ui.lng])}function Es(d){for(var x=0,z=0,j=0,Y=0;Y<d.length;Y++){var se=kt(d[Y]);x+=se.lat,z+=se.lng,j++}return kt([x/j,z/j])}var Yu={__proto__:null,clipPolygon:Vo,polygonCenter:On,centroid:Es};function mu(d,x){if(!x||!d.length)return d.slice();var z=x*x;return d=bf(d,z),d=Gc(d,z),d}function Gn(d,x,z){return Math.sqrt(cs(d,x,z,!0))}function pd(d,x,z){return cs(d,x,z)}function Gc(d,x){var z=d.length,j=typeof Uint8Array<"u"?Uint8Array:Array,Y=new j(z);Y[0]=Y[z-1]=1,Zc(d,Y,x,0,z-1);var se,Ae=[];for(se=0;se<z;se++)Y[se]&&Ae.push(d[se]);return Ae}function Zc(d,x,z,j,Y){var se=0,Ae,Ue,ot;for(Ue=j+1;Ue<=Y-1;Ue++)ot=cs(d[Ue],d[j],d[Y],!0),ot>se&&(Ae=Ue,se=ot);se>z&&(x[Ae]=1,Zc(d,x,z,j,Ae),Zc(d,x,z,Ae,Y))}function bf(d,x){for(var z=[d[0]],j=1,Y=0,se=d.length;j<se;j++)Ku(d[j],d[Y])>x&&(z.push(d[j]),Y=j);return Y<se-1&&z.push(d[se-1]),z}var Pl;function Wu(d,x,z,j,Y){var se=j?Pl:Cs(d,z),Ae=Cs(x,z),Ue,ot,Tt;for(Pl=Ae;;){if(!(se|Ae))return[d,x];if(se&Ae)return!1;Ue=se||Ae,ot=As(d,x,Ue,z,Y),Tt=Cs(ot,z),Ue===se?(d=ot,se=Tt):(x=ot,Ae=Tt)}}function As(d,x,z,j,Y){var se=x.x-d.x,Ae=x.y-d.y,Ue=j.min,ot=j.max,Tt,jt;return z&8?(Tt=d.x+se*(ot.y-d.y)/Ae,jt=ot.y):z&4?(Tt=d.x+se*(Ue.y-d.y)/Ae,jt=Ue.y):z&2?(Tt=ot.x,jt=d.y+Ae*(ot.x-d.x)/se):z&1&&(Tt=Ue.x,jt=d.y+Ae*(Ue.x-d.x)/se),new Mt(Tt,jt,Y)}function Cs(d,x){var z=0;return d.x<x.min.x?z|=1:d.x>x.max.x&&(z|=2),d.y<x.min.y?z|=4:d.y>x.max.y&&(z|=8),z}function Ku(d,x){var z=x.x-d.x,j=x.y-d.y;return z*z+j*j}function cs(d,x,z,j){var Y=x.x,se=x.y,Ae=z.x-Y,Ue=z.y-se,ot=Ae*Ae+Ue*Ue,Tt;return ot>0&&(Tt=((d.x-Y)*Ae+(d.y-se)*Ue)/ot,Tt>1?(Y=z.x,se=z.y):Tt>0&&(Y+=Ae*Tt,se+=Ue*Tt)),Ae=d.x-Y,Ue=d.y-se,j?Ae*Ae+Ue*Ue:new Mt(Y,se)}function na(d){return!Ne(d[0])||typeof d[0][0]!="object"&&typeof d[0][0]<"u"}function Wn(d){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),na(d)}function zl(d,x){var z,j,Y,se,Ae,Ue,ot,Tt;if(!d||d.length===0)throw new Error("latlngs not passed");na(d)||(console.warn("latlngs are not flat! Only the first ring will be used"),d=d[0]);var jt=kt([0,0]),ui=zt(d),zi=ui.getNorthWest().distanceTo(ui.getSouthWest())*ui.getNorthEast().distanceTo(ui.getNorthWest());zi<1700&&(jt=Es(d));var mr=d.length,Kn=[];for(z=0;z<mr;z++){var $a=kt(d[z]);Kn.push(x.project(kt([$a.lat-jt.lat,$a.lng-jt.lng])))}for(z=0,j=0;z<mr-1;z++)j+=Kn[z].distanceTo(Kn[z+1])/2;if(j===0)Tt=Kn[0];else for(z=0,se=0;z<mr-1;z++)if(Ae=Kn[z],Ue=Kn[z+1],Y=Ae.distanceTo(Ue),se+=Y,se>j){ot=(se-j)/Y,Tt=[Ue.x-ot*(Ue.x-Ae.x),Ue.y-ot*(Ue.y-Ae.y)];break}var cn=x.unproject(Nt(Tt));return kt([cn.lat+jt.lat,cn.lng+jt.lng])}var gu={__proto__:null,simplify:mu,pointToSegmentDistance:Gn,closestPointOnSegment:pd,clipSegment:Wu,_getEdgeIntersection:As,_getBitCode:Cs,_sqClosestPointOnSegment:cs,isFlat:na,_flat:Wn,polylineCenter:zl},rl={project:function(d){return new Mt(d.lng,d.lat)},unproject:function(d){return new Dt(d.y,d.x)},bounds:new ze([-180,-90],[180,90])},hs={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ze([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(d){var x=Math.PI/180,z=this.R,j=d.lat*x,Y=this.R_MINOR/z,se=Math.sqrt(1-Y*Y),Ae=se*Math.sin(j),Ue=Math.tan(Math.PI/4-j/2)/Math.pow((1-Ae)/(1+Ae),se/2);return j=-z*Math.log(Math.max(Ue,1e-10)),new Mt(d.lng*x*z,j)},unproject:function(d){for(var x=180/Math.PI,z=this.R,j=this.R_MINOR/z,Y=Math.sqrt(1-j*j),se=Math.exp(-d.y/z),Ae=Math.PI/2-2*Math.atan(se),Ue=0,ot=.1,Tt;Ue<15&&Math.abs(ot)>1e-7;Ue++)Tt=Y*Math.sin(Ae),Tt=Math.pow((1-Tt)/(1+Tt),Y/2),ot=Math.PI/2-2*Math.atan(se*Tt)-Ae,Ae+=ot;return new Dt(Ae*x,d.x*x/z)}},md={__proto__:null,LonLat:rl,Mercator:hs,SphericalMercator:hr},Ju=S({},Ei,{code:"EPSG:3395",projection:hs,transformation:(function(){var d=.5/(Math.PI*hs.R);return Mr(d,.5,-d,.5)})()}),zh=S({},Ei,{code:"EPSG:4326",projection:rl,transformation:Mr(1/180,1,-1/180,.5)}),Go=S({},fi,{projection:rl,transformation:Mr(1,0,-1,0),scale:function(d){return Math.pow(2,d)},zoom:function(d){return Math.log(d)/Math.LN2},distance:function(d,x){var z=x.lng-d.lng,j=x.lat-d.lat;return Math.sqrt(z*z+j*j)},infinite:!0});fi.Earth=Ei,fi.EPSG3395=Ju,fi.EPSG3857=as,fi.EPSG900913=Rn,fi.EPSG4326=zh,fi.Simple=Go;var ja=Pt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(d){return d.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(d){return d&&d.removeLayer(this),this},getPane:function(d){return this._map.getPane(d?this.options[d]||d:this.options.pane)},addInteractiveTarget:function(d){return this._map._targets[k(d)]=this,this},removeInteractiveTarget:function(d){return delete this._map._targets[k(d)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(d){var x=d.target;if(x.hasLayer(this)){if(this._map=x,this._zoomAnimated=x._zoomAnimated,this.getEvents){var z=this.getEvents();x.on(z,this),this.once("remove",function(){x.off(z,this)},this)}this.onAdd(x),this.fire("add"),x.fire("layeradd",{layer:this})}}});Pi.include({addLayer:function(d){if(!d._layerAdd)throw new Error("The provided object is not a Layer.");var x=k(d);return this._layers[x]?this:(this._layers[x]=d,d._mapToAdd=this,d.beforeAdd&&d.beforeAdd(this),this.whenReady(d._layerAdd,d),this)},removeLayer:function(d){var x=k(d);return this._layers[x]?(this._loaded&&d.onRemove(this),delete this._layers[x],this._loaded&&(this.fire("layerremove",{layer:d}),d.fire("remove")),d._map=d._mapToAdd=null,this):this},hasLayer:function(d){return k(d)in this._layers},eachLayer:function(d,x){for(var z in this._layers)d.call(x,this._layers[z]);return this},_addLayers:function(d){d=d?Ne(d)?d:[d]:[];for(var x=0,z=d.length;x<z;x++)this.addLayer(d[x])},_addZoomLimit:function(d){(!isNaN(d.options.maxZoom)||!isNaN(d.options.minZoom))&&(this._zoomBoundLayers[k(d)]=d,this._updateZoomLevels())},_removeZoomLimit:function(d){var x=k(d);this._zoomBoundLayers[x]&&(delete this._zoomBoundLayers[x],this._updateZoomLevels())},_updateZoomLevels:function(){var d=1/0,x=-1/0,z=this._getZoomSpan();for(var j in this._zoomBoundLayers){var Y=this._zoomBoundLayers[j].options;d=Y.minZoom===void 0?d:Math.min(d,Y.minZoom),x=Y.maxZoom===void 0?x:Math.max(x,Y.maxZoom)}this._layersMaxZoom=x===-1/0?void 0:x,this._layersMinZoom=d===1/0?void 0:d,z!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Il=ja.extend({initialize:function(d,x){fe(this,x),this._layers={};var z,j;if(d)for(z=0,j=d.length;z<j;z++)this.addLayer(d[z])},addLayer:function(d){var x=this.getLayerId(d);return this._layers[x]=d,this._map&&this._map.addLayer(d),this},removeLayer:function(d){var x=d in this._layers?d:this.getLayerId(d);return this._map&&this._layers[x]&&this._map.removeLayer(this._layers[x]),delete this._layers[x],this},hasLayer:function(d){var x=typeof d=="number"?d:this.getLayerId(d);return x in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(d){var x=Array.prototype.slice.call(arguments,1),z,j;for(z in this._layers)j=this._layers[z],j[d]&&j[d].apply(j,x);return this},onAdd:function(d){this.eachLayer(d.addLayer,d)},onRemove:function(d){this.eachLayer(d.removeLayer,d)},eachLayer:function(d,x){for(var z in this._layers)d.call(x,this._layers[z]);return this},getLayer:function(d){return this._layers[d]},getLayers:function(){var d=[];return this.eachLayer(d.push,d),d},setZIndex:function(d){return this.invoke("setZIndex",d)},getLayerId:function(d){return k(d)}}),gd=function(d,x){return new Il(d,x)},wo=Il.extend({addLayer:function(d){return this.hasLayer(d)?this:(d.addEventParent(this),Il.prototype.addLayer.call(this,d),this.fire("layeradd",{layer:d}))},removeLayer:function(d){return this.hasLayer(d)?(d in this._layers&&(d=this._layers[d]),d.removeEventParent(this),Il.prototype.removeLayer.call(this,d),this.fire("layerremove",{layer:d})):this},setStyle:function(d){return this.invoke("setStyle",d)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var d=new It;for(var x in this._layers){var z=this._layers[x];d.extend(z.getBounds?z.getBounds():z.getLatLng())}return d}}),qc=function(d,x){return new wo(d,x)},To=Ci.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(d){fe(this,d)},createIcon:function(d){return this._createIcon("icon",d)},createShadow:function(d){return this._createIcon("shadow",d)},_createIcon:function(d,x){var z=this._getIconUrl(d);if(!z){if(d==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var j=this._createImg(z,x&&x.tagName==="IMG"?x:null);return this._setIconStyles(j,d),(this.options.crossOrigin||this.options.crossOrigin==="")&&(j.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),j},_setIconStyles:function(d,x){var z=this.options,j=z[x+"Size"];typeof j=="number"&&(j=[j,j]);var Y=Nt(j),se=Nt(x==="shadow"&&z.shadowAnchor||z.iconAnchor||Y&&Y.divideBy(2,!0));d.className="leaflet-marker-"+x+" "+(z.className||""),se&&(d.style.marginLeft=-se.x+"px",d.style.marginTop=-se.y+"px"),Y&&(d.style.width=Y.x+"px",d.style.height=Y.y+"px")},_createImg:function(d,x){return x=x||document.createElement("img"),x.src=d,x},_getIconUrl:function(d){return et.retina&&this.options[d+"RetinaUrl"]||this.options[d+"Url"]}});function yu(d){return new To(d)}var _u=To.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(d){return typeof _u.imagePath!="string"&&(_u.imagePath=this._detectIconPath()),(this.options.imagePath||_u.imagePath)+To.prototype._getIconUrl.call(this,d)},_stripUrl:function(d){var x=function(z,j,Y){var se=j.exec(z);return se&&se[Y]};return d=x(d,/^url\((['"])?(.+)\1\)$/,2),d&&x(d,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var d=Gi("div","leaflet-default-icon-path",document.body),x=Ta(d,"background-image")||Ta(d,"backgroundImage");if(document.body.removeChild(d),x=this._stripUrl(x),x)return x;var z=document.querySelector('link[href$="leaflet.css"]');return z?z.href.substring(0,z.href.length-11-1):""}}),vu=xo.extend({initialize:function(d){this._marker=d},addHooks:function(){var d=this._marker._icon;this._draggable||(this._draggable=new rr(d,d,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ti(d,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Yn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(d){var x=this._marker,z=x._map,j=this._marker.options.autoPanSpeed,Y=this._marker.options.autoPanPadding,se=Js(x._icon),Ae=z.getPixelBounds(),Ue=z.getPixelOrigin(),ot=dt(Ae.min._subtract(Ue).add(Y),Ae.max._subtract(Ue).subtract(Y));if(!ot.contains(se)){var Tt=Nt((Math.max(ot.max.x,se.x)-ot.max.x)/(Ae.max.x-ot.max.x)-(Math.min(ot.min.x,se.x)-ot.min.x)/(Ae.min.x-ot.min.x),(Math.max(ot.max.y,se.y)-ot.max.y)/(Ae.max.y-ot.max.y)-(Math.min(ot.min.y,se.y)-ot.min.y)/(Ae.min.y-ot.min.y)).multiplyBy(j);z.panBy(Tt,{animate:!1}),this._draggable._newPos._add(Tt),this._draggable._startPos._add(Tt),Pn(x._icon,this._draggable._newPos),this._onDrag(d),this._panRequest=hi(this._adjustPan.bind(this,d))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(d){this._marker.options.autoPan&&(li(this._panRequest),this._panRequest=hi(this._adjustPan.bind(this,d)))},_onDrag:function(d){var x=this._marker,z=x._shadow,j=Js(x._icon),Y=x._map.layerPointToLatLng(j);z&&Pn(z,j),x._latlng=Y,d.latlng=Y,d.oldLatLng=this._oldLatLng,x.fire("move",d).fire("drag",d)},_onDragEnd:function(d){li(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",d)}}),Zo=ja.extend({options:{icon:new _u,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(d,x){fe(this,x),this._latlng=kt(d)},onAdd:function(d){this._zoomAnimated=this._zoomAnimated&&d.options.markerZoomAnimation,this._zoomAnimated&&d.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(d){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&d.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(d){var x=this._latlng;return this._latlng=kt(d),this.update(),this.fire("move",{oldLatLng:x,latlng:this._latlng})},setZIndexOffset:function(d){return this.options.zIndexOffset=d,this.update()},getIcon:function(){return this.options.icon},setIcon:function(d){return this.options.icon=d,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var d=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(d)}return this},_initIcon:function(){var d=this.options,x="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),z=d.icon.createIcon(this._icon),j=!1;z!==this._icon&&(this._icon&&this._removeIcon(),j=!0,d.title&&(z.title=d.title),z.tagName==="IMG"&&(z.alt=d.alt||"")),Ti(z,x),d.keyboard&&(z.tabIndex="0",z.setAttribute("role","button")),this._icon=z,d.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ii(z,"focus",this._panOnFocus,this);var Y=d.icon.createShadow(this._shadow),se=!1;Y!==this._shadow&&(this._removeShadow(),se=!0),Y&&(Ti(Y,x),Y.alt=""),this._shadow=Y,d.opacity<1&&this._updateOpacity(),j&&this.getPane().appendChild(this._icon),this._initInteraction(),Y&&se&&this.getPane(d.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Zt(this._icon,"focus",this._panOnFocus,this),on(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&on(this._shadow),this._shadow=null},_setPos:function(d){this._icon&&Pn(this._icon,d),this._shadow&&Pn(this._shadow,d),this._zIndex=d.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(d){this._icon&&(this._icon.style.zIndex=this._zIndex+d)},_animateZoom:function(d){var x=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center).round();this._setPos(x)},_initInteraction:function(){if(this.options.interactive&&(Ti(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),vu)){var d=this.options.draggable;this.dragging&&(d=this.dragging.enabled(),this.dragging.disable()),this.dragging=new vu(this),d&&this.dragging.enable()}},setOpacity:function(d){return this.options.opacity=d,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var d=this.options.opacity;this._icon&&kn(this._icon,d),this._shadow&&kn(this._shadow,d)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var d=this._map;if(d){var x=this.options.icon.options,z=x.iconSize?Nt(x.iconSize):Nt(0,0),j=x.iconAnchor?Nt(x.iconAnchor):Nt(0,0);d.panInside(this._latlng,{paddingTopLeft:j,paddingBottomRight:z.subtract(j)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Ih(d,x){return new Zo(d,x)}var So=ja.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(d){this._renderer=d.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(d){return fe(this,d),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&d&&Object.prototype.hasOwnProperty.call(d,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),qo=So.extend({options:{fill:!0,radius:10},initialize:function(d,x){fe(this,x),this._latlng=kt(d),this._radius=this.options.radius},setLatLng:function(d){var x=this._latlng;return this._latlng=kt(d),this.redraw(),this.fire("move",{oldLatLng:x,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(d){return this.options.radius=this._radius=d,this.redraw()},getRadius:function(){return this._radius},setStyle:function(d){var x=d&&d.radius||this._radius;return So.prototype.setStyle.call(this,d),this.setRadius(x),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var d=this._radius,x=this._radiusY||d,z=this._clickTolerance(),j=[d+z,x+z];this._pxBounds=new ze(this._point.subtract(j),this._point.add(j))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(d){return d.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Lh(d,x){return new qo(d,x)}var Ll=qo.extend({initialize:function(d,x,z){if(typeof x=="number"&&(x=S({},z,{radius:x})),fe(this,x),this._latlng=kt(d),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(d){return this._mRadius=d,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var d=[this._radius,this._radiusY||this._radius];return new It(this._map.layerPointToLatLng(this._point.subtract(d)),this._map.layerPointToLatLng(this._point.add(d)))},setStyle:So.prototype.setStyle,_project:function(){var d=this._latlng.lng,x=this._latlng.lat,z=this._map,j=z.options.crs;if(j.distance===Ei.distance){var Y=Math.PI/180,se=this._mRadius/Ei.R/Y,Ae=z.project([x+se,d]),Ue=z.project([x-se,d]),ot=Ae.add(Ue).divideBy(2),Tt=z.unproject(ot).lat,jt=Math.acos((Math.cos(se*Y)-Math.sin(x*Y)*Math.sin(Tt*Y))/(Math.cos(x*Y)*Math.cos(Tt*Y)))/Y;(isNaN(jt)||jt===0)&&(jt=se/Math.cos(Math.PI/180*x)),this._point=ot.subtract(z.getPixelOrigin()),this._radius=isNaN(jt)?0:ot.x-z.project([Tt,d-jt]).x,this._radiusY=ot.y-Ae.y}else{var ui=j.unproject(j.project(this._latlng).subtract([this._mRadius,0]));this._point=z.latLngToLayerPoint(this._latlng),this._radius=this._point.x-z.latLngToLayerPoint(ui).x}this._updateBounds()}});function yd(d,x,z){return new Ll(d,x,z)}var Ps=So.extend({options:{smoothFactor:1,noClip:!1},initialize:function(d,x){fe(this,x),this._setLatLngs(d)},getLatLngs:function(){return this._latlngs},setLatLngs:function(d){return this._setLatLngs(d),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(d){for(var x=1/0,z=null,j=cs,Y,se,Ae=0,Ue=this._parts.length;Ae<Ue;Ae++)for(var ot=this._parts[Ae],Tt=1,jt=ot.length;Tt<jt;Tt++){Y=ot[Tt-1],se=ot[Tt];var ui=j(d,Y,se,!0);ui<x&&(x=ui,z=j(d,Y,se))}return z&&(z.distance=Math.sqrt(x)),z},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return zl(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(d,x){return x=x||this._defaultShape(),d=kt(d),x.push(d),this._bounds.extend(d),this.redraw()},_setLatLngs:function(d){this._bounds=new It,this._latlngs=this._convertLatLngs(d)},_defaultShape:function(){return na(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(d){for(var x=[],z=na(d),j=0,Y=d.length;j<Y;j++)z?(x[j]=kt(d[j]),this._bounds.extend(x[j])):x[j]=this._convertLatLngs(d[j]);return x},_project:function(){var d=new ze;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,d),this._bounds.isValid()&&d.isValid()&&(this._rawPxBounds=d,this._updateBounds())},_updateBounds:function(){var d=this._clickTolerance(),x=new Mt(d,d);this._rawPxBounds&&(this._pxBounds=new ze([this._rawPxBounds.min.subtract(x),this._rawPxBounds.max.add(x)]))},_projectLatlngs:function(d,x,z){var j=d[0]instanceof Dt,Y=d.length,se,Ae;if(j){for(Ae=[],se=0;se<Y;se++)Ae[se]=this._map.latLngToLayerPoint(d[se]),z.extend(Ae[se]);x.push(Ae)}else for(se=0;se<Y;se++)this._projectLatlngs(d[se],x,z)},_clipPoints:function(){var d=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(d))){if(this.options.noClip){this._parts=this._rings;return}var x=this._parts,z,j,Y,se,Ae,Ue,ot;for(z=0,Y=0,se=this._rings.length;z<se;z++)for(ot=this._rings[z],j=0,Ae=ot.length;j<Ae-1;j++)Ue=Wu(ot[j],ot[j+1],d,j,!0),Ue&&(x[Y]=x[Y]||[],x[Y].push(Ue[0]),(Ue[1]!==ot[j+1]||j===Ae-2)&&(x[Y].push(Ue[1]),Y++))}},_simplifyPoints:function(){for(var d=this._parts,x=this.options.smoothFactor,z=0,j=d.length;z<j;z++)d[z]=mu(d[z],x)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(d,x){var z,j,Y,se,Ae,Ue,ot=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(d))return!1;for(z=0,se=this._parts.length;z<se;z++)for(Ue=this._parts[z],j=0,Ae=Ue.length,Y=Ae-1;j<Ae;Y=j++)if(!(!x&&j===0)&&Gn(d,Ue[Y],Ue[j])<=ot)return!0;return!1}});function _d(d,x){return new Ps(d,x)}Ps._flat=Wn;var ds=Ps.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return On(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(d){var x=Ps.prototype._convertLatLngs.call(this,d),z=x.length;return z>=2&&x[0]instanceof Dt&&x[0].equals(x[z-1])&&x.pop(),x},_setLatLngs:function(d){Ps.prototype._setLatLngs.call(this,d),na(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return na(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var d=this._renderer._bounds,x=this.options.weight,z=new Mt(x,x);if(d=new ze(d.min.subtract(z),d.max.add(z)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(d))){if(this.options.noClip){this._parts=this._rings;return}for(var j=0,Y=this._rings.length,se;j<Y;j++)se=Vo(this._rings[j],d,!0),se.length&&this._parts.push(se)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(d){var x=!1,z,j,Y,se,Ae,Ue,ot,Tt;if(!this._pxBounds||!this._pxBounds.contains(d))return!1;for(se=0,ot=this._parts.length;se<ot;se++)for(z=this._parts[se],Ae=0,Tt=z.length,Ue=Tt-1;Ae<Tt;Ue=Ae++)j=z[Ae],Y=z[Ue],j.y>d.y!=Y.y>d.y&&d.x<(Y.x-j.x)*(d.y-j.y)/(Y.y-j.y)+j.x&&(x=!x);return x||Ps.prototype._containsPoint.call(this,d,!0)}});function vd(d,x){return new ds(d,x)}var $o=wo.extend({initialize:function(d,x){fe(this,x),this._layers={},d&&this.addData(d)},addData:function(d){var x=Ne(d)?d:d.features,z,j,Y;if(x){for(z=0,j=x.length;z<j;z++)Y=x[z],(Y.geometries||Y.geometry||Y.features||Y.coordinates)&&this.addData(Y);return this}var se=this.options;if(se.filter&&!se.filter(d))return this;var Ae=ra(d,se);return Ae?(Ae.feature=Rl(d),Ae.defaultOptions=Ae.options,this.resetStyle(Ae),se.onEachFeature&&se.onEachFeature(d,Ae),this.addLayer(Ae)):this},resetStyle:function(d){return d===void 0?this.eachLayer(this.resetStyle,this):(d.options=S({},d.defaultOptions),this._setLayerStyle(d,this.options.style),this)},setStyle:function(d){return this.eachLayer(function(x){this._setLayerStyle(x,d)},this)},_setLayerStyle:function(d,x){d.setStyle&&(typeof x=="function"&&(x=x(d.feature)),d.setStyle(x))}});function ra(d,x){var z=d.type==="Feature"?d.geometry:d,j=z?z.coordinates:null,Y=[],se=x&&x.pointToLayer,Ae=x&&x.coordsToLatLng||Ua,Ue,ot,Tt,jt;if(!j&&!z)return null;switch(z.type){case"Point":return Ue=Ae(j),zs(se,d,Ue,x);case"MultiPoint":for(Tt=0,jt=j.length;Tt<jt;Tt++)Ue=Ae(j[Tt]),Y.push(zs(se,d,Ue,x));return new wo(Y);case"LineString":case"MultiLineString":return ot=al(j,z.type==="LineString"?0:1,Ae),new Ps(ot,x);case"Polygon":case"MultiPolygon":return ot=al(j,z.type==="Polygon"?1:2,Ae),new ds(ot,x);case"GeometryCollection":for(Tt=0,jt=z.geometries.length;Tt<jt;Tt++){var ui=ra({geometry:z.geometries[Tt],type:"Feature",properties:d.properties},x);ui&&Y.push(ui)}return new wo(Y);case"FeatureCollection":for(Tt=0,jt=z.features.length;Tt<jt;Tt++){var zi=ra(z.features[Tt],x);zi&&Y.push(zi)}return new wo(Y);default:throw new Error("Invalid GeoJSON object.")}}function zs(d,x,z,j){return d?d(x,z):new Zo(z,j&&j.markersInheritOptions&&j)}function Ua(d){return new Dt(d[1],d[0],d[2])}function al(d,x,z){for(var j=[],Y=0,se=d.length,Ae;Y<se;Y++)Ae=x?al(d[Y],x-1,z):(z||Ua)(d[Y]),j.push(Ae);return j}function bu(d,x){return d=kt(d),d.alt!==void 0?[ae(d.lng,x),ae(d.lat,x),ae(d.alt,x)]:[ae(d.lng,x),ae(d.lat,x)]}function Dl(d,x,z,j){for(var Y=[],se=0,Ae=d.length;se<Ae;se++)Y.push(x?Dl(d[se],na(d[se])?0:x-1,z,j):bu(d[se],j));return!x&&z&&Y.length>0&&Y.push(Y[0].slice()),Y}function fs(d,x){return d.feature?S({},d.feature,{geometry:x}):Rl(x)}function Rl(d){return d.type==="Feature"||d.type==="FeatureCollection"?d:{type:"Feature",properties:{},geometry:d}}var Va={toGeoJSON:function(d){return fs(this,{type:"Point",coordinates:bu(this.getLatLng(),d)})}};Zo.include(Va),Ll.include(Va),qo.include(Va),Ps.include({toGeoJSON:function(d){var x=!na(this._latlngs),z=Dl(this._latlngs,x?1:0,!1,d);return fs(this,{type:(x?"Multi":"")+"LineString",coordinates:z})}}),ds.include({toGeoJSON:function(d){var x=!na(this._latlngs),z=x&&!na(this._latlngs[0]),j=Dl(this._latlngs,z?2:x?1:0,!0,d);return x||(j=[j]),fs(this,{type:(z?"Multi":"")+"Polygon",coordinates:j})}}),Il.include({toMultiPoint:function(d){var x=[];return this.eachLayer(function(z){x.push(z.toGeoJSON(d).geometry.coordinates)}),fs(this,{type:"MultiPoint",coordinates:x})},toGeoJSON:function(d){var x=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(x==="MultiPoint")return this.toMultiPoint(d);var z=x==="GeometryCollection",j=[];return this.eachLayer(function(Y){if(Y.toGeoJSON){var se=Y.toGeoJSON(d);if(z)j.push(se.geometry);else{var Ae=Rl(se);Ae.type==="FeatureCollection"?j.push.apply(j,Ae.features):j.push(Ae)}}}),z?fs(this,{geometries:j,type:"GeometryCollection"}):{type:"FeatureCollection",features:j}}});function xu(d,x){return new $o(d,x)}var Qu=xu,kl=ja.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(d,x,z){this._url=d,this._bounds=zt(x),fe(this,z)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ti(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){on(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(d){return this.options.opacity=d,this._image&&this._updateOpacity(),this},setStyle:function(d){return d.opacity&&this.setOpacity(d.opacity),this},bringToFront:function(){return this._map&&Li(this._image),this},bringToBack:function(){return this._map&&Ks(this._image),this},setUrl:function(d){return this._url=d,this._image&&(this._image.src=d),this},setBounds:function(d){return this._bounds=zt(d),this._map&&this._reset(),this},getEvents:function(){var d={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},setZIndex:function(d){return this.options.zIndex=d,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var d=this._url.tagName==="IMG",x=this._image=d?this._url:Gi("img");if(Ti(x,"leaflet-image-layer"),this._zoomAnimated&&Ti(x,"leaflet-zoom-animated"),this.options.className&&Ti(x,this.options.className),x.onselectstart=K,x.onmousemove=K,x.onload=w(this.fire,this,"load"),x.onerror=w(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(x.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),d){this._url=x.src;return}x.src=this._url,x.alt=this.options.alt},_animateZoom:function(d){var x=this._map.getZoomScale(d.zoom),z=this._map._latLngBoundsToNewLayerBounds(this._bounds,d.zoom,d.center).min;No(this._image,z,x)},_reset:function(){var d=this._image,x=new ze(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),z=x.getSize();Pn(d,x.min),d.style.width=z.x+"px",d.style.height=z.y+"px"},_updateOpacity:function(){kn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var d=this.options.errorOverlayUrl;d&&this._url!==d&&(this._url=d,this._image.src=d)},getCenter:function(){return this._bounds.getCenter()}}),bd=function(d,x,z){return new kl(d,x,z)},ol=kl.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var d=this._url.tagName==="VIDEO",x=this._image=d?this._url:Gi("video");if(Ti(x,"leaflet-image-layer"),this._zoomAnimated&&Ti(x,"leaflet-zoom-animated"),this.options.className&&Ti(x,this.options.className),x.onselectstart=K,x.onmousemove=K,x.onloadeddata=w(this.fire,this,"load"),d){for(var z=x.getElementsByTagName("source"),j=[],Y=0;Y<z.length;Y++)j.push(z[Y].src);this._url=z.length>0?j:[x.src];return}Ne(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(x.style,"objectFit")&&(x.style.objectFit="fill"),x.autoplay=!!this.options.autoplay,x.loop=!!this.options.loop,x.muted=!!this.options.muted,x.playsInline=!!this.options.playsInline;for(var se=0;se<this._url.length;se++){var Ae=Gi("source");Ae.src=this._url[se],x.appendChild(Ae)}}});function Ol(d,x,z){return new ol(d,x,z)}var $c=kl.extend({_initImage:function(){var d=this._image=this._url;Ti(d,"leaflet-image-layer"),this._zoomAnimated&&Ti(d,"leaflet-zoom-animated"),this.options.className&&Ti(d,this.options.className),d.onselectstart=K,d.onmousemove=K}});function Yi(d,x,z){return new $c(d,x,z)}var Cr=ja.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(d,x){d&&(d instanceof Dt||Ne(d))?(this._latlng=kt(d),fe(this,x)):(fe(this,d),this._source=x),this.options.content&&(this._content=this.options.content)},openOn:function(d){return d=arguments.length?d:this._source._map,d.hasLayer(this)||d.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(d){return this._map?this.close():(arguments.length?this._source=d:d=this._source,this._prepareOpen(),this.openOn(d._map)),this},onAdd:function(d){this._zoomAnimated=d._zoomAnimated,this._container||this._initLayout(),d._fadeAnimated&&kn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),d._fadeAnimated&&kn(this._container,1),this.bringToFront(),this.options.interactive&&(Ti(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(d){d._fadeAnimated?(kn(this._container,0),this._removeTimeout=setTimeout(w(on,void 0,this._container),200)):on(this._container),this.options.interactive&&(Yn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(d){return this._latlng=kt(d),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(d){return this._content=d,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var d={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Li(this._container),this},bringToBack:function(){return this._map&&Ks(this._container),this},_prepareOpen:function(d){var x=this._source;if(!x._map)return!1;if(x instanceof wo){x=null;var z=this._source._layers;for(var j in z)if(z[j]._map){x=z[j];break}if(!x)return!1;this._source=x}if(!d)if(x.getCenter)d=x.getCenter();else if(x.getLatLng)d=x.getLatLng();else if(x.getBounds)d=x.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(d),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var d=this._contentNode,x=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof x=="string")d.innerHTML=x;else{for(;d.hasChildNodes();)d.removeChild(d.firstChild);d.appendChild(x)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var d=this._map.latLngToLayerPoint(this._latlng),x=Nt(this.options.offset),z=this._getAnchor();this._zoomAnimated?Pn(this._container,d.add(z)):x=x.add(d).add(z);var j=this._containerBottom=-x.y,Y=this._containerLeft=-Math.round(this._containerWidth/2)+x.x;this._container.style.bottom=j+"px",this._container.style.left=Y+"px"}},_getAnchor:function(){return[0,0]}});Pi.include({_initOverlay:function(d,x,z,j){var Y=x;return Y instanceof d||(Y=new d(j).setContent(x)),z&&Y.setLatLng(z),Y}}),ja.include({_initOverlay:function(d,x,z,j){var Y=z;return Y instanceof d?(fe(Y,j),Y._source=this):(Y=x&&!j?x:new d(j,this),Y.setContent(z)),Y}});var sl=Cr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(d){return d=arguments.length?d:this._source._map,!d.hasLayer(this)&&d._popup&&d._popup.options.autoClose&&d.removeLayer(d._popup),d._popup=this,Cr.prototype.openOn.call(this,d)},onAdd:function(d){Cr.prototype.onAdd.call(this,d),d.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof So||this._source.on("preclick",Fn))},onRemove:function(d){Cr.prototype.onRemove.call(this,d),d.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof So||this._source.off("preclick",Fn))},getEvents:function(){var d=Cr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(d.preclick=this.close),this.options.keepInView&&(d.moveend=this._adjustPan),d},_initLayout:function(){var d="leaflet-popup",x=this._container=Gi("div",d+" "+(this.options.className||"")+" leaflet-zoom-animated"),z=this._wrapper=Gi("div",d+"-content-wrapper",x);if(this._contentNode=Gi("div",d+"-content",z),Ba(x),Ma(this._contentNode),ii(x,"contextmenu",Fn),this._tipContainer=Gi("div",d+"-tip-container",x),this._tip=Gi("div",d+"-tip",this._tipContainer),this.options.closeButton){var j=this._closeButton=Gi("a",d+"-close-button",x);j.setAttribute("role","button"),j.setAttribute("aria-label","Close popup"),j.href="#close",j.innerHTML='<span aria-hidden="true">&#215;</span>',ii(j,"click",function(Y){Ai(Y),this.close()},this)}},_updateLayout:function(){var d=this._contentNode,x=d.style;x.width="",x.whiteSpace="nowrap";var z=d.offsetWidth;z=Math.min(z,this.options.maxWidth),z=Math.max(z,this.options.minWidth),x.width=z+1+"px",x.whiteSpace="",x.height="";var j=d.offsetHeight,Y=this.options.maxHeight,se="leaflet-popup-scrolled";Y&&j>Y?(x.height=Y+"px",Ti(d,se)):Yn(d,se),this._containerWidth=this._container.offsetWidth},_animateZoom:function(d){var x=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center),z=this._getAnchor();Pn(this._container,x.add(z))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var d=this._map,x=parseInt(Ta(this._container,"marginBottom"),10)||0,z=this._container.offsetHeight+x,j=this._containerWidth,Y=new Mt(this._containerLeft,-z-this._containerBottom);Y._add(Js(this._container));var se=d.layerPointToContainerPoint(Y),Ae=Nt(this.options.autoPanPadding),Ue=Nt(this.options.autoPanPaddingTopLeft||Ae),ot=Nt(this.options.autoPanPaddingBottomRight||Ae),Tt=d.getSize(),jt=0,ui=0;se.x+j+ot.x>Tt.x&&(jt=se.x+j-Tt.x+ot.x),se.x-jt-Ue.x<0&&(jt=se.x-Ue.x),se.y+z+ot.y>Tt.y&&(ui=se.y+z-Tt.y+ot.y),se.y-ui-Ue.y<0&&(ui=se.y-Ue.y),(jt||ui)&&(this.options.keepInView&&(this._autopanning=!0),d.fire("autopanstart").panBy([jt,ui]))}},_getAnchor:function(){return Nt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ec=function(d,x){return new sl(d,x)};Pi.mergeOptions({closePopupOnClick:!0}),Pi.include({openPopup:function(d,x,z){return this._initOverlay(sl,d,x,z).openOn(this),this},closePopup:function(d){return d=arguments.length?d:this._popup,d&&d.close(),this}}),ja.include({bindPopup:function(d,x){return this._popup=this._initOverlay(sl,this._popup,d,x),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(d){return this._popup&&(this instanceof wo||(this._popup._source=this),this._popup._prepareOpen(d||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(d){return this._popup&&this._popup.setContent(d),this},getPopup:function(){return this._popup},_openPopup:function(d){if(!(!this._popup||!this._map)){Fa(d);var x=d.layer||d.target;if(this._popup._source===x&&!(x instanceof So)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(d.latlng);return}this._popup._source=x,this.openPopup(d.latlng)}},_movePopup:function(d){this._popup.setLatLng(d.latlng)},_onKeyPress:function(d){d.originalEvent.keyCode===13&&this._openPopup(d)}});var Bl=Cr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(d){Cr.prototype.onAdd.call(this,d),this.setOpacity(this.options.opacity),d.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(d){Cr.prototype.onRemove.call(this,d),d.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var d=Cr.prototype.getEvents.call(this);return this.options.permanent||(d.preclick=this.close),d},_initLayout:function(){var d="leaflet-tooltip",x=d+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Gi("div",x),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+k(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(d){var x,z,j=this._map,Y=this._container,se=j.latLngToContainerPoint(j.getCenter()),Ae=j.layerPointToContainerPoint(d),Ue=this.options.direction,ot=Y.offsetWidth,Tt=Y.offsetHeight,jt=Nt(this.options.offset),ui=this._getAnchor();Ue==="top"?(x=ot/2,z=Tt):Ue==="bottom"?(x=ot/2,z=0):Ue==="center"?(x=ot/2,z=Tt/2):Ue==="right"?(x=0,z=Tt/2):Ue==="left"?(x=ot,z=Tt/2):Ae.x<se.x?(Ue="right",x=0,z=Tt/2):(Ue="left",x=ot+(jt.x+ui.x)*2,z=Tt/2),d=d.subtract(Nt(x,z,!0)).add(jt).add(ui),Yn(Y,"leaflet-tooltip-right"),Yn(Y,"leaflet-tooltip-left"),Yn(Y,"leaflet-tooltip-top"),Yn(Y,"leaflet-tooltip-bottom"),Ti(Y,"leaflet-tooltip-"+Ue),Pn(Y,d)},_updatePosition:function(){var d=this._map.latLngToLayerPoint(this._latlng);this._setPosition(d)},setOpacity:function(d){this.options.opacity=d,this._container&&kn(this._container,d)},_animateZoom:function(d){var x=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center);this._setPosition(x)},_getAnchor:function(){return Nt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Fl=function(d,x){return new Bl(d,x)};Pi.include({openTooltip:function(d,x,z){return this._initOverlay(Bl,d,x,z).openOn(this),this},closeTooltip:function(d){return d.close(),this}}),ja.include({bindTooltip:function(d,x){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Bl,this._tooltip,d,x),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(d){if(!(!d&&this._tooltipHandlersAdded)){var x=d?"off":"on",z={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?z.add=this._openTooltip:(z.mouseover=this._openTooltip,z.mouseout=this.closeTooltip,z.click=this._openTooltip,this._map?this._addFocusListeners():z.add=this._addFocusListeners),this._tooltip.options.sticky&&(z.mousemove=this._moveTooltip),this[x](z),this._tooltipHandlersAdded=!d}},openTooltip:function(d){return this._tooltip&&(this instanceof wo||(this._tooltip._source=this),this._tooltip._prepareOpen(d)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(d){return this._tooltip&&this._tooltip.setContent(d),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(d){var x=typeof d.getElement=="function"&&d.getElement();x&&(ii(x,"focus",function(){this._tooltip._source=d,this.openTooltip()},this),ii(x,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(d){var x=typeof d.getElement=="function"&&d.getElement();x&&x.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(d){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var x=this;this._map.once("moveend",function(){x._openOnceFlag=!1,x._openTooltip(d)});return}this._tooltip._source=d.layer||d.target,this.openTooltip(this._tooltip.options.sticky?d.latlng:void 0)}},_moveTooltip:function(d){var x=d.latlng,z,j;this._tooltip.options.sticky&&d.originalEvent&&(z=this._map.mouseEventToContainerPoint(d.originalEvent),j=this._map.containerPointToLayerPoint(z),x=this._map.layerPointToLatLng(j)),this._tooltip.setLatLng(x)}});var wu=To.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(d){var x=d&&d.tagName==="DIV"?d:document.createElement("div"),z=this.options;if(z.html instanceof Element?(Sa(x),x.appendChild(z.html)):x.innerHTML=z.html!==!1?z.html:"",z.bgPos){var j=Nt(z.bgPos);x.style.backgroundPosition=-j.x+"px "+-j.y+"px"}return this._setIconStyles(x,"icon"),x},createShadow:function(){return null}});function Tu(d){return new wu(d)}To.Default=_u;var aa=ja.extend({options:{tileSize:256,opacity:1,updateWhenIdle:et.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(d){fe(this,d)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(d){d._addZoomLimit(this)},onRemove:function(d){this._removeAllTiles(),on(this._container),d._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Li(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ks(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(d){return this.options.opacity=d,this._updateOpacity(),this},setZIndex:function(d){return this.options.zIndex=d,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var d=this._clampZoom(this._map.getZoom());d!==this._tileZoom&&(this._tileZoom=d,this._updateLevels()),this._update()}return this},getEvents:function(){var d={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=N(this._onMoveEnd,this.options.updateInterval,this)),d.move=this._onMove),this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},createTile:function(){return document.createElement("div")},getTileSize:function(){var d=this.options.tileSize;return d instanceof Mt?d:new Mt(d,d)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(d){for(var x=this.getPane().children,z=-d(-1/0,1/0),j=0,Y=x.length,se;j<Y;j++)se=x[j].style.zIndex,x[j]!==this._container&&se&&(z=d(z,+se));isFinite(z)&&(this.options.zIndex=z+d(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!et.ielt9){kn(this._container,this.options.opacity);var d=+new Date,x=!1,z=!1;for(var j in this._tiles){var Y=this._tiles[j];if(!(!Y.current||!Y.loaded)){var se=Math.min(1,(d-Y.loaded)/200);kn(Y.el,se),se<1?x=!0:(Y.active?z=!0:this._onOpaqueTile(Y),Y.active=!0)}}z&&!this._noPrune&&this._pruneTiles(),x&&(li(this._fadeFrame),this._fadeFrame=hi(this._updateOpacity,this))}},_onOpaqueTile:K,_initContainer:function(){this._container||(this._container=Gi("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var d=this._tileZoom,x=this.options.maxZoom;if(d!==void 0){for(var z in this._levels)z=Number(z),this._levels[z].el.children.length||z===d?(this._levels[z].el.style.zIndex=x-Math.abs(d-z),this._onUpdateLevel(z)):(on(this._levels[z].el),this._removeTilesAtZoom(z),this._onRemoveLevel(z),delete this._levels[z]);var j=this._levels[d],Y=this._map;return j||(j=this._levels[d]={},j.el=Gi("div","leaflet-tile-container leaflet-zoom-animated",this._container),j.el.style.zIndex=x,j.origin=Y.project(Y.unproject(Y.getPixelOrigin()),d).round(),j.zoom=d,this._setZoomTransform(j,Y.getCenter(),Y.getZoom()),K(j.el.offsetWidth),this._onCreateLevel(j)),this._level=j,j}},_onUpdateLevel:K,_onRemoveLevel:K,_onCreateLevel:K,_pruneTiles:function(){if(this._map){var d,x,z=this._map.getZoom();if(z>this.options.maxZoom||z<this.options.minZoom){this._removeAllTiles();return}for(d in this._tiles)x=this._tiles[d],x.retain=x.current;for(d in this._tiles)if(x=this._tiles[d],x.current&&!x.active){var j=x.coords;this._retainParent(j.x,j.y,j.z,j.z-5)||this._retainChildren(j.x,j.y,j.z,j.z+2)}for(d in this._tiles)this._tiles[d].retain||this._removeTile(d)}},_removeTilesAtZoom:function(d){for(var x in this._tiles)this._tiles[x].coords.z===d&&this._removeTile(x)},_removeAllTiles:function(){for(var d in this._tiles)this._removeTile(d)},_invalidateAll:function(){for(var d in this._levels)on(this._levels[d].el),this._onRemoveLevel(Number(d)),delete this._levels[d];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(d,x,z,j){var Y=Math.floor(d/2),se=Math.floor(x/2),Ae=z-1,Ue=new Mt(+Y,+se);Ue.z=+Ae;var ot=this._tileCoordsToKey(Ue),Tt=this._tiles[ot];return Tt&&Tt.active?(Tt.retain=!0,!0):(Tt&&Tt.loaded&&(Tt.retain=!0),Ae>j?this._retainParent(Y,se,Ae,j):!1)},_retainChildren:function(d,x,z,j){for(var Y=2*d;Y<2*d+2;Y++)for(var se=2*x;se<2*x+2;se++){var Ae=new Mt(Y,se);Ae.z=z+1;var Ue=this._tileCoordsToKey(Ae),ot=this._tiles[Ue];if(ot&&ot.active){ot.retain=!0;continue}else ot&&ot.loaded&&(ot.retain=!0);z+1<j&&this._retainChildren(Y,se,z+1,j)}},_resetView:function(d){var x=d&&(d.pinch||d.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),x,x)},_animateZoom:function(d){this._setView(d.center,d.zoom,!0,d.noUpdate)},_clampZoom:function(d){var x=this.options;return x.minNativeZoom!==void 0&&d<x.minNativeZoom?x.minNativeZoom:x.maxNativeZoom!==void 0&&x.maxNativeZoom<d?x.maxNativeZoom:d},_setView:function(d,x,z,j){var Y=Math.round(x);this.options.maxZoom!==void 0&&Y>this.options.maxZoom||this.options.minZoom!==void 0&&Y<this.options.minZoom?Y=void 0:Y=this._clampZoom(Y);var se=this.options.updateWhenZooming&&Y!==this._tileZoom;(!j||se)&&(this._tileZoom=Y,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Y!==void 0&&this._update(d),z||this._pruneTiles(),this._noPrune=!!z),this._setZoomTransforms(d,x)},_setZoomTransforms:function(d,x){for(var z in this._levels)this._setZoomTransform(this._levels[z],d,x)},_setZoomTransform:function(d,x,z){var j=this._map.getZoomScale(z,d.zoom),Y=d.origin.multiplyBy(j).subtract(this._map._getNewPixelOrigin(x,z)).round();et.any3d?No(d.el,Y,j):Pn(d.el,Y)},_resetGrid:function(){var d=this._map,x=d.options.crs,z=this._tileSize=this.getTileSize(),j=this._tileZoom,Y=this._map.getPixelWorldBounds(this._tileZoom);Y&&(this._globalTileRange=this._pxBoundsToTileRange(Y)),this._wrapX=x.wrapLng&&!this.options.noWrap&&[Math.floor(d.project([0,x.wrapLng[0]],j).x/z.x),Math.ceil(d.project([0,x.wrapLng[1]],j).x/z.y)],this._wrapY=x.wrapLat&&!this.options.noWrap&&[Math.floor(d.project([x.wrapLat[0],0],j).y/z.x),Math.ceil(d.project([x.wrapLat[1],0],j).y/z.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(d){var x=this._map,z=x._animatingZoom?Math.max(x._animateToZoom,x.getZoom()):x.getZoom(),j=x.getZoomScale(z,this._tileZoom),Y=x.project(d,this._tileZoom).floor(),se=x.getSize().divideBy(j*2);return new ze(Y.subtract(se),Y.add(se))},_update:function(d){var x=this._map;if(x){var z=this._clampZoom(x.getZoom());if(d===void 0&&(d=x.getCenter()),this._tileZoom!==void 0){var j=this._getTiledPixelBounds(d),Y=this._pxBoundsToTileRange(j),se=Y.getCenter(),Ae=[],Ue=this.options.keepBuffer,ot=new ze(Y.getBottomLeft().subtract([Ue,-Ue]),Y.getTopRight().add([Ue,-Ue]));if(!(isFinite(Y.min.x)&&isFinite(Y.min.y)&&isFinite(Y.max.x)&&isFinite(Y.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Tt in this._tiles){var jt=this._tiles[Tt].coords;(jt.z!==this._tileZoom||!ot.contains(new Mt(jt.x,jt.y)))&&(this._tiles[Tt].current=!1)}if(Math.abs(z-this._tileZoom)>1){this._setView(d,z);return}for(var ui=Y.min.y;ui<=Y.max.y;ui++)for(var zi=Y.min.x;zi<=Y.max.x;zi++){var mr=new Mt(zi,ui);if(mr.z=this._tileZoom,!!this._isValidTile(mr)){var Kn=this._tiles[this._tileCoordsToKey(mr)];Kn?Kn.current=!0:Ae.push(mr)}}if(Ae.sort(function(cn,Wi){return cn.distanceTo(se)-Wi.distanceTo(se)}),Ae.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var $a=document.createDocumentFragment();for(zi=0;zi<Ae.length;zi++)this._addTile(Ae[zi],$a);this._level.el.appendChild($a)}}}},_isValidTile:function(d){var x=this._map.options.crs;if(!x.infinite){var z=this._globalTileRange;if(!x.wrapLng&&(d.x<z.min.x||d.x>z.max.x)||!x.wrapLat&&(d.y<z.min.y||d.y>z.max.y))return!1}if(!this.options.bounds)return!0;var j=this._tileCoordsToBounds(d);return zt(this.options.bounds).overlaps(j)},_keyToBounds:function(d){return this._tileCoordsToBounds(this._keyToTileCoords(d))},_tileCoordsToNwSe:function(d){var x=this._map,z=this.getTileSize(),j=d.scaleBy(z),Y=j.add(z),se=x.unproject(j,d.z),Ae=x.unproject(Y,d.z);return[se,Ae]},_tileCoordsToBounds:function(d){var x=this._tileCoordsToNwSe(d),z=new It(x[0],x[1]);return this.options.noWrap||(z=this._map.wrapLatLngBounds(z)),z},_tileCoordsToKey:function(d){return d.x+":"+d.y+":"+d.z},_keyToTileCoords:function(d){var x=d.split(":"),z=new Mt(+x[0],+x[1]);return z.z=+x[2],z},_removeTile:function(d){var x=this._tiles[d];x&&(on(x.el),delete this._tiles[d],this.fire("tileunload",{tile:x.el,coords:this._keyToTileCoords(d)}))},_initTile:function(d){Ti(d,"leaflet-tile");var x=this.getTileSize();d.style.width=x.x+"px",d.style.height=x.y+"px",d.onselectstart=K,d.onmousemove=K,et.ielt9&&this.options.opacity<1&&kn(d,this.options.opacity)},_addTile:function(d,x){var z=this._getTilePos(d),j=this._tileCoordsToKey(d),Y=this.createTile(this._wrapCoords(d),w(this._tileReady,this,d));this._initTile(Y),this.createTile.length<2&&hi(w(this._tileReady,this,d,null,Y)),Pn(Y,z),this._tiles[j]={el:Y,coords:d,current:!0},x.appendChild(Y),this.fire("tileloadstart",{tile:Y,coords:d})},_tileReady:function(d,x,z){x&&this.fire("tileerror",{error:x,tile:z,coords:d});var j=this._tileCoordsToKey(d);z=this._tiles[j],z&&(z.loaded=+new Date,this._map._fadeAnimated?(kn(z.el,0),li(this._fadeFrame),this._fadeFrame=hi(this._updateOpacity,this)):(z.active=!0,this._pruneTiles()),x||(Ti(z.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:z.el,coords:d})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),et.ielt9||!this._map._fadeAnimated?hi(this._pruneTiles,this):setTimeout(w(this._pruneTiles,this),250)))},_getTilePos:function(d){return d.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(d){var x=new Mt(this._wrapX?H(d.x,this._wrapX):d.x,this._wrapY?H(d.y,this._wrapY):d.y);return x.z=d.z,x},_pxBoundsToTileRange:function(d){var x=this.getTileSize();return new ze(d.min.unscaleBy(x).floor(),d.max.unscaleBy(x).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var d in this._tiles)if(!this._tiles[d].loaded)return!1;return!0}});function Dh(d){return new aa(d)}var Is=aa.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(d,x){this._url=d,x=fe(this,x),x.detectRetina&&et.retina&&x.maxZoom>0?(x.tileSize=Math.floor(x.tileSize/2),x.zoomReverse?(x.zoomOffset--,x.minZoom=Math.min(x.maxZoom,x.minZoom+1)):(x.zoomOffset++,x.maxZoom=Math.max(x.minZoom,x.maxZoom-1)),x.minZoom=Math.max(0,x.minZoom)):x.zoomReverse?x.minZoom=Math.min(x.maxZoom,x.minZoom):x.maxZoom=Math.max(x.minZoom,x.maxZoom),typeof x.subdomains=="string"&&(x.subdomains=x.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(d,x){return this._url===d&&x===void 0&&(x=!0),this._url=d,x||this.redraw(),this},createTile:function(d,x){var z=document.createElement("img");return ii(z,"load",w(this._tileOnLoad,this,x,z)),ii(z,"error",w(this._tileOnError,this,x,z)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(z.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(z.referrerPolicy=this.options.referrerPolicy),z.alt="",z.src=this.getTileUrl(d),z},getTileUrl:function(d){var x={r:et.retina?"@2x":"",s:this._getSubdomain(d),x:d.x,y:d.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var z=this._globalTileRange.max.y-d.y;this.options.tms&&(x.y=z),x["-y"]=z}return Fe(this._url,S(x,this.options))},_tileOnLoad:function(d,x){et.ielt9?setTimeout(w(d,this,null,x),0):d(null,x)},_tileOnError:function(d,x,z){var j=this.options.errorTileUrl;j&&x.getAttribute("src")!==j&&(x.src=j),d(z,x)},_onTileRemove:function(d){d.tile.onload=null},_getZoomForUrl:function(){var d=this._tileZoom,x=this.options.maxZoom,z=this.options.zoomReverse,j=this.options.zoomOffset;return z&&(d=x-d),d+j},_getSubdomain:function(d){var x=Math.abs(d.x+d.y)%this.options.subdomains.length;return this.options.subdomains[x]},_abortLoading:function(){var d,x;for(d in this._tiles)if(this._tiles[d].coords.z!==this._tileZoom&&(x=this._tiles[d].el,x.onload=K,x.onerror=K,!x.complete)){x.src=Pe;var z=this._tiles[d].coords;on(x),delete this._tiles[d],this.fire("tileabort",{tile:x,coords:z})}},_removeTile:function(d){var x=this._tiles[d];if(x)return x.el.setAttribute("src",Pe),aa.prototype._removeTile.call(this,d)},_tileReady:function(d,x,z){if(!(!this._map||z&&z.getAttribute("src")===Pe))return aa.prototype._tileReady.call(this,d,x,z)}});function Ga(d,x){return new Is(d,x)}var Ho=Is.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(d,x){this._url=d;var z=S({},this.defaultWmsParams);for(var j in x)j in this.options||(z[j]=x[j]);x=fe(this,x);var Y=x.detectRetina&&et.retina?2:1,se=this.getTileSize();z.width=se.x*Y,z.height=se.y*Y,this.wmsParams=z},onAdd:function(d){this._crs=this.options.crs||d.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var x=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[x]=this._crs.code,Is.prototype.onAdd.call(this,d)},getTileUrl:function(d){var x=this._tileCoordsToNwSe(d),z=this._crs,j=dt(z.project(x[0]),z.project(x[1])),Y=j.min,se=j.max,Ae=(this._wmsVersion>=1.3&&this._crs===zh?[Y.y,Y.x,se.y,se.x]:[Y.x,Y.y,se.x,se.y]).join(","),Ue=Is.prototype.getTileUrl.call(this,d);return Ue+ce(this.wmsParams,Ue,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Ae},setParams:function(d,x){return S(this.wmsParams,d),x||this.redraw(),this}});function Aa(d,x){return new Ho(d,x)}Is.WMS=Ho,Ga.wms=Aa;var oa=ja.extend({options:{padding:.1},initialize:function(d){fe(this,d),k(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ti(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var d={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(d.zoomanim=this._onAnimZoom),d},_onAnimZoom:function(d){this._updateTransform(d.center,d.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(d,x){var z=this._map.getZoomScale(x,this._zoom),j=this._map.getSize().multiplyBy(.5+this.options.padding),Y=this._map.project(this._center,x),se=j.multiplyBy(-z).add(Y).subtract(this._map._getNewPixelOrigin(d,x));et.any3d?No(this._container,se,z):Pn(this._container,se)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var d in this._layers)this._layers[d]._reset()},_onZoomEnd:function(){for(var d in this._layers)this._layers[d]._project()},_updatePaths:function(){for(var d in this._layers)this._layers[d]._update()},_update:function(){var d=this.options.padding,x=this._map.getSize(),z=this._map.containerPointToLayerPoint(x.multiplyBy(-d)).round();this._bounds=new ze(z,z.add(x.multiplyBy(1+d*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ll=oa.extend({options:{tolerance:0},getEvents:function(){var d=oa.prototype.getEvents.call(this);return d.viewprereset=this._onViewPreReset,d},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){oa.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var d=this._container=document.createElement("canvas");ii(d,"mousemove",this._onMouseMove,this),ii(d,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ii(d,"mouseout",this._handleMouseOut,this),d._leaflet_disable_events=!0,this._ctx=d.getContext("2d")},_destroyContainer:function(){li(this._redrawRequest),delete this._ctx,on(this._container),Zt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var d;this._redrawBounds=null;for(var x in this._layers)d=this._layers[x],d._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){oa.prototype._update.call(this);var d=this._bounds,x=this._container,z=d.getSize(),j=et.retina?2:1;Pn(x,d.min),x.width=j*z.x,x.height=j*z.y,x.style.width=z.x+"px",x.style.height=z.y+"px",et.retina&&this._ctx.scale(2,2),this._ctx.translate(-d.min.x,-d.min.y),this.fire("update")}},_reset:function(){oa.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(d){this._updateDashArray(d),this._layers[k(d)]=d;var x=d._order={layer:d,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=x),this._drawLast=x,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(d){this._requestRedraw(d)},_removePath:function(d){var x=d._order,z=x.next,j=x.prev;z?z.prev=j:this._drawLast=j,j?j.next=z:this._drawFirst=z,delete d._order,delete this._layers[k(d)],this._requestRedraw(d)},_updatePath:function(d){this._extendRedrawBounds(d),d._project(),d._update(),this._requestRedraw(d)},_updateStyle:function(d){this._updateDashArray(d),this._requestRedraw(d)},_updateDashArray:function(d){if(typeof d.options.dashArray=="string"){var x=d.options.dashArray.split(/[, ]+/),z=[],j,Y;for(Y=0;Y<x.length;Y++){if(j=Number(x[Y]),isNaN(j))return;z.push(j)}d.options._dashArray=z}else d.options._dashArray=d.options.dashArray},_requestRedraw:function(d){this._map&&(this._extendRedrawBounds(d),this._redrawRequest=this._redrawRequest||hi(this._redraw,this))},_extendRedrawBounds:function(d){if(d._pxBounds){var x=(d.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ze,this._redrawBounds.extend(d._pxBounds.min.subtract([x,x])),this._redrawBounds.extend(d._pxBounds.max.add([x,x]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var d=this._redrawBounds;if(d){var x=d.getSize();this._ctx.clearRect(d.min.x,d.min.y,x.x,x.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var d,x=this._redrawBounds;if(this._ctx.save(),x){var z=x.getSize();this._ctx.beginPath(),this._ctx.rect(x.min.x,x.min.y,z.x,z.y),this._ctx.clip()}this._drawing=!0;for(var j=this._drawFirst;j;j=j.next)d=j.layer,(!x||d._pxBounds&&d._pxBounds.intersects(x))&&d._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(d,x){if(this._drawing){var z,j,Y,se,Ae=d._parts,Ue=Ae.length,ot=this._ctx;if(Ue){for(ot.beginPath(),z=0;z<Ue;z++){for(j=0,Y=Ae[z].length;j<Y;j++)se=Ae[z][j],ot[j?"lineTo":"moveTo"](se.x,se.y);x&&ot.closePath()}this._fillStroke(ot,d)}}},_updateCircle:function(d){if(!(!this._drawing||d._empty())){var x=d._point,z=this._ctx,j=Math.max(Math.round(d._radius),1),Y=(Math.max(Math.round(d._radiusY),1)||j)/j;Y!==1&&(z.save(),z.scale(1,Y)),z.beginPath(),z.arc(x.x,x.y/Y,j,0,Math.PI*2,!1),Y!==1&&z.restore(),this._fillStroke(z,d)}},_fillStroke:function(d,x){var z=x.options;z.fill&&(d.globalAlpha=z.fillOpacity,d.fillStyle=z.fillColor||z.color,d.fill(z.fillRule||"evenodd")),z.stroke&&z.weight!==0&&(d.setLineDash&&d.setLineDash(x.options&&x.options._dashArray||[]),d.globalAlpha=z.opacity,d.lineWidth=z.weight,d.strokeStyle=z.color,d.lineCap=z.lineCap,d.lineJoin=z.lineJoin,d.stroke())},_onClick:function(d){for(var x=this._map.mouseEventToLayerPoint(d),z,j,Y=this._drawFirst;Y;Y=Y.next)z=Y.layer,z.options.interactive&&z._containsPoint(x)&&(!(d.type==="click"||d.type==="preclick")||!this._map._draggableMoved(z))&&(j=z);this._fireEvent(j?[j]:!1,d)},_onMouseMove:function(d){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var x=this._map.mouseEventToLayerPoint(d);this._handleMouseHover(d,x)}},_handleMouseOut:function(d){var x=this._hoveredLayer;x&&(Yn(this._container,"leaflet-interactive"),this._fireEvent([x],d,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(d,x){if(!this._mouseHoverThrottled){for(var z,j,Y=this._drawFirst;Y;Y=Y.next)z=Y.layer,z.options.interactive&&z._containsPoint(x)&&(j=z);j!==this._hoveredLayer&&(this._handleMouseOut(d),j&&(Ti(this._container,"leaflet-interactive"),this._fireEvent([j],d,"mouseover"),this._hoveredLayer=j)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,d),this._mouseHoverThrottled=!0,setTimeout(w(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(d,x,z){this._map._fireDOMEvent(x,z||x.type,d)},_bringToFront:function(d){var x=d._order;if(x){var z=x.next,j=x.prev;if(z)z.prev=j;else return;j?j.next=z:z&&(this._drawFirst=z),x.prev=this._drawLast,this._drawLast.next=x,x.next=null,this._drawLast=x,this._requestRedraw(d)}},_bringToBack:function(d){var x=d._order;if(x){var z=x.next,j=x.prev;if(j)j.next=z;else return;z?z.prev=j:j&&(this._drawLast=j),x.prev=null,x.next=this._drawFirst,this._drawFirst.prev=x,this._drawFirst=x,this._requestRedraw(d)}}});function ul(d){return et.canvas?new ll(d):null}var Ls=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(d){return document.createElement("<lvml:"+d+' class="lvml">')}}catch{}return function(d){return document.createElement("<"+d+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),cl={_initContainer:function(){this._container=Gi("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(oa.prototype._update.call(this),this.fire("update"))},_initPath:function(d){var x=d._container=Ls("shape");Ti(x,"leaflet-vml-shape "+(this.options.className||"")),x.coordsize="1 1",d._path=Ls("path"),x.appendChild(d._path),this._updateStyle(d),this._layers[k(d)]=d},_addPath:function(d){var x=d._container;this._container.appendChild(x),d.options.interactive&&d.addInteractiveTarget(x)},_removePath:function(d){var x=d._container;on(x),d.removeInteractiveTarget(x),delete this._layers[k(d)]},_updateStyle:function(d){var x=d._stroke,z=d._fill,j=d.options,Y=d._container;Y.stroked=!!j.stroke,Y.filled=!!j.fill,j.stroke?(x||(x=d._stroke=Ls("stroke")),Y.appendChild(x),x.weight=j.weight+"px",x.color=j.color,x.opacity=j.opacity,j.dashArray?x.dashStyle=Ne(j.dashArray)?j.dashArray.join(" "):j.dashArray.replace(/( *, *)/g," "):x.dashStyle="",x.endcap=j.lineCap.replace("butt","flat"),x.joinstyle=j.lineJoin):x&&(Y.removeChild(x),d._stroke=null),j.fill?(z||(z=d._fill=Ls("fill")),Y.appendChild(z),z.color=j.fillColor||j.color,z.opacity=j.fillOpacity):z&&(Y.removeChild(z),d._fill=null)},_updateCircle:function(d){var x=d._point.round(),z=Math.round(d._radius),j=Math.round(d._radiusY||z);this._setPath(d,d._empty()?"M0 0":"AL "+x.x+","+x.y+" "+z+","+j+" 0,"+65535*360)},_setPath:function(d,x){d._path.v=x},_bringToFront:function(d){Li(d._container)},_bringToBack:function(d){Ks(d._container)}},Ca=et.vml?Ls:Jr,Nl=oa.extend({_initContainer:function(){this._container=Ca("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ca("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){on(this._container),Zt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){oa.prototype._update.call(this);var d=this._bounds,x=d.getSize(),z=this._container;(!this._svgSize||!this._svgSize.equals(x))&&(this._svgSize=x,z.setAttribute("width",x.x),z.setAttribute("height",x.y)),Pn(z,d.min),z.setAttribute("viewBox",[d.min.x,d.min.y,x.x,x.y].join(" ")),this.fire("update")}},_initPath:function(d){var x=d._path=Ca("path");d.options.className&&Ti(x,d.options.className),d.options.interactive&&Ti(x,"leaflet-interactive"),this._updateStyle(d),this._layers[k(d)]=d},_addPath:function(d){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(d._path),d.addInteractiveTarget(d._path)},_removePath:function(d){on(d._path),d.removeInteractiveTarget(d._path),delete this._layers[k(d)]},_updatePath:function(d){d._project(),d._update()},_updateStyle:function(d){var x=d._path,z=d.options;x&&(z.stroke?(x.setAttribute("stroke",z.color),x.setAttribute("stroke-opacity",z.opacity),x.setAttribute("stroke-width",z.weight),x.setAttribute("stroke-linecap",z.lineCap),x.setAttribute("stroke-linejoin",z.lineJoin),z.dashArray?x.setAttribute("stroke-dasharray",z.dashArray):x.removeAttribute("stroke-dasharray"),z.dashOffset?x.setAttribute("stroke-dashoffset",z.dashOffset):x.removeAttribute("stroke-dashoffset")):x.setAttribute("stroke","none"),z.fill?(x.setAttribute("fill",z.fillColor||z.color),x.setAttribute("fill-opacity",z.fillOpacity),x.setAttribute("fill-rule",z.fillRule||"evenodd")):x.setAttribute("fill","none"))},_updatePoly:function(d,x){this._setPath(d,wa(d._parts,x))},_updateCircle:function(d){var x=d._point,z=Math.max(Math.round(d._radius),1),j=Math.max(Math.round(d._radiusY),1)||z,Y="a"+z+","+j+" 0 1,0 ",se=d._empty()?"M0 0":"M"+(x.x-z)+","+x.y+Y+z*2+",0 "+Y+-z*2+",0 ";this._setPath(d,se)},_setPath:function(d,x){d._path.setAttribute("d",x)},_bringToFront:function(d){Li(d._path)},_bringToBack:function(d){Ks(d._path)}});et.vml&&Nl.include(cl);function jl(d){return et.svg||et.vml?new Nl(d):null}Pi.include({getRenderer:function(d){var x=d.options.renderer||this._getPaneRenderer(d.options.pane)||this.options.renderer||this._renderer;return x||(x=this._renderer=this._createRenderer()),this.hasLayer(x)||this.addLayer(x),x},_getPaneRenderer:function(d){if(d==="overlayPane"||d===void 0)return!1;var x=this._paneRenderers[d];return x===void 0&&(x=this._createRenderer({pane:d}),this._paneRenderers[d]=x),x},_createRenderer:function(d){return this.options.preferCanvas&&ul(d)||jl(d)}});var Si=ds.extend({initialize:function(d,x){ds.prototype.initialize.call(this,this._boundsToLatLngs(d),x)},setBounds:function(d){return this.setLatLngs(this._boundsToLatLngs(d))},_boundsToLatLngs:function(d){return d=zt(d),[d.getSouthWest(),d.getNorthWest(),d.getNorthEast(),d.getSouthEast()]}});function Hc(d,x){return new Si(d,x)}Nl.create=Ca,Nl.pointsToPath=wa,$o.geometryToLayer=ra,$o.coordsToLatLng=Ua,$o.coordsToLatLngs=al,$o.latLngToCoords=bu,$o.latLngsToCoords=Dl,$o.getFeature=fs,$o.asFeature=Rl,Pi.mergeOptions({boxZoom:!0});var Za=xo.extend({initialize:function(d){this._map=d,this._container=d._container,this._pane=d._panes.overlayPane,this._resetStateTimeout=0,d.on("unload",this._destroy,this)},addHooks:function(){ii(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Zt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){on(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(d){if(!d.shiftKey||d.which!==1&&d.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),us(),pu(),this._startPoint=this._map.mouseEventToContainerPoint(d),ii(document,{contextmenu:Fa,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(d){this._moved||(this._moved=!0,this._box=Gi("div","leaflet-zoom-box",this._container),Ti(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(d);var x=new ze(this._point,this._startPoint),z=x.getSize();Pn(this._box,x.min),this._box.style.width=z.x+"px",this._box.style.height=z.y+"px"},_finish:function(){this._moved&&(on(this._box),Yn(this._container,"leaflet-crosshair")),ao(),Ms(),Zt(document,{contextmenu:Fa,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(d){if(!(d.which!==1&&d.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(w(this._resetState,this),0);var x=new It(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(x).fire("boxzoomend",{boxZoomBounds:x})}},_onKeyDown:function(d){d.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Pi.addInitHook("addHandler","boxZoom",Za),Pi.mergeOptions({doubleClickZoom:!0});var tc=xo.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(d){var x=this._map,z=x.getZoom(),j=x.options.zoomDelta,Y=d.originalEvent.shiftKey?z-j:z+j;x.options.doubleClickZoom==="center"?x.setZoom(Y):x.setZoomAround(d.containerPoint,Y)}});Pi.addInitHook("addHandler","doubleClickZoom",tc),Pi.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var qa=xo.extend({addHooks:function(){if(!this._draggable){var d=this._map;this._draggable=new rr(d._mapPane,d._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),d.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),d.on("zoomend",this._onZoomEnd,this),d.whenReady(this._onZoomEnd,this))}Ti(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Yn(this._map._container,"leaflet-grab"),Yn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var d=this._map;if(d._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var x=zt(this._map.options.maxBounds);this._offsetLimit=dt(this._map.latLngToContainerPoint(x.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(x.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;d.fire("movestart").fire("dragstart"),d.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(d){if(this._map.options.inertia){var x=this._lastTime=+new Date,z=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(z),this._times.push(x),this._prunePositions(x)}this._map.fire("move",d).fire("drag",d)},_prunePositions:function(d){for(;this._positions.length>1&&d-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var d=this._map.getSize().divideBy(2),x=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=x.subtract(d).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(d,x){return d-(d-x)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var d=this._draggable._newPos.subtract(this._draggable._startPos),x=this._offsetLimit;d.x<x.min.x&&(d.x=this._viscousLimit(d.x,x.min.x)),d.y<x.min.y&&(d.y=this._viscousLimit(d.y,x.min.y)),d.x>x.max.x&&(d.x=this._viscousLimit(d.x,x.max.x)),d.y>x.max.y&&(d.y=this._viscousLimit(d.y,x.max.y)),this._draggable._newPos=this._draggable._startPos.add(d)}},_onPreDragWrap:function(){var d=this._worldWidth,x=Math.round(d/2),z=this._initialWorldOffset,j=this._draggable._newPos.x,Y=(j-x+z)%d+x-z,se=(j+x+z)%d-x-z,Ae=Math.abs(Y+z)<Math.abs(se+z)?Y:se;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Ae},_onDragEnd:function(d){var x=this._map,z=x.options,j=!z.inertia||d.noInertia||this._times.length<2;if(x.fire("dragend",d),j)x.fire("moveend");else{this._prunePositions(+new Date);var Y=this._lastPos.subtract(this._positions[0]),se=(this._lastTime-this._times[0])/1e3,Ae=z.easeLinearity,Ue=Y.multiplyBy(Ae/se),ot=Ue.distanceTo([0,0]),Tt=Math.min(z.inertiaMaxSpeed,ot),jt=Ue.multiplyBy(Tt/ot),ui=Tt/(z.inertiaDeceleration*Ae),zi=jt.multiplyBy(-ui/2).round();!zi.x&&!zi.y?x.fire("moveend"):(zi=x._limitOffset(zi,x.options.maxBounds),hi(function(){x.panBy(zi,{duration:ui,easeLinearity:Ae,noMoveStart:!0,animate:!0})}))}}});Pi.addInitHook("addHandler","dragging",qa),Pi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Rh=xo.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(d){this._map=d,this._setPanDelta(d.options.keyboardPanDelta),this._setZoomDelta(d.options.zoomDelta)},addHooks:function(){var d=this._map._container;d.tabIndex<=0&&(d.tabIndex="0"),ii(d,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Zt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var d=document.body,x=document.documentElement,z=d.scrollTop||x.scrollTop,j=d.scrollLeft||x.scrollLeft;this._map._container.focus(),window.scrollTo(j,z)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(d){var x=this._panKeys={},z=this.keyCodes,j,Y;for(j=0,Y=z.left.length;j<Y;j++)x[z.left[j]]=[-1*d,0];for(j=0,Y=z.right.length;j<Y;j++)x[z.right[j]]=[d,0];for(j=0,Y=z.down.length;j<Y;j++)x[z.down[j]]=[0,d];for(j=0,Y=z.up.length;j<Y;j++)x[z.up[j]]=[0,-1*d]},_setZoomDelta:function(d){var x=this._zoomKeys={},z=this.keyCodes,j,Y;for(j=0,Y=z.zoomIn.length;j<Y;j++)x[z.zoomIn[j]]=d;for(j=0,Y=z.zoomOut.length;j<Y;j++)x[z.zoomOut[j]]=-d},_addHooks:function(){ii(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Zt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(d){if(!(d.altKey||d.ctrlKey||d.metaKey)){var x=d.keyCode,z=this._map,j;if(x in this._panKeys){if(!z._panAnim||!z._panAnim._inProgress)if(j=this._panKeys[x],d.shiftKey&&(j=Nt(j).multiplyBy(3)),z.options.maxBounds&&(j=z._limitOffset(Nt(j),z.options.maxBounds)),z.options.worldCopyJump){var Y=z.wrapLatLng(z.unproject(z.project(z.getCenter()).add(j)));z.panTo(Y)}else z.panBy(j)}else if(x in this._zoomKeys)z.setZoom(z.getZoom()+(d.shiftKey?3:1)*this._zoomKeys[x]);else if(x===27&&z._popup&&z._popup.options.closeOnEscapeKey)z.closePopup();else return;Fa(d)}}});Pi.addInitHook("addHandler","keyboard",Rh),Pi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ic=xo.extend({addHooks:function(){ii(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Zt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(d){var x=pr(d),z=this._map.options.wheelDebounceTime;this._delta+=x,this._lastMousePos=this._map.mouseEventToContainerPoint(d),this._startTime||(this._startTime=+new Date);var j=Math.max(z-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(w(this._performZoom,this),j),Fa(d)},_performZoom:function(){var d=this._map,x=d.getZoom(),z=this._map.options.zoomSnap||0;d._stop();var j=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Y=4*Math.log(2/(1+Math.exp(-Math.abs(j))))/Math.LN2,se=z?Math.ceil(Y/z)*z:Y,Ae=d._limitZoom(x+(this._delta>0?se:-se))-x;this._delta=0,this._startTime=null,Ae&&(d.options.scrollWheelZoom==="center"?d.setZoom(x+Ae):d.setZoomAround(this._lastMousePos,x+Ae))}});Pi.addInitHook("addHandler","scrollWheelZoom",ic);var hl=600;Pi.mergeOptions({tapHold:et.touchNative&&et.safari&&et.mobile,tapTolerance:15});var Xc=xo.extend({addHooks:function(){ii(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Zt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(d){if(clearTimeout(this._holdTimeout),d.touches.length===1){var x=d.touches[0];this._startPos=this._newPos=new Mt(x.clientX,x.clientY),this._holdTimeout=setTimeout(w(function(){this._cancel(),this._isTapValid()&&(ii(document,"touchend",Ai),ii(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",x))},this),hl),ii(document,"touchend touchcancel contextmenu",this._cancel,this),ii(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function d(){Zt(document,"touchend",Ai),Zt(document,"touchend touchcancel",d)},_cancel:function(){clearTimeout(this._holdTimeout),Zt(document,"touchend touchcancel contextmenu",this._cancel,this),Zt(document,"touchmove",this._onMove,this)},_onMove:function(d){var x=d.touches[0];this._newPos=new Mt(x.clientX,x.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(d,x){var z=new MouseEvent(d,{bubbles:!0,cancelable:!0,view:window,screenX:x.screenX,screenY:x.screenY,clientX:x.clientX,clientY:x.clientY});z._simulated=!0,x.target.dispatchEvent(z)}});Pi.addInitHook("addHandler","tapHold",Xc),Pi.mergeOptions({touchZoom:et.touch,bounceAtZoomLimits:!0});var nc=xo.extend({addHooks:function(){Ti(this._map._container,"leaflet-touch-zoom"),ii(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Yn(this._map._container,"leaflet-touch-zoom"),Zt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(d){var x=this._map;if(!(!d.touches||d.touches.length!==2||x._animatingZoom||this._zooming)){var z=x.mouseEventToContainerPoint(d.touches[0]),j=x.mouseEventToContainerPoint(d.touches[1]);this._centerPoint=x.getSize()._divideBy(2),this._startLatLng=x.containerPointToLatLng(this._centerPoint),x.options.touchZoom!=="center"&&(this._pinchStartLatLng=x.containerPointToLatLng(z.add(j)._divideBy(2))),this._startDist=z.distanceTo(j),this._startZoom=x.getZoom(),this._moved=!1,this._zooming=!0,x._stop(),ii(document,"touchmove",this._onTouchMove,this),ii(document,"touchend touchcancel",this._onTouchEnd,this),Ai(d)}},_onTouchMove:function(d){if(!(!d.touches||d.touches.length!==2||!this._zooming)){var x=this._map,z=x.mouseEventToContainerPoint(d.touches[0]),j=x.mouseEventToContainerPoint(d.touches[1]),Y=z.distanceTo(j)/this._startDist;if(this._zoom=x.getScaleZoom(Y,this._startZoom),!x.options.bounceAtZoomLimits&&(this._zoom<x.getMinZoom()&&Y<1||this._zoom>x.getMaxZoom()&&Y>1)&&(this._zoom=x._limitZoom(this._zoom)),x.options.touchZoom==="center"){if(this._center=this._startLatLng,Y===1)return}else{var se=z._add(j)._divideBy(2)._subtract(this._centerPoint);if(Y===1&&se.x===0&&se.y===0)return;this._center=x.unproject(x.project(this._pinchStartLatLng,this._zoom).subtract(se),this._zoom)}this._moved||(x._moveStart(!0,!1),this._moved=!0),li(this._animRequest);var Ae=w(x._move,x,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=hi(Ae,this,!0),Ai(d)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,li(this._animRequest),Zt(document,"touchmove",this._onTouchMove,this),Zt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Pi.addInitHook("addHandler","touchZoom",nc),Pi.BoxZoom=Za,Pi.DoubleClickZoom=tc,Pi.Drag=qa,Pi.Keyboard=Rh,Pi.ScrollWheelZoom=ic,Pi.TapHold=Xc,Pi.TouchZoom=nc,h.Bounds=ze,h.Browser=et,h.CRS=fi,h.Canvas=ll,h.Circle=Ll,h.CircleMarker=qo,h.Class=Ci,h.Control=kr,h.DivIcon=wu,h.DivOverlay=Cr,h.DomEvent=$u,h.DomUtil=Ar,h.Draggable=rr,h.Evented=Pt,h.FeatureGroup=wo,h.GeoJSON=$o,h.GridLayer=aa,h.Handler=xo,h.Icon=To,h.ImageOverlay=kl,h.LatLng=Dt,h.LatLngBounds=It,h.Layer=ja,h.LayerGroup=Il,h.LineUtil=gu,h.Map=Pi,h.Marker=Zo,h.Mixin=vf,h.Path=So,h.Point=Mt,h.PolyUtil=Yu,h.Polygon=ds,h.Polyline=Ps,h.Popup=sl,h.PosAnimation=tl,h.Projection=md,h.Rectangle=Si,h.Renderer=oa,h.SVG=Nl,h.SVGOverlay=$c,h.TileLayer=Is,h.Tooltip=Bl,h.Transformation=_o,h.Util=nn,h.VideoOverlay=ol,h.bind=w,h.bounds=dt,h.canvas=ul,h.circle=yd,h.circleMarker=Lh,h.control=Mi,h.divIcon=Tu,h.extend=S,h.featureGroup=qc,h.geoJSON=xu,h.geoJson=Qu,h.gridLayer=Dh,h.icon=yu,h.imageOverlay=bd,h.latLng=kt,h.latLngBounds=zt,h.layerGroup=gd,h.map=pn,h.marker=Ih,h.point=Nt,h.polygon=vd,h.polyline=_d,h.popup=ec,h.rectangle=Hc,h.setOptions=fe,h.stamp=k,h.svg=jl,h.svgOverlay=Yi,h.tileLayer=Ga,h.tooltip=Fl,h.transformation=Mr,h.version=g,h.videoOverlay=Ol;var dl=window.L;h.noConflict=function(){return window.L=dl,this},window.L=h}))})(cy,cy.exports)),cy.exports}var kC=RC();const Dr=Ry(kC);var iv={exports:{}};var OC=iv.exports,D1;function BC(){return D1||(D1=1,(function(s,a){(function(h,g){s.exports=g()})(OC,(function(){var h={},g={};function S(w,c,k){if(g[w]=k,w==="index"){var N="var sharedModule = {}; ("+g.shared+")(sharedModule); ("+g.worker+")(sharedModule);",H={};return g.shared(H),g.index(h,H),typeof window<"u"&&h.setWorkerUrl(window.URL.createObjectURL(new Blob([N],{type:"text/javascript"}))),h}}S("shared",["exports"],(function(w){function c(n,e,i,u){return new(i||(i=Promise))((function(p,_){function v(R){try{P(u.next(R))}catch(F){_(F)}}function E(R){try{P(u.throw(R))}catch(F){_(F)}}function P(R){var F;R.done?p(R.value):(F=R.value,F instanceof i?F:new i((function(V){V(F)}))).then(v,E)}P((u=u.apply(n,e||[])).next())}))}function k(n,e){this.x=n,this.y=e}function N(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var H,K;typeof SuppressedError=="function"&&SuppressedError,k.prototype={clone(){return new k(this.x,this.y)},add(n){return this.clone()._add(n)},sub(n){return this.clone()._sub(n)},multByPoint(n){return this.clone()._multByPoint(n)},divByPoint(n){return this.clone()._divByPoint(n)},mult(n){return this.clone()._mult(n)},div(n){return this.clone()._div(n)},rotate(n){return this.clone()._rotate(n)},rotateAround(n,e){return this.clone()._rotateAround(n,e)},matMult(n){return this.clone()._matMult(n)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(n){return this.x===n.x&&this.y===n.y},dist(n){return Math.sqrt(this.distSqr(n))},distSqr(n){const e=n.x-this.x,i=n.y-this.y;return e*e+i*i},angle(){return Math.atan2(this.y,this.x)},angleTo(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith(n){return this.angleWithSep(n.x,n.y)},angleWithSep(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult(n){const e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add(n){return this.x+=n.x,this.y+=n.y,this},_sub(n){return this.x-=n.x,this.y-=n.y,this},_mult(n){return this.x*=n,this.y*=n,this},_div(n){return this.x/=n,this.y/=n,this},_multByPoint(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint(n){return this.x/=n.x,this.y/=n.y,this},_unit(){return this._div(this.mag()),this},_perp(){const n=this.y;return this.y=this.x,this.x=-n,this},_rotate(n){const e=Math.cos(n),i=Math.sin(n),u=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=u,this},_rotateAround(n,e){const i=Math.cos(n),u=Math.sin(n),p=e.y+u*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-u*(this.y-e.y),this.y=p,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:k},k.convert=function(n){if(n instanceof k)return n;if(Array.isArray(n))return new k(+n[0],+n[1]);if(n.x!==void 0&&n.y!==void 0)return new k(+n.x,+n.y);throw new Error("Expected [x, y] or {x, y} point format")};var ae=(function(){if(K)return H;function n(e,i,u,p){this.cx=3*e,this.bx=3*(u-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(p-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=u,this.p2y=p}return K=1,H=n,n.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,i){if(i===void 0&&(i=1e-6),e<0)return 0;if(e>1)return 1;for(var u=e,p=0;p<8;p++){var _=this.sampleCurveX(u)-e;if(Math.abs(_)<i)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=_/v}var E=0,P=1;for(u=e,p=0;p<20&&(_=this.sampleCurveX(u),!(Math.abs(_-e)<i));p++)e>_?E=u:P=u,u=.5*(P-E)+E;return u},solve:function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))}},H})(),ue=N(ae);let ge,fe;function ce(){return ge==null&&(ge=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ge}function qe(){if(fe==null&&(fe=!1,ce())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let u=0;u<25;u++){const p=4*u;e.fillStyle=`rgb(${p},${p+1},${p+2})`,e.fillRect(u%5,Math.floor(u/5),1,1)}const i=e.getImageData(0,0,5,5).data;for(let u=0;u<100;u++)if(u%4!=3&&i[u]!==u){fe=!0;break}}}return fe||!1}var Fe=1e-6,Ne=typeof Float32Array<"u"?Float32Array:Array;function Be(){var n=new Ne(9);return Ne!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function Pe(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function $e(){var n=new Ne(3);return Ne!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Qe(n){var e=n[0],i=n[1],u=n[2];return Math.sqrt(e*e+i*i+u*u)}function Et(n,e,i){var u=new Ne(3);return u[0]=n,u[1]=e,u[2]=i,u}function Ut(n,e,i){return n[0]=e[0]+i[0],n[1]=e[1]+i[1],n[2]=e[2]+i[2],n}function $t(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function hi(n,e,i){var u=e[0],p=e[1],_=e[2],v=i[0],E=i[1],P=i[2];return n[0]=p*P-_*E,n[1]=_*v-u*P,n[2]=u*E-p*v,n}var li,nn=Qe;function Ci(n,e,i){var u=e[0],p=e[1],_=e[2],v=e[3];return n[0]=i[0]*u+i[4]*p+i[8]*_+i[12]*v,n[1]=i[1]*u+i[5]*p+i[9]*_+i[13]*v,n[2]=i[2]*u+i[6]*p+i[10]*_+i[14]*v,n[3]=i[3]*u+i[7]*p+i[11]*_+i[15]*v,n}function Qi(){var n=new Ne(4);return Ne!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function lt(n,e,i,u){var p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",_=Math.PI/360;e*=_,u*=_,i*=_;var v=Math.sin(e),E=Math.cos(e),P=Math.sin(i),R=Math.cos(i),F=Math.sin(u),V=Math.cos(u);switch(p){case"xyz":n[0]=v*R*V+E*P*F,n[1]=E*P*V-v*R*F,n[2]=E*R*F+v*P*V,n[3]=E*R*V-v*P*F;break;case"xzy":n[0]=v*R*V-E*P*F,n[1]=E*P*V-v*R*F,n[2]=E*R*F+v*P*V,n[3]=E*R*V+v*P*F;break;case"yxz":n[0]=v*R*V+E*P*F,n[1]=E*P*V-v*R*F,n[2]=E*R*F-v*P*V,n[3]=E*R*V+v*P*F;break;case"yzx":n[0]=v*R*V+E*P*F,n[1]=E*P*V+v*R*F,n[2]=E*R*F-v*P*V,n[3]=E*R*V-v*P*F;break;case"zxy":n[0]=v*R*V-E*P*F,n[1]=E*P*V+v*R*F,n[2]=E*R*F+v*P*V,n[3]=E*R*V-v*P*F;break;case"zyx":n[0]=v*R*V-E*P*F,n[1]=E*P*V+v*R*F,n[2]=E*R*F-v*P*V,n[3]=E*R*V+v*P*F;break;default:throw new Error("Unknown angle order "+p)}return n}function Pt(){var n=new Ne(2);return Ne!=Float32Array&&(n[0]=0,n[1]=0),n}function Mt(n,e){var i=new Ne(2);return i[0]=n,i[1]=e,i}$e(),li=new Ne(4),Ne!=Float32Array&&(li[0]=0,li[1]=0,li[2]=0,li[3]=0),$e(),Et(1,0,0),Et(0,1,0),Qi(),Qi(),Be(),Pt();const ei=8192;function Nt(n,e,i){return e*(ei/(n.tileSize*Math.pow(2,i-n.tileID.overscaledZ)))}function ze(n,e){return(n%e+e)%e}function dt(n,e,i){return n*(1-i)+e*i}function It(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,i=e*n;return 4*(n<.5?i:3*(n-e)+i-.75)}function zt(n,e,i,u){const p=new ue(n,e,i,u);return _=>p.solve(_)}const Dt=zt(.25,.1,.25,1);function kt(n,e,i){return Math.min(i,Math.max(e,n))}function fi(n,e,i){const u=i-e,p=((n-e)%u+u)%u+e;return p===e?i:p}function Ei(n,...e){for(const i of e)for(const u in i)n[u]=i[u];return n}let rn=1;function hr(n,e,i){const u={};for(const p in n)u[p]=e.call(this,n[p],p,n);return u}function _o(n,e,i){const u={};for(const p in n)e.call(this,n[p],p,n)&&(u[p]=n[p]);return u}function Mr(n){return Array.isArray(n)?n.map(Mr):typeof n=="object"&&n?hr(n,Mr):n}const as={};function Rn(n){as[n]||(typeof console<"u"&&console.warn(n),as[n]=!0)}function Jr(n,e,i){return(i.y-n.y)*(e.x-n.x)>(e.y-n.y)*(i.x-n.x)}function wa(n){return typeof WorkerGlobalScope<"u"&&n!==void 0&&n instanceof WorkerGlobalScope}let Cn=null;function La(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const ko="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Oo(n,e,i,u,p){return c(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(n,{timestamp:0});try{const v=_?.format;if(!v||!v.startsWith("BGR")&&!v.startsWith("RGB"))throw new Error(`Unrecognized format ${v}`);const E=v.startsWith("BGR"),P=new Uint8ClampedArray(u*p*4);if(yield _.copyTo(P,(function(R,F,V,Z,q){const W=4*Math.max(-F,0),Q=(Math.max(0,V)-V)*Z*4+W,te=4*Z,oe=Math.max(0,F),xe=Math.max(0,V);return{rect:{x:oe,y:xe,width:Math.min(R.width,F+Z)-oe,height:Math.min(R.height,V+q)-xe},layout:[{offset:Q,stride:te}]}})(n,e,i,u,p)),E)for(let R=0;R<P.length;R+=4){const F=P[R];P[R]=P[R+2],P[R+2]=F}return P}finally{_.close()}}))}let no,vo;function wl(n,e,i,u){return n.addEventListener(e,i,u),{unsubscribe:()=>{n.removeEventListener(e,i,u)}}}function Rr(n){return n*Math.PI/180}function Da(n){return n/Math.PI*180}const Ve={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ne={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ie="AbortError";class de extends Error{constructor(e=ie){super(e instanceof Error?e.message:e),this.name=ie,e instanceof Error&&e.stack&&(this.stack=e.stack)}}function Ee(n){return n.name===ie}const Le={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ye(n){return Le.REGISTERED_PROTOCOLS[n.substring(0,n.indexOf("://"))]}const je="global-dispatcher";class Re extends Error{constructor(e,i,u,p){super(`AJAXError: ${i} (${e}): ${u}`),this.status=e,this.statusText=i,this.url=u,this.body=p}}const We=()=>wa(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,mt=function(n,e){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){const u=Ye(n.url);if(u)return u(n,e);if(wa(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,targetMapId:je},e)}if(!(/^file:/.test(i=n.url)||/^file:/.test(We())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(u,p){return c(this,void 0,void 0,(function*(){const _=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:We(),signal:p.signal});let v,E;u.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");try{v=yield fetch(_)}catch(R){throw Ee(R)?R:new Re(0,R.message,u.url,new Blob)}if(!v.ok){const R=yield v.blob();throw new Re(v.status,v.statusText,u.url,R)}E=u.type==="arrayBuffer"||u.type==="image"?v.arrayBuffer():u.type==="json"?v.json():v.text();const P=yield E;return p.signal.throwIfAborted(),{data:P,cacheControl:v.headers.get("Cache-Control"),expires:v.headers.get("Expires")}}))})(n,e);if(wa(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,mustQueue:!0,targetMapId:je},e)}var i;return(function(u,p){return new Promise(((_,v)=>{var E;const P=new XMLHttpRequest;P.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(P.responseType="arraybuffer");for(const R in u.headers)P.setRequestHeader(R,u.headers[R]);u.type==="json"&&(P.responseType="text",!((E=u.headers)===null||E===void 0)&&E.Accept||P.setRequestHeader("Accept","application/json")),P.withCredentials=u.credentials==="include",P.onerror=()=>{v(new Error(P.statusText))},P.onload=()=>{if(!p.signal.aborted)if((P.status>=200&&P.status<300||P.status===0)&&P.response!==null){let R=P.response;if(u.type==="json")try{R=JSON.parse(P.response)}catch(F){return void v(F)}_({data:R,cacheControl:P.getResponseHeader("Cache-Control"),expires:P.getResponseHeader("Expires")})}else{const R=new Blob([P.response],{type:P.getResponseHeader("Content-Type")});v(new Re(P.status,P.statusText,u.url,R))}},p.signal.addEventListener("abort",(()=>{P.abort(),v(new de(p.signal.reason))})),P.send(u.body)}))})(n,e)};function pt(n){if(!n||n.indexOf("://")<=0||n.indexOf("data:image/")===0||n.indexOf("blob:")===0)return!0;const e=new URL(n),i=window.location;return e.protocol===i.protocol&&e.host===i.host}function Vt(n,e,i){i[n]&&i[n].indexOf(e)!==-1||(i[n]=i[n]||[],i[n].push(e))}function Kt(n,e,i){if(i&&i[n]){const u=i[n].indexOf(e);u!==-1&&i[n].splice(u,1)}}class di{constructor(e,i={}){Ei(this,i),this.type=e}}class en extends di{constructor(e,i={}){super("error",Ei({error:e},i))}}class Fi{on(e,i){return this._listeners=this._listeners||{},Vt(e,i,this._listeners),{unsubscribe:()=>{this.off(e,i)}}}off(e,i){return Kt(e,i,this._listeners),Kt(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Vt(e,i,this._oneTimeListeners),this):new Promise((u=>this.once(e,u)))}fire(e,i){typeof e=="string"&&(e=new di(e,i||{}));const u=e.type;if(this.listens(u)){e.target=this;const p=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const E of p)E.call(this,e);const _=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const E of _)Kt(u,E,this._oneTimeListeners),E.call(this,e);const v=this._eventedParent;v&&(Ei(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(e))}else e instanceof en&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var Ze={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ln=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function dr(n,e){const i={};for(const u in n)u!=="ref"&&(i[u]=n[u]);return ln.forEach((u=>{u in e&&(i[u]=e[u])})),i}function gi(n,e){if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let i=0;i<n.length;i++)if(!gi(n[i],e[i]))return!1;return!0}if(typeof n=="object"&&n!==null&&e!==null){if(typeof e!="object"||Object.keys(n).length!==Object.keys(e).length)return!1;for(const i in n)if(!gi(n[i],e[i]))return!1;return!0}return n===e}function un(n,e){n.push(e)}function Er(n,e,i){un(i,{command:"addSource",args:[n,e[n]]})}function an(n,e,i){un(e,{command:"removeSource",args:[n]}),i[n]=!0}function nr(n,e,i,u){an(n,i,u),Er(n,e,i)}function _n(n,e,i){let u;for(u in n[i])if(Object.prototype.hasOwnProperty.call(n[i],u)&&u!=="data"&&!gi(n[i][u],e[i][u]))return!1;for(u in e[i])if(Object.prototype.hasOwnProperty.call(e[i],u)&&u!=="data"&&!gi(n[i][u],e[i][u]))return!1;return!0}function fr(n,e,i,u,p,_){n=n||{},e=e||{};for(const v in n)Object.prototype.hasOwnProperty.call(n,v)&&(gi(n[v],e[v])||i.push({command:_,args:[u,v,e[v],p]}));for(const v in e)Object.prototype.hasOwnProperty.call(e,v)&&!Object.prototype.hasOwnProperty.call(n,v)&&(gi(n[v],e[v])||i.push({command:_,args:[u,v,e[v],p]}))}function du(n){return n.id}function ha(n,e){return n[e.id]=e,n}class et{constructor(e,i,u,p){this.message=(e?`${e}: `:"")+u,p&&(this.identifier=p),i!=null&&i.__line__&&(this.line=i.__line__)}}function Qr(n,...e){for(const i of e)for(const u in i)n[u]=i[u];return n}class ea extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class bo{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[u,p]of i)this.bindings[u]=p}concat(e){return new bo(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const vn={kind:"null"},At={kind:"number"},yi={kind:"string"},pi={kind:"boolean"},Ra={kind:"color"},Bc={kind:"projectionDefinition"},os={kind:"object"},_i={kind:"value"},Tl={kind:"collator"},Bo={kind:"formatted"},Ts={kind:"padding"},ro={kind:"colorArray"},ss={kind:"numberArray"},Xn={kind:"resolvedImage"},fu={kind:"variableAnchorOffsetCollection"};function da(n,e){return{kind:"array",itemType:n,N:e}}function Vi(n){if(n.kind==="array"){const e=Vi(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}return n.kind}const Fo=[vn,At,yi,pi,Ra,Bc,Bo,os,da(_i),Ts,ss,ro,Xn,fu];function ls(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!ls(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(const i of Fo)if(!ls(i,e))return null}}return`Expected ${Vi(n)} but found ${Vi(e)} instead.`}function Sl(n,e){return e.some((i=>i.kind===n.kind))}function Ss(n,e){return e.some((i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n))}function Ta(n,e){return n.kind==="array"&&e.kind==="array"?n.itemType.kind===e.itemType.kind&&typeof n.N=="number":n.kind===e.kind}const Gi=.96422,on=.82521,Sa=4/29,Li=6/29,Ks=3*Li*Li,Fc=Li*Li*Li,Ti=Math.PI/180,Yn=180/Math.PI;function Ml(n){return(n%=360)<0&&(n+=360),n}function Zu([n,e,i,u]){let p,_;const v=qu((.2225045*(n=kn(n))+.7168786*(e=kn(e))+.0606169*(i=kn(i)))/1);n===e&&e===i?p=_=v:(p=qu((.4360747*n+.3850649*e+.1430804*i)/Gi),_=qu((.0139322*n+.0971045*e+.7141733*i)/on));const E=116*v-16;return[E<0?0:E,500*(p-v),200*(v-_),u]}function kn(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function qu(n){return n>Fc?Math.pow(n,1/3):n/Ks+Sa}function El([n,e,i,u]){let p=(n+16)/116,_=isNaN(e)?p:p+e/500,v=isNaN(i)?p:p-i/200;return p=1*Pn(p),_=Gi*Pn(_),v=on*Pn(v),[No(3.1338561*_-1.6168667*p-.4906146*v),No(-.9787684*_+1.9161415*p+.033454*v),No(.0719453*_-.2289914*p+1.4052427*v),u]}function No(n){return(n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055)<0?0:n>1?1:n}function Pn(n){return n>Li?n*n*n:Ks*(n-Sa)}const Js=Object.hasOwn||function(n,e){return Object.prototype.hasOwnProperty.call(n,e)};function us(n,e){return Js(n,e)?n[e]:void 0}function ao(n){return parseInt(n.padEnd(2,n),16)/255}function Nc(n,e){return jo(e?n/100:n,0,1)}function jo(n,e,i){return Math.min(Math.max(e,n),i)}function pu(n){return!n.some(Number.isNaN)}const Ms={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Uo(n,e,i){return n+i*(e-n)}function Qs(n,e,i){return n.map(((u,p)=>Uo(u,e[p],i)))}class xi{constructor(e,i,u,p=1,_=!0){this.r=e,this.g=i,this.b=u,this.a=p,_||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[e,i,u,p]))}static parse(e){if(e instanceof xi)return e;if(typeof e!="string")return;const i=(function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=us(Ms,u);if(p){const[v,E,P]=p;return[v/255,E/255,P/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){const v=u.length<6?1:2;let E=1;return[ao(u.slice(E,E+=v)),ao(u.slice(E,E+=v)),ao(u.slice(E,E+=v)),ao(u.slice(E,E+v)||"ff")]}if(u.startsWith("rgb")){const v=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[E,P,R,F,V,Z,q,W,Q,te,oe,xe]=v,le=[F||" ",q||" ",te].join("");if(le==="  "||le==="  /"||le===",,"||le===",,,"){const pe=[R,Z,Q].join(""),Te=pe==="%%%"?100:pe===""?255:0;if(Te){const Me=[jo(+P/Te,0,1),jo(+V/Te,0,1),jo(+W/Te,0,1),oe?Nc(+oe,xe):1];if(pu(Me))return Me}}return}}const _=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[v,E,P,R,F,V,Z,q,W]=_,Q=[P||" ",F||" ",Z].join("");if(Q==="  "||Q==="  /"||Q===",,"||Q===",,,"){const te=[+E,jo(+R,0,100),jo(+V,0,100),q?Nc(+q,W):1];if(pu(te))return(function([oe,xe,le,pe]){function Te(Me){const Xe=(Me+oe/30)%12,gt=xe*Math.min(le,1-le);return le-gt*Math.max(-1,Math.min(Xe-3,9-Xe,1))}return oe=Ml(oe),xe/=100,le/=100,[Te(0),Te(8),Te(4),pe]})(te)}}})(e);return i?new xi(...i,!1):void 0}get rgb(){const{r:e,g:i,b:u,a:p}=this,_=p||1/0;return this.overwriteGetter("rgb",[e/_,i/_,u/_,p])}get hcl(){return this.overwriteGetter("hcl",(function(e){const[i,u,p,_]=Zu(e),v=Math.sqrt(u*u+p*p);return[Math.round(1e4*v)?Ml(Math.atan2(p,u)*Yn):NaN,v,i,_]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Zu(this.rgb))}overwriteGetter(e,i){return Object.defineProperty(this,e,{value:i}),i}toString(){const[e,i,u,p]=this.rgb;return`rgba(${[e,i,u].map((_=>Math.round(255*_))).join(",")},${p})`}static interpolate(e,i,u,p="rgb"){switch(p){case"rgb":{const[_,v,E,P]=Qs(e.rgb,i.rgb,u);return new xi(_,v,E,P,!1)}case"hcl":{const[_,v,E,P]=e.hcl,[R,F,V,Z]=i.hcl;let q,W;if(isNaN(_)||isNaN(R))isNaN(_)?isNaN(R)?q=NaN:(q=R,E!==1&&E!==0||(W=F)):(q=_,V!==1&&V!==0||(W=v));else{let le=R-_;R>_&&le>180?le-=360:R<_&&_-R>180&&(le+=360),q=_+u*le}const[Q,te,oe,xe]=(function([le,pe,Te,Me]){return le=isNaN(le)?0:le*Ti,El([Te,Math.cos(le)*pe,Math.sin(le)*pe,Me])})([q,W??Uo(v,F,u),Uo(E,V,u),Uo(P,Z,u)]);return new xi(Q,te,oe,xe,!1)}case"lab":{const[_,v,E,P]=El(Qs(e.lab,i.lab,u));return new xi(_,v,E,P,!1)}}}}xi.black=new xi(0,0,0,1),xi.white=new xi(1,1,1,1),xi.transparent=new xi(0,0,0,0),xi.red=new xi(1,0,0,1);class ka{constructor(e,i,u){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const jc=["bottom","center","top"];class Al{constructor(e,i,u,p,_,v){this.text=e,this.image=i,this.scale=u,this.fontStack=p,this.textColor=_,this.verticalAlign=v}}class Ar{constructor(e){this.sections=e}static fromString(e){return new Ar([new Al(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof Ar?e:Ar.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}}class ii{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ii)return e;if(typeof e=="number")return new ii([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const i of e)if(typeof i!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new ii(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,u){return new ii(Qs(e.values,i.values,u))}}class Xi{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Xi)return e;if(typeof e=="number")return new Xi([e]);if(Array.isArray(e)){for(const i of e)if(typeof i!="number")return;return new Xi(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,u){return new Xi(Qs(e.values,i.values,u))}}class Zt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Zt)return e;if(typeof e=="string"){const u=xi.parse(e);return u?new Zt([u]):void 0}if(!Array.isArray(e))return;const i=[];for(const u of e){if(typeof u!="string")return;const p=xi.parse(u);if(!p)return;i.push(p)}return new Zt(i)}toString(){return JSON.stringify(this.values)}static interpolate(e,i,u,p="rgb"){const _=[];if(e.values.length!=i.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${i.values.length}), cannot interpolate.`);for(let v=0;v<e.values.length;v++)_.push(xi.interpolate(e.values[v],i.values[v],u,p));return new Zt(_)}}class fn extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const Oa=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Bn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Bn)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let i=0;i<e.length;i+=2){const u=e[i],p=e[i+1];if(typeof u!="string"||!Oa.has(u)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new Bn(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,u){const p=e.values,_=i.values;if(p.length!==_.length)throw new fn(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${i.toString()}`);const v=[];for(let E=0;E<p.length;E+=2){if(p[E]!==_[E])throw new fn(`Cannot interpolate values containing mismatched anchors. from[${E}]: ${p[E]}, to[${E}]: ${_[E]}`);v.push(p[E]);const[P,R]=p[E+1],[F,V]=_[E+1];v.push([Uo(P,F,u),Uo(R,V,u)])}return new Bn(v)}}class ta{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new ta({name:e,available:!1}):null}}class Fn{constructor(e,i,u){this.from=e,this.to=i,this.transition=u}static interpolate(e,i,u){return new Fn(e,i,u)}static parse(e){return e instanceof Fn?e:Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"?new Fn(e[0],e[1],e[2]):typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number"?new Fn(e.from,e.to,e.transition):typeof e=="string"?new Fn(e,e,1):void 0}}function Ma(n,e,i,u){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[n,e,i,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[n,e,i,u]:[n,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ba(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Fn||n instanceof xi||n instanceof ka||n instanceof Ar||n instanceof ii||n instanceof Xi||n instanceof Zt||n instanceof Bn||n instanceof ta)return!0;if(Array.isArray(n)){for(const e of n)if(!Ba(e))return!1;return!0}if(typeof n=="object"){for(const e in n)if(!Ba(n[e]))return!1;return!0}return!1}function Ai(n){if(n===null)return vn;if(typeof n=="string")return yi;if(typeof n=="boolean")return pi;if(typeof n=="number")return At;if(n instanceof xi)return Ra;if(n instanceof Fn)return Bc;if(n instanceof ka)return Tl;if(n instanceof Ar)return Bo;if(n instanceof ii)return Ts;if(n instanceof Xi)return ss;if(n instanceof Zt)return ro;if(n instanceof Bn)return fu;if(n instanceof ta)return Xn;if(Array.isArray(n)){const e=n.length;let i;for(const u of n){const p=Ai(u);if(i){if(i===p)continue;i=_i;break}i=p}return da(i||_i,e)}return os}function Fa(n){const e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof xi||n instanceof Fn||n instanceof Ar||n instanceof ii||n instanceof Xi||n instanceof Zt||n instanceof Bn||n instanceof ta?n.toString():JSON.stringify(n)}class Na{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ba(e[1]))return i.error("invalid value");const u=e[1];let p=Ai(u);const _=i.expectedType;return p.kind!=="array"||p.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(p=_),new Na(p,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const el={string:yi,number:At,boolean:pi,object:os};class Ea{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let u,p=1;const _=e[0];if(_==="array"){let E,P;if(e.length>2){const R=e[1];if(typeof R!="string"||!(R in el)||R==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);E=el[R],p++}else E=_i;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);P=e[2],p++}u=da(E,P)}else{if(!el[_])throw new Error(`Types doesn't contain name = ${_}`);u=el[_]}const v=[];for(;p<e.length;p++){const E=i.parse(e[p],p,_i);if(!E)return null;v.push(E)}return new Ea(u,v)}evaluate(e){for(let i=0;i<this.args.length;i++){const u=this.args[i].evaluate(e);if(!ls(this.type,Ai(u)))return u;if(i===this.args.length-1)throw new fn(`Expected value to be of type ${Vi(this.type)}, but found ${Vi(Ai(u))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const pr={"to-boolean":pi,"to-color":Ra,"to-number":At,"to-string":yi};class ia{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const u=e[0];if(!pr[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&e.length!==2)return i.error("Expected one argument.");const p=pr[u],_=[];for(let v=1;v<e.length;v++){const E=i.parse(e[v],v,_i);if(!E)return null;_.push(E)}return new ia(p,_)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let i,u;for(const p of this.args){if(i=p.evaluate(e),u=null,i instanceof xi)return i;if(typeof i=="string"){const _=e.parseColor(i);if(_)return _}else if(Array.isArray(i)&&(u=i.length<3||i.length>4?`Invalid rgba value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Ma(i[0],i[1],i[2],i[3]),!u))return new xi(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new fn(u||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"padding":{let i;for(const u of this.args){i=u.evaluate(e);const p=ii.parse(i);if(p)return p}throw new fn(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"numberArray":{let i;for(const u of this.args){i=u.evaluate(e);const p=Xi.parse(i);if(p)return p}throw new fn(`Could not parse numberArray from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"colorArray":{let i;for(const u of this.args){i=u.evaluate(e);const p=Zt.parse(i);if(p)return p}throw new fn(`Could not parse colorArray from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"variableAnchorOffsetCollection":{let i;for(const u of this.args){i=u.evaluate(e);const p=Bn.parse(i);if(p)return p}throw new fn(`Could not parse variableAnchorOffsetCollection from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"number":{let i=null;for(const u of this.args){if(i=u.evaluate(e),i===null)return 0;const p=Number(i);if(!isNaN(p))return p}throw new fn(`Could not convert ${JSON.stringify(i)} to number.`)}case"formatted":return Ar.fromString(Fa(this.args[0].evaluate(e)));case"resolvedImage":return ta.fromString(Fa(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return Fa(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const $u=["Unknown","Point","LineString","Polygon"];class tl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?$u[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let i=this._parseColorCache.get(e);return i||(i=xi.parse(e),this._parseColorCache.set(e,i)),i}}class Pi{constructor(e,i,u=[],p,_=new bo,v=[]){this.registry=e,this.path=u,this.key=u.map((E=>`[${E}]`)).join(""),this.scope=_,this.errors=v,this.expectedType=p,this._isConstant=i}parse(e,i,u,p,_={}){return i?this.concat(i,u,p)._parse(e,_):this._parse(e,_)}_parse(e,i){function u(p,_,v){return v==="assert"?new Ea(_,[p]):v==="coerce"?new ia(_,[p]):p}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=e[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[p];if(_){let v=_.parse(e,this);if(!v)return null;if(this.expectedType){const E=this.expectedType,P=v.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||P.kind!=="value"){if(E.kind==="projectionDefinition"&&["string","array"].includes(P.kind)||["color","formatted","resolvedImage"].includes(E.kind)&&["value","string"].includes(P.kind)||["padding","numberArray"].includes(E.kind)&&["value","number","array"].includes(P.kind)||E.kind==="colorArray"&&["value","string","array"].includes(P.kind)||E.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(P.kind))v=u(v,E,i.typeAnnotation||"coerce");else if(this.checkSubtype(E,P))return null}else v=u(v,E,i.typeAnnotation||"assert")}if(!(v instanceof Na)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){const E=new tl;try{v=new Na(v.type,v.evaluate(E))}catch(P){return this.error(P.message),null}}return v}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,u){const p=typeof e=="number"?this.path.concat(e):this.path,_=u?this.scope.concat(u):this.scope;return new Pi(this.registry,this._isConstant,p,i||null,_,this.errors)}error(e,...i){const u=`${this.key}${i.map((p=>`[${p}]`)).join("")}`;this.errors.push(new ea(u,e))}checkSubtype(e,i){const u=ls(e,i);return u&&this.error(u),u}}class pn{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const u=[];for(let _=1;_<e.length-1;_+=2){const v=e[_];if(typeof v!="string")return i.error(`Expected string, but found ${typeof v} instead.`,_);if(/[^a-zA-Z0-9_]/.test(v))return i.error("Variable names must contain only alphanumeric characters or '_'.",_);const E=i.parse(e[_+1],_+1);if(!E)return null;u.push([v,E])}const p=i.parse(e[e.length-1],e.length-1,i.expectedType,u);return p?new pn(u,p):null}outputDefined(){return this.result.outputDefined()}}class kr{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const u=e[1];return i.scope.has(u)?new kr(u,i.scope.get(u)):i.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Mi{constructor(e,i,u){this.type=e,this.index=i,this.input=u}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=i.parse(e[1],1,At),p=i.parse(e[2],2,da(i.expectedType||_i));return u&&p?new Mi(p.type.itemType,u,p):null}evaluate(e){const i=this.index.evaluate(e),u=this.input.evaluate(e);if(i<0)throw new fn(`Array index out of bounds: ${i} < 0.`);if(i>=u.length)throw new fn(`Array index out of bounds: ${i} > ${u.length-1}.`);if(i!==Math.floor(i))throw new fn(`Array index must be an integer, but found ${i} instead.`);return u[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class vi{constructor(e,i){this.type=pi,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=i.parse(e[1],1,_i),p=i.parse(e[2],2,_i);return u&&p?Sl(u.type,[pi,yi,At,vn,_i])?new vi(u,p):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Vi(u.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!u)return!1;if(!Ss(i,["boolean","string","number","null"]))throw new fn(`Expected first argument to be of type boolean, string, number or null, but found ${Vi(Ai(i))} instead.`);if(!Ss(u,["string","array"]))throw new fn(`Expected second argument to be of type array or string, but found ${Vi(Ai(u))} instead.`);return u.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Cl{constructor(e,i,u){this.type=At,this.needle=e,this.haystack=i,this.fromIndex=u}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const u=i.parse(e[1],1,_i),p=i.parse(e[2],2,_i);if(!u||!p)return null;if(!Sl(u.type,[pi,yi,At,vn,_i]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Vi(u.type)} instead`);if(e.length===4){const _=i.parse(e[3],3,At);return _?new Cl(u,p,_):null}return new Cl(u,p)}evaluate(e){const i=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!Ss(i,["boolean","string","number","null"]))throw new fn(`Expected first argument to be of type boolean, string, number or null, but found ${Vi(Ai(i))} instead.`);let p;if(this.fromIndex&&(p=this.fromIndex.evaluate(e)),Ss(u,["string"])){const _=u.indexOf(i,p);return _===-1?-1:[...u.slice(0,_)].length}if(Ss(u,["array"]))return u.indexOf(i,p);throw new fn(`Expected second argument to be of type array or string, but found ${Vi(Ai(u))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Di{constructor(e,i,u,p,_,v){this.inputType=e,this.type=i,this.input=u,this.cases=p,this.outputs=_,this.otherwise=v}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let u,p;i.expectedType&&i.expectedType.kind!=="value"&&(p=i.expectedType);const _={},v=[];for(let R=2;R<e.length-1;R+=2){let F=e[R];const V=e[R+1];Array.isArray(F)||(F=[F]);const Z=i.concat(R);if(F.length===0)return Z.error("Expected at least one branch label.");for(const W of F){if(typeof W!="number"&&typeof W!="string")return Z.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return Z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return Z.error("Numeric branch labels must be integer values.");if(u){if(Z.checkSubtype(u,Ai(W)))return null}else u=Ai(W);if(_[String(W)]!==void 0)return Z.error("Branch labels must be unique.");_[String(W)]=v.length}const q=i.parse(V,R,p);if(!q)return null;p=p||q.type,v.push(q)}const E=i.parse(e[1],1,_i);if(!E)return null;const P=i.parse(e[e.length-1],e.length-1,p);return P?E.type.kind!=="value"&&i.concat(1).checkSubtype(u,E.type)?null:new Di(u,p,E,_,v,P):null}evaluate(e){const i=this.input.evaluate(e);return(Ai(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class Hu{constructor(e,i,u){this.type=e,this.branches=i,this.otherwise=u}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let u;i.expectedType&&i.expectedType.kind!=="value"&&(u=i.expectedType);const p=[];for(let v=1;v<e.length-1;v+=2){const E=i.parse(e[v],v,pi);if(!E)return null;const P=i.parse(e[v+1],v+1,u);if(!P)return null;p.push([E,P]),u=u||P.type}const _=i.parse(e[e.length-1],e.length-1,u);if(!_)return null;if(!u)throw new Error("Can't infer output type");return new Hu(u,p,_)}evaluate(e){for(const[i,u]of this.branches)if(i.evaluate(e))return u.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,u]of this.branches)e(i),e(u);e(this.otherwise)}outputDefined(){return this.branches.every((([e,i])=>i.outputDefined()))&&this.otherwise.outputDefined()}}class oo{constructor(e,i,u,p){this.type=e,this.input=i,this.beginIndex=u,this.endIndex=p}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const u=i.parse(e[1],1,_i),p=i.parse(e[2],2,At);if(!u||!p)return null;if(!Sl(u.type,[da(_i),yi,_i]))return i.error(`Expected first argument to be of type array or string, but found ${Vi(u.type)} instead`);if(e.length===4){const _=i.parse(e[3],3,At);return _?new oo(u.type,u,p,_):null}return new oo(u.type,u,p)}evaluate(e){const i=this.input.evaluate(e),u=this.beginIndex.evaluate(e);let p;if(this.endIndex&&(p=this.endIndex.evaluate(e)),Ss(i,["string"]))return[...i].slice(u,p).join("");if(Ss(i,["array"]))return i.slice(u,p);throw new fn(`Expected first argument to be of type array or string, but found ${Vi(Ai(i))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function il(n,e){const i=n.length-1;let u,p,_=0,v=i,E=0;for(;_<=v;)if(E=Math.floor((_+v)/2),u=n[E],p=n[E+1],u<=e){if(E===i||e<p)return E;_=E+1}else{if(!(u>e))throw new fn("Input is not a number.");v=E-1}return 0}class nl{constructor(e,i,u){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[p,_]of u)this.labels.push(p),this.outputs.push(_)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const u=i.parse(e[1],1,At);if(!u)return null;const p=[];let _=null;i.expectedType&&i.expectedType.kind!=="value"&&(_=i.expectedType);for(let v=1;v<e.length;v+=2){const E=v===1?-1/0:e[v],P=e[v+1],R=v,F=v+1;if(typeof E!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(p.length&&p[p.length-1][0]>=E)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const V=i.parse(P,F,_);if(!V)return null;_=_||V.type,p.push([E,V])}return new nl(_,u,p)}evaluate(e){const i=this.labels,u=this.outputs;if(i.length===1)return u[0].evaluate(e);const p=this.input.evaluate(e);if(p<=i[0])return u[0].evaluate(e);const _=i.length;return p>=i[_-1]?u[_-1].evaluate(e):u[il(i,p)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Uc(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Xu,xo,vf=(function(){if(xo)return Xu;function n(e,i,u,p){this.cx=3*e,this.bx=3*(u-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(p-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=u,this.p2y=p}return xo=1,Xu=n,n.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,i){if(i===void 0&&(i=1e-6),e<0)return 0;if(e>1)return 1;for(var u=e,p=0;p<8;p++){var _=this.sampleCurveX(u)-e;if(Math.abs(_)<i)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=_/v}var E=0,P=1;for(u=e,p=0;p<20&&(_=this.sampleCurveX(u),!(Math.abs(_-e)<i));p++)e>_?E=u:P=u,u=.5*(P-E)+E;return u},solve:function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))}},Xu})(),Vc=Uc(vf);class rr{constructor(e,i,u,p,_){this.type=e,this.operator=i,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(const[v,E]of _)this.labels.push(v),this.outputs.push(E)}static interpolationFactor(e,i,u,p){let _=0;if(e.name==="exponential")_=Vo(i,e.base,u,p);else if(e.name==="linear")_=Vo(i,1,u,p);else if(e.name==="cubic-bezier"){const v=e.controlPoints;_=new Vc(v[0],v[1],v[2],v[3]).solve(Vo(i,1,u,p))}return _}static parse(e,i){let[u,p,_,...v]=e;if(!Array.isArray(p)||p.length===0)return i.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const R=p[1];if(typeof R!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:R}}else{if(p[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const R=p.slice(1);if(R.length!==4||R.some((F=>typeof F!="number"||F<0||F>1)))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:R}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(_=i.parse(_,2,At),!_)return null;const E=[];let P=null;u!=="interpolate-hcl"&&u!=="interpolate-lab"||i.expectedType==ro?i.expectedType&&i.expectedType.kind!=="value"&&(P=i.expectedType):P=Ra;for(let R=0;R<v.length;R+=2){const F=v[R],V=v[R+1],Z=R+3,q=R+4;if(typeof F!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(E.length&&E[E.length-1][0]>=F)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Z);const W=i.parse(V,q,P);if(!W)return null;P=P||W.type,E.push([F,W])}return Ta(P,At)||Ta(P,Bc)||Ta(P,Ra)||Ta(P,Ts)||Ta(P,ss)||Ta(P,ro)||Ta(P,fu)||Ta(P,da(At))?new rr(P,u,p,_,E):i.error(`Type ${Vi(P)} is not interpolatable.`)}evaluate(e){const i=this.labels,u=this.outputs;if(i.length===1)return u[0].evaluate(e);const p=this.input.evaluate(e);if(p<=i[0])return u[0].evaluate(e);const _=i.length;if(p>=i[_-1])return u[_-1].evaluate(e);const v=il(i,p),E=rr.interpolationFactor(this.interpolation,p,i[v],i[v+1]),P=u[v].evaluate(e),R=u[v+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Uo(P,R,E);case"color":return xi.interpolate(P,R,E);case"padding":return ii.interpolate(P,R,E);case"colorArray":return Zt.interpolate(P,R,E);case"numberArray":return Xi.interpolate(P,R,E);case"variableAnchorOffsetCollection":return Bn.interpolate(P,R,E);case"array":return Qs(P,R,E);case"projectionDefinition":return Fn.interpolate(P,R,E)}case"interpolate-hcl":switch(this.type.kind){case"color":return xi.interpolate(P,R,E,"hcl");case"colorArray":return Zt.interpolate(P,R,E,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return xi.interpolate(P,R,E,"lab");case"colorArray":return Zt.interpolate(P,R,E,"lab")}}}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Vo(n,e,i,u){const p=u-i,_=n-i;return p===0?0:e===1?_/p:(Math.pow(e,_)-1)/(Math.pow(e,p)-1)}const On={color:xi.interpolate,number:Uo,padding:ii.interpolate,numberArray:Xi.interpolate,colorArray:Zt.interpolate,variableAnchorOffsetCollection:Bn.interpolate,array:Qs};class Es{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let u=null;const p=i.expectedType;p&&p.kind!=="value"&&(u=p);const _=[];for(const E of e.slice(1)){const P=i.parse(E,1+_.length,u,void 0,{typeAnnotation:"omit"});if(!P)return null;u=u||P.type,_.push(P)}if(!u)throw new Error("No output type");const v=p&&_.some((E=>ls(p,E.type)));return new Es(v?_i:u,_)}evaluate(e){let i,u=null,p=0;for(const _ of this.args)if(p++,u=_.evaluate(e),u&&u instanceof ta&&!u.available&&(i||(i=u.name),u=null,p===this.args.length&&(u=i)),u!==null)break;return u}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function Yu(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function mu(n,e,i,u){return u.compare(e,i)===0}function Gn(n,e,i){const u=n!=="=="&&n!=="!=";return class O2{constructor(_,v,E){this.type=pi,this.lhs=_,this.rhs=v,this.collator=E,this.hasUntypedArgument=_.type.kind==="value"||v.type.kind==="value"}static parse(_,v){if(_.length!==3&&_.length!==4)return v.error("Expected two or three arguments.");const E=_[0];let P=v.parse(_[1],1,_i);if(!P)return null;if(!Yu(E,P.type))return v.concat(1).error(`"${E}" comparisons are not supported for type '${Vi(P.type)}'.`);let R=v.parse(_[2],2,_i);if(!R)return null;if(!Yu(E,R.type))return v.concat(2).error(`"${E}" comparisons are not supported for type '${Vi(R.type)}'.`);if(P.type.kind!==R.type.kind&&P.type.kind!=="value"&&R.type.kind!=="value")return v.error(`Cannot compare types '${Vi(P.type)}' and '${Vi(R.type)}'.`);u&&(P.type.kind==="value"&&R.type.kind!=="value"?P=new Ea(R.type,[P]):P.type.kind!=="value"&&R.type.kind==="value"&&(R=new Ea(P.type,[R])));let F=null;if(_.length===4){if(P.type.kind!=="string"&&R.type.kind!=="string"&&P.type.kind!=="value"&&R.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(F=v.parse(_[3],3,Tl),!F)return null}return new O2(P,R,F)}evaluate(_){const v=this.lhs.evaluate(_),E=this.rhs.evaluate(_);if(u&&this.hasUntypedArgument){const P=Ai(v),R=Ai(E);if(P.kind!==R.kind||P.kind!=="string"&&P.kind!=="number")throw new fn(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${P.kind}, ${R.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const P=Ai(v),R=Ai(E);if(P.kind!=="string"||R.kind!=="string")return e(_,v,E)}return this.collator?i(_,v,E,this.collator.evaluate(_)):e(_,v,E)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const pd=Gn("==",(function(n,e,i){return e===i}),mu),Gc=Gn("!=",(function(n,e,i){return e!==i}),(function(n,e,i,u){return!mu(0,e,i,u)})),Zc=Gn("<",(function(n,e,i){return e<i}),(function(n,e,i,u){return u.compare(e,i)<0})),bf=Gn(">",(function(n,e,i){return e>i}),(function(n,e,i,u){return u.compare(e,i)>0})),Pl=Gn("<=",(function(n,e,i){return e<=i}),(function(n,e,i,u){return u.compare(e,i)<=0})),Wu=Gn(">=",(function(n,e,i){return e>=i}),(function(n,e,i,u){return u.compare(e,i)>=0}));class As{constructor(e,i,u){this.type=Tl,this.locale=u,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const u=e[1];if(typeof u!="object"||Array.isArray(u))return i.error("Collator options argument must be an object.");const p=i.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,pi);if(!p)return null;const _=i.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,pi);if(!_)return null;let v=null;return u.locale&&(v=i.parse(u.locale,1,yi),!v)?null:new As(p,_,v)}evaluate(e){return new ka(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Cs{constructor(e,i,u,p,_){this.type=yi,this.number=e,this.locale=i,this.currency=u,this.minFractionDigits=p,this.maxFractionDigits=_}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const u=i.parse(e[1],1,At);if(!u)return null;const p=e[2];if(typeof p!="object"||Array.isArray(p))return i.error("NumberFormat options argument must be an object.");let _=null;if(p.locale&&(_=i.parse(p.locale,1,yi),!_))return null;let v=null;if(p.currency&&(v=i.parse(p.currency,1,yi),!v))return null;let E=null;if(p["min-fraction-digits"]&&(E=i.parse(p["min-fraction-digits"],1,At),!E))return null;let P=null;return p["max-fraction-digits"]&&(P=i.parse(p["max-fraction-digits"],1,At),!P)?null:new Cs(u,_,v,E,P)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Ku{constructor(e){this.type=Bo,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const u=e[1];if(!Array.isArray(u)&&typeof u=="object")return i.error("First argument must be an image or text section.");const p=[];let _=!1;for(let v=1;v<=e.length-1;++v){const E=e[v];if(_&&typeof E=="object"&&!Array.isArray(E)){_=!1;let P=null;if(E["font-scale"]&&(P=i.parse(E["font-scale"],1,At),!P))return null;let R=null;if(E["text-font"]&&(R=i.parse(E["text-font"],1,da(yi)),!R))return null;let F=null;if(E["text-color"]&&(F=i.parse(E["text-color"],1,Ra),!F))return null;let V=null;if(E["vertical-align"]){if(typeof E["vertical-align"]=="string"&&!jc.includes(E["vertical-align"]))return i.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${E["vertical-align"]}' instead.`);if(V=i.parse(E["vertical-align"],1,yi),!V)return null}const Z=p[p.length-1];Z.scale=P,Z.font=R,Z.textColor=F,Z.verticalAlign=V}else{const P=i.parse(e[v],1,_i);if(!P)return null;const R=P.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,p.push({content:P,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Ku(p)}evaluate(e){return new Ar(this.sections.map((i=>{const u=i.content.evaluate(e);return Ai(u)===Xn?new Al("",u,null,null,null,i.verticalAlign?i.verticalAlign.evaluate(e):null):new Al(Fa(u),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null,i.verticalAlign?i.verticalAlign.evaluate(e):null)})))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor),i.verticalAlign&&e(i.verticalAlign)}outputDefined(){return!1}}class cs{constructor(e){this.type=Xn,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const u=i.parse(e[1],1,yi);return u?new cs(u):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),u=ta.fromString(i);return u&&e.availableImages&&(u.available=e.availableImages.indexOf(i)>-1),u}eachChild(e){e(this.input)}outputDefined(){return!1}}class na{constructor(e){this.type=At,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const u=i.parse(e[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${Vi(u.type)} instead.`):new na(u):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string")return[...i].length;if(Array.isArray(i))return i.length;throw new fn(`Expected value to be of type string or array, but found ${Vi(Ai(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Wn=8192;function zl(n,e){const i=(180+n[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,p=Math.pow(2,e.z);return[Math.round(i*p*Wn),Math.round(u*p*Wn)]}function gu(n,e){const i=Math.pow(2,e.z);return[(p=(n[0]/Wn+e.x)/i,360*p-180),(u=(n[1]/Wn+e.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90)];var u,p}function rl(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function hs(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function md(n,e,i){const u=n[0]-e[0],p=n[1]-e[1],_=n[0]-i[0],v=n[1]-i[1];return u*v-_*p==0&&u*_<=0&&p*v<=0}function Ju(n,e,i,u){return(p=[u[0]-i[0],u[1]-i[1]])[0]*(_=[e[0]-n[0],e[1]-n[1]])[1]-p[1]*_[0]!=0&&!(!wo(n,e,i,u)||!wo(i,u,n,e));var p,_}function zh(n,e,i){for(const u of i)for(let p=0;p<u.length-1;++p)if(Ju(n,e,u[p],u[p+1]))return!0;return!1}function Go(n,e,i=!1){let u=!1;for(const E of e)for(let P=0;P<E.length-1;P++){if(md(n,E[P],E[P+1]))return i;(_=E[P])[1]>(p=n)[1]!=(v=E[P+1])[1]>p[1]&&p[0]<(v[0]-_[0])*(p[1]-_[1])/(v[1]-_[1])+_[0]&&(u=!u)}var p,_,v;return u}function ja(n,e){for(const i of e)if(Go(n,i))return!0;return!1}function Il(n,e){for(const i of n)if(!Go(i,e))return!1;for(let i=0;i<n.length-1;++i)if(zh(n[i],n[i+1],e))return!1;return!0}function gd(n,e){for(const i of e)if(Il(n,i))return!0;return!1}function wo(n,e,i,u){const p=u[0]-i[0],_=u[1]-i[1],v=(n[0]-i[0])*_-p*(n[1]-i[1]),E=(e[0]-i[0])*_-p*(e[1]-i[1]);return v>0&&E<0||v<0&&E>0}function qc(n,e,i){const u=[];for(let p=0;p<n.length;p++){const _=[];for(let v=0;v<n[p].length;v++){const E=zl(n[p][v],i);rl(e,E),_.push(E)}u.push(_)}return u}function To(n,e,i){const u=[];for(let p=0;p<n.length;p++){const _=qc(n[p],e,i);u.push(_)}return u}function yu(n,e,i,u){if(n[0]<i[0]||n[0]>i[2]){const p=.5*u;let _=n[0]-i[0]>p?-u:i[0]-n[0]>p?u:0;_===0&&(_=n[0]-i[2]>p?-u:i[2]-n[0]>p?u:0),n[0]+=_}rl(e,n)}function _u(n,e,i,u){const p=Math.pow(2,u.z)*Wn,_=[u.x*Wn,u.y*Wn],v=[];for(const E of n)for(const P of E){const R=[P.x+_[0],P.y+_[1]];yu(R,e,i,p),v.push(R)}return v}function vu(n,e,i,u){const p=Math.pow(2,u.z)*Wn,_=[u.x*Wn,u.y*Wn],v=[];for(const P of n){const R=[];for(const F of P){const V=[F.x+_[0],F.y+_[1]];rl(e,V),R.push(V)}v.push(R)}if(e[2]-e[0]<=p/2){(E=e)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const P of v)for(const R of P)yu(R,e,i,p)}var E;return v}class Zo{constructor(e,i){this.type=pi,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ba(e[1])){const u=e[1];if(u.type==="FeatureCollection"){const p=[];for(const _ of u.features){const{type:v,coordinates:E}=_.geometry;v==="Polygon"&&p.push(E),v==="MultiPolygon"&&p.push(...E)}if(p.length)return new Zo(u,{type:"MultiPolygon",coordinates:p})}else if(u.type==="Feature"){const p=u.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Zo(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Zo(u,u)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(i,u){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=i.canonicalID();if(u.type==="Polygon"){const E=qc(u.coordinates,_,v),P=_u(i.geometry(),p,_,v);if(!hs(p,_))return!1;for(const R of P)if(!Go(R,E))return!1}if(u.type==="MultiPolygon"){const E=To(u.coordinates,_,v),P=_u(i.geometry(),p,_,v);if(!hs(p,_))return!1;for(const R of P)if(!ja(R,E))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(i,u){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=i.canonicalID();if(u.type==="Polygon"){const E=qc(u.coordinates,_,v),P=vu(i.geometry(),p,_,v);if(!hs(p,_))return!1;for(const R of P)if(!Il(R,E))return!1}if(u.type==="MultiPolygon"){const E=To(u.coordinates,_,v),P=vu(i.geometry(),p,_,v);if(!hs(p,_))return!1;for(const R of P)if(!gd(R,E))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ih=class{constructor(n=[],e=(i,u)=>i<u?-1:i>u?1:0){if(this.data=n,this.length=this.data.length,this.compare=e,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:e,compare:i}=this,u=e[n];for(;n>0;){const p=n-1>>1,_=e[p];if(i(u,_)>=0)break;e[n]=_,n=p}e[n]=u}_down(n){const{data:e,compare:i}=this,u=this.length>>1,p=e[n];for(;n<u;){let _=1+(n<<1);const v=_+1;if(v<this.length&&i(e[v],e[_])<0&&(_=v),i(e[_],p)>=0)break;e[n]=e[_],n=_}e[n]=p}};function So(n,e,i=0,u=n.length-1,p=Lh){for(;u>i;){if(u-i>600){const P=u-i+1,R=e-i+1,F=Math.log(P),V=.5*Math.exp(2*F/3),Z=.5*Math.sqrt(F*V*(P-V)/P)*(R-P/2<0?-1:1);So(n,e,Math.max(i,Math.floor(e-R*V/P+Z)),Math.min(u,Math.floor(e+(P-R)*V/P+Z)),p)}const _=n[e];let v=i,E=u;for(qo(n,i,e),p(n[u],_)>0&&qo(n,i,u);v<E;){for(qo(n,v,E),v++,E--;p(n[v],_)<0;)v++;for(;p(n[E],_)>0;)E--}p(n[i],_)===0?qo(n,i,E):(E++,qo(n,E,u)),E<=e&&(i=E+1),e<=E&&(u=E-1)}}function qo(n,e,i){const u=n[e];n[e]=n[i],n[i]=u}function Lh(n,e){return n<e?-1:n>e?1:0}function Ll(n,e){if(n.length<=1)return[n];const i=[];let u,p;for(const _ of n){const v=Ps(_);v!==0&&(_.area=Math.abs(v),p===void 0&&(p=v<0),p===v<0?(u&&i.push(u),u=[_]):u.push(_))}if(u&&i.push(u),e>1)for(let _=0;_<i.length;_++)i[_].length<=e||(So(i[_],e,1,i[_].length-1,yd),i[_]=i[_].slice(0,e));return i}function yd(n,e){return e.area-n.area}function Ps(n){let e=0;for(let i,u,p=0,_=n.length,v=_-1;p<_;v=p++)i=n[p],u=n[v],e+=(u.x-i.x)*(i.y+u.y);return e}const _d=1/298.257223563,ds=_d*(2-_d),vd=Math.PI/180;class $o{constructor(e){const i=6378.137*vd*1e3,u=Math.cos(e*vd),p=1/(1-ds*(1-u*u)),_=Math.sqrt(p);this.kx=i*_*u,this.ky=i*_*p*(1-ds)}distance(e,i){const u=this.wrap(e[0]-i[0])*this.kx,p=(e[1]-i[1])*this.ky;return Math.sqrt(u*u+p*p)}pointOnLine(e,i){let u,p,_,v,E=1/0;for(let P=0;P<e.length-1;P++){let R=e[P][0],F=e[P][1],V=this.wrap(e[P+1][0]-R)*this.kx,Z=(e[P+1][1]-F)*this.ky,q=0;V===0&&Z===0||(q=(this.wrap(i[0]-R)*this.kx*V+(i[1]-F)*this.ky*Z)/(V*V+Z*Z),q>1?(R=e[P+1][0],F=e[P+1][1]):q>0&&(R+=V/this.kx*q,F+=Z/this.ky*q)),V=this.wrap(i[0]-R)*this.kx,Z=(i[1]-F)*this.ky;const W=V*V+Z*Z;W<E&&(E=W,u=R,p=F,_=P,v=q)}return{point:[u,p],index:_,t:Math.max(0,Math.min(1,v))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function ra(n,e){return e[0]-n[0]}function zs(n){return n[1]-n[0]+1}function Ua(n,e){return n[1]>=n[0]&&n[1]<e}function al(n,e){if(n[0]>n[1])return[null,null];const i=zs(n);if(e){if(i===2)return[n,null];const p=Math.floor(i/2);return[[n[0],n[0]+p],[n[0]+p,n[1]]]}if(i===1)return[n,null];const u=Math.floor(i/2)-1;return[[n[0],n[0]+u],[n[0]+u+1,n[1]]]}function bu(n,e){if(!Ua(e,n.length))return[1/0,1/0,-1/0,-1/0];const i=[1/0,1/0,-1/0,-1/0];for(let u=e[0];u<=e[1];++u)rl(i,n[u]);return i}function Dl(n){const e=[1/0,1/0,-1/0,-1/0];for(const i of n)for(const u of i)rl(e,u);return e}function fs(n){return n[0]!==-1/0&&n[1]!==-1/0&&n[2]!==1/0&&n[3]!==1/0}function Rl(n,e,i){if(!fs(n)||!fs(e))return NaN;let u=0,p=0;return n[2]<e[0]&&(u=e[0]-n[2]),n[0]>e[2]&&(u=n[0]-e[2]),n[1]>e[3]&&(p=n[1]-e[3]),n[3]<e[1]&&(p=e[1]-n[3]),i.distance([0,0],[u,p])}function Va(n,e,i){const u=i.pointOnLine(e,n);return i.distance(n,u.point)}function xu(n,e,i,u,p){const _=Math.min(Va(n,[i,u],p),Va(e,[i,u],p)),v=Math.min(Va(i,[n,e],p),Va(u,[n,e],p));return Math.min(_,v)}function Qu(n,e,i,u,p){if(!Ua(e,n.length)||!Ua(u,i.length))return 1/0;let _=1/0;for(let v=e[0];v<e[1];++v){const E=n[v],P=n[v+1];for(let R=u[0];R<u[1];++R){const F=i[R],V=i[R+1];if(Ju(E,P,F,V))return 0;_=Math.min(_,xu(E,P,F,V,p))}}return _}function kl(n,e,i,u,p){if(!Ua(e,n.length)||!Ua(u,i.length))return NaN;let _=1/0;for(let v=e[0];v<=e[1];++v)for(let E=u[0];E<=u[1];++E)if(_=Math.min(_,p.distance(n[v],i[E])),_===0)return _;return _}function bd(n,e,i){if(Go(n,e,!0))return 0;let u=1/0;for(const p of e){const _=p[0],v=p[p.length-1];if(_!==v&&(u=Math.min(u,Va(n,[v,_],i)),u===0))return u;const E=i.pointOnLine(p,n);if(u=Math.min(u,i.distance(n,E.point)),u===0)return u}return u}function ol(n,e,i,u){if(!Ua(e,n.length))return NaN;for(let _=e[0];_<=e[1];++_)if(Go(n[_],i,!0))return 0;let p=1/0;for(let _=e[0];_<e[1];++_){const v=n[_],E=n[_+1];for(const P of i)for(let R=0,F=P.length,V=F-1;R<F;V=R++){const Z=P[V],q=P[R];if(Ju(v,E,Z,q))return 0;p=Math.min(p,xu(v,E,Z,q,u))}}return p}function Ol(n,e){for(const i of n)for(const u of i)if(Go(u,e,!0))return!0;return!1}function $c(n,e,i,u=1/0){const p=Dl(n),_=Dl(e);if(u!==1/0&&Rl(p,_,i)>=u)return u;if(hs(p,_)){if(Ol(n,e))return 0}else if(Ol(e,n))return 0;let v=1/0;for(const E of n)for(let P=0,R=E.length,F=R-1;P<R;F=P++){const V=E[F],Z=E[P];for(const q of e)for(let W=0,Q=q.length,te=Q-1;W<Q;te=W++){const oe=q[te],xe=q[W];if(Ju(V,Z,oe,xe))return 0;v=Math.min(v,xu(V,Z,oe,xe,i))}}return v}function Yi(n,e,i,u,p,_){if(!_)return;const v=Rl(bu(u,_),p,i);v<e&&n.push([v,_,[0,0]])}function Cr(n,e,i,u,p,_,v){if(!_||!v)return;const E=Rl(bu(u,_),bu(p,v),i);E<e&&n.push([E,_,v])}function sl(n,e,i,u,p=1/0){let _=Math.min(u.distance(n[0],i[0][0]),p);if(_===0)return _;const v=new Ih([[0,[0,n.length-1],[0,0]]],ra),E=Dl(i);for(;v.length>0;){const P=v.pop();if(P[0]>=_)continue;const R=P[1],F=e?50:100;if(zs(R)<=F){if(!Ua(R,n.length))return NaN;if(e){const V=ol(n,R,i,u);if(isNaN(V)||V===0)return V;_=Math.min(_,V)}else for(let V=R[0];V<=R[1];++V){const Z=bd(n[V],i,u);if(_=Math.min(_,Z),_===0)return 0}}else{const V=al(R,e);Yi(v,_,u,n,E,V[0]),Yi(v,_,u,n,E,V[1])}}return _}function ec(n,e,i,u,p,_=1/0){let v=Math.min(_,p.distance(n[0],i[0]));if(v===0)return v;const E=new Ih([[0,[0,n.length-1],[0,i.length-1]]],ra);for(;E.length>0;){const P=E.pop();if(P[0]>=v)continue;const R=P[1],F=P[2],V=e?50:100,Z=u?50:100;if(zs(R)<=V&&zs(F)<=Z){if(!Ua(R,n.length)&&Ua(F,i.length))return NaN;let q;if(e&&u)q=Qu(n,R,i,F,p),v=Math.min(v,q);else if(e&&!u){const W=n.slice(R[0],R[1]+1);for(let Q=F[0];Q<=F[1];++Q)if(q=Va(i[Q],W,p),v=Math.min(v,q),v===0)return v}else if(!e&&u){const W=i.slice(F[0],F[1]+1);for(let Q=R[0];Q<=R[1];++Q)if(q=Va(n[Q],W,p),v=Math.min(v,q),v===0)return v}else q=kl(n,R,i,F,p),v=Math.min(v,q)}else{const q=al(R,e),W=al(F,u);Cr(E,v,p,n,i,q[0],W[0]),Cr(E,v,p,n,i,q[0],W[1]),Cr(E,v,p,n,i,q[1],W[0]),Cr(E,v,p,n,i,q[1],W[1])}}return v}function Bl(n){return n.type==="MultiPolygon"?n.coordinates.map((e=>({type:"Polygon",coordinates:e}))):n.type==="MultiLineString"?n.coordinates.map((e=>({type:"LineString",coordinates:e}))):n.type==="MultiPoint"?n.coordinates.map((e=>({type:"Point",coordinates:e}))):[n]}class Fl{constructor(e,i){this.type=At,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ba(e[1])){const u=e[1];if(u.type==="FeatureCollection")return new Fl(u,u.features.map((p=>Bl(p.geometry))).flat());if(u.type==="Feature")return new Fl(u,Bl(u.geometry));if("type"in u&&"coordinates"in u)return new Fl(u,Bl(u))}return i.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(i,u){const p=i.geometry(),_=p.flat().map((P=>gu([P.x,P.y],i.canonical)));if(p.length===0)return NaN;const v=new $o(_[0][1]);let E=1/0;for(const P of u){switch(P.type){case"Point":E=Math.min(E,ec(_,!1,[P.coordinates],!1,v,E));break;case"LineString":E=Math.min(E,ec(_,!1,P.coordinates,!0,v,E));break;case"Polygon":E=Math.min(E,sl(_,!1,P.coordinates,v,E))}if(E===0)return E}return E})(e,this.geometries);if(e.geometryType()==="LineString")return(function(i,u){const p=i.geometry(),_=p.flat().map((P=>gu([P.x,P.y],i.canonical)));if(p.length===0)return NaN;const v=new $o(_[0][1]);let E=1/0;for(const P of u){switch(P.type){case"Point":E=Math.min(E,ec(_,!0,[P.coordinates],!1,v,E));break;case"LineString":E=Math.min(E,ec(_,!0,P.coordinates,!0,v,E));break;case"Polygon":E=Math.min(E,sl(_,!0,P.coordinates,v,E))}if(E===0)return E}return E})(e,this.geometries);if(e.geometryType()==="Polygon")return(function(i,u){const p=i.geometry();if(p.length===0||p[0].length===0)return NaN;const _=Ll(p,0).map((P=>P.map((R=>R.map((F=>gu([F.x,F.y],i.canonical))))))),v=new $o(_[0][0][0][1]);let E=1/0;for(const P of u)for(const R of _){switch(P.type){case"Point":E=Math.min(E,sl([P.coordinates],!1,R,v,E));break;case"LineString":E=Math.min(E,sl(P.coordinates,!0,R,v,E));break;case"Polygon":E=Math.min(E,$c(R,P.coordinates,v,E))}if(E===0)return E}return E})(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class wu{constructor(e){this.type=_i,this.key=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const u=e[1];return u==null?i.error("Global state property must be defined."):typeof u!="string"?i.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new wu(u)}evaluate(e){var i;const u=(i=e.globals)===null||i===void 0?void 0:i.globalState;return u&&Object.keys(u).length!==0?us(u,this.key):null}eachChild(){}outputDefined(){return!1}}const Tu={"==":pd,"!=":Gc,">":bf,"<":Zc,">=":Wu,"<=":Pl,array:Ea,at:Mi,boolean:Ea,case:Hu,coalesce:Es,collator:As,format:Ku,image:cs,in:vi,"index-of":Cl,interpolate:rr,"interpolate-hcl":rr,"interpolate-lab":rr,length:na,let:pn,literal:Na,match:Di,number:Ea,"number-format":Cs,object:Ea,slice:oo,step:nl,string:Ea,"to-boolean":ia,"to-color":ia,"to-number":ia,"to-string":ia,var:kr,within:Zo,distance:Fl,"global-state":wu};class aa{constructor(e,i,u,p){this.name=e,this.type=i,this._evaluate=u,this.args=p}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,i){const u=e[0],p=aa.definitions[u];if(!p)return i.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(p)?p[0]:p.type,v=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,E=v.filter((([R])=>!Array.isArray(R)||R.length===e.length-1));let P=null;for(const[R,F]of E){P=new Pi(i.registry,Aa,i.path,null,i.scope);const V=[];let Z=!1;for(let q=1;q<e.length;q++){const W=e[q],Q=Array.isArray(R)?R[q-1]:R.type,te=P.parse(W,1+V.length,Q);if(!te){Z=!0;break}V.push(te)}if(!Z)if(Array.isArray(R)&&R.length!==V.length)P.error(`Expected ${R.length} arguments, but found ${V.length} instead.`);else{for(let q=0;q<V.length;q++){const W=Array.isArray(R)?R[q]:R.type,Q=V[q];P.concat(q+1).checkSubtype(W,Q.type)}if(P.errors.length===0)return new aa(u,_,F,V)}}if(E.length===1)i.errors.push(...P.errors);else{const R=(E.length?E:v).map((([V])=>{return Z=V,Array.isArray(Z)?`(${Z.map(Vi).join(", ")})`:`(${Vi(Z.type)}...)`;var Z})).join(" | "),F=[];for(let V=1;V<e.length;V++){const Z=i.parse(e[V],1+F.length);if(!Z)return null;F.push(Vi(Z.type))}i.error(`Expected arguments of type ${R}, but found (${F.join(", ")}) instead.`)}return null}static register(e,i){aa.definitions=i;for(const u in i)e[u]=aa}}function Dh(n,[e,i,u,p]){e=e.evaluate(n),i=i.evaluate(n),u=u.evaluate(n);const _=p?p.evaluate(n):1,v=Ma(e,i,u,_);if(v)throw new fn(v);return new xi(e/255,i/255,u/255,_,!1)}function Is(n,e){return n in e}function Ga(n,e){const i=e[n];return i===void 0?null:i}function Ho(n){return{type:n}}function Aa(n){if(n instanceof kr)return Aa(n.boundExpression);if(n instanceof aa&&n.name==="error"||n instanceof As||n instanceof Zo||n instanceof Fl||n instanceof wu)return!1;const e=n instanceof ia||n instanceof Ea;let i=!0;return n.eachChild((u=>{i=e?i&&Aa(u):i&&u instanceof Na})),!!i&&oa(n)&&ul(n,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function oa(n){if(n instanceof aa&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof Zo||n instanceof Fl)return!1;let e=!0;return n.eachChild((i=>{e&&!oa(i)&&(e=!1)})),e}function ll(n){if(n instanceof aa&&n.name==="feature-state")return!1;let e=!0;return n.eachChild((i=>{e&&!ll(i)&&(e=!1)})),e}function ul(n,e){if(n instanceof aa&&e.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild((u=>{i&&!ul(u,e)&&(i=!1)})),i}function Ls(n){return{result:"success",value:n}}function cl(n){return{result:"error",value:n}}function Ca(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function Nl(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function jl(n){return!!n.expression&&n.expression.interpolated}function Si(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Hc(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&Ai(n)===os}function Za(n){return n}function tc(n,e){const i=n.stops&&typeof n.stops[0][0]=="object",u=i||!(i||n.property!==void 0),p=n.type||(jl(e)?"exponential":"interval"),_=(function(F){switch(F.type){case"color":return xi.parse;case"padding":return ii.parse;case"numberArray":return Xi.parse;case"colorArray":return Zt.parse;default:return null}})(e);if(_&&((n=Qr({},n)).stops&&(n.stops=n.stops.map((F=>[F[0],_(F[1])]))),n.default=_(n.default?n.default:e.default)),n.colorSpace&&(v=n.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${n.colorSpace}"`);var v;const E=(function(F){switch(F){case"exponential":return hl;case"interval":return ic;case"categorical":return Rh;case"identity":return Xc;default:throw new Error(`Unknown function type "${F}"`)}})(p);let P,R;if(p==="categorical"){P=Object.create(null);for(const F of n.stops)P[F[0]]=F[1];R=typeof n.stops[0][0]}if(i){const F={},V=[];for(let W=0;W<n.stops.length;W++){const Q=n.stops[W],te=Q[0].zoom;F[te]===void 0&&(F[te]={zoom:te,type:n.type,property:n.property,default:n.default,stops:[]},V.push(te)),F[te].stops.push([Q[0].value,Q[1]])}const Z=[];for(const W of V)Z.push([F[W].zoom,tc(F[W],e)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:rr.interpolationFactor.bind(void 0,q),zoomStops:Z.map((W=>W[0])),evaluate:({zoom:W},Q)=>hl({stops:Z,base:n.base},e,W).evaluate(W,Q)}}if(u){const F=p==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:rr.interpolationFactor.bind(void 0,F),zoomStops:n.stops.map((V=>V[0])),evaluate:({zoom:V})=>E(n,e,V,P,R)}}return{kind:"source",evaluate(F,V){const Z=V&&V.properties?V.properties[n.property]:void 0;return Z===void 0?qa(n.default,e.default):E(n,e,Z,P,R)}}}function qa(n,e,i){return n!==void 0?n:e!==void 0?e:i!==void 0?i:void 0}function Rh(n,e,i,u,p){return qa(typeof i===p?u[i]:void 0,n.default,e.default)}function ic(n,e,i){if(Si(i)!=="number")return qa(n.default,e.default);const u=n.stops.length;if(u===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[u-1][0])return n.stops[u-1][1];const p=il(n.stops.map((_=>_[0])),i);return n.stops[p][1]}function hl(n,e,i){const u=n.base!==void 0?n.base:1;if(Si(i)!=="number")return qa(n.default,e.default);const p=n.stops.length;if(p===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[p-1][0])return n.stops[p-1][1];const _=il(n.stops.map((F=>F[0])),i),v=(function(F,V,Z,q){const W=q-Z,Q=F-Z;return W===0?0:V===1?Q/W:(Math.pow(V,Q)-1)/(Math.pow(V,W)-1)})(i,u,n.stops[_][0],n.stops[_+1][0]),E=n.stops[_][1],P=n.stops[_+1][1],R=On[e.type]||Za;return typeof E.evaluate=="function"?{evaluate(...F){const V=E.evaluate.apply(void 0,F),Z=P.evaluate.apply(void 0,F);if(V!==void 0&&Z!==void 0)return R(V,Z,v,n.colorSpace)}}:R(E,P,v,n.colorSpace)}function Xc(n,e,i){switch(e.type){case"color":i=xi.parse(i);break;case"formatted":i=Ar.fromString(i.toString());break;case"resolvedImage":i=ta.fromString(i.toString());break;case"padding":i=ii.parse(i);break;case"colorArray":i=Zt.parse(i);break;case"numberArray":i=Xi.parse(i);break;default:Si(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0)}return qa(i,n.default,e.default)}aa.register(Tu,{error:[{kind:"error"},[yi],(n,[e])=>{throw new fn(e.evaluate(n))}],typeof:[yi,[_i],(n,[e])=>Vi(Ai(e.evaluate(n)))],"to-rgba":[da(At,4),[Ra],(n,[e])=>{const[i,u,p,_]=e.evaluate(n).rgb;return[255*i,255*u,255*p,_]}],rgb:[Ra,[At,At,At],Dh],rgba:[Ra,[At,At,At,At],Dh],has:{type:pi,overloads:[[[yi],(n,[e])=>Is(e.evaluate(n),n.properties())],[[yi,os],(n,[e,i])=>Is(e.evaluate(n),i.evaluate(n))]]},get:{type:_i,overloads:[[[yi],(n,[e])=>Ga(e.evaluate(n),n.properties())],[[yi,os],(n,[e,i])=>Ga(e.evaluate(n),i.evaluate(n))]]},"feature-state":[_i,[yi],(n,[e])=>Ga(e.evaluate(n),n.featureState||{})],properties:[os,[],n=>n.properties()],"geometry-type":[yi,[],n=>n.geometryType()],id:[_i,[],n=>n.id()],zoom:[At,[],n=>n.globals.zoom],"heatmap-density":[At,[],n=>n.globals.heatmapDensity||0],elevation:[At,[],n=>n.globals.elevation||0],"line-progress":[At,[],n=>n.globals.lineProgress||0],accumulated:[_i,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[At,Ho(At),(n,e)=>{let i=0;for(const u of e)i+=u.evaluate(n);return i}],"*":[At,Ho(At),(n,e)=>{let i=1;for(const u of e)i*=u.evaluate(n);return i}],"-":{type:At,overloads:[[[At,At],(n,[e,i])=>e.evaluate(n)-i.evaluate(n)],[[At],(n,[e])=>-e.evaluate(n)]]},"/":[At,[At,At],(n,[e,i])=>e.evaluate(n)/i.evaluate(n)],"%":[At,[At,At],(n,[e,i])=>e.evaluate(n)%i.evaluate(n)],ln2:[At,[],()=>Math.LN2],pi:[At,[],()=>Math.PI],e:[At,[],()=>Math.E],"^":[At,[At,At],(n,[e,i])=>Math.pow(e.evaluate(n),i.evaluate(n))],sqrt:[At,[At],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[At,[At],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[At,[At],(n,[e])=>Math.log(e.evaluate(n))],log2:[At,[At],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[At,[At],(n,[e])=>Math.sin(e.evaluate(n))],cos:[At,[At],(n,[e])=>Math.cos(e.evaluate(n))],tan:[At,[At],(n,[e])=>Math.tan(e.evaluate(n))],asin:[At,[At],(n,[e])=>Math.asin(e.evaluate(n))],acos:[At,[At],(n,[e])=>Math.acos(e.evaluate(n))],atan:[At,[At],(n,[e])=>Math.atan(e.evaluate(n))],min:[At,Ho(At),(n,e)=>Math.min(...e.map((i=>i.evaluate(n))))],max:[At,Ho(At),(n,e)=>Math.max(...e.map((i=>i.evaluate(n))))],abs:[At,[At],(n,[e])=>Math.abs(e.evaluate(n))],round:[At,[At],(n,[e])=>{const i=e.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[At,[At],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[At,[At],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[pi,[yi,_i],(n,[e,i])=>n.properties()[e.value]===i.value],"filter-id-==":[pi,[_i],(n,[e])=>n.id()===e.value],"filter-type-==":[pi,[yi],(n,[e])=>n.geometryType()===e.value],"filter-<":[pi,[yi,_i],(n,[e,i])=>{const u=n.properties()[e.value],p=i.value;return typeof u==typeof p&&u<p}],"filter-id-<":[pi,[_i],(n,[e])=>{const i=n.id(),u=e.value;return typeof i==typeof u&&i<u}],"filter->":[pi,[yi,_i],(n,[e,i])=>{const u=n.properties()[e.value],p=i.value;return typeof u==typeof p&&u>p}],"filter-id->":[pi,[_i],(n,[e])=>{const i=n.id(),u=e.value;return typeof i==typeof u&&i>u}],"filter-<=":[pi,[yi,_i],(n,[e,i])=>{const u=n.properties()[e.value],p=i.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[pi,[_i],(n,[e])=>{const i=n.id(),u=e.value;return typeof i==typeof u&&i<=u}],"filter->=":[pi,[yi,_i],(n,[e,i])=>{const u=n.properties()[e.value],p=i.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[pi,[_i],(n,[e])=>{const i=n.id(),u=e.value;return typeof i==typeof u&&i>=u}],"filter-has":[pi,[_i],(n,[e])=>e.value in n.properties()],"filter-has-id":[pi,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[pi,[da(yi)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[pi,[da(_i)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[pi,[yi,da(_i)],(n,[e,i])=>i.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[pi,[yi,da(_i)],(n,[e,i])=>(function(u,p,_,v){for(;_<=v;){const E=_+v>>1;if(p[E]===u)return!0;p[E]>u?v=E-1:_=E+1}return!1})(n.properties()[e.value],i.value,0,i.value.length-1)],all:{type:pi,overloads:[[[pi,pi],(n,[e,i])=>e.evaluate(n)&&i.evaluate(n)],[Ho(pi),(n,e)=>{for(const i of e)if(!i.evaluate(n))return!1;return!0}]]},any:{type:pi,overloads:[[[pi,pi],(n,[e,i])=>e.evaluate(n)||i.evaluate(n)],[Ho(pi),(n,e)=>{for(const i of e)if(i.evaluate(n))return!0;return!1}]]},"!":[pi,[pi],(n,[e])=>!e.evaluate(n)],"is-supported-script":[pi,[yi],(n,[e])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(e.evaluate(n))}],upcase:[yi,[yi],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[yi,[yi],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[yi,Ho(_i),(n,e)=>e.map((i=>Fa(i.evaluate(n)))).join("")],"resolved-locale":[yi,[Tl],(n,[e])=>e.evaluate(n).resolvedLocale()]});class nc{constructor(e,i,u){this.expression=e,this._warningHistory={},this._evaluator=new tl,this._defaultValue=i?(function(p){if(p.type==="color"&&Hc(p.default))return new xi(0,0,0,0);switch(p.type){case"color":return xi.parse(p.default)||null;case"padding":return ii.parse(p.default)||null;case"numberArray":return Xi.parse(p.default)||null;case"colorArray":return Zt.parse(p.default)||null;case"variableAnchorOffsetCollection":return Bn.parse(p.default)||null;case"projectionDefinition":return Fn.parse(p.default)||null;default:return p.default===void 0?null:p.default}})(i):null,this._enumValues=i&&i.type==="enum"?i.values:null,this._globalState=u}evaluateWithoutErrorHandling(e,i,u,p,_,v){return this._globalState&&(e=Ue(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=u,this._evaluator.canonical=p,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(e,i,u,p,_,v){this._globalState&&(e=Ue(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v||null;try{const E=this.expression.evaluate(this._evaluator);if(E==null||typeof E=="number"&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new fn(`Expected value to be one of ${Object.keys(this._enumValues).map((P=>JSON.stringify(P))).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function dl(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Tu}function d(n,e,i){const u=new Pi(Tu,Aa,[],e?(function(_){const v={color:Ra,string:yi,number:At,enum:yi,boolean:pi,formatted:Bo,padding:Ts,numberArray:ss,colorArray:ro,projectionDefinition:Bc,resolvedImage:Xn,variableAnchorOffsetCollection:fu};return _.type==="array"?da(v[_.value]||_i,_.length):v[_.type]})(e):void 0),p=u.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Ls(new nc(p,e,i)):cl(u.errors)}class x{constructor(e,i,u){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!ll(i.expression),this.globalStateRefs=Ae(i.expression),this._globalState=u}evaluateWithoutErrorHandling(e,i,u,p,_,v){return this._globalState&&(e=Ue(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,i,u,p,_,v)}evaluate(e,i,u,p,_,v){return this._globalState&&(e=Ue(e,this._globalState)),this._styleExpression.evaluate(e,i,u,p,_,v)}}class z{constructor(e,i,u,p,_){this.kind=e,this.zoomStops=u,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!ll(i.expression),this.globalStateRefs=Ae(i.expression),this.interpolationType=p,this._globalState=_}evaluateWithoutErrorHandling(e,i,u,p,_,v){return this._globalState&&(e=Ue(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,i,u,p,_,v)}evaluate(e,i,u,p,_,v){return this._globalState&&(e=Ue(e,this._globalState)),this._styleExpression.evaluate(e,i,u,p,_,v)}interpolationFactor(e,i,u){return this.interpolationType?rr.interpolationFactor(this.interpolationType,e,i,u):0}}function j(n,e,i){const u=d(n,e,i);if(u.result==="error")return u;const p=u.value.expression,_=oa(p);if(!_&&!Ca(e))return cl([new ea("","data expressions not supported")]);const v=ul(p,["zoom"]);if(!v&&!Nl(e))return cl([new ea("","zoom expressions not supported")]);const E=se(p);return E||v?E instanceof ea?cl([E]):E instanceof rr&&!jl(e)?cl([new ea("",'"interpolate" expressions cannot be used with this property')]):Ls(E?new z(_?"camera":"composite",u.value,E.labels,E instanceof rr?E.interpolation:void 0,i):new x(_?"constant":"source",u.value,i)):cl([new ea("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Y{constructor(e,i){this._parameters=e,this._specification=i,Qr(this,tc(this._parameters,this._specification))}static deserialize(e){return new Y(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function se(n){let e=null;if(n instanceof pn)e=se(n.result);else if(n instanceof Es){for(const i of n.args)if(e=se(i),e)break}else(n instanceof nl||n instanceof rr)&&n.input instanceof aa&&n.input.name==="zoom"&&(e=n);return e instanceof ea||n.eachChild((i=>{const u=se(i);u instanceof ea?e=u:!e&&u?e=new ea("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&u&&e!==u&&(e=new ea("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function Ae(n,e=new Set){return n instanceof wu&&e.add(n.key),n.eachChild((i=>{Ae(i,e)})),e}function Ue(n,e){const{zoom:i,heatmapDensity:u,elevation:p,lineProgress:_,isSupportedScript:v,accumulated:E}=n??{};return{zoom:i,heatmapDensity:u,elevation:p,lineProgress:_,isSupportedScript:v,accumulated:E,globalState:e}}function ot(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!ot(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Tt={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function jt(n,e){if(n==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};ot(n)||(n=mr(n));const i=d(n,Tt,e);if(i.result==="error")throw new Error(i.value.map((u=>`${u.key}: ${u.message}`)).join(", "));return{filter:(u,p,_)=>i.value.evaluate(u,p,{},_),needGeometry:zi(n),getGlobalStateRefs:()=>Ae(i.value.expression)}}function ui(n,e){return n<e?-1:n>e?1:0}function zi(n){if(!Array.isArray(n))return!1;if(n[0]==="within"||n[0]==="distance")return!0;for(let e=1;e<n.length;e++)if(zi(n[e]))return!0;return!1}function mr(n){if(!n)return!0;const e=n[0];return n.length<=1?e!=="any":e==="=="?Kn(n[1],n[2],"=="):e==="!="?Wi(Kn(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Kn(n[1],n[2],e):e==="any"?(i=n.slice(1),["any"].concat(i.map(mr))):e==="all"?["all"].concat(n.slice(1).map(mr)):e==="none"?["all"].concat(n.slice(1).map(mr).map(Wi)):e==="in"?$a(n[1],n.slice(2)):e==="!in"?Wi($a(n[1],n.slice(2))):e==="has"?cn(n[1]):e!=="!has"||Wi(cn(n[1]));var i}function Kn(n,e,i){switch(n){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,n,e]}}function $a(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((i=>typeof i!=typeof e[0]))?["filter-in-large",n,["literal",e.sort(ui)]]:["filter-in-small",n,["literal",e]]}}function cn(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Wi(n){return["!",n]}function Ri(n){const e=typeof n;if(e==="number"||e==="boolean"||e==="string"||n==null)return JSON.stringify(n);if(Array.isArray(n)){let p="[";for(const _ of n)p+=`${Ri(_)},`;return`${p}]`}const i=Object.keys(n).sort();let u="{";for(let p=0;p<i.length;p++)u+=`${JSON.stringify(i[p])}:${Ri(n[i[p]])},`;return`${u}}`}function Ds(n){let e="";for(const i of ln)e+=`/${Ri(n[i])}`;return e}function so(n){const e=n.value;return e?[new et(n.key,e,"constants have been deprecated as of v8")]:[]}function Nn(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Ha(n){if(Array.isArray(n))return n.map(Ha);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const i in n)e[i]=Ha(n[i]);return e}return Nn(n)}function Xa(n){const e=n.key,i=n.value,u=n.valueSpec||{},p=n.objectElementValidators||{},_=n.style,v=n.styleSpec,E=n.validateSpec;let P=[];const R=Si(i);if(R!=="object")return[new et(e,i,`object expected, ${R} found`)];for(const F in i){const V=F.split(".")[0],Z=us(u,V)||u["*"];let q;if(us(p,V))q=p[V];else if(us(u,V))q=E;else if(p["*"])q=p["*"];else{if(!u["*"]){P.push(new et(e,i[F],`unknown property "${F}"`));continue}q=E}P=P.concat(q({key:(e&&`${e}.`)+F,value:i[F],valueSpec:Z,style:_,styleSpec:v,object:i,objectKey:F,validateSpec:E},i))}for(const F in u)p[F]||u[F].required&&u[F].default===void 0&&i[F]===void 0&&P.push(new et(e,i,`missing required property "${F}"`));return P}function Zn(n){const e=n.value,i=n.valueSpec,u=n.style,p=n.styleSpec,_=n.key,v=n.arrayElementValidator||n.validateSpec;if(Si(e)!=="array")return[new et(_,e,`array expected, ${Si(e)} found`)];if(i.length&&e.length!==i.length)return[new et(_,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new et(_,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let E={type:i.value,values:i.values};p.$version<7&&(E.function=i.function),Si(i.value)==="object"&&(E=i.value);let P=[];for(let R=0;R<e.length;R++)P=P.concat(v({array:e,arrayIndex:R,value:e[R],valueSpec:E,validateSpec:n.validateSpec,style:u,styleSpec:p,key:`${_}[${R}]`}));return P}function lo(n){const e=n.key,i=n.value,u=n.valueSpec;let p=Si(i);return p==="number"&&i!=i&&(p="NaN"),p!=="number"?[new et(e,i,`number expected, ${p} found`)]:"minimum"in u&&i<u.minimum?[new et(e,i,`${i} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&i>u.maximum?[new et(e,i,`${i} is greater than the maximum value ${u.maximum}`)]:[]}function ps(n){const e=n.valueSpec,i=Nn(n.value.type);let u,p,_,v={};const E=i!=="categorical"&&n.value.property===void 0,P=!E,R=Si(n.value.stops)==="array"&&Si(n.value.stops[0])==="array"&&Si(n.value.stops[0][0])==="object",F=Xa({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(q){if(i==="identity")return[new et(q.key,q.value,'identity function may not have a "stops" property')];let W=[];const Q=q.value;return W=W.concat(Zn({key:q.key,value:Q,valueSpec:q.valueSpec,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:V})),Si(Q)==="array"&&Q.length===0&&W.push(new et(q.key,Q,"array must have at least one stop")),W},default:function(q){return q.validateSpec({key:q.key,value:q.value,valueSpec:e,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec})}}});return i==="identity"&&E&&F.push(new et(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||F.push(new et(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!jl(n.valueSpec)&&F.push(new et(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(P&&!Ca(n.valueSpec)?F.push(new et(n.key,n.value,"property functions not supported")):E&&!Nl(n.valueSpec)&&F.push(new et(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!R||n.value.property!==void 0||F.push(new et(n.key,n.value,'"property" property is required')),F;function V(q){let W=[];const Q=q.value,te=q.key;if(Si(Q)!=="array")return[new et(te,Q,`array expected, ${Si(Q)} found`)];if(Q.length!==2)return[new et(te,Q,`array length 2 expected, length ${Q.length} found`)];if(R){if(Si(Q[0])!=="object")return[new et(te,Q,`object expected, ${Si(Q[0])} found`)];if(Q[0].zoom===void 0)return[new et(te,Q,"object stop key must have zoom")];if(Q[0].value===void 0)return[new et(te,Q,"object stop key must have value")];if(_&&_>Nn(Q[0].zoom))return[new et(te,Q[0].zoom,"stop zoom values must appear in ascending order")];Nn(Q[0].zoom)!==_&&(_=Nn(Q[0].zoom),p=void 0,v={}),W=W.concat(Xa({key:`${te}[0]`,value:Q[0],valueSpec:{zoom:{}},validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:lo,value:Z}}))}else W=W.concat(Z({key:`${te}[0]`,value:Q[0],validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec},Q));return dl(Ha(Q[1]))?W.concat([new et(`${te}[1]`,Q[1],"expressions are not allowed in function stops.")]):W.concat(q.validateSpec({key:`${te}[1]`,value:Q[1],valueSpec:e,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec}))}function Z(q,W){const Q=Si(q.value),te=Nn(q.value),oe=q.value!==null?q.value:W;if(u){if(Q!==u)return[new et(q.key,oe,`${Q} stop domain type must match previous stop domain type ${u}`)]}else u=Q;if(Q!=="number"&&Q!=="string"&&Q!=="boolean")return[new et(q.key,oe,"stop domain value must be a number, string, or boolean")];if(Q!=="number"&&i!=="categorical"){let xe=`number expected, ${Q} found`;return Ca(e)&&i===void 0&&(xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new et(q.key,oe,xe)]}return i!=="categorical"||Q!=="number"||isFinite(te)&&Math.floor(te)===te?i!=="categorical"&&Q==="number"&&p!==void 0&&te<p?[new et(q.key,oe,"stop domain values must appear in ascending order")]:(p=te,i==="categorical"&&te in v?[new et(q.key,oe,"stop domain values must be unique")]:(v[te]=!0,[])):[new et(q.key,oe,`integer expected, found ${te}`)]}}function ms(n){const e=(n.expressionContext==="property"?j:d)(Ha(n.value),n.valueSpec);if(e.result==="error")return e.value.map((u=>new et(`${n.key}${u.key}`,n.value,u.message)));const i=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new et(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!ll(i))return[new et(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!ll(i))return[new et(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!ul(i,["zoom","feature-state"]))return[new et(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!oa(i))return[new et(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Rs(n){const e=n.key,i=n.value,u=Si(i);return u!=="string"?[new et(e,i,`color expected, ${u} found`)]:xi.parse(String(i))?[]:[new et(e,i,`color expected, "${i}" found`)]}function Xo(n){const e=n.key,i=n.value,u=n.valueSpec,p=[];return Array.isArray(u.values)?u.values.indexOf(Nn(i))===-1&&p.push(new et(e,i,`expected one of [${u.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(u.values).indexOf(Nn(i))===-1&&p.push(new et(e,i,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(i)} found`)),p}function uo(n){return ot(Ha(n.value))?ms(Qr({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):gs(n)}function gs(n){const e=n.value,i=n.key;if(Si(e)!=="array")return[new et(i,e,`array expected, ${Si(e)} found`)];const u=n.styleSpec;let p,_=[];if(e.length<1)return[new et(i,e,"filter array must have at least 1 element")];switch(_=_.concat(Xo({key:`${i}[0]`,value:e[0],valueSpec:u.filter_operator,style:n.style,styleSpec:n.styleSpec})),Nn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Nn(e[1])==="$type"&&_.push(new et(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&_.push(new et(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(p=Si(e[1]),p!=="string"&&_.push(new et(`${i}[1]`,e[1],`string expected, ${p} found`)));for(let v=2;v<e.length;v++)p=Si(e[v]),Nn(e[1])==="$type"?_=_.concat(Xo({key:`${i}[${v}]`,value:e[v],valueSpec:u.geometry_type,style:n.style,styleSpec:n.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&_.push(new et(`${i}[${v}]`,e[v],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let v=1;v<e.length;v++)_=_.concat(gs({key:`${i}[${v}]`,value:e[v],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":p=Si(e[1]),e.length!==2?_.push(new et(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):p!=="string"&&_.push(new et(`${i}[1]`,e[1],`string expected, ${p} found`))}return _}function Ul(n,e){const i=n.key,u=n.validateSpec,p=n.style,_=n.styleSpec,v=n.value,E=n.objectKey,P=_[`${e}_${n.layerType}`];if(!P)return[];const R=E.match(/^(.*)-transition$/);if(e==="paint"&&R&&P[R[1]]&&P[R[1]].transition)return u({key:i,value:v,valueSpec:_.transition,style:p,styleSpec:_});const F=n.valueSpec||P[E];if(!F)return[new et(i,v,`unknown property "${E}"`)];let V;if(Si(v)==="string"&&Ca(F)&&!F.tokens&&(V=/^{([^}]+)}$/.exec(v)))return[new et(i,v,`"${E}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(V[1])} }\`.`)];const Z=[];return n.layerType==="symbol"&&E==="text-font"&&Hc(Ha(v))&&Nn(v.type)==="identity"&&Z.push(new et(i,v,'"text-font" does not support identity functions')),Z.concat(u({key:n.key,value:v,valueSpec:F,style:p,styleSpec:_,expressionContext:"property",propertyType:e,propertyKey:E}))}function fl(n){return Ul(n,"paint")}function xd(n){return Ul(n,"layout")}function wd(n){let e=[];const i=n.value,u=n.key,p=n.style,_=n.styleSpec;if(Si(i)!=="object")return[new et(u,i,`object expected, ${Si(i)} found`)];i.type||i.ref||e.push(new et(u,i,'either "type" or "ref" is required'));let v=Nn(i.type);const E=Nn(i.ref);if(i.id){const P=Nn(i.id);for(let R=0;R<n.arrayIndex;R++){const F=p.layers[R];Nn(F.id)===P&&e.push(new et(u,i.id,`duplicate layer id "${i.id}", previously used at line ${F.id.__line__}`))}}if("ref"in i){let P;["type","source","source-layer","filter","layout"].forEach((R=>{R in i&&e.push(new et(u,i[R],`"${R}" is prohibited for ref layers`))})),p.layers.forEach((R=>{Nn(R.id)===E&&(P=R)})),P?P.ref?e.push(new et(u,i.ref,"ref cannot reference another ref layer")):v=Nn(P.type):e.push(new et(u,i.ref,`ref layer "${E}" not found`))}else if(v!=="background")if(i.source){const P=p.sources&&p.sources[i.source],R=P&&Nn(P.type);P?R==="vector"&&v==="raster"?e.push(new et(u,i.source,`layer "${i.id}" requires a raster source`)):R!=="raster-dem"&&v==="hillshade"||R!=="raster-dem"&&v==="color-relief"?e.push(new et(u,i.source,`layer "${i.id}" requires a raster-dem source`)):R==="raster"&&v!=="raster"?e.push(new et(u,i.source,`layer "${i.id}" requires a vector source`)):R!=="vector"||i["source-layer"]?R==="raster-dem"&&v!=="hillshade"&&v!=="color-relief"?e.push(new et(u,i.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):v!=="line"||!i.paint||!i.paint["line-gradient"]||R==="geojson"&&P.lineMetrics||e.push(new et(u,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new et(u,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new et(u,i.source,`source "${i.source}" not found`))}else e.push(new et(u,i,'missing required property "source"'));return e=e.concat(Xa({key:u,value:i,valueSpec:_.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*":()=>[],type:()=>n.validateSpec({key:`${u}.type`,value:i.type,valueSpec:_.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:i,objectKey:"type"}),filter:uo,layout:P=>Xa({layer:i,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*":R=>xd(Qr({layerType:v},R))}}),paint:P=>Xa({layer:i,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*":R=>fl(Qr({layerType:v},R))}})}})),e}function ys(n){const e=n.value,i=n.key,u=Si(e);return u!=="string"?[new et(i,e,`string expected, ${u} found`)]:[]}const Yc={promoteId:function({key:n,value:e}){if(Si(e)==="string")return ys({key:n,value:e});{const i=[];for(const u in e)i.push(...ys({key:`${n}.${u}`,value:e[u]}));return i}}};function Vl(n){const e=n.value,i=n.key,u=n.styleSpec,p=n.style,_=n.validateSpec;if(!e.type)return[new et(i,e,'"type" is required')];const v=Nn(e.type);let E;switch(v){case"vector":case"raster":return E=Xa({key:i,value:e,valueSpec:u[`source_${v.replace("-","_")}`],style:n.style,styleSpec:u,objectElementValidators:Yc,validateSpec:_}),E;case"raster-dem":return E=(function(P){var R;const F=(R=P.sourceName)!==null&&R!==void 0?R:"",V=P.value,Z=P.styleSpec,q=Z.source_raster_dem,W=P.style;let Q=[];const te=Si(V);if(V===void 0)return Q;if(te!=="object")return Q.push(new et("source_raster_dem",V,`object expected, ${te} found`)),Q;const oe=Nn(V.encoding)==="custom",xe=["redFactor","greenFactor","blueFactor","baseShift"],le=P.value.encoding?`"${P.value.encoding}"`:"Default";for(const pe in V)!oe&&xe.includes(pe)?Q.push(new et(pe,V[pe],`In "${F}": "${pe}" is only valid when "encoding" is set to "custom". ${le} encoding found`)):q[pe]?Q=Q.concat(P.validateSpec({key:pe,value:V[pe],valueSpec:q[pe],validateSpec:P.validateSpec,style:W,styleSpec:Z})):Q.push(new et(pe,V[pe],`unknown property "${pe}"`));return Q})({sourceName:i,value:e,style:n.style,styleSpec:u,validateSpec:_}),E;case"geojson":if(E=Xa({key:i,value:e,valueSpec:u.source_geojson,style:p,styleSpec:u,validateSpec:_,objectElementValidators:Yc}),e.cluster)for(const P in e.clusterProperties){const[R,F]=e.clusterProperties[P],V=typeof R=="string"?[R,["accumulated"],["get",P]]:R;E.push(...ms({key:`${i}.${P}.map`,value:F,expressionContext:"cluster-map"})),E.push(...ms({key:`${i}.${P}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return E;case"video":return Xa({key:i,value:e,valueSpec:u.source_video,style:p,validateSpec:_,styleSpec:u});case"image":return Xa({key:i,value:e,valueSpec:u.source_image,style:p,validateSpec:_,styleSpec:u});case"canvas":return[new et(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xo({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Pr(n){const e=n.value,i=n.styleSpec,u=i.light,p=n.style;let _=[];const v=Si(e);if(e===void 0)return _;if(v!=="object")return _=_.concat([new et("light",e,`object expected, ${v} found`)]),_;for(const E in e){const P=E.match(/^(.*)-transition$/);_=_.concat(P&&u[P[1]]&&u[P[1]].transition?n.validateSpec({key:E,value:e[E],valueSpec:i.transition,validateSpec:n.validateSpec,style:p,styleSpec:i}):u[E]?n.validateSpec({key:E,value:e[E],valueSpec:u[E],validateSpec:n.validateSpec,style:p,styleSpec:i}):[new et(E,e[E],`unknown property "${E}"`)])}return _}function kh(n){const e=n.value,i=n.styleSpec,u=i.sky,p=n.style,_=Si(e);if(e===void 0)return[];if(_!=="object")return[new et("sky",e,`object expected, ${_} found`)];let v=[];for(const E in e)v=v.concat(u[E]?n.validateSpec({key:E,value:e[E],valueSpec:u[E],style:p,styleSpec:i}):[new et(E,e[E],`unknown property "${E}"`)]);return v}function Td(n){const e=n.value,i=n.styleSpec,u=i.terrain,p=n.style;let _=[];const v=Si(e);if(e===void 0)return _;if(v!=="object")return _=_.concat([new et("terrain",e,`object expected, ${v} found`)]),_;for(const E in e)_=_.concat(u[E]?n.validateSpec({key:E,value:e[E],valueSpec:u[E],validateSpec:n.validateSpec,style:p,styleSpec:i}):[new et(E,e[E],`unknown property "${E}"`)]);return _}function xf(n){let e=[];const i=n.value,u=n.key;if(Array.isArray(i)){const p=[],_=[];for(const v in i)i[v].id&&p.includes(i[v].id)&&e.push(new et(u,i,`all the sprites' ids must be unique, but ${i[v].id} is duplicated`)),p.push(i[v].id),i[v].url&&_.includes(i[v].url)&&e.push(new et(u,i,`all the sprites' URLs must be unique, but ${i[v].url} is duplicated`)),_.push(i[v].url),e=e.concat(Xa({key:`${u}[${v}]`,value:i[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:n.validateSpec}));return e}return ys({key:u,value:i})}function Op(n){return e=n.value,e&&e.constructor===Object?[]:[new et(n.key,n.value,`object expected, ${Si(n.value)} found`)];var e}const wf={"*":()=>[],array:Zn,boolean:function(n){const e=n.value,i=n.key,u=Si(e);return u!=="boolean"?[new et(i,e,`boolean expected, ${u} found`)]:[]},number:lo,color:Rs,constants:so,enum:Xo,filter:uo,function:ps,layer:wd,object:Xa,source:Vl,light:Pr,sky:kh,terrain:Td,projection:function(n){const e=n.value,i=n.styleSpec,u=i.projection,p=n.style,_=Si(e);if(e===void 0)return[];if(_!=="object")return[new et("projection",e,`object expected, ${_} found`)];let v=[];for(const E in e)v=v.concat(u[E]?n.validateSpec({key:E,value:e[E],valueSpec:u[E],style:p,styleSpec:i}):[new et(E,e[E],`unknown property "${E}"`)]);return v},projectionDefinition:function(n){const e=n.key;let i=n.value;i=i instanceof String?i.valueOf():i;const u=Si(i);return u!=="array"||(function(p){return Array.isArray(p)&&p.length===3&&typeof p[0]=="string"&&typeof p[1]=="string"&&typeof p[2]=="number"})(i)||(function(p){return!!["interpolate","step","literal"].includes(p[0])})(i)?["array","string"].includes(u)?[]:[new et(e,i,`projection expected, invalid type "${u}" found`)]:[new et(e,i,`projection expected, invalid array ${JSON.stringify(i)} found`)]},string:ys,formatted:function(n){return ys(n).length===0?[]:ms(n)},resolvedImage:function(n){return ys(n).length===0?[]:ms(n)},padding:function(n){const e=n.key,i=n.value;if(Si(i)==="array"){if(i.length<1||i.length>4)return[new et(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const u={type:"number"};let p=[];for(let _=0;_<i.length;_++)p=p.concat(n.validateSpec({key:`${e}[${_}]`,value:i[_],validateSpec:n.validateSpec,valueSpec:u}));return p}return lo({key:e,value:i,valueSpec:{}})},numberArray:function(n){const e=n.key,i=n.value;if(Si(i)==="array"){const u={type:"number"};if(i.length<1)return[new et(e,i,"array length at least 1 expected, length 0 found")];let p=[];for(let _=0;_<i.length;_++)p=p.concat(n.validateSpec({key:`${e}[${_}]`,value:i[_],validateSpec:n.validateSpec,valueSpec:u}));return p}return lo({key:e,value:i,valueSpec:{}})},colorArray:function(n){const e=n.key,i=n.value;if(Si(i)==="array"){if(i.length<1)return[new et(e,i,"array length at least 1 expected, length 0 found")];let u=[];for(let p=0;p<i.length;p++)u=u.concat(Rs({key:`${e}[${p}]`,value:i[p]}));return u}return Rs({key:e,value:i})},variableAnchorOffsetCollection:function(n){const e=n.key,i=n.value,u=Si(i),p=n.styleSpec;if(u!=="array"||i.length<1||i.length%2!=0)return[new et(e,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let v=0;v<i.length;v+=2)_=_.concat(Xo({key:`${e}[${v}]`,value:i[v],valueSpec:p.layout_symbol["text-anchor"]})),_=_.concat(Zn({key:`${e}[${v+1}]`,value:i[v+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:p}));return _},sprite:xf,state:Op};function ar(n){const e=n.value,i=n.valueSpec,u=n.styleSpec;return n.validateSpec=ar,i.expression&&Hc(Nn(e))?ps(n):i.expression&&dl(Ha(e))?ms(n):i.type&&wf[i.type]?wf[i.type](n):Xa(Qr({},n,{valueSpec:i.type?u[i.type]:i}))}function Su(n){const e=n.value,i=n.key,u=ys(n);return u.length||(e.indexOf("{fontstack}")===-1&&u.push(new et(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&u.push(new et(i,e,'"glyphs" url must include a "{range}" token'))),u}function Ya(n,e=Ze){let i=[];return i=i.concat(ar({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,validateSpec:ar,objectElementValidators:{glyphs:Su,"*":()=>[]}})),n.constants&&(i=i.concat(so({key:"constants",value:n.constants}))),Sd(i)}function co(n){return function(e){return n(Object.assign({},e,{validateSpec:ar}))}}function Sd(n){return[].concat(n).sort(((e,i)=>e.line-i.line))}function Wa(n){return function(...e){return Sd(n.apply(this,e))}}Ya.source=Wa(co(Vl)),Ya.sprite=Wa(co(xf)),Ya.glyphs=Wa(co(Su)),Ya.light=Wa(co(Pr)),Ya.sky=Wa(co(kh)),Ya.terrain=Wa(co(Td)),Ya.state=Wa(co(Op)),Ya.layer=Wa(co(wd)),Ya.filter=Wa(co(uo)),Ya.paintProperty=Wa(co(fl)),Ya.layoutProperty=Wa(co(xd));const Wc=Ze,Kc=Ya,Jc=Kc.light,Oh=Kc.sky,Mo=Kc.paintProperty,ks=Kc.layoutProperty;function Bh(n,e){let i=!1;if(e&&e.length)for(const u of e)n.fire(new en(new Error(u.message))),i=!0;return i}class Mu{constructor(e,i,u){const p=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const v=new Int32Array(this.arrayBuffer);e=v[0],this.d=(i=v[1])+2*(u=v[2]);for(let P=0;P<this.d*this.d;P++){const R=v[3+P],F=v[3+P+1];p.push(R===F?null:v.subarray(R,F))}const E=v[3+p.length+1];this.keys=v.subarray(v[3+p.length],E),this.bboxes=v.subarray(E),this.insert=this._insertReadonly}else{this.d=i+2*u;for(let v=0;v<this.d*this.d;v++)p.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=e,this.padding=u,this.scale=i/e,this.uid=0;const _=u/i*e;this.min=-_,this.max=e+_}insert(e,i,u,p,_){this._forEachCell(i,u,p,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(i),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,i,u,p,_,v){this.cells[_].push(v)}query(e,i,u,p,_){const v=this.min,E=this.max;if(e<=v&&i<=v&&E<=u&&E<=p&&!_)return Array.prototype.slice.call(this.keys);{const P=[];return this._forEachCell(e,i,u,p,this._queryCell,P,{},_),P}}_queryCell(e,i,u,p,_,v,E,P){const R=this.cells[_];if(R!==null){const F=this.keys,V=this.bboxes;for(let Z=0;Z<R.length;Z++){const q=R[Z];if(E[q]===void 0){const W=4*q;(P?P(V[W+0],V[W+1],V[W+2],V[W+3]):e<=V[W+2]&&i<=V[W+3]&&u>=V[W+0]&&p>=V[W+1])?(E[q]=!0,v.push(F[q])):E[q]=!1}}}}_forEachCell(e,i,u,p,_,v,E,P){const R=this._convertToCellCoord(e),F=this._convertToCellCoord(i),V=this._convertToCellCoord(u),Z=this._convertToCellCoord(p);for(let q=R;q<=V;q++)for(let W=F;W<=Z;W++){const Q=this.d*W+q;if((!P||P(this._convertFromCellCoord(q),this._convertFromCellCoord(W),this._convertFromCellCoord(q+1),this._convertFromCellCoord(W+1)))&&_.call(this,e,i,u,p,Q,v,E,P))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,i=3+this.cells.length+1+1;let u=0;for(let v=0;v<this.cells.length;v++)u+=this.cells[v].length;const p=new Int32Array(i+u+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let _=i;for(let v=0;v<e.length;v++){const E=e[v];p[3+v]=_,p.set(E,_),_+=E.length}return p[3+e.length]=_,p.set(this.keys,_),_+=this.keys.length,p[3+e.length+1]=_,p.set(this.bboxes,_),_+=this.bboxes.length,p.buffer}static serialize(e,i){const u=e.toArrayBuffer();return i&&i.push(u),{buffer:u}}static deserialize(e){return new Mu(e.buffer)}}const pl={};function Ot(n,e,i={}){if(pl[n])throw new Error(`${n} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:n,writeable:!1}),pl[n]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}Ot("Object",Object),Ot("Set",Set),Ot("TransferableGridIndex",Mu),Ot("Color",xi),Ot("Error",Error),Ot("AJAXError",Re),Ot("ResolvedImage",ta),Ot("StylePropertyFunction",Y),Ot("StyleExpression",nc,{omit:["_evaluator"]}),Ot("ZoomDependentExpression",z),Ot("ZoomConstantExpression",x),Ot("CompoundExpression",aa,{omit:["_evaluate"]});for(const n in Tu)Tu[n]._classRegistryKey||Ot(`Expression_${n}`,Tu[n]);function Fh(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function Eu(n){return n.$name||n.constructor._classRegistryKey}function Nh(n){return!(function(e){if(e===null||typeof e!="object")return!1;const i=Eu(e);return!(!i||i==="Object")})(n)&&(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||n instanceof Error||Fh(n)||La(n)||ArrayBuffer.isView(n)||n instanceof ImageData)}function Au(n,e){if(Nh(n))return(Fh(n)||La(n))&&e&&e.push(n),ArrayBuffer.isView(n)&&e&&e.push(n.buffer),n instanceof ImageData&&e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const _=[];for(const v of n)_.push(Au(v,e));return _}if(typeof n!="object")throw new Error("can't serialize object of type "+typeof n);const i=Eu(n);if(!i)throw new Error(`can't serialize object of unregistered class ${n.constructor.name}`);if(!pl[i])throw new Error(`${i} is not registered.`);const{klass:u}=pl[i],p=u.serialize?u.serialize(n,e):{};if(u.serialize){if(e&&p===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in n){if(!n.hasOwnProperty(_)||pl[i].omit.indexOf(_)>=0)continue;const v=n[_];p[_]=pl[i].shallow.indexOf(_)>=0?v:Au(v,e)}n instanceof Error&&(p.message=n.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(p.$name=i),p}function Qc(n){if(Nh(n))return n;if(Array.isArray(n))return n.map(Qc);if(typeof n!="object")throw new Error("can't deserialize object of type "+typeof n);const e=Eu(n)||"Object";if(!pl[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=pl[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(n);const u=Object.create(i.prototype);for(const p of Object.keys(n)){if(p==="$name")continue;const _=n[p];u[p]=pl[e].shallow.indexOf(p)>=0?_:Qc(_)}return u}class Yo{constructor(){this.first=!0}update(e,i){const u=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=u,!0))}}function rc(n){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))}function Md(n){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))}function Tf(n){return/\s/u.test(String.fromCodePoint(n))}function _s(n){for(const e of n)if(Md(e.codePointAt(0)))return!0;return!1}function jh(n){for(const e of n)if(!Ed(e.codePointAt(0)))return!1;return!0}function Uh(n){const e=n.map((i=>{try{return new RegExp(`\\p{sc=${i}}`,"u").source}catch{return null}})).filter((i=>i));return new RegExp(e.join("|"),"u")}const Cu=Uh(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ed(n){return!Cu.test(String.fromCodePoint(n))}function Vh(n){return!(Md(n)||(e=n,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(e))));var e}const ml=Uh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Ad(n){return ml.test(String.fromCodePoint(n))}function Gl(n,e){return!(!e&&Ad(n)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(n)))}function Cd(n){for(const e of n)if(Ad(e.codePointAt(0)))return!0;return!1}const Os=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(n){this.pluginStatus=n.pluginStatus,this.pluginURL=n.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(n){if(Os.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=n.applyArabicShaping,this.processBidirectionalText=n.processBidirectionalText,this.processStyledBidirectionalText=n.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(n,e){return c(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(n.pluginStatus!=="loading")return this.setState(n),n;const i=n.pluginURL,u=new Promise((_=>{this.loadScriptResolve=_}));e(i);const p=new Promise((_=>setTimeout((()=>_()),this.TIMEOUT)));if(yield Promise.race([u,p]),this.isParsed()){const _={pluginStatus:"loaded",pluginURL:i};return this.setState(_),_}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${i}`)}))}};class $i{constructor(e,i){this.isSupportedScript=Zl,this.zoom=e,i?(this.now=i.now||0,this.fadeDuration=i.fadeDuration||0,this.zoomHistory=i.zoomHistory||new Yo,this.transition=i.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Yo,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),u=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*i}}}function Zl(n){return(function(e,i){for(const u of e)if(!Gl(u.codePointAt(0),i))return!1;return!0})(n,Os.getRTLTextPluginStatus()==="loaded")}const Pu="-transition";class ac{constructor(e,i,u){this.property=e,this.value=i,this.expression=(function(p,_,v){if(Hc(p))return new Y(p,_);if(dl(p)){const E=j(p,_,v);if(E.result==="error")throw new Error(E.value.map((P=>`${P.key}: ${P.message}`)).join(", "));return E.value}{let E=p;return _.type==="color"&&typeof p=="string"?E=xi.parse(p):_.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?_.type!=="numberArray"||typeof p!="number"&&!Array.isArray(p)?_.type!=="colorArray"||typeof p!="string"&&!Array.isArray(p)?_.type==="variableAnchorOffsetCollection"&&Array.isArray(p)?E=Bn.parse(p):_.type==="projectionDefinition"&&typeof p=="string"&&(E=Fn.parse(p)):E=Zt.parse(p):E=Xi.parse(p):E=ii.parse(p),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>E}}})(i===void 0?e.specification.default:i,e.specification,u)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,i,u){return this.property.possiblyEvaluate(this,e,i,u)}}class Gh{constructor(e,i){this.property=e,this.value=new ac(e,void 0,i)}transitioned(e,i){return new eh(this.property,this.value,i,Ei({},e.transition,this.transition),e.now)}untransitioned(){return new eh(this.property,this.value,null,{},0)}}class oc{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._globalState=i}getValue(e){return Mr(this._values[e].value.value)}setValue(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Gh(this._values[e].property,this._globalState)),this._values[e].value=new ac(this._values[e].property,i===null?void 0:Mr(i),this._globalState)}getTransition(e){return Mr(this._values[e].transition)}setTransition(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Gh(this._values[e].property,this._globalState)),this._values[e].transition=Mr(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const u=this.getValue(i);u!==void 0&&(e[i]=u);const p=this.getTransition(i);p!==void 0&&(e[`${i}${Pu}`]=p)}return e}transitioned(e,i){const u=new Pd(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].transitioned(e,i._values[p]);return u}untransitioned(){const e=new Pd(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class eh{constructor(e,i,u,p,_){this.property=e,this.value=i,this.begin=_+p.delay||0,this.end=this.begin+p.duration||0,e.specification.transition&&(p.delay||p.duration)&&(this.prior=u)}possiblyEvaluate(e,i,u){const p=e.now||0,_=this.value.possiblyEvaluate(e,i,u),v=this.prior;if(v){if(p>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(p<this.begin)return v.possiblyEvaluate(e,i,u);{const E=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(e,i,u),_,It(E))}}return _}}class Pd{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,u){const p=new sc(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(e,i,u);return p}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Sf{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._globalState=i}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Mr(this._values[e].value)}setValue(e,i){this._values[e]=new ac(this._values[e].property,i===null?void 0:Mr(i),this._globalState)}serialize(){const e={};for(const i of Object.keys(this._values)){const u=this.getValue(i);u!==void 0&&(e[i]=u)}return e}possiblyEvaluate(e,i,u){const p=new sc(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(e,i,u);return p}}class ho{constructor(e,i,u){this.property=e,this.value=i,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,u,p){return this.property.evaluate(this.value,this.parameters,e,i,u,p)}}class sc{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Jt{constructor(e){this.specification=e}possiblyEvaluate(e,i){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(i)}interpolate(e,i,u){const p=On[this.specification.type];return p?p(e,i,u):e}}class ai{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,u,p){return new ho(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},u,p)}:e.expression,i)}interpolate(e,i,u){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new ho(this,{kind:"constant",value:void 0},e.parameters);const p=On[this.specification.type];if(p){const _=p(e.value.value,i.value.value,u);return new ho(this,{kind:"constant",value:_},e.parameters)}return e}evaluate(e,i,u,p,_,v){return e.kind==="constant"?e.value:e.evaluate(i,u,p,_,v)}}class zu extends ai{possiblyEvaluate(e,i,u,p){if(e.value===void 0)return new ho(this,{kind:"constant",value:void 0},i);if(e.expression.kind==="constant"){const _=e.expression.evaluate(i,null,{},u,p),v=e.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,E=this._calculate(v,v,v,i);return new ho(this,{kind:"constant",value:E},i)}if(e.expression.kind==="camera"){const _=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new ho(this,{kind:"constant",value:_},i)}return new ho(this,e.expression,i)}evaluate(e,i,u,p,_,v){if(e.kind==="source"){const E=e.evaluate(i,u,p,_,v);return this._calculate(E,E,E,i)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},u,p),e.evaluate({zoom:Math.floor(i.zoom)},u,p),e.evaluate({zoom:Math.floor(i.zoom)+1},u,p),i):e.value}_calculate(e,i,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:u,to:i}}interpolate(e){return e}}class fo{constructor(e){this.specification=e}possiblyEvaluate(e,i,u,p){if(e.value!==void 0){if(e.expression.kind==="constant"){const _=e.expression.evaluate(i,null,{},u,p);return this._calculate(_,_,_,i)}return this._calculate(e.expression.evaluate(new $i(Math.floor(i.zoom-1),i)),e.expression.evaluate(new $i(Math.floor(i.zoom),i)),e.expression.evaluate(new $i(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:u,to:i}}interpolate(e){return e}}class fa{constructor(e){this.specification=e}possiblyEvaluate(e,i,u,p){return!!e.expression.evaluate(i,null,{},u,p)}interpolate(){return!1}}class xr{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in e){const u=e[i];u.specification.overridable&&this.overridableProperties.push(i);const p=this.defaultPropertyValues[i]=new ac(u,void 0,void 0),_=this.defaultTransitionablePropertyValues[i]=new Gh(u,void 0);this.defaultTransitioningPropertyValues[i]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=p.possiblyEvaluate({})}}}Ot("DataDrivenProperty",ai),Ot("DataConstantProperty",Jt),Ot("CrossFadedDataDrivenProperty",zu),Ot("CrossFadedProperty",fo),Ot("ColorRampProperty",fa);class po extends Fi{constructor(e,i,u){if(super(),this.id=e.id,this.type=e.type,this._globalState=u,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=jt(e.filter,u)),i.layout&&(this._unevaluatedLayout=new Sf(i.layout,u)),i.paint)){this._transitionablePaint=new oc(i.paint,u);for(const p in e.paint)this.setPaintProperty(p,e.paint[p],{validate:!1});for(const p in e.layout)this.setLayoutProperty(p,e.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new sc(i.paint)}}setFilter(e){this.filter=e,this._featureFilter=jt(e,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){const e=new Set;if(this._unevaluatedLayout)for(const i in this._unevaluatedLayout._values){const u=this._unevaluatedLayout._values[i];for(const p of u.getGlobalStateRefs())e.add(p)}for(const i of this._featureFilter.getGlobalStateRefs())e.add(i);return e}getPaintAffectingGlobalStateRefs(){var e;const i=new globalThis.Map;if(this._transitionablePaint)for(const u in this._transitionablePaint._values){const p=this._transitionablePaint._values[u].value;for(const _ of p.getGlobalStateRefs()){const v=(e=i.get(_))!==null&&e!==void 0?e:[];v.push({name:u,value:p.value}),i.set(_,v)}}return i}setLayoutProperty(e,i,u={}){i!=null&&this._validate(ks,`layers.${this.id}.layout.${e}`,e,i,u)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return e.endsWith(Pu)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,u={}){if(i!=null&&this._validate(Mo,`layers.${this.id}.paint.${e}`,e,i,u))return!1;if(e.endsWith(Pu))return this._transitionablePaint.setTransition(e.slice(0,-11),i||void 0),!1;{const p=this._transitionablePaint._values[e],_=p.property.specification["property-type"]==="cross-faded-data-driven",v=p.value.isDataDriven(),E=p.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const P=this._transitionablePaint._values[e].value;return P.isDataDriven()||v||_||this._handleOverridablePaintPropertyUpdate(e,E,P)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,i,u){return!1}isHidden(e,i=!1){return!!(this.minzoom&&e<(i?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),_o(e,((i,u)=>!(i===void 0||u==="layout"&&!Object.keys(i).length||u==="paint"&&!Object.keys(i).length)))}_validate(e,i,u,p,_={}){return(!_||_.validate!==!1)&&Bh(this,e.call(Kc,{key:i,layerType:this.type,objectKey:u,value:p,styleSpec:Ze,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof ho&&Ca(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}let Mf;var Iu={get paint(){return Mf=Mf||new xr({"raster-opacity":new Jt(Ze.paint_raster["raster-opacity"]),"raster-hue-rotate":new Jt(Ze.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Jt(Ze.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Jt(Ze.paint_raster["raster-brightness-max"]),"raster-saturation":new Jt(Ze.paint_raster["raster-saturation"]),"raster-contrast":new Jt(Ze.paint_raster["raster-contrast"]),"raster-resampling":new Jt(Ze.paint_raster["raster-resampling"]),"raster-fade-duration":new Jt(Ze.paint_raster["raster-fade-duration"])})}};class Eo extends po{constructor(e,i){super(e,Iu,i)}}const wr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ql{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class mn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ri(n,e=1){let i=0,u=0;return{members:n.map((p=>{const _=wr[p.type].BYTES_PER_ELEMENT,v=i=zn(i,Math.max(e,_)),E=p.components||1;return u=Math.max(u,_),i+=_*E,{name:p.name,type:p.type,components:E,offset:v}})),size:zn(i,Math.max(u,e)),alignment:e}}function zn(n,e){return Math.ceil(n/e)*e}class or extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const u=this.length;return this.resize(u+1),this.emplace(u,e,i)}emplace(e,i,u){const p=2*e;return this.int16[p+0]=i,this.int16[p+1]=u,e}}or.prototype.bytesPerElement=4,Ot("StructArrayLayout2i4",or);class lc extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,u)}emplace(e,i,u,p){const _=3*e;return this.int16[_+0]=i,this.int16[_+1]=u,this.int16[_+2]=p,e}}lc.prototype.bytesPerElement=6,Ot("StructArrayLayout3i6",lc);class Wo extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,u,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,u,p)}emplace(e,i,u,p,_){const v=4*e;return this.int16[v+0]=i,this.int16[v+1]=u,this.int16[v+2]=p,this.int16[v+3]=_,e}}Wo.prototype.bytesPerElement=8,Ot("StructArrayLayout4i8",Wo);class $l extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,u,p,_,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,u,p,_,v)}emplace(e,i,u,p,_,v,E){const P=6*e;return this.int16[P+0]=i,this.int16[P+1]=u,this.int16[P+2]=p,this.int16[P+3]=_,this.int16[P+4]=v,this.int16[P+5]=E,e}}$l.prototype.bytesPerElement=12,Ot("StructArrayLayout2i4i12",$l);class th extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,u,p,_,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,u,p,_,v)}emplace(e,i,u,p,_,v,E){const P=4*e,R=8*e;return this.int16[P+0]=i,this.int16[P+1]=u,this.uint8[R+4]=p,this.uint8[R+5]=_,this.uint8[R+6]=v,this.uint8[R+7]=E,e}}th.prototype.bytesPerElement=8,Ot("StructArrayLayout2i4ub8",th);class Hl extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const u=this.length;return this.resize(u+1),this.emplace(u,e,i)}emplace(e,i,u){const p=2*e;return this.float32[p+0]=i,this.float32[p+1]=u,e}}Hl.prototype.bytesPerElement=8,Ot("StructArrayLayout2f8",Hl);class Xl extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,u,p,_,v,E,P,R,F){const V=this.length;return this.resize(V+1),this.emplace(V,e,i,u,p,_,v,E,P,R,F)}emplace(e,i,u,p,_,v,E,P,R,F,V){const Z=10*e;return this.uint16[Z+0]=i,this.uint16[Z+1]=u,this.uint16[Z+2]=p,this.uint16[Z+3]=_,this.uint16[Z+4]=v,this.uint16[Z+5]=E,this.uint16[Z+6]=P,this.uint16[Z+7]=R,this.uint16[Z+8]=F,this.uint16[Z+9]=V,e}}Xl.prototype.bytesPerElement=20,Ot("StructArrayLayout10ui20",Xl);class Ef extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,u,p,_,v,E,P){const R=this.length;return this.resize(R+1),this.emplace(R,e,i,u,p,_,v,E,P)}emplace(e,i,u,p,_,v,E,P,R){const F=8*e;return this.uint16[F+0]=i,this.uint16[F+1]=u,this.uint16[F+2]=p,this.uint16[F+3]=_,this.uint16[F+4]=v,this.uint16[F+5]=E,this.uint16[F+6]=P,this.uint16[F+7]=R,e}}Ef.prototype.bytesPerElement=16,Ot("StructArrayLayout8ui16",Ef);class sr extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,u,p,_,v,E,P,R,F,V,Z){const q=this.length;return this.resize(q+1),this.emplace(q,e,i,u,p,_,v,E,P,R,F,V,Z)}emplace(e,i,u,p,_,v,E,P,R,F,V,Z,q){const W=12*e;return this.int16[W+0]=i,this.int16[W+1]=u,this.int16[W+2]=p,this.int16[W+3]=_,this.uint16[W+4]=v,this.uint16[W+5]=E,this.uint16[W+6]=P,this.uint16[W+7]=R,this.int16[W+8]=F,this.int16[W+9]=V,this.int16[W+10]=Z,this.int16[W+11]=q,e}}sr.prototype.bytesPerElement=24,Ot("StructArrayLayout4i4ui4i24",sr);class Bs extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,u)}emplace(e,i,u,p){const _=3*e;return this.float32[_+0]=i,this.float32[_+1]=u,this.float32[_+2]=p,e}}Bs.prototype.bytesPerElement=12,Ot("StructArrayLayout3f12",Bs);class ih extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}ih.prototype.bytesPerElement=4,Ot("StructArrayLayout1ul4",ih);class nh extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,u,p,_,v,E,P,R){const F=this.length;return this.resize(F+1),this.emplace(F,e,i,u,p,_,v,E,P,R)}emplace(e,i,u,p,_,v,E,P,R,F){const V=10*e,Z=5*e;return this.int16[V+0]=i,this.int16[V+1]=u,this.int16[V+2]=p,this.int16[V+3]=_,this.int16[V+4]=v,this.int16[V+5]=E,this.uint32[Z+3]=P,this.uint16[V+8]=R,this.uint16[V+9]=F,e}}nh.prototype.bytesPerElement=20,Ot("StructArrayLayout6i1ul2ui20",nh);class Zh extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,u,p,_,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,u,p,_,v)}emplace(e,i,u,p,_,v,E){const P=6*e;return this.int16[P+0]=i,this.int16[P+1]=u,this.int16[P+2]=p,this.int16[P+3]=_,this.int16[P+4]=v,this.int16[P+5]=E,e}}Zh.prototype.bytesPerElement=12,Ot("StructArrayLayout2i2i2i12",Zh);class qh extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,u,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,e,i,u,p,_)}emplace(e,i,u,p,_,v){const E=4*e,P=8*e;return this.float32[E+0]=i,this.float32[E+1]=u,this.float32[E+2]=p,this.int16[P+6]=_,this.int16[P+7]=v,e}}qh.prototype.bytesPerElement=16,Ot("StructArrayLayout2f1f2i16",qh);class $h extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,u,p,_,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,u,p,_,v)}emplace(e,i,u,p,_,v,E){const P=16*e,R=4*e,F=8*e;return this.uint8[P+0]=i,this.uint8[P+1]=u,this.float32[R+1]=p,this.float32[R+2]=_,this.int16[F+6]=v,this.int16[F+7]=E,e}}$h.prototype.bytesPerElement=16,Ot("StructArrayLayout2ub2f2i16",$h);class Yl extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,u)}emplace(e,i,u,p){const _=3*e;return this.uint16[_+0]=i,this.uint16[_+1]=u,this.uint16[_+2]=p,e}}Yl.prototype.bytesPerElement=6,Ot("StructArrayLayout3ui6",Yl);class Wl extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,u,p,_,v,E,P,R,F,V,Z,q,W,Q,te,oe){const xe=this.length;return this.resize(xe+1),this.emplace(xe,e,i,u,p,_,v,E,P,R,F,V,Z,q,W,Q,te,oe)}emplace(e,i,u,p,_,v,E,P,R,F,V,Z,q,W,Q,te,oe,xe){const le=24*e,pe=12*e,Te=48*e;return this.int16[le+0]=i,this.int16[le+1]=u,this.uint16[le+2]=p,this.uint16[le+3]=_,this.uint32[pe+2]=v,this.uint32[pe+3]=E,this.uint32[pe+4]=P,this.uint16[le+10]=R,this.uint16[le+11]=F,this.uint16[le+12]=V,this.float32[pe+7]=Z,this.float32[pe+8]=q,this.uint8[Te+36]=W,this.uint8[Te+37]=Q,this.uint8[Te+38]=te,this.uint32[pe+10]=oe,this.int16[le+22]=xe,e}}Wl.prototype.bytesPerElement=48,Ot("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Wl);class Pa extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,u,p,_,v,E,P,R,F,V,Z,q,W,Q,te,oe,xe,le,pe,Te,Me,Xe,gt,ut,xt,Rt,wt){const ft=this.length;return this.resize(ft+1),this.emplace(ft,e,i,u,p,_,v,E,P,R,F,V,Z,q,W,Q,te,oe,xe,le,pe,Te,Me,Xe,gt,ut,xt,Rt,wt)}emplace(e,i,u,p,_,v,E,P,R,F,V,Z,q,W,Q,te,oe,xe,le,pe,Te,Me,Xe,gt,ut,xt,Rt,wt,ft){const it=32*e,Ht=16*e;return this.int16[it+0]=i,this.int16[it+1]=u,this.int16[it+2]=p,this.int16[it+3]=_,this.int16[it+4]=v,this.int16[it+5]=E,this.int16[it+6]=P,this.int16[it+7]=R,this.uint16[it+8]=F,this.uint16[it+9]=V,this.uint16[it+10]=Z,this.uint16[it+11]=q,this.uint16[it+12]=W,this.uint16[it+13]=Q,this.uint16[it+14]=te,this.uint16[it+15]=oe,this.uint16[it+16]=xe,this.uint16[it+17]=le,this.uint16[it+18]=pe,this.uint16[it+19]=Te,this.uint16[it+20]=Me,this.uint16[it+21]=Xe,this.uint16[it+22]=gt,this.uint32[Ht+12]=ut,this.float32[Ht+13]=xt,this.float32[Ht+14]=Rt,this.uint16[it+30]=wt,this.uint16[it+31]=ft,e}}Pa.prototype.bytesPerElement=64,Ot("StructArrayLayout8i15ui1ul2f2ui64",Pa);class Jn extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}Jn.prototype.bytesPerElement=4,Ot("StructArrayLayout1f4",Jn);class gl extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,u)}emplace(e,i,u,p){const _=3*e;return this.uint16[6*e+0]=i,this.float32[_+1]=u,this.float32[_+2]=p,e}}gl.prototype.bytesPerElement=12,Ot("StructArrayLayout1ui2f12",gl);class uc extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,u)}emplace(e,i,u,p){const _=4*e;return this.uint32[2*e+0]=i,this.uint16[_+2]=u,this.uint16[_+3]=p,e}}uc.prototype.bytesPerElement=8,Ot("StructArrayLayout1ul2ui8",uc);class rh extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const u=this.length;return this.resize(u+1),this.emplace(u,e,i)}emplace(e,i,u){const p=2*e;return this.uint16[p+0]=i,this.uint16[p+1]=u,e}}rh.prototype.bytesPerElement=4,Ot("StructArrayLayout2ui4",rh);class ah extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}ah.prototype.bytesPerElement=2,Ot("StructArrayLayout1ui2",ah);class Fs extends mn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,u,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,u,p)}emplace(e,i,u,p,_){const v=4*e;return this.float32[v+0]=i,this.float32[v+1]=u,this.float32[v+2]=p,this.float32[v+3]=_,e}}Fs.prototype.bytesPerElement=16,Ot("StructArrayLayout4f16",Fs);class b extends ql{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new k(this.anchorPointX,this.anchorPointY)}}b.prototype.size=20;class t extends nh{get(e){return new b(this,e)}}Ot("CollisionBoxArray",t);class o extends ql{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}o.prototype.size=48;class f extends Wl{get(e){return new o(this,e)}}Ot("PlacedSymbolArray",f);class y extends ql{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}y.prototype.size=64;class M extends Pa{get(e){return new y(this,e)}}Ot("SymbolInstanceArray",M);class C extends Jn{getoffsetX(e){return this.float32[1*e+0]}}Ot("GlyphOffsetArray",C);class D extends lc{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Ot("SymbolLineVertexArray",D);class O extends ql{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}O.prototype.size=12;class U extends gl{get(e){return new O(this,e)}}Ot("TextAnchorOffsetArray",U);class G extends ql{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}G.prototype.size=8;class X extends uc{get(e){return new G(this,e)}}Ot("FeatureIndexArray",X);class $ extends or{}class ee extends or{}class re extends or{}class me extends $l{}class _e extends th{}class ye extends Hl{}class ve extends Xl{}class Se extends Ef{}class be extends sr{}class Ce extends Bs{}class Ie extends ih{}class we extends Zh{}class ke extends $h{}class Ke extends Yl{}class He extends rh{}const Je=ri([{name:"a_pos",components:2,type:"Int16"}],4),{members:tt}=Je;class bt{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,i,u,p){const _=this.segments[this.segments.length-1];return e>bt.MAX_VERTEX_ARRAY_LENGTH&&Rn(`Max vertices per segment is ${bt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${bt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!_||_.vertexLength+e>bt.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==p?this.createNewSegment(i,u,p):_}createNewSegment(e,i,u){const p={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0,vaos:{}};return u!==void 0&&(p.sortKey=u),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(p),p}getOrCreateLatestSegment(e,i,u){return this.prepareSegment(0,e,i,u)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,u,p){return new bt([{vertexOffset:e,primitiveOffset:i,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])}}function Ct(n,e){return 256*(n=kt(Math.floor(n),0,255))+kt(Math.floor(e),0,255)}bt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ot("SegmentVector",bt);const _t=ri([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Yt=ri([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var wi,hn,In,gn={exports:{}},qn={exports:{}},xn={exports:{}},Or=(function(){if(In)return gn.exports;In=1;var n=(wi||(wi=1,qn.exports=function(i,u){var p,_,v,E,P,R,F,V;for(_=i.length-(p=3&i.length),v=u,P=3432918353,R=461845907,V=0;V<_;)F=255&i.charCodeAt(V)|(255&i.charCodeAt(++V))<<8|(255&i.charCodeAt(++V))<<16|(255&i.charCodeAt(++V))<<24,++V,v=27492+(65535&(E=5*(65535&(v=(v^=F=(65535&(F=(F=(65535&F)*P+(((F>>>16)*P&65535)<<16)&4294967295)<<15|F>>>17))*R+(((F>>>16)*R&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(F=0,p){case 3:F^=(255&i.charCodeAt(V+2))<<16;case 2:F^=(255&i.charCodeAt(V+1))<<8;case 1:v^=F=(65535&(F=(F=(65535&(F^=255&i.charCodeAt(V)))*P+(((F>>>16)*P&65535)<<16)&4294967295)<<15|F>>>17))*R+(((F>>>16)*R&65535)<<16)&4294967295}return v^=i.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),qn.exports),e=(hn||(hn=1,xn.exports=function(i,u){for(var p,_=i.length,v=u^_,E=0;_>=4;)p=1540483477*(65535&(p=255&i.charCodeAt(E)|(255&i.charCodeAt(++E))<<8|(255&i.charCodeAt(++E))<<16|(255&i.charCodeAt(++E))<<24))+((1540483477*(p>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),_-=4,++E;switch(_){case 3:v^=(255&i.charCodeAt(E+2))<<16;case 2:v^=(255&i.charCodeAt(E+1))<<8;case 1:v=1540483477*(65535&(v^=255&i.charCodeAt(E)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),xn.exports);return gn.exports=n,gn.exports.murmur3=n,gn.exports.murmur2=e,gn.exports})(),jn=N(Or);class Br{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,u,p){this.ids.push(lr(e)),this.positions.push(i,u,p)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=lr(e);let u=0,p=this.ids.length-1;for(;u<p;){const v=u+p>>1;this.ids[v]>=i?p=v:u=v+1}const _=[];for(;this.ids[u]===i;)_.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return _}static serialize(e,i){const u=new Float64Array(e.ids),p=new Uint32Array(e.positions);return gr(u,p,0,u.length-1),i&&i.push(u.buffer,p.buffer),{ids:u,positions:p}}static deserialize(e){const i=new Br;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function lr(n){const e=+n;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:jn(String(n))}function gr(n,e,i,u){for(;i<u;){const p=n[i+u>>1];let _=i-1,v=u+1;for(;;){do _++;while(n[_]<p);do v--;while(n[v]>p);if(_>=v)break;pa(n,_,v),pa(e,3*_,3*v),pa(e,3*_+1,3*v+1),pa(e,3*_+2,3*v+2)}v-i<u-v?(gr(n,e,i,v),i=v+1):(gr(n,e,v+1,u),u=v)}}function pa(n,e,i){const u=n[e];n[e]=n[i],n[i]=u}Ot("FeaturePositionMap",Br);class za{constructor(e,i){this.gl=e.gl,this.location=i}}class Ns extends za{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Kl extends za{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class cc extends za{constructor(e,i){super(e,i),this.current=xi.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const zd=new Float32Array(16);function hc(n){return[Ct(255*n.r,255*n.g),Ct(255*n.b,255*n.a)]}class Ao{constructor(e,i,u){this.value=e,this.uniformNames=i.map((p=>`u_${p}`)),this.type=u}setUniform(e,i,u){e.set(u.constantOr(this.value))}getBinding(e,i,u){return this.type==="color"?new cc(e,i):new Ns(e,i)}}class Fr{constructor(e,i){this.uniformNames=i.map((u=>`u_${u}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=e.tlbr}setConstantDashPositions(e,i){this.dashTo=[0,e.y,e.height,e.width],this.dashFrom=[0,i.y,i.height,i.width]}setUniform(e,i,u,p){let _=null;p==="u_pattern_to"?_=this.patternTo:p==="u_pattern_from"?_=this.patternFrom:p==="u_dasharray_to"?_=this.dashTo:p==="u_dasharray_from"?_=this.dashFrom:p==="u_pixel_ratio_to"?_=this.pixelRatioTo:p==="u_pixel_ratio_from"&&(_=this.pixelRatioFrom),_!==null&&e.set(_)}getBinding(e,i,u){return u.substr(0,9)==="u_pattern"||u.substr(0,12)==="u_dasharray_"?new Kl(e,i):new Ns(e,i)}}class sa{constructor(e,i,u,p){this.expression=e,this.type=u,this.maxValue=0,this.paintVertexAttributes=i.map((_=>({name:`a_${_}`,type:"Float32",components:u==="color"?2:1,offset:0}))),this.paintVertexArray=new p}populatePaintArray(e,i,u){const p=this.paintVertexArray.length,_=this.expression.evaluate(new $i(0,u),i,{},u.canonical,[],u.formattedSection);this.paintVertexArray.resize(e),this._setPaintValue(p,e,_)}updatePaintArray(e,i,u,p,_){const v=this.expression.evaluate(new $i(0,_),u,p);this._setPaintValue(e,i,v)}_setPaintValue(e,i,u){if(this.type==="color"){const p=hc(u);for(let _=e;_<i;_++)this.paintVertexArray.emplace(_,p[0],p[1])}else{for(let p=e;p<i;p++)this.paintVertexArray.emplace(p,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ma{constructor(e,i,u,p,_,v){this.expression=e,this.uniformNames=i.map((E=>`u_${E}_t`)),this.type=u,this.useIntegerZoom=p,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=i.map((E=>({name:`a_${E}`,type:"Float32",components:u==="color"?4:2,offset:0}))),this.paintVertexArray=new v}populatePaintArray(e,i,u){const p=this.expression.evaluate(new $i(this.zoom,u),i,{},u.canonical,[],u.formattedSection),_=this.expression.evaluate(new $i(this.zoom+1,u),i,{},u.canonical,[],u.formattedSection),v=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(v,e,p,_)}updatePaintArray(e,i,u,p,_){const v=this.expression.evaluate(new $i(this.zoom,_),u,p),E=this.expression.evaluate(new $i(this.zoom+1,_),u,p);this._setPaintValue(e,i,v,E)}_setPaintValue(e,i,u,p){if(this.type==="color"){const _=hc(u),v=hc(p);for(let E=e;E<i;E++)this.paintVertexArray.emplace(E,_[0],_[1],v[0],v[1])}else{for(let _=e;_<i;_++)this.paintVertexArray.emplace(_,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const u=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,p=kt(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);e.set(p)}getBinding(e,i,u){return new Ns(e,i)}}class Ko{constructor(e,i,u,p,_,v){this.expression=e,this.type=i,this.useIntegerZoom=u,this.zoom=p,this.layerId=v,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(e,i,u){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(p,e,this.getPositionIds(i),u)}updatePaintArray(e,i,u,p,_){this._setPaintValues(e,i,this.getPositionIds(u),_)}_setPaintValues(e,i,u,p){const _=this.getPositions(p);if(!_||!u)return;const v=_[u.min],E=_[u.mid],P=_[u.max];if(v&&E&&P)for(let R=e;R<i;R++)this.emplace(this.zoomInPaintVertexArray,R,E,v),this.emplace(this.zoomOutPaintVertexArray,R,E,P)}upload(e){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const i=this.getVertexAttributes();this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,i,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,i,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class ur extends Ko{getPositions(e){return e.imagePositions}getPositionIds(e){return e.patterns&&e.patterns[this.layerId]}getVertexAttributes(){return _t.members}emplace(e,i,u,p){e.emplace(i,u.tlbr[0],u.tlbr[1],u.tlbr[2],u.tlbr[3],p.tlbr[0],p.tlbr[1],p.tlbr[2],p.tlbr[3],u.pixelRatio,p.pixelRatio)}}class Nr extends Ko{getPositions(e){return e.dashPositions}getPositionIds(e){return e.dashes&&e.dashes[this.layerId]}getVertexAttributes(){return Yt.members}emplace(e,i,u,p){e.emplace(i,0,u.y,u.height,u.width,0,p.y,p.height,p.width)}}class mo{constructor(e,i,u){this.binders={},this._buffers=[];const p=[];for(const _ in e.paint._values){if(!u(_))continue;const v=e.paint.get(_);if(!(v instanceof ho&&Ca(v.property.specification)))continue;const E=Af(_,e.type),P=v.value,R=v.property.specification.type,F=v.property.useIntegerZoom,V=v.property.specification["property-type"],Z=V==="cross-faded"||V==="cross-faded-data-driven";if(P.kind==="constant")this.binders[_]=Z?new Fr(P.value,E):new Ao(P.value,E,R),p.push(`/u_${_}`);else if(P.kind==="source"||Z){const q=Id(_,R,"source");this.binders[_]=Z?_==="line-dasharray"?new Nr(P,R,F,i,q,e.id):new ur(P,R,F,i,q,e.id):new sa(P,E,R,q),p.push(`/a_${_}`)}else{const q=Id(_,R,"composite");this.binders[_]=new ma(P,E,R,F,i,q),p.push(`/z_${_}`)}}this.cacheKey=p.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof sa||i instanceof ma?i.maxValue:0}populatePaintArrays(e,i,u){for(const p in this.binders){const _=this.binders[p];(_ instanceof sa||_ instanceof ma||_ instanceof Ko)&&_.populatePaintArray(e,i,u)}}setConstantPatternPositions(e,i){for(const u in this.binders){const p=this.binders[u];p instanceof Fr&&p.setConstantPatternPositions(e,i)}}setConstantDashPositions(e,i){for(const u in this.binders){const p=this.binders[u];p instanceof Fr&&p.setConstantDashPositions(e,i)}}updatePaintArrays(e,i,u,p,_){let v=!1;for(const E in e){const P=i.getPositions(E);for(const R of P){const F=u.feature(R.index);for(const V in this.binders){const Z=this.binders[V];if((Z instanceof sa||Z instanceof ma||Z instanceof Ko)&&Z.expression.isStateDependent===!0){const q=p.paint.get(V);Z.expression=q.value,Z.updatePaintArray(R.start,R.end,F,e[E],_),v=!0}}}}return v}defines(){const e=[];for(const i in this.binders){const u=this.binders[i];(u instanceof Ao||u instanceof Fr)&&e.push(...u.uniformNames.map((p=>`#define HAS_UNIFORM_${p}`)))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const u=this.binders[i];if(u instanceof sa||u instanceof ma)for(let p=0;p<u.paintVertexAttributes.length;p++)e.push(u.paintVertexAttributes[p].name);else if(u instanceof Ko){const p=u.getVertexAttributes();for(const _ of p)e.push(_.name)}}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const u=this.binders[i];if(u instanceof Ao||u instanceof Fr||u instanceof ma)for(const p of u.uniformNames)e.push(p)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const u=[];for(const p in this.binders){const _=this.binders[p];if(_ instanceof Ao||_ instanceof Fr||_ instanceof ma){for(const v of _.uniformNames)if(i[v]){const E=_.getBinding(e,i[v],v);u.push({name:v,property:p,binding:E})}}}return u}setUniforms(e,i,u,p){for(const{name:_,property:v,binding:E}of i)this.binders[v].setUniform(E,p,u.get(v),_)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const u=this.binders[i];if(e&&u instanceof Ko){const p=e.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(u instanceof sa||u instanceof ma)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(e){for(const i in this.binders){const u=this.binders[i];(u instanceof sa||u instanceof ma||u instanceof Ko)&&u.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof sa||i instanceof ma||i instanceof Ko)&&i.destroy()}}}class Qn{constructor(e,i,u=()=>!0){this.programConfigurations={};for(const p of e)this.programConfigurations[p.id]=new mo(p,i,u);this.needsUpload=!1,this._featureMap=new Br,this._bufferOffset=0}populatePaintArrays(e,i,u,p){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(e,i,p);i.id!==void 0&&this._featureMap.add(i.id,u,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,u,p){for(const _ of u)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,i,_,p)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Af(n,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}function Id(n,e,i){const u={color:{source:Hl,composite:Fs},number:{source:Jn,composite:Hl}},p=(function(_){return{"line-pattern":{source:ve,composite:ve},"fill-pattern":{source:ve,composite:ve},"fill-extrusion-pattern":{source:ve,composite:ve},"line-dasharray":{source:Se,composite:Se}}[_]})(n);return p&&p[i]||u[e][i]}Ot("ConstantBinder",Ao),Ot("CrossFadedConstantBinder",Fr),Ot("SourceExpressionBinder",sa),Ot("CrossFadedPatternBinder",ur),Ot("CrossFadedDasharrayBinder",Nr),Ot("CompositeExpressionBinder",ma),Ot("ProgramConfiguration",mo,{omit:["_buffers"]}),Ot("ProgramConfigurationSet",Qn);const Ld=Math.pow(2,14)-1,Cf=-Ld-1;function Jo(n){const e=ei/n.extent,i=n.loadGeometry();for(let u=0;u<i.length;u++){const p=i[u];for(let _=0;_<p.length;_++){const v=p[_],E=Math.round(v.x*e),P=Math.round(v.y*e);v.x=kt(E,Cf,Ld),v.y=kt(P,Cf,Ld),(E<v.x||E>v.x+1||P<v.y||P>v.y+1)&&Rn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function Lu(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?Jo(n):[]}}const Jl=-32768;function Pf(n,e,i,u,p){n.emplaceBack(Jl+8*e+u,Jl+8*i+p)}class dc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new ee,this.indexArray=new Ke,this.segments=new bt,this.programConfigurations=new Qn(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,u){const p=this.layers[0],_=[];let v=null,E=!1,P=p.type==="heatmap";if(p.type==="circle"){const F=p;v=F.layout.get("circle-sort-key"),E=!v.isConstant(),P=P||F.paint.get("circle-pitch-alignment")==="map"}const R=P?i.subdivisionGranularity.circle:1;for(const{feature:F,id:V,index:Z,sourceLayerIndex:q}of e){const W=this.layers[0]._featureFilter.needGeometry,Q=Lu(F,W);if(!this.layers[0]._featureFilter.filter(new $i(this.zoom),Q,u))continue;const te=E?v.evaluate(Q,{},u):void 0,oe={id:V,properties:F.properties,type:F.type,sourceLayerIndex:q,index:Z,geometry:W?Q.geometry:Jo(F),patterns:{},sortKey:te};_.push(oe)}E&&_.sort(((F,V)=>F.sortKey-V.sortKey));for(const F of _){const{geometry:V,index:Z,sourceLayerIndex:q}=F,W=e[Z].feature;this.addFeature(F,V,Z,u,R),i.featureIndex.insert(W,V,Z,q,this.index)}}update(e,i,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:u})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,tt),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,u,p,_=1){let v;switch(_){case 1:v=[0,7];break;case 3:v=[0,2,5,7];break;case 5:v=[0,1,3,4,6,7];break;case 7:v=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${_}; valid values are 1, 3, 5, 7.`)}const E=v.length;for(const P of i)for(const R of P){const F=R.x,V=R.y;if(F<0||F>=ei||V<0||V>=ei)continue;const Z=this.segments.prepareSegment(E*E,this.layoutVertexArray,this.indexArray,e.sortKey),q=Z.vertexLength;for(let W=0;W<E;W++)for(let Q=0;Q<E;Q++)Pf(this.layoutVertexArray,F,V,v[Q],v[W]);for(let W=0;W<E-1;W++)for(let Q=0;Q<E-1;Q++){const te=q+W*E+Q,oe=q+(W+1)*E+Q;this.indexArray.emplaceBack(te,oe+1,te+1),this.indexArray.emplaceBack(te,oe,oe+1)}Z.vertexLength+=E*E,Z.primitiveLength+=(E-1)*(E-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,{imagePositions:{},canonical:p})}}function Dd(n,e){for(let i=0;i<n.length;i++)if(Hh(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(Hh(n,e[i]))return!0;return!!Qm(n,e)}function Du(n,e,i){return!!Hh(n,e)||!!jr(e,n,i)}function Rd(n,e){if(n.length===1)return tg(e,n[0]);for(let i=0;i<e.length;i++){const u=e[i];for(let p=0;p<u.length;p++)if(Hh(n,u[p]))return!0}for(let i=0;i<n.length;i++)if(tg(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(Qm(n,e[i]))return!0;return!1}function kd(n,e,i){if(n.length>1){if(Qm(n,e))return!0;for(let u=0;u<e.length;u++)if(jr(e[u],n,i))return!0}for(let u=0;u<n.length;u++)if(jr(n[u],e,i))return!0;return!1}function Qm(n,e){if(n.length===0||e.length===0)return!1;for(let i=0;i<n.length-1;i++){const u=n[i],p=n[i+1];for(let _=0;_<e.length-1;_++)if(eg(u,p,e[_],e[_+1]))return!0}return!1}function eg(n,e,i,u){return Jr(n,i,u)!==Jr(e,i,u)&&Jr(n,e,i)!==Jr(n,e,u)}function jr(n,e,i){const u=i*i;if(e.length===1)return n.distSqr(e[0])<u;for(let p=1;p<e.length;p++)if(Ka(n,e[p-1],e[p])<u)return!0;return!1}function Ka(n,e,i){const u=e.distSqr(i);if(u===0)return n.distSqr(e);const p=((n.x-e.x)*(i.x-e.x)+(n.y-e.y)*(i.y-e.y))/u;return n.distSqr(p<0?e:p>1?i:i.sub(e)._mult(p)._add(e))}function tg(n,e){let i,u,p,_=!1;for(let v=0;v<n.length;v++){i=n[v];for(let E=0,P=i.length-1;E<i.length;P=E++)u=i[E],p=i[P],u.y>e.y!=p.y>e.y&&e.x<(p.x-u.x)*(e.y-u.y)/(p.y-u.y)+u.x&&(_=!_)}return _}function Hh(n,e){let i=!1;for(let u=0,p=n.length-1;u<n.length;p=u++){const _=n[u],v=n[p];_.y>e.y!=v.y>e.y&&e.x<(v.x-_.x)*(e.y-_.y)/(v.y-_.y)+_.x&&(i=!i)}return i}function $y(n,e,i){const u=i[0],p=i[2];if(n.x<u.x&&e.x<u.x||n.x>p.x&&e.x>p.x||n.y<u.y&&e.y<u.y||n.y>p.y&&e.y>p.y)return!1;const _=Jr(n,e,i[0]);return _!==Jr(n,e,i[1])||_!==Jr(n,e,i[2])||_!==Jr(n,e,i[3])}function Xh(n,e,i){const u=e.paint.get(n).value;return u.kind==="constant"?u.value:i.programConfigurations.get(e.id).getMaxValue(n)}function oh(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function zf(n,e,i,u,p){if(!e[0]&&!e[1])return n;const _=k.convert(e)._mult(p);i==="viewport"&&_._rotate(-u);const v=[];for(let E=0;E<n.length;E++)v.push(n[E].sub(_));return v}function Bp(n){const e=[];for(let i=0;i<n.length;i++){const u=n[i],p=e.at(-1);(i===0||p&&!u.equals(p))&&e.push(u)}return e}function Hy({queryGeometry:n,size:e},i){return Du(n,i,e)}function Wv({queryGeometry:n,size:e,transform:i,unwrappedTileID:u,getElevation:p},_){return Du(n,_,e*(i.projectTileCoordinates(_.x,_.y,u,p).signedDistanceFromCamera/i.cameraToCenterDistance))}function Fp({queryGeometry:n,size:e,transform:i,unwrappedTileID:u,getElevation:p},_){const v=i.projectTileCoordinates(_.x,_.y,u,p).signedDistanceFromCamera,E=e*(i.cameraToCenterDistance/v);return Du(n,Np(_,i,u,p),E)}function ig({queryGeometry:n,size:e,transform:i,unwrappedTileID:u,getElevation:p},_){return Du(n,Np(_,i,u,p),e)}function ng({queryGeometry:n,size:e,transform:i,unwrappedTileID:u,getElevation:p,pitchAlignment:_="map",pitchScale:v="map"},E){const P=_==="map"?v==="map"?Hy:Wv:v==="map"?Fp:ig,R={queryGeometry:n,size:e,transform:i,unwrappedTileID:u,getElevation:p};for(const F of E)for(const V of F)if(P(R,V))return!0;return!1}function Np(n,e,i,u){const p=e.projectTileCoordinates(n.x,n.y,i,u).point;return new k((.5*p.x+.5)*e.width,(.5*-p.y+.5)*e.height)}let rg,jp;Ot("CircleBucket",dc,{omit:["layers"]});var ag={get paint(){return jp=jp||new xr({"circle-radius":new ai(Ze.paint_circle["circle-radius"]),"circle-color":new ai(Ze.paint_circle["circle-color"]),"circle-blur":new ai(Ze.paint_circle["circle-blur"]),"circle-opacity":new ai(Ze.paint_circle["circle-opacity"]),"circle-translate":new Jt(Ze.paint_circle["circle-translate"]),"circle-translate-anchor":new Jt(Ze.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Jt(Ze.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Jt(Ze.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ai(Ze.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ai(Ze.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ai(Ze.paint_circle["circle-stroke-opacity"])})},get layout(){return rg=rg||new xr({"circle-sort-key":new ai(Ze.layout_circle["circle-sort-key"])})}};class og extends po{constructor(e,i){super(e,ag,i)}createBucket(e){return new dc(e)}queryRadius(e){const i=e;return Xh("circle-radius",this,i)+Xh("circle-stroke-width",this,i)+oh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:u,geometry:p,transform:_,pixelsToTileUnits:v,unwrappedTileID:E,getElevation:P}){const R=zf(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-_.bearingInRadians,v),F=this.paint.get("circle-radius").evaluate(i,u)+this.paint.get("circle-stroke-width").evaluate(i,u),V=this.paint.get("circle-pitch-scale"),Z=this.paint.get("circle-pitch-alignment");let q,W;return Z==="map"?(q=R,W=F*v):(q=(function(Q,te,oe,xe){return Q.map((le=>Np(le,te,oe,xe)))})(R,_,E,P),W=F),ng({queryGeometry:q,size:W,transform:_,unwrappedTileID:E,getElevation:P,pitchAlignment:Z,pitchScale:V},p)}}class sg extends dc{}let Up;Ot("HeatmapBucket",sg,{omit:["layers"]});var Vp={get paint(){return Up=Up||new xr({"heatmap-radius":new ai(Ze.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ai(Ze.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Jt(Ze.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fa(Ze.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Jt(Ze.paint_heatmap["heatmap-opacity"])})}};function If(n,{width:e,height:i},u,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==e*i*u)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${e*i*u}`)}else p=new Uint8Array(e*i*u);return n.width=e,n.height=i,n.data=p,n}function lg(n,{width:e,height:i},u){if(e===n.width&&i===n.height)return;const p=If({},{width:e,height:i},u);Lf(n,p,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,e),height:Math.min(n.height,i)},u),n.width=e,n.height=i,n.data=p.data}function Lf(n,e,i,u,p,_){if(p.width===0||p.height===0)return e;if(p.width>n.width||p.height>n.height||i.x>n.width-p.width||i.y>n.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>e.width||p.height>e.height||u.x>e.width-p.width||u.y>e.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const v=n.data,E=e.data;if(v===E)throw new Error("srcData equals dstData, so image is already copied");for(let P=0;P<p.height;P++){const R=((i.y+P)*n.width+i.x)*_,F=((u.y+P)*e.width+u.x)*_;for(let V=0;V<p.width*_;V++)E[F+V]=v[R+V]}return e}class Od{constructor(e,i){If(this,e,1,i)}resize(e){lg(this,e,1)}clone(){return new Od({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,u,p,_){Lf(e,i,u,p,_,1)}}class zr{constructor(e,i){If(this,e,4,i)}resize(e){lg(this,e,4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new zr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,u,p,_){Lf(e,i,u,p,_,4)}setPixel(e,i,u){const p=4*(e*this.width+i);this.data[p+0]=Math.round(255*u.r/u.a),this.data[p+1]=Math.round(255*u.g/u.a),this.data[p+2]=Math.round(255*u.b/u.a),this.data[p+3]=Math.round(255*u.a)}}function Gp(n){const e={},i=n.resolution||256,u=n.clips?n.clips.length:1,p=n.image||new zr({width:i,height:u});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const _=(v,E,P)=>{e[n.evaluationKey]=P;const R=n.expression.evaluate(e);p.setPixel(v/4/i,E/4,R)};if(n.clips)for(let v=0,E=0;v<u;++v,E+=4*i)for(let P=0,R=0;P<i;P++,R+=4){const F=P/(i-1),{start:V,end:Z}=n.clips[v];_(E,R,V*(1-F)+Z*F)}else for(let v=0,E=0;v<i;v++,E+=4)_(0,E,v/(i-1));return p}Ot("AlphaImage",Od),Ot("RGBAImage",zr);const ug="big-fb";class Xy extends po{createBucket(e){return new sg(e)}constructor(e,i){super(e,Vp,i),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Gp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(ug)&&this.heatmapFbos.delete(ug)}queryRadius(e){return Xh("heatmap-radius",this,e)}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:u,geometry:p,transform:_,pixelsToTileUnits:v,unwrappedTileID:E,getElevation:P}){return ng({queryGeometry:e,size:this.paint.get("heatmap-radius").evaluate(i,u)*v,transform:_,unwrappedTileID:E,getElevation:P},p)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Ru;var cg={get paint(){return Ru=Ru||new xr({"hillshade-illumination-direction":new Jt(Ze.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Jt(Ze.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Jt(Ze.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Jt(Ze.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Jt(Ze.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Jt(Ze.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Jt(Ze.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Jt(Ze.paint_hillshade["hillshade-method"])})}};class Yy extends po{constructor(e,i){super(e,cg,i),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,i=this.paint.get("hillshade-illumination-altitude").values,u=this.paint.get("hillshade-highlight-color").values,p=this.paint.get("hillshade-shadow-color").values;const _=Math.max(e.length,i.length,u.length,p.length);e=e.concat(Array(_-e.length).fill(e.at(-1))),i=i.concat(Array(_-i.length).fill(i.at(-1))),u=u.concat(Array(_-u.length).fill(u.at(-1))),p=p.concat(Array(_-p.length).fill(p.at(-1)));const v=i.map(Rr);return{directionRadians:e.map(Rr),altitudeRadians:v,shadowColor:p,highlightColor:u}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Df;var Rf={get paint(){return Df=Df||new xr({"color-relief-opacity":new Jt(Ze["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new fa(Ze["paint_color-relief"]["color-relief-color"])})}};class er{constructor(e,i,u,p){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(i,p)}update(e,i,u){const{width:p,height:_}=e,v=!(this.size&&this.size[0]===p&&this.size[1]===_||u),{context:E}=this,{gl:P}=E;if(this.useMipmap=!!(i&&i.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!i||i.premultiply!==!1)),v)this.size=[p,_],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||La(e)?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,e):P.texImage2D(P.TEXTURE_2D,0,this.format,p,_,0,this.format,P.UNSIGNED_BYTE,e.data);else{const{x:R,y:F}=u||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||La(e)?P.texSubImage2D(P.TEXTURE_2D,0,R,F,P.RGBA,P.UNSIGNED_BYTE,e):P.texSubImage2D(P.TEXTURE_2D,0,R,F,p,_,P.RGBA,P.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D),E.pixelStoreUnpackFlipY.setDefault(),E.pixelStoreUnpack.setDefault(),E.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,i,u){const{context:p}=this,{gl:_}=p;_.bindTexture(_.TEXTURE_2D,this.texture),u!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=_.LINEAR),e!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,e),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,u||e),this.filter=e),i!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,i),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Wy{constructor(e,i,u,p=1,_=1,v=1,E=0){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void Rn(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=i.height;const P=this.dim=i.height-2;switch(this.data=new Uint32Array(i.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=_,this.blueFactor=v,this.baseShift=E;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let R=0;R<P;R++)this.data[this._idx(-1,R)]=this.data[this._idx(0,R)],this.data[this._idx(P,R)]=this.data[this._idx(P-1,R)],this.data[this._idx(R,-1)]=this.data[this._idx(R,0)],this.data[this._idx(R,P)]=this.data[this._idx(R,P-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(P,-1)]=this.data[this._idx(P-1,0)],this.data[this._idx(-1,P)]=this.data[this._idx(0,P-1)],this.data[this._idx(P,P)]=this.data[this._idx(P-1,P-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let R=0;R<P;R++)for(let F=0;F<P;F++){const V=this.get(R,F);V>this.max&&(this.max=V),V<this.min&&(this.min=V)}}get(e,i){const u=new Uint8Array(this.data.buffer),p=4*this._idx(e,i);return this.unpack(u[p],u[p+1],u[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}unpack(e,i,u){return e*this.redFactor+i*this.greenFactor+u*this.blueFactor-this.baseShift}pack(e){return Ky(e,this.getUnpackVector())}getPixels(){return new zr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,i,u){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let p=i*this.dim,_=i*this.dim+this.dim,v=u*this.dim,E=u*this.dim+this.dim;switch(i){case-1:p=_-1;break;case 1:_=p+1}switch(u){case-1:v=E-1;break;case 1:E=v+1}const P=-i*this.dim,R=-u*this.dim;for(let F=v;F<E;F++)for(let V=p;V<_;V++)this.data[this._idx(V,F)]=e.data[this._idx(V+P,F+R)]}}function Ky(n,e){const i=e[0],u=e[1],p=e[2],_=e[3],v=Math.min(i,u,p),E=Math.round((n+_)/v);return{r:Math.floor(E*v/i)%256,g:Math.floor(E*v/u)%256,b:Math.floor(E*v/p)%256}}Ot("DEMData",Wy);class Jy extends po{constructor(e,i){super(e,Rf,i)}_createColorRamp(e){const i={elevationStops:[],colorStops:[]},u=this._transitionablePaint._values["color-relief-color"].value.expression;if(u instanceof x&&u._styleExpression.expression instanceof rr){this.colorRampExpression=u;const v=u._styleExpression.expression;i.elevationStops=v.labels,i.colorStops=[];for(const E of i.elevationStops)i.colorStops.push(v.evaluate({globals:{elevation:E}}))}if(i.elevationStops.length<1&&(i.elevationStops=[0],i.colorStops=[xi.transparent]),i.elevationStops.length<2&&(i.elevationStops.push(i.elevationStops[0]+1),i.colorStops.push(i.colorStops[0])),i.elevationStops.length<=e)return i;const p={elevationStops:[],colorStops:[]},_=(i.elevationStops.length-1)/(e-1);for(let v=0;v<i.elevationStops.length-.5;v+=_)p.elevationStops.push(i.elevationStops[Math.round(v)]),p.colorStops.push(i.colorStops[Math.round(v)]);return Rn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${e}, provided: ${i.elevationStops.length}`),p}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,i,u){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const p=this._createColorRamp(i),_=new zr({width:p.colorStops.length,height:1}),v=new zr({width:p.colorStops.length,height:1});for(let E=0;E<p.elevationStops.length;E++){const P=Ky(p.elevationStops[E],u);v.setPixel(0,E,new xi(P.r/255,P.g/255,P.b/255,1)),_.setPixel(0,E,p.colorStops[E])}return this.colorRampTextures={elevationTexture:new er(e,v,e.gl.RGBA),colorTexture:new er(e,_,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const kf=ri([{name:"a_pos",components:2,type:"Int16"}],4),{members:sh}=kf;function Of(n,e,i){const u=i.patternDependencies;let p=!1;for(const _ of e){const v=_.paint.get(`${n}-pattern`);v.isConstant()||(p=!0);const E=v.constantOr(null);E&&(p=!0,u[E.to]=!0,u[E.from]=!0)}return p}function Zp(n,e,i,u,p){const{zoom:_}=u,v=p.patternDependencies;for(const E of e){const P=E.paint.get(`${n}-pattern`).value;if(P.kind!=="constant"){let R=P.evaluate({zoom:_-1},i,{},p.availableImages),F=P.evaluate({zoom:_},i,{},p.availableImages),V=P.evaluate({zoom:_+1},i,{},p.availableImages);R=R&&R.name?R.name:R,F=F&&F.name?F.name:F,V=V&&V.name?V.name:V,v[R]=!0,v[F]=!0,v[V]=!0,i.patterns[E.id]={min:R,mid:F,max:V}}}return i}function Bd(n,e,i,u,p){let _;if(p===(function(v,E,P,R){let F=0;for(let V=E,Z=P-R;V<P;V+=R)F+=(v[Z]-v[V])*(v[V+1]+v[Z+1]),Z=V;return F})(n,e,i,u)>0)for(let v=e;v<i;v+=u)_=yg(v/u|0,n[v],n[v+1],_);else for(let v=i-u;v>=e;v-=u)_=yg(v/u|0,n[v],n[v+1],_);return _&&Yh(_,_.next)&&(Bf(_),_=_.next),_}function Co(n,e){if(!n)return n;e||(e=n);let i,u=n;do if(i=!1,u.steiner||!Yh(u,u.next)&&Tr(u.prev,u,u.next)!==0)u=u.next;else{if(Bf(u),u=e=u.prev,u===u.next)break;i=!0}while(i||u!==e);return e}function Fd(n,e,i,u,p,_,v){if(!n)return;!v&&_&&(function(P,R,F,V){let Z=P;do Z.z===0&&(Z.z=Ur(Z.x,Z.y,R,F,V)),Z.prevZ=Z.prev,Z.nextZ=Z.next,Z=Z.next;while(Z!==P);Z.prevZ.nextZ=null,Z.prevZ=null,(function(q){let W,Q=1;do{let te,oe=q;q=null;let xe=null;for(W=0;oe;){W++;let le=oe,pe=0;for(let Me=0;Me<Q&&(pe++,le=le.nextZ,le);Me++);let Te=Q;for(;pe>0||Te>0&&le;)pe!==0&&(Te===0||!le||oe.z<=le.z)?(te=oe,oe=oe.nextZ,pe--):(te=le,le=le.nextZ,Te--),xe?xe.nextZ=te:q=te,te.prevZ=xe,xe=te;oe=le}xe.nextZ=null,Q*=2}while(W>1)})(Z)})(n,u,p,_);let E=n;for(;n.prev!==n.next;){const P=n.prev,R=n.next;if(_?Qy(n,u,p,_):hg(n))e.push(P.i,n.i,R.i),Bf(n),n=R.next,E=R.next;else if((n=R)===E){v?v===1?Fd(n=dg(Co(n),e),e,i,u,p,_,2):v===2&&fg(n,e,i,u,p,_):Fd(Co(n),e,i,u,p,_,1);break}}}function hg(n){const e=n.prev,i=n,u=n.next;if(Tr(e,i,u)>=0)return!1;const p=e.x,_=i.x,v=u.x,E=e.y,P=i.y,R=u.y,F=Math.min(p,_,v),V=Math.min(E,P,R),Z=Math.max(p,_,v),q=Math.max(E,P,R);let W=u.next;for(;W!==e;){if(W.x>=F&&W.x<=Z&&W.y>=V&&W.y<=q&&Vr(p,E,_,P,v,R,W.x,W.y)&&Tr(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function Qy(n,e,i,u){const p=n.prev,_=n,v=n.next;if(Tr(p,_,v)>=0)return!1;const E=p.x,P=_.x,R=v.x,F=p.y,V=_.y,Z=v.y,q=Math.min(E,P,R),W=Math.min(F,V,Z),Q=Math.max(E,P,R),te=Math.max(F,V,Z),oe=Ur(q,W,e,i,u),xe=Ur(Q,te,e,i,u);let le=n.prevZ,pe=n.nextZ;for(;le&&le.z>=oe&&pe&&pe.z<=xe;){if(le.x>=q&&le.x<=Q&&le.y>=W&&le.y<=te&&le!==p&&le!==v&&Vr(E,F,P,V,R,Z,le.x,le.y)&&Tr(le.prev,le,le.next)>=0||(le=le.prevZ,pe.x>=q&&pe.x<=Q&&pe.y>=W&&pe.y<=te&&pe!==p&&pe!==v&&Vr(E,F,P,V,R,Z,pe.x,pe.y)&&Tr(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;le&&le.z>=oe;){if(le.x>=q&&le.x<=Q&&le.y>=W&&le.y<=te&&le!==p&&le!==v&&Vr(E,F,P,V,R,Z,le.x,le.y)&&Tr(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;pe&&pe.z<=xe;){if(pe.x>=q&&pe.x<=Q&&pe.y>=W&&pe.y<=te&&pe!==p&&pe!==v&&Vr(E,F,P,V,R,Z,pe.x,pe.y)&&Tr(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function dg(n,e){let i=n;do{const u=i.prev,p=i.next.next;!Yh(u,p)&&yr(u,i,i.next,p)&&Nd(u,p)&&Nd(p,u)&&(e.push(u.i,i.i,p.i),Bf(i),Bf(i.next),i=n=p),i=i.next}while(i!==n);return Co(i)}function fg(n,e,i,u,p,_){let v=n;do{let E=v.next.next;for(;E!==v.prev;){if(v.i!==E.i&&Kv(v,E)){let P=gg(v,E);return v=Co(v,v.next),P=Co(P,P.next),Fd(v,e,i,u,p,_,0),void Fd(P,e,i,u,p,_,0)}E=E.next}v=v.next}while(v!==n)}function qp(n,e){let i=n.x-e.x;return i===0&&(i=n.y-e.y,i===0)&&(i=(n.next.y-n.y)/(n.next.x-n.x)-(e.next.y-e.y)/(e.next.x-e.x)),i}function e_(n,e){const i=(function(p,_){let v=_;const E=p.x,P=p.y;let R,F=-1/0;if(Yh(p,v))return v;do{if(Yh(p,v.next))return v.next;if(P<=v.y&&P>=v.next.y&&v.next.y!==v.y){const Q=v.x+(P-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(Q<=E&&Q>F&&(F=Q,R=v.x<v.next.x?v:v.next,Q===E))return R}v=v.next}while(v!==_);if(!R)return null;const V=R,Z=R.x,q=R.y;let W=1/0;v=R;do{if(E>=v.x&&v.x>=Z&&E!==v.x&&mg(P<q?E:F,P,Z,q,P<q?F:E,P,v.x,v.y)){const Q=Math.abs(P-v.y)/(E-v.x);Nd(v,p)&&(Q<W||Q===W&&(v.x>R.x||v.x===R.x&&fc(R,v)))&&(R=v,W=Q)}v=v.next}while(v!==V);return R})(n,e);if(!i)return e;const u=gg(i,n);return Co(u,u.next),Co(i,i.next)}function fc(n,e){return Tr(n.prev,n,e.prev)<0&&Tr(e.next,n,n.next)<0}function Ur(n,e,i,u,p){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-u)*p|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function pg(n){let e=n,i=n;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==n);return i}function mg(n,e,i,u,p,_,v,E){return(p-v)*(e-E)>=(n-v)*(_-E)&&(n-v)*(u-E)>=(i-v)*(e-E)&&(i-v)*(_-E)>=(p-v)*(u-E)}function Vr(n,e,i,u,p,_,v,E){return!(n===v&&e===E)&&mg(n,e,i,u,p,_,v,E)}function Kv(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!(function(i,u){let p=i;do{if(p.i!==i.i&&p.next.i!==i.i&&p.i!==u.i&&p.next.i!==u.i&&yr(p,p.next,i,u))return!0;p=p.next}while(p!==i);return!1})(n,e)&&(Nd(n,e)&&Nd(e,n)&&(function(i,u){let p=i,_=!1;const v=(i.x+u.x)/2,E=(i.y+u.y)/2;do p.y>E!=p.next.y>E&&p.next.y!==p.y&&v<(p.next.x-p.x)*(E-p.y)/(p.next.y-p.y)+p.x&&(_=!_),p=p.next;while(p!==i);return _})(n,e)&&(Tr(n.prev,n,e.prev)||Tr(n,e.prev,e))||Yh(n,e)&&Tr(n.prev,n,n.next)>0&&Tr(e.prev,e,e.next)>0)}function Tr(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function Yh(n,e){return n.x===e.x&&n.y===e.y}function yr(n,e,i,u){const p=yl(Tr(n,e,i)),_=yl(Tr(n,e,u)),v=yl(Tr(i,u,n)),E=yl(Tr(i,u,e));return p!==_&&v!==E||!(p!==0||!go(n,i,e))||!(_!==0||!go(n,u,e))||!(v!==0||!go(i,n,u))||!(E!==0||!go(i,e,u))}function go(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function yl(n){return n>0?1:n<0?-1:0}function Nd(n,e){return Tr(n.prev,n,n.next)<0?Tr(n,e,n.next)>=0&&Tr(n,n.prev,e)>=0:Tr(n,e,n.prev)<0||Tr(n,n.next,e)<0}function gg(n,e){const i=jd(n.i,n.x,n.y),u=jd(e.i,e.x,e.y),p=n.next,_=e.prev;return n.next=e,e.prev=n,i.next=p,p.prev=i,u.next=i,i.prev=u,_.next=u,u.prev=_,u}function yg(n,e,i,u){const p=jd(n,e,i);return u?(p.next=u.next,p.prev=u,u.next.prev=p,u.next=p):(p.prev=p,p.next=p),p}function Bf(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function jd(n,e,i){return{i:n,x:e,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Ia{constructor(e,i){if(i>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=i}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class vs{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}vs.noSubdivision=new vs({fill:new Ia(0,0),line:new Ia(0,0),tile:new Ia(0,0),stencil:new Ia(0,0),circle:1}),Ot("SubdivisionGranularityExpression",Ia),Ot("SubdivisionGranularitySetting",vs);const Wh=-32768,Ja=32767;class t_{constructor(e,i){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=ei/e,this._canonical=i}_getKey(e,i){return(e+=32768)<<16|i+32768}_vertexToIndex(e,i){if(e<-32768||i<-32768||e>32767||i>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const u=0|Math.round(e),p=0|Math.round(i),_=this._getKey(u,p);if(this._vertexDictionary.has(_))return this._vertexDictionary.get(_);const v=this._vertexBuffer.length/2;return this._vertexDictionary.set(_,v),this._vertexBuffer.push(u,p),v}_subdivideTrianglesScanline(e){if(this._granularity<2)return(function(p,_){const v=[];for(let E=0;E<_.length;E+=3){const P=_[E],R=_[E+1],F=_[E+2],V=p[2*P],Z=p[2*P+1];(p[2*R]-V)*(p[2*F+1]-Z)-(p[2*R+1]-Z)*(p[2*F]-V)>0?(v.push(P),v.push(F),v.push(R)):(v.push(P),v.push(R),v.push(F))}return v})(this._vertexBuffer,e);const i=[],u=e.length;for(let p=0;p<u;p+=3){const _=[e[p+0],e[p+1],e[p+2]],v=[this._vertexBuffer[2*e[p+0]+0],this._vertexBuffer[2*e[p+0]+1],this._vertexBuffer[2*e[p+1]+0],this._vertexBuffer[2*e[p+1]+1],this._vertexBuffer[2*e[p+2]+0],this._vertexBuffer[2*e[p+2]+1]];let E=1/0,P=1/0,R=-1/0,F=-1/0;for(let Q=0;Q<3;Q++){const te=v[2*Q],oe=v[2*Q+1];E=Math.min(E,te),R=Math.max(R,te),P=Math.min(P,oe),F=Math.max(F,oe)}if(E===R||P===F)continue;const V=Math.floor(E/this._granularityCellSize),Z=Math.ceil(R/this._granularityCellSize),q=Math.floor(P/this._granularityCellSize),W=Math.ceil(F/this._granularityCellSize);if(V!==Z||q!==W)for(let Q=q;Q<W;Q++){const te=this._scanlineGenerateVertexRingForCellRow(Q,v,_);pc(this._vertexBuffer,te,i)}else i.push(..._)}return i}_scanlineGenerateVertexRingForCellRow(e,i,u){const p=e*this._granularityCellSize,_=p+this._granularityCellSize,v=[];for(let E=0;E<3;E++){const P=i[2*E],R=i[2*E+1],F=i[2*(E+1)%6],V=i[(2*(E+1)+1)%6],Z=i[2*(E+2)%6],q=i[(2*(E+2)+1)%6],W=F-P,Q=V-R,te=W===0,oe=Q===0,xe=(p-R)/Q,le=(_-R)/Q,pe=Math.min(xe,le),Te=Math.max(xe,le);if(!oe&&(pe>=1||Te<=0)||oe&&(R<p||R>_)){V>=p&&V<=_&&v.push(u[(E+1)%3]);continue}!oe&&pe>0&&v.push(this._vertexToIndex(P+W*pe,R+Q*pe));const Me=P+W*Math.max(pe,0),Xe=P+W*Math.min(Te,1);te||this._generateIntraEdgeVertices(v,P,R,F,V,Me,Xe),!oe&&Te<1&&v.push(this._vertexToIndex(P+W*Te,R+Q*Te)),(oe||V>=p&&V<=_)&&v.push(u[(E+1)%3]),!oe&&(V<=p||V>=_)&&this._generateInterEdgeVertices(v,P,R,F,V,Z,q,Xe,p,_)}return v}_generateIntraEdgeVertices(e,i,u,p,_,v,E){const P=p-i,R=_-u,F=R===0,V=F?Math.min(i,p):Math.min(v,E),Z=F?Math.max(i,p):Math.max(v,E),q=Math.floor(V/this._granularityCellSize)+1,W=Math.ceil(Z/this._granularityCellSize)-1;if(F?i<p:v<E)for(let Q=q;Q<=W;Q++){const te=Q*this._granularityCellSize;e.push(this._vertexToIndex(te,u+R*(te-i)/P))}else for(let Q=W;Q>=q;Q--){const te=Q*this._granularityCellSize;e.push(this._vertexToIndex(te,u+R*(te-i)/P))}}_generateInterEdgeVertices(e,i,u,p,_,v,E,P,R,F){const V=_-u,Z=v-p,q=E-_,W=(R-_)/q,Q=(F-_)/q,te=Math.min(W,Q),oe=Math.max(W,Q),xe=p+Z*te;let le=Math.floor(Math.min(xe,P)/this._granularityCellSize)+1,pe=Math.ceil(Math.max(xe,P)/this._granularityCellSize)-1,Te=P<xe;const Me=q===0;if(Me&&(E===R||E===F))return;if(Me||te>=1||oe<=0){const gt=u-E,ut=v+(i-v)*Math.min((R-E)/gt,(F-E)/gt);le=Math.floor(Math.min(ut,P)/this._granularityCellSize)+1,pe=Math.ceil(Math.max(ut,P)/this._granularityCellSize)-1,Te=P<ut}const Xe=V>0?F:R;if(Te)for(let gt=le;gt<=pe;gt++)e.push(this._vertexToIndex(gt*this._granularityCellSize,Xe));else for(let gt=pe;gt>=le;gt--)e.push(this._vertexToIndex(gt*this._granularityCellSize,Xe))}_generateOutline(e){const i=[];for(const u of e){const p=js(u,this._granularity,!0),_=this._pointArrayToIndices(p),v=[];for(let E=1;E<_.length;E++)v.push(_[E-1]),v.push(_[E]);i.push(v)}return i}_handlePoles(e){let i=!1,u=!1;this._canonical&&(this._canonical.y===0&&(i=!0),this._canonical.y===(1<<this._canonical.z)-1&&(u=!0)),(i||u)&&this._fillPoles(e,i,u)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let i=0;i<e.length;i+=2){const u=e[i+1];u===Wh&&(e[i+1]=-32767),u===Ja&&(e[i+1]=32766)}}_generatePoleQuad(e,i,u,p,_,v){p>_!=(v===Wh)?(e.push(i),e.push(u),e.push(this._vertexToIndex(p,v)),e.push(u),e.push(this._vertexToIndex(_,v)),e.push(this._vertexToIndex(p,v))):(e.push(u),e.push(i),e.push(this._vertexToIndex(p,v)),e.push(this._vertexToIndex(_,v)),e.push(u),e.push(this._vertexToIndex(p,v)))}_fillPoles(e,i,u){const p=this._vertexBuffer,_=ei,v=e.length;for(let E=2;E<v;E+=3){const P=e[E-2],R=e[E-1],F=e[E],V=p[2*P],Z=p[2*P+1],q=p[2*R],W=p[2*R+1],Q=p[2*F],te=p[2*F+1];i&&(Z===0&&W===0&&this._generatePoleQuad(e,P,R,V,q,Wh),W===0&&te===0&&this._generatePoleQuad(e,R,F,q,Q,Wh),te===0&&Z===0&&this._generatePoleQuad(e,F,P,Q,V,Wh)),u&&(Z===_&&W===_&&this._generatePoleQuad(e,P,R,V,q,Ja),W===_&&te===_&&this._generatePoleQuad(e,R,F,q,Q,Ja),te===_&&Z===_&&this._generatePoleQuad(e,F,P,Q,V,Ja))}}_initializeVertices(e){for(let i=0;i<e.length;i+=2)this._vertexToIndex(e[i],e[i+1])}subdividePolygonInternal(e,i){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:u,holeIndices:p}=(function(E){const P=[],R=[];for(const F of E)if(F.length!==0){F!==E[0]&&P.push(R.length/2);for(let V=0;V<F.length;V++)R.push(F[V].x),R.push(F[V].y)}return{flattened:R,holeIndices:P}})(e);let _;this._initializeVertices(u);try{const E=(function(R,F,V=2){const Z=F&&F.length,q=Z?F[0]*V:R.length;let W=Bd(R,0,q,V,!0);const Q=[];if(!W||W.next===W.prev)return Q;let te,oe,xe;if(Z&&(W=(function(le,pe,Te,Me){const Xe=[];for(let gt=0,ut=pe.length;gt<ut;gt++){const xt=Bd(le,pe[gt]*Me,gt<ut-1?pe[gt+1]*Me:le.length,Me,!1);xt===xt.next&&(xt.steiner=!0),Xe.push(pg(xt))}Xe.sort(qp);for(let gt=0;gt<Xe.length;gt++)Te=e_(Xe[gt],Te);return Te})(R,F,W,V)),R.length>80*V){te=R[0],oe=R[1];let le=te,pe=oe;for(let Te=V;Te<q;Te+=V){const Me=R[Te],Xe=R[Te+1];Me<te&&(te=Me),Xe<oe&&(oe=Xe),Me>le&&(le=Me),Xe>pe&&(pe=Xe)}xe=Math.max(le-te,pe-oe),xe=xe!==0?32767/xe:0}return Fd(W,Q,V,te,oe,xe,0),Q})(u,p),P=this._convertIndices(u,E);_=this._subdivideTrianglesScanline(P)}catch(E){console.error(E)}let v=[];return i&&(v=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(_),{verticesFlattened:this._vertexBuffer,indicesTriangles:_,indicesLineList:v}}_convertIndices(e,i){const u=[];for(let p=0;p<i.length;p++)u.push(this._vertexToIndex(e[2*i[p]],e[2*i[p]+1]));return u}_pointArrayToIndices(e){const i=[];for(let u=0;u<e.length;u++){const p=e[u];i.push(this._vertexToIndex(p.x,p.y))}return i}}function ku(n,e,i,u=!0){return new t_(i,e).subdividePolygonInternal(n,u)}function js(n,e,i=!1){if(!n||n.length<1)return[];if(n.length<2)return[];const u=n[0],p=n[n.length-1],_=i&&(u.x!==p.x||u.y!==p.y);if(e<2)return _?[...n,n[0]]:[...n];const v=Math.floor(ei/e),E=[];E.push(new k(n[0].x,n[0].y));const P=n.length,R=_?P:P-1;for(let F=0;F<R;F++){const V=n[F],Z=F<P-1?n[F+1]:n[0],q=V.x,W=V.y,Q=Z.x,te=Z.y,oe=q!==Q,xe=W!==te;if(!oe&&!xe)continue;const le=Q-q,pe=te-W,Te=Math.abs(le),Me=Math.abs(pe);let Xe=q,gt=W;for(;;){const xt=le>0?(Math.floor(Xe/v)+1)*v:(Math.ceil(Xe/v)-1)*v,Rt=pe>0?(Math.floor(gt/v)+1)*v:(Math.ceil(gt/v)-1)*v,wt=Math.abs(Xe-xt),ft=Math.abs(gt-Rt),it=Math.abs(Xe-Q),Ht=Math.abs(gt-te),Gt=oe?wt/Te:Number.POSITIVE_INFINITY,Xt=xe?ft/Me:Number.POSITIVE_INFINITY;if((it<=wt||!oe)&&(Ht<=ft||!xe))break;if(Gt<Xt&&oe||!xe){Xe=xt,gt+=pe*Gt;const Ft=new k(Xe,Math.round(gt));E[E.length-1].x===Ft.x&&E[E.length-1].y===Ft.y||E.push(Ft)}else{Xe+=le*Xt,gt=Rt;const Ft=new k(Math.round(Xe),gt);E[E.length-1].x===Ft.x&&E[E.length-1].y===Ft.y||E.push(Ft)}}const ut=new k(Q,te);E[E.length-1].x===ut.x&&E[E.length-1].y===ut.y||E.push(ut)}return E}function pc(n,e,i){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let u=0,p=n[2*e[0]];for(let P=1;P<e.length;P++){const R=n[2*e[P]];R<p&&(p=R,u=P)}const _=e.length;let v=u,E=(v+1)%_;for(;;){const P=v-1>=0?v-1:_-1,R=(E+1)%_,F=n[2*e[P]],V=n[2*e[R]],Z=n[2*e[v]],q=n[2*e[v]+1],W=n[2*e[E]+1];let Q=!1;if(F<V)Q=!0;else if(F>V)Q=!1;else{const te=W-q,oe=-(n[2*e[E]]-Z),xe=q<W?1:-1;((F-Z)*te+(n[2*e[P]+1]-q)*oe)*xe>((V-Z)*te+(n[2*e[R]+1]-q)*oe)*xe&&(Q=!0)}if(Q){const te=e[P],oe=e[v],xe=e[E];te!==oe&&te!==xe&&oe!==xe&&i.push(xe,oe,te),v--,v<0&&(v=_-1)}else{const te=e[R],oe=e[v],xe=e[E];te!==oe&&te!==xe&&oe!==xe&&i.push(xe,oe,te),E++,E>=_&&(E=0)}if(P===R)break}}function $p(n,e,i,u,p,_,v,E,P){const R=p.length/2,F=v&&E&&P;if(R<bt.MAX_VERTEX_ARRAY_LENGTH){const V=e.prepareSegment(R,i,u),Z=V.vertexLength;for(let Q=0;Q<_.length;Q+=3)u.emplaceBack(Z+_[Q],Z+_[Q+1],Z+_[Q+2]);let q,W;V.vertexLength+=R,V.primitiveLength+=_.length/3,F&&(W=v.prepareSegment(R,i,E),q=W.vertexLength,W.vertexLength+=R);for(let Q=0;Q<p.length;Q+=2)n(p[Q],p[Q+1]);if(F)for(let Q=0;Q<P.length;Q++){const te=P[Q];for(let oe=1;oe<te.length;oe+=2)E.emplaceBack(q+te[oe-1],q+te[oe]);W.primitiveLength+=te.length/2}}else(function(V,Z,q,W,Q,te){const oe=[];for(let Me=0;Me<W.length/2;Me++)oe.push(-1);const xe={count:0};let le=0,pe=V.getOrCreateLatestSegment(Z,q),Te=pe.vertexLength;for(let Me=2;Me<Q.length;Me+=3){const Xe=Q[Me-2],gt=Q[Me-1],ut=Q[Me];let xt=oe[Xe]<le,Rt=oe[gt]<le,wt=oe[ut]<le;pe.vertexLength+((xt?1:0)+(Rt?1:0)+(wt?1:0))>bt.MAX_VERTEX_ARRAY_LENGTH&&(pe=V.createNewSegment(Z,q),le=xe.count,xt=!0,Rt=!0,wt=!0,Te=0);const ft=Kh(oe,W,te,xe,Xe,xt,pe),it=Kh(oe,W,te,xe,gt,Rt,pe),Ht=Kh(oe,W,te,xe,ut,wt,pe);q.emplaceBack(Te+ft-le,Te+it-le,Te+Ht-le),pe.primitiveLength++}})(e,i,u,p,_,n),F&&(function(V,Z,q,W,Q,te){const oe=[];for(let Me=0;Me<W.length/2;Me++)oe.push(-1);const xe={count:0};let le=0,pe=V.getOrCreateLatestSegment(Z,q),Te=pe.vertexLength;for(let Me=0;Me<Q.length;Me++){const Xe=Q[Me];for(let gt=1;gt<Q[Me].length;gt+=2){const ut=Xe[gt-1],xt=Xe[gt];let Rt=oe[ut]<le,wt=oe[xt]<le;pe.vertexLength+((Rt?1:0)+(wt?1:0))>bt.MAX_VERTEX_ARRAY_LENGTH&&(pe=V.createNewSegment(Z,q),le=xe.count,Rt=!0,wt=!0,Te=0);const ft=Kh(oe,W,te,xe,ut,Rt,pe),it=Kh(oe,W,te,xe,xt,wt,pe);q.emplaceBack(Te+ft-le,Te+it-le),pe.primitiveLength++}}})(v,i,E,p,P,n),e.forceNewSegmentOnNextPrepare(),v?.forceNewSegmentOnNextPrepare()}function Kh(n,e,i,u,p,_,v){if(_){const E=u.count;return i(e[2*p],e[2*p+1]),n[p]=u.count,u.count++,v.vertexLength++,E}return n[p]}class Us{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new re,this.indexArray=new Ke,this.indexArray2=new He,this.programConfigurations=new Qn(e.layers,e.zoom),this.segments=new bt,this.segments2=new bt,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,u){this.hasDependencies=Of("fill",this.layers,i);const p=this.layers[0].layout.get("fill-sort-key"),_=!p.isConstant(),v=[];for(const{feature:E,id:P,index:R,sourceLayerIndex:F}of e){const V=this.layers[0]._featureFilter.needGeometry,Z=Lu(E,V);if(!this.layers[0]._featureFilter.filter(new $i(this.zoom),Z,u))continue;const q=_?p.evaluate(Z,{},u,i.availableImages):void 0,W={id:P,properties:E.properties,type:E.type,sourceLayerIndex:F,index:R,geometry:V?Z.geometry:Jo(E),patterns:{},sortKey:q};v.push(W)}_&&v.sort(((E,P)=>E.sortKey-P.sortKey));for(const E of v){const{geometry:P,index:R,sourceLayerIndex:F}=E;if(this.hasDependencies){const V=Zp("fill",this.layers,E,{zoom:this.zoom},i);this.patternFeatures.push(V)}else this.addFeature(E,P,R,u,{},i.subdivisionGranularity);i.featureIndex.insert(e[R].feature,P,R,F,this.index)}}update(e,i,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:u})}addFeatures(e,i,u){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,i,u,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sh),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,u,p,_,v){for(const E of Ll(i,500)){const P=ku(E,p,v.fill.getGranularityForZoomLevel(p.z)),R=this.layoutVertexArray;$p(((F,V)=>{R.emplaceBack(F,V)}),this.segments,this.layoutVertexArray,this.indexArray,P.verticesFlattened,P.indicesTriangles,this.segments2,this.indexArray2,P.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,{imagePositions:_,canonical:p})}}let _g,Jh;Ot("FillBucket",Us,{omit:["layers","patternFeatures"]});var Ff={get paint(){return Jh=Jh||new xr({"fill-antialias":new Jt(Ze.paint_fill["fill-antialias"]),"fill-opacity":new ai(Ze.paint_fill["fill-opacity"]),"fill-color":new ai(Ze.paint_fill["fill-color"]),"fill-outline-color":new ai(Ze.paint_fill["fill-outline-color"]),"fill-translate":new Jt(Ze.paint_fill["fill-translate"]),"fill-translate-anchor":new Jt(Ze.paint_fill["fill-translate-anchor"]),"fill-pattern":new zu(Ze.paint_fill["fill-pattern"])})},get layout(){return _g=_g||new xr({"fill-sort-key":new ai(Ze.layout_fill["fill-sort-key"])})}};class Nf extends po{constructor(e,i){super(e,Ff,i)}recalculate(e,i){super.recalculate(e,i);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Us(e)}queryRadius(){return oh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:i,transform:u,pixelsToTileUnits:p}){return Rd(zf(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-u.bearingInRadians,p),i)}isTileClipped(){return!0}}const Ud=ri([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),i_=ri([{name:"a_centroid",components:2,type:"Int16"}],4),{members:n_}=Ud;class mc{constructor(e,i,u,p,_){this.properties={},this.extent=u,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=p,this._values=_,e.readFields(r_,this,i)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos,u=[];let p,_=1,v=0,E=0,P=0;for(;e.pos<i;){if(v<=0){const R=e.readVarint();_=7&R,v=R>>3}if(v--,_===1||_===2)E+=e.readSVarint(),P+=e.readSVarint(),_===1&&(p&&u.push(p),p=[]),p&&p.push(new k(E,P));else{if(_!==7)throw new Error(`unknown command ${_}`);p&&p.push(p[0].clone())}}return p&&u.push(p),u}bbox(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos;let u=1,p=0,_=0,v=0,E=1/0,P=-1/0,R=1/0,F=-1/0;for(;e.pos<i;){if(p<=0){const V=e.readVarint();u=7&V,p=V>>3}if(p--,u===1||u===2)_+=e.readSVarint(),v+=e.readSVarint(),_<E&&(E=_),_>P&&(P=_),v<R&&(R=v),v>F&&(F=v);else if(u!==7)throw new Error(`unknown command ${u}`)}return[E,R,P,F]}toGeoJSON(e,i,u){const p=this.extent*Math.pow(2,u),_=this.extent*e,v=this.extent*i,E=this.loadGeometry();function P(Z){return[360*(Z.x+_)/p-180,360/Math.PI*Math.atan(Math.exp((1-2*(Z.y+v)/p)*Math.PI))-90]}function R(Z){return Z.map(P)}let F;if(this.type===1){const Z=[];for(const W of E)Z.push(W[0]);const q=R(Z);F=Z.length===1?{type:"Point",coordinates:q[0]}:{type:"MultiPoint",coordinates:q}}else if(this.type===2){const Z=E.map(R);F=Z.length===1?{type:"LineString",coordinates:Z[0]}:{type:"MultiLineString",coordinates:Z}}else{if(this.type!==3)throw new Error("unknown feature type");{const Z=jf(E),q=[];for(const W of Z)q.push(W.map(R));F=q.length===1?{type:"Polygon",coordinates:q[0]}:{type:"MultiPolygon",coordinates:q}}}const V={type:"Feature",geometry:F,properties:this.properties};return this.id!=null&&(V.id=this.id),V}}function r_(n,e,i){n===1?e.id=i.readVarint():n===2?(function(u,p){const _=u.readVarint()+u.pos;for(;u.pos<_;){const v=p._keys[u.readVarint()],E=p._values[u.readVarint()];p.properties[v]=E}})(i,e):n===3?e.type=i.readVarint():n===4&&(e._geometry=i.pos)}function jf(n){const e=n.length;if(e<=1)return[n];const i=[];let u,p;for(let _=0;_<e;_++){const v=a_(n[_]);v!==0&&(p===void 0&&(p=v<0),p===v<0?(u&&i.push(u),u=[n[_]]):u&&u.push(n[_]))}return u&&i.push(u),i}function a_(n){let e=0;for(let i,u,p=0,_=n.length,v=_-1;p<_;v=p++)i=n[p],u=n[v],e+=(u.x-i.x)*(i.y+u.y);return e}mc.types=["Unknown","Point","LineString","Polygon"];class Jv{constructor(e,i){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Qv,this,i),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const i=this._pbf.readVarint()+this._pbf.pos;return new mc(this._pbf,i,this.extent,this._keys,this._values)}}function Qv(n,e,i){n===15?e.version=i.readVarint():n===1?e.name=i.readString():n===5?e.extent=i.readVarint():n===2?e._features.push(i.pos):n===3?e._keys.push(i.readString()):n===4&&e._values.push((function(u){let p=null;const _=u.readVarint()+u.pos;for(;u.pos<_;){const v=u.readVarint()>>3;p=v===1?u.readString():v===2?u.readFloat():v===3?u.readDouble():v===4?u.readVarint64():v===5?u.readVarint():v===6?u.readSVarint():v===7?u.readBoolean():null}if(p==null)throw new Error("unknown feature value");return p})(i))}class wn{constructor(e,i){this.layers=e.readFields(tr,{},i)}}function tr(n,e,i){if(n===3){const u=new Jv(i,i.readVarint()+i.pos);u.length&&(e[u.name]=u)}}const Hi=Math.pow(2,13);function Zi(n,e,i,u,p,_,v,E){n.emplaceBack(e,i,2*Math.floor(u*Hi)+v,p*Hi*2,_*Hi*2,Math.round(E))}class Ln{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new me,this.centroidVertexArray=new $,this.indexArray=new Ke,this.programConfigurations=new Qn(e.layers,e.zoom),this.segments=new bt,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,u){this.features=[],this.hasDependencies=Of("fill-extrusion",this.layers,i);for(const{feature:p,id:_,index:v,sourceLayerIndex:E}of e){const P=this.layers[0]._featureFilter.needGeometry,R=Lu(p,P);if(!this.layers[0]._featureFilter.filter(new $i(this.zoom),R,u))continue;const F={id:_,sourceLayerIndex:E,index:v,geometry:P?R.geometry:Jo(p),properties:p.properties,type:p.type,patterns:{}};this.hasDependencies?this.features.push(Zp("fill-extrusion",this.layers,F,{zoom:this.zoom},i)):this.addFeature(F,F.geometry,v,u,{},i.subdivisionGranularity),i.featureIndex.insert(p,F.geometry,v,E,this.index,!0)}}addFeatures(e,i,u){for(const p of this.features){const{geometry:_}=p;this.addFeature(p,_,p.index,i,u,e.subdivisionGranularity)}}update(e,i,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:u})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,n_),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,i_.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,i,u,p,_,v){for(const E of Ll(i,500)){const P={x:0,y:0,sampleCount:0},R=this.layoutVertexArray.length;this.processPolygon(P,p,e,E,v);const F=this.layoutVertexArray.length-R,V=Math.floor(P.x/P.sampleCount),Z=Math.floor(P.y/P.sampleCount);for(let q=0;q<F;q++)this.centroidVertexArray.emplaceBack(V,Z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,{imagePositions:_,canonical:p})}processPolygon(e,i,u,p,_){if(p.length<1||Qh(p[0]))return;for(const V of p)V.length!==0&&Vs(e,V);const v={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},E=_.fill.getGranularityForZoomLevel(i.z),P=mc.types[u.type]==="Polygon";for(const V of p){if(V.length===0||Qh(V))continue;const Z=js(V,E,P);this._generateSideFaces(Z,v)}if(!P)return;const R=ku(p,i,E,!1),F=this.layoutVertexArray;$p(((V,Z)=>{Zi(F,V,Z,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,R.verticesFlattened,R.indicesTriangles)}_generateSideFaces(e,i){let u=0;for(let p=1;p<e.length;p++){const _=e[p],v=e[p-1];if(lh(_,v))continue;i.segment.vertexLength+4>bt.MAX_VERTEX_ARRAY_LENGTH&&(i.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const E=_.sub(v)._perp()._unit(),P=v.dist(_);u+P>32768&&(u=0),Zi(this.layoutVertexArray,_.x,_.y,E.x,E.y,0,0,u),Zi(this.layoutVertexArray,_.x,_.y,E.x,E.y,0,1,u),u+=P,Zi(this.layoutVertexArray,v.x,v.y,E.x,E.y,0,0,u),Zi(this.layoutVertexArray,v.x,v.y,E.x,E.y,0,1,u);const R=i.segment.vertexLength;this.indexArray.emplaceBack(R,R+2,R+1),this.indexArray.emplaceBack(R+1,R+2,R+3),i.segment.vertexLength+=4,i.segment.primitiveLength+=2}}}function Vs(n,e){for(let i=0;i<e.length;i++){const u=e[i];i===e.length-1&&e[0].x===u.x&&e[0].y===u.y||(n.x+=u.x,n.y+=u.y,n.sampleCount++)}}function lh(n,e){return n.x===e.x&&(n.x<0||n.x>ei)||n.y===e.y&&(n.y<0||n.y>ei)}function Qh(n){return n.every((e=>e.x<0))||n.every((e=>e.x>ei))||n.every((e=>e.y<0))||n.every((e=>e.y>ei))}let Hp;Ot("FillExtrusionBucket",Ln,{omit:["layers","features"]});var gc={get paint(){return Hp=Hp||new xr({"fill-extrusion-opacity":new Jt(Ze["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ai(Ze["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Jt(Ze["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Jt(Ze["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new zu(Ze["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ai(Ze["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ai(Ze["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Jt(Ze["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Gr extends po{constructor(e,i){super(e,gc,i)}createBucket(e){return new Ln(e)}queryRadius(){return oh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:u,geometry:p,transform:_,pixelsToTileUnits:v,pixelPosMatrix:E}){const P=zf(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-_.bearingInRadians,v),R=this.paint.get("fill-extrusion-height").evaluate(i,u),F=this.paint.get("fill-extrusion-base").evaluate(i,u),V=(function(q,W){const Q=[];for(const te of q){const oe=[te.x,te.y,0,1];Ci(oe,oe,W),Q.push(new k(oe[0]/oe[3],oe[1]/oe[3]))}return Q})(P,E),Z=(function(q,W,Q,te){const oe=[],xe=[],le=te[8]*W,pe=te[9]*W,Te=te[10]*W,Me=te[11]*W,Xe=te[8]*Q,gt=te[9]*Q,ut=te[10]*Q,xt=te[11]*Q;for(const Rt of q){const wt=[],ft=[];for(const it of Rt){const Ht=it.x,Gt=it.y,Xt=te[0]*Ht+te[4]*Gt+te[12],Ft=te[1]*Ht+te[5]*Gt+te[13],ni=te[2]*Ht+te[6]*Gt+te[14],sn=te[3]*Ht+te[7]*Gt+te[15],Ni=ni+Te,vr=sn+Me,Lo=Xt+Xe,_a=Ft+gt,br=ni+ut,cr=sn+xt,En=new k((Xt+le)/vr,(Ft+pe)/vr);En.z=Ni/vr,wt.push(En);const Ir=new k(Lo/cr,_a/cr);Ir.z=br/cr,ft.push(Ir)}oe.push(wt),xe.push(ft)}return[oe,xe]})(p,F,R,E);return(function(q,W,Q){let te=1/0;Rd(Q,W)&&(te=uh(Q,W[0]));for(let oe=0;oe<W.length;oe++){const xe=W[oe],le=q[oe];for(let pe=0;pe<xe.length-1;pe++){const Te=xe[pe],Me=[Te,xe[pe+1],le[pe+1],le[pe],Te];Dd(Q,Me)&&(te=Math.min(te,uh(Q,Me)))}}return te!==1/0&&te})(Z[0],Z[1],V)}}function _l(n,e){return n.x*e.x+n.y*e.y}function uh(n,e){if(n.length===1){let i=0;const u=e[i++];let p;for(;!p||u.equals(p);)if(p=e[i++],!p)return 1/0;for(;i<e.length;i++){const _=e[i],v=n[0],E=p.sub(u),P=_.sub(u),R=v.sub(u),F=_l(E,E),V=_l(E,P),Z=_l(P,P),q=_l(R,E),W=_l(R,P),Q=F*Z-V*V,te=(Z*q-V*W)/Q,oe=(F*W-V*q)/Q,xe=u.z*(1-te-oe)+p.z*te+_.z*oe;if(isFinite(xe))return xe}return 1/0}{let i=1/0;for(const u of e)i=Math.min(i,u.z);return i}}const vg=ri([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Gs}=vg,Vd=ri([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Uf}=Vd,bs=Math.cos(Math.PI/180*37.5),Xp=Math.pow(2,14)/.5;class Gd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((i=>{this.gradients[i.id]={}})),this.layoutVertexArray=new _e,this.layoutVertexArray2=new ye,this.indexArray=new Ke,this.programConfigurations=new Qn(e.layers,e.zoom),this.segments=new bt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,u){this.hasDependencies=Of("line",this.layers,i)||this.hasLineDasharray(this.layers);const p=this.layers[0].layout.get("line-sort-key"),_=!p.isConstant(),v=[];for(const{feature:E,id:P,index:R,sourceLayerIndex:F}of e){const V=this.layers[0]._featureFilter.needGeometry,Z=Lu(E,V);if(!this.layers[0]._featureFilter.filter(new $i(this.zoom),Z,u))continue;const q=_?p.evaluate(Z,{},u):void 0,W={id:P,properties:E.properties,type:E.type,sourceLayerIndex:F,index:R,geometry:V?Z.geometry:Jo(E),patterns:{},dashes:{},sortKey:q};v.push(W)}_&&v.sort(((E,P)=>E.sortKey-P.sortKey));for(const E of v){const{geometry:P,index:R,sourceLayerIndex:F}=E;this.hasDependencies?(Of("line",this.layers,i)?Zp("line",this.layers,E,{zoom:this.zoom},i):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,E,this.zoom,i),this.patternFeatures.push(E)):this.addFeature(E,P,R,u,{},{},i.subdivisionGranularity),i.featureIndex.insert(e[R].feature,P,R,F,this.index)}}update(e,i,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:u,dashPositions:p})}addFeatures(e,i,u,p){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,i,u,p,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Uf)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Gs),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,u,p,_,v,E){const P=this.layers[0].layout,R=P.get("line-join").evaluate(e,{}),F=P.get("line-cap"),V=P.get("line-miter-limit"),Z=P.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const q of i)this.addLine(q,e,R,F,V,Z,p,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,{imagePositions:_,dashPositions:v,canonical:p})}addLine(e,i,u,p,_,v,E,P){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=js(e,E?P.line.getGranularityForZoomLevel(E.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<e.length-1;le++)this.totalDistance+=e[le].dist(e[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const R=mc.types[i.type]==="Polygon";let F=e.length;for(;F>=2&&e[F-1].equals(e[F-2]);)F--;let V=0;for(;V<F-1&&e[V].equals(e[V+1]);)V++;if(F<(R?3:2))return;u==="bevel"&&(_=1.05);const Z=this.overscaling<=16?122880/(512*this.overscaling):0,q=this.segments.prepareSegment(10*F,this.layoutVertexArray,this.indexArray);let W,Q,te,oe,xe;this.e1=this.e2=-1,R&&(W=e[F-2],xe=e[V].sub(W)._unit()._perp());for(let le=V;le<F;le++){if(te=le===F-1?R?e[V+1]:void 0:e[le+1],te&&e[le].equals(te))continue;xe&&(oe=xe),W&&(Q=W),W=e[le],xe=te?te.sub(W)._unit()._perp():oe,oe=oe||xe;let pe=oe.add(xe);pe.x===0&&pe.y===0||pe._unit();const Te=oe.x*xe.x+oe.y*xe.y,Me=pe.x*xe.x+pe.y*xe.y,Xe=Me!==0?1/Me:1/0,gt=2*Math.sqrt(2-2*Me),ut=Me<bs&&Q&&te,xt=oe.x*xe.y-oe.y*xe.x>0;if(ut&&le>V){const ft=W.dist(Q);if(ft>2*Z){const it=W.sub(W.sub(Q)._mult(Z/ft)._round());this.updateDistance(Q,it),this.addCurrentVertex(it,oe,0,0,q),Q=it}}const Rt=Q&&te;let wt=Rt?u:R?"butt":p;if(Rt&&wt==="round"&&(Xe<v?wt="miter":Xe<=2&&(wt="fakeround")),wt==="miter"&&Xe>_&&(wt="bevel"),wt==="bevel"&&(Xe>2&&(wt="flipbevel"),Xe<_&&(wt="miter")),Q&&this.updateDistance(Q,W),wt==="miter")pe._mult(Xe),this.addCurrentVertex(W,pe,0,0,q);else if(wt==="flipbevel"){if(Xe>100)pe=xe.mult(-1);else{const ft=Xe*oe.add(xe).mag()/oe.sub(xe).mag();pe._perp()._mult(ft*(xt?-1:1))}this.addCurrentVertex(W,pe,0,0,q),this.addCurrentVertex(W,pe.mult(-1),0,0,q)}else if(wt==="bevel"||wt==="fakeround"){const ft=-Math.sqrt(Xe*Xe-1),it=xt?ft:0,Ht=xt?0:ft;if(Q&&this.addCurrentVertex(W,oe,it,Ht,q),wt==="fakeround"){const Gt=Math.round(180*gt/Math.PI/20);for(let Xt=1;Xt<Gt;Xt++){let Ft=Xt/Gt;if(Ft!==.5){const sn=Ft-.5;Ft+=Ft*sn*(Ft-1)*((1.0904+Te*(Te*(3.55645-1.43519*Te)-3.2452))*sn*sn+(.848013+Te*(.215638*Te-1.06021)))}const ni=xe.sub(oe)._mult(Ft)._add(oe)._unit()._mult(xt?-1:1);this.addHalfVertex(W,ni.x,ni.y,!1,xt,0,q)}}te&&this.addCurrentVertex(W,xe,-it,-Ht,q)}else if(wt==="butt")this.addCurrentVertex(W,pe,0,0,q);else if(wt==="square"){const ft=Q?1:-1;this.addCurrentVertex(W,pe,ft,ft,q)}else wt==="round"&&(Q&&(this.addCurrentVertex(W,oe,0,0,q),this.addCurrentVertex(W,oe,1,1,q,!0)),te&&(this.addCurrentVertex(W,xe,-1,-1,q,!0),this.addCurrentVertex(W,xe,0,0,q)));if(ut&&le<F-1){const ft=W.dist(te);if(ft>2*Z){const it=W.add(te.sub(W)._mult(Z/ft)._round());this.updateDistance(W,it),this.addCurrentVertex(it,xe,0,0,q),W=it}}}}addCurrentVertex(e,i,u,p,_,v=!1){const E=i.y*p-i.x,P=-i.y-i.x*p;this.addHalfVertex(e,i.x+i.y*u,i.y-i.x*u,v,!1,u,_),this.addHalfVertex(e,E,P,v,!0,-p,_),this.distance>Xp/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,i,u,p,_,v))}addHalfVertex({x:e,y:i},u,p,_,v,E,P){const R=.5*(this.lineClips?this.scaledDistance*(Xp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(_?1:0),(i<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*p)+128,1+(E===0?0:E<0?-1:1)|(63&R)<<2,R>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const F=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,F,this.e2),P.primitiveLength++),v?this.e2=F:this.e1=F}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}hasLineDasharray(e){for(const i of e){const u=i.paint.get("line-dasharray");if(u&&!u.isConstant())return!0}return!1}addLineDashDependencies(e,i,u,p){for(const _ of e){const v=_.paint.get("line-dasharray");if(!v||v.value.kind==="constant")continue;const E=_.layout.get("line-cap")==="round",P={dasharray:v.value.evaluate({zoom:u-1},i,{}),round:E},R={dasharray:v.value.evaluate({zoom:u},i,{}),round:E},F={dasharray:v.value.evaluate({zoom:u+1},i,{}),round:E},V=`${P.dasharray.join(",")},${P.round}`,Z=`${R.dasharray.join(",")},${R.round}`,q=`${F.dasharray.join(",")},${F.round}`;p.dashDependencies[V]=P,p.dashDependencies[Z]=R,p.dashDependencies[q]=F,i.dashes[_.id]={min:V,mid:Z,max:q}}}}let bg,Vf;Ot("LineBucket",Gd,{omit:["layers","patternFeatures"]});var Gf={get paint(){return Vf=Vf||new xr({"line-opacity":new ai(Ze.paint_line["line-opacity"]),"line-color":new ai(Ze.paint_line["line-color"]),"line-translate":new Jt(Ze.paint_line["line-translate"]),"line-translate-anchor":new Jt(Ze.paint_line["line-translate-anchor"]),"line-width":new ai(Ze.paint_line["line-width"]),"line-gap-width":new ai(Ze.paint_line["line-gap-width"]),"line-offset":new ai(Ze.paint_line["line-offset"]),"line-blur":new ai(Ze.paint_line["line-blur"]),"line-dasharray":new zu(Ze.paint_line["line-dasharray"]),"line-pattern":new zu(Ze.paint_line["line-pattern"]),"line-gradient":new fa(Ze.paint_line["line-gradient"])})},get layout(){return bg=bg||new xr({"line-cap":new Jt(Ze.layout_line["line-cap"]),"line-join":new ai(Ze.layout_line["line-join"]),"line-miter-limit":new Jt(Ze.layout_line["line-miter-limit"]),"line-round-limit":new Jt(Ze.layout_line["line-round-limit"]),"line-sort-key":new ai(Ze.layout_line["line-sort-key"])})}};class ch extends ai{possiblyEvaluate(e,i){return i=new $i(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(e,i)}evaluate(e,i,u,p){return i=Ei({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(e,i,u,p)}}let Zr;class hh extends po{constructor(e,i){super(e,Gf,i),this.gradientVersion=0,Zr||(Zr=new ch(Gf.paint.properties["line-width"].specification),Zr.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const i=this.gradientExpression();this.stepInterpolant=!!(function(u){return u._styleExpression!==void 0})(i)&&i._styleExpression.expression instanceof nl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,i){super.recalculate(e,i),this.paint._values["line-floorwidth"]=Zr.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Gd(e)}queryRadius(e){const i=e,u=ed(Xh("line-width",this,i),Xh("line-gap-width",this,i)),p=Xh("line-offset",this,i);return u/2+Math.abs(p)+oh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:u,geometry:p,transform:_,pixelsToTileUnits:v}){const E=zf(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-_.bearingInRadians,v),P=v/2*ed(this.paint.get("line-width").evaluate(i,u),this.paint.get("line-gap-width").evaluate(i,u)),R=this.paint.get("line-offset").evaluate(i,u);return R&&(p=(function(F,V){const Z=[];for(let q=0;q<F.length;q++){const W=Bp(F[q]),Q=[];for(let te=0;te<W.length;te++){const oe=W[te],xe=W[te-1],le=W[te+1],pe=te===0?new k(0,0):oe.sub(xe)._unit()._perp(),Te=te===W.length-1?new k(0,0):le.sub(oe)._unit()._perp(),Me=pe._add(Te)._unit(),Xe=Me.x*Te.x+Me.y*Te.y;Xe!==0&&Me._mult(1/Xe),Q.push(Me._mult(V)._add(oe))}Z.push(Q)}return Z})(p,R*v)),(function(F,V,Z){for(let q=0;q<V.length;q++){const W=V[q];if(F.length>=3){for(let Q=0;Q<W.length;Q++)if(Hh(F,W[Q]))return!0}if(kd(F,W,Z))return!0}return!1})(E,p,P)}isTileClipped(){return!0}}function ed(n,e){return e>0?e+2*n:n}const yc=ri([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),xg=ri([{name:"a_projected_pos",components:3,type:"Float32"}],4);ri([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const wg=ri([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ri([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Tg=ri([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Zf=ri([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Sg(n,e,i){return n.sections.forEach((u=>{u.text=(function(p,_,v){const E=_.layout.get("text-transform").evaluate(v,{});return E==="uppercase"?p=p.toLocaleUpperCase():E==="lowercase"&&(p=p.toLocaleLowerCase()),Os.applyArabicShaping&&(p=Os.applyArabicShaping(p)),p})(u.text,e,i)})),n}ri([{name:"triangle",components:3,type:"Uint16"}]),ri([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ri([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ri([{type:"Float32",name:"offsetX"}]),ri([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ri([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var Tn=24;const Zd={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},xs={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},o_={40:!0};function Mg(n,e,i,u,p,_){if("fontStack"in e){const v=i[e.fontStack],E=v&&v[n];return E?E.metrics.advance*e.scale+p:0}{const v=u[e.imageName];return v?v.displaySize[0]*e.scale*Tn/_+p:0}}function s_(n,e,i,u){const p=Math.pow(n-e,2);return u?n<e?p/2:2*p:p+Math.abs(i)*i}function dh(n,e,i){let u=0;return n===10&&(u-=1e4),i&&(u+=150),n!==40&&n!==65288||(u+=50),e!==41&&e!==65289||(u+=50),u}function qf(n,e,i,u,p,_){let v=null,E=s_(e,i,p,_);for(const P of u){const R=s_(e-P.x,i,p,_)+P.badness;R<=E&&(v=P,E=R)}return{index:n,x:e,priorBreak:v,badness:E}}function Yp(n){return n?Yp(n.priorBreak).concat(n.index):[]}class Ql{constructor(e="",i=[],u=[]){this.text=e,this.sections=i,this.sectionIndex=u,this.imageSectionID=null}static fromFeature(e,i){const u=new Ql;for(let p=0;p<e.sections.length;p++){const _=e.sections[p];_.image?u.addImageSection(_):u.addTextSection(_,i)}return u}length(){return[...this.text].length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}verticalizePunctuation(){this.text=(function(e){let i="",u={premature:!0,value:void 0};const p=e[Symbol.iterator]();let _=p.next();const v=e[Symbol.iterator]();v.next();let E=v.next();for(;!_.done;)i+=!E.done&&Vh(E.value.codePointAt(0))&&!Zd[E.value]||!u.premature&&Vh(u.value.codePointAt(0))&&!Zd[u.value]||!Zd[_.value]?_.value:Zd[_.value],u={value:_.value,premature:!1},_=p.next(),E=v.next();return i})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const e=this.text.match(/^\s*/),i=e?e[0].length:0,u=this.text.match(/\S\s*$/),p=u?u[0].length-1:0;this.text=this.text.substring(i,this.text.length-p),this.sectionIndex=this.sectionIndex.slice(i,this.sectionIndex.length-p)}substring(e,i){const u=[...this.text].slice(e,i).join(""),p=this.sectionIndex.slice(e,i);return new Ql(u,this.sections,p)}toCodeUnitIndex(e){return[...this.text].slice(0,e).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,i)=>Math.max(e,this.sections[i].scale)),0)}getMaxImageSize(e){let i=0,u=0;for(let p=0;p<this.length();p++){const _=this.getSection(p);if("imageName"in _){const v=e[_.imageName];if(!v)continue;const E=v.displaySize;i=Math.max(i,E[0]),u=Math.max(u,E[1])}}return{maxImageWidth:i,maxImageHeight:u}}addTextSection(e,i){this.text+=e.text,this.sections.push({scale:e.scale||1,verticalAlign:e.verticalAlign||"bottom",fontStack:e.fontStack||i});const u=this.sections.length-1;this.sectionIndex.push(...[...e.text].map((()=>u)))}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void Rn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push({scale:1,verticalAlign:e.verticalAlign||"bottom",imageName:i}),this.sectionIndex.push(this.sections.length-1)):Rn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(e,i,u,p,_){const v=[],E=this.determineAverageLineWidth(e,i,u,p,_),P=this.hasZeroWidthSpaces();let R=0,F=0;const V=this.text[Symbol.iterator]();let Z=V.next();const q=this.text[Symbol.iterator]();q.next();let W=q.next();const Q=this.text[Symbol.iterator]();Q.next(),Q.next();let te=Q.next();for(;!Z.done;){const oe=this.getSection(F),xe=Z.value.codePointAt(0);if(Tf(xe)||(R+=Mg(xe,oe,u,p,e,_)),!W.done){const le=rc(xe),pe=W.value.codePointAt(0);(xs[xe]||le||"imageName"in oe||!te.done&&o_[pe])&&v.push(qf(F+1,R,E,v,dh(xe,pe,le&&P),!1))}F++,Z=V.next(),W=q.next(),te=Q.next()}return Yp(qf(this.length(),R,E,v,0,!0))}determineAverageLineWidth(e,i,u,p,_){let v=0,E=0;for(const P of this.text){const R=this.getSection(E);v+=Mg(P.codePointAt(0),R,u,p,e,_),E++}return v/Math.max(1,Math.ceil(v/i))}}const Wp=4294967296,Eg=1/Wp,Ag=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class $f{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,i,u=this.length){for(;this.pos<u;){const p=this.readVarint(),_=p>>3,v=this.pos;this.type=7&p,e(_,i,this),this.pos===v&&this.skip(p)}return i}readMessage(e,i){return this.readFields(e,i,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Wp;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Wp;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const i=this.buf;let u,p;return p=i[this.pos++],u=127&p,p<128?u:(p=i[this.pos++],u|=(127&p)<<7,p<128?u:(p=i[this.pos++],u|=(127&p)<<14,p<128?u:(p=i[this.pos++],u|=(127&p)<<21,p<128?u:(p=i[this.pos],u|=(15&p)<<28,(function(_,v,E){const P=E.buf;let R,F;if(F=P[E.pos++],R=(112&F)>>4,F<128||(F=P[E.pos++],R|=(127&F)<<3,F<128)||(F=P[E.pos++],R|=(127&F)<<10,F<128)||(F=P[E.pos++],R|=(127&F)<<17,F<128)||(F=P[E.pos++],R|=(127&F)<<24,F<128)||(F=P[E.pos++],R|=(1&F)<<31,F<128))return _c(_,R,v);throw new Error("Expected varint not more than 10 bytes")})(u,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,i=this.pos;return this.pos=e,e-i>=12&&Ag?Ag.decode(this.buf.subarray(i,e)):(function(u,p,_){let v="",E=p;for(;E<_;){const P=u[E];let R,F,V,Z=null,q=P>239?4:P>223?3:P>191?2:1;if(E+q>_)break;q===1?P<128&&(Z=P):q===2?(R=u[E+1],(192&R)==128&&(Z=(31&P)<<6|63&R,Z<=127&&(Z=null))):q===3?(R=u[E+1],F=u[E+2],(192&R)==128&&(192&F)==128&&(Z=(15&P)<<12|(63&R)<<6|63&F,(Z<=2047||Z>=55296&&Z<=57343)&&(Z=null))):q===4&&(R=u[E+1],F=u[E+2],V=u[E+3],(192&R)==128&&(192&F)==128&&(192&V)==128&&(Z=(15&P)<<18|(63&R)<<12|(63&F)<<6|63&V,(Z<=65535||Z>=1114112)&&(Z=null))),Z===null?(Z=65533,q=1):Z>65535&&(Z-=65536,v+=String.fromCharCode(Z>>>10&1023|55296),Z=56320|1023&Z),v+=String.fromCharCode(Z),E+=q}return v})(this.buf,i,e)}readBytes(){const e=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,e);return this.pos=e,i}readPackedVarint(e=[],i){const u=this.readPackedEnd();for(;this.pos<u;)e.push(this.readVarint(i));return e}readPackedSVarint(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(e){const i=7&e;if(i===0)for(;this.buf[this.pos++]>127;);else if(i===2)this.pos=this.readVarint()+this.pos;else if(i===5)this.pos+=4;else{if(i!==1)throw new Error(`Unimplemented type: ${i}`);this.pos+=8}}writeTag(e,i){this.writeVarint(e<<3|i)}realloc(e){let i=this.length||16;for(;i<this.pos+e;)i*=2;if(i!==this.length){const u=new Uint8Array(i);u.set(this.buf),this.buf=u,this.dataView=new DataView(u.buffer),this.length=i}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Eg),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Eg),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?(function(i,u){let p,_;if(i>=0?(p=i%4294967296|0,_=i/4294967296|0):(p=~(-i%4294967296),_=~(-i/4294967296),4294967295^p?p=p+1|0:(p=0,_=_+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),(function(v,E,P){P.buf[P.pos++]=127&v|128,v>>>=7,P.buf[P.pos++]=127&v|128,v>>>=7,P.buf[P.pos++]=127&v|128,v>>>=7,P.buf[P.pos++]=127&v|128,P.buf[P.pos]=127&(v>>>=7)})(p,0,u),(function(v,E){const P=(7&v)<<4;E.buf[E.pos++]|=P|((v>>>=3)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v)))))})(_,u)})(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const i=this.pos;this.pos=(function(p,_,v){for(let E,P,R=0;R<_.length;R++){if(E=_.charCodeAt(R),E>55295&&E<57344){if(!P){E>56319||R+1===_.length?(p[v++]=239,p[v++]=191,p[v++]=189):P=E;continue}if(E<56320){p[v++]=239,p[v++]=191,p[v++]=189,P=E;continue}E=P-55296<<10|E-56320|65536,P=null}else P&&(p[v++]=239,p[v++]=191,p[v++]=189,P=null);E<128?p[v++]=E:(E<2048?p[v++]=E>>6|192:(E<65536?p[v++]=E>>12|224:(p[v++]=E>>18|240,p[v++]=E>>12&63|128),p[v++]=E>>6&63|128),p[v++]=63&E|128)}return v})(this.buf,e,this.pos);const u=this.pos-i;u>=128&&Kp(i,u,this),this.pos=i-1,this.writeVarint(u),this.pos+=u}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const i=e.length;this.writeVarint(i),this.realloc(i);for(let u=0;u<i;u++)this.buf[this.pos++]=e[u]}writeRawMessage(e,i){this.pos++;const u=this.pos;e(i,this);const p=this.pos-u;p>=128&&Kp(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p}writeMessage(e,i,u){this.writeTag(e,2),this.writeRawMessage(i,u)}writePackedVarint(e,i){i.length&&this.writeMessage(e,e0,i)}writePackedSVarint(e,i){i.length&&this.writeMessage(e,t0,i)}writePackedBoolean(e,i){i.length&&this.writeMessage(e,u_,i)}writePackedFloat(e,i){i.length&&this.writeMessage(e,i0,i)}writePackedDouble(e,i){i.length&&this.writeMessage(e,l_,i)}writePackedFixed32(e,i){i.length&&this.writeMessage(e,qd,i)}writePackedSFixed32(e,i){i.length&&this.writeMessage(e,Jp,i)}writePackedFixed64(e,i){i.length&&this.writeMessage(e,c_,i)}writePackedSFixed64(e,i){i.length&&this.writeMessage(e,h_,i)}writeBytesField(e,i){this.writeTag(e,2),this.writeBytes(i)}writeFixed32Field(e,i){this.writeTag(e,5),this.writeFixed32(i)}writeSFixed32Field(e,i){this.writeTag(e,5),this.writeSFixed32(i)}writeFixed64Field(e,i){this.writeTag(e,1),this.writeFixed64(i)}writeSFixed64Field(e,i){this.writeTag(e,1),this.writeSFixed64(i)}writeVarintField(e,i){this.writeTag(e,0),this.writeVarint(i)}writeSVarintField(e,i){this.writeTag(e,0),this.writeSVarint(i)}writeStringField(e,i){this.writeTag(e,2),this.writeString(i)}writeFloatField(e,i){this.writeTag(e,5),this.writeFloat(i)}writeDoubleField(e,i){this.writeTag(e,1),this.writeDouble(i)}writeBooleanField(e,i){this.writeVarintField(e,+i)}}function _c(n,e,i){return i?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}function Kp(n,e,i){const u=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(u);for(let p=i.pos-1;p>=n;p--)i.buf[p+u]=i.buf[p]}function e0(n,e){for(let i=0;i<n.length;i++)e.writeVarint(n[i])}function t0(n,e){for(let i=0;i<n.length;i++)e.writeSVarint(n[i])}function i0(n,e){for(let i=0;i<n.length;i++)e.writeFloat(n[i])}function l_(n,e){for(let i=0;i<n.length;i++)e.writeDouble(n[i])}function u_(n,e){for(let i=0;i<n.length;i++)e.writeBoolean(n[i])}function qd(n,e){for(let i=0;i<n.length;i++)e.writeFixed32(n[i])}function Jp(n,e){for(let i=0;i<n.length;i++)e.writeSFixed32(n[i])}function c_(n,e){for(let i=0;i<n.length;i++)e.writeFixed64(n[i])}function h_(n,e){for(let i=0;i<n.length;i++)e.writeSFixed64(n[i])}function d_(n,e,i){n===1&&i.readMessage(f_,e)}function f_(n,e,i){if(n===3){const{id:u,bitmap:p,width:_,height:v,left:E,top:P,advance:R}=i.readMessage(p_,{});e.push({id:u,bitmap:new Od({width:_+6,height:v+6},p),metrics:{width:_,height:v,left:E,top:P,advance:R}})}}function p_(n,e,i){n===1?e.id=i.readVarint():n===2?e.bitmap=i.readBytes():n===3?e.width=i.readVarint():n===4?e.height=i.readVarint():n===5?e.left=i.readSVarint():n===6?e.top=i.readSVarint():n===7&&(e.advance=i.readVarint())}function Cg(n){let e=0,i=0;for(const v of n)e+=v.w*v.h,i=Math.max(i,v.w);n.sort(((v,E)=>E.h-v.h));const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let p=0,_=0;for(const v of n)for(let E=u.length-1;E>=0;E--){const P=u[E];if(!(v.w>P.w||v.h>P.h)){if(v.x=P.x,v.y=P.y,_=Math.max(_,v.y+v.h),p=Math.max(p,v.x+v.w),v.w===P.w&&v.h===P.h){const R=u.pop();R&&E<u.length&&(u[E]=R)}else v.h===P.h?(P.x+=v.w,P.w-=v.w):v.w===P.w?(P.y+=v.h,P.h-=v.h):(u.push({x:P.x+v.w,y:P.y,w:P.w-v.w,h:v.h}),P.y+=v.h,P.h-=v.h);break}}return{w:p,h:_,fill:e/(p*_)||0}}class $d{constructor(e,{pixelRatio:i,version:u,stretchX:p,stretchY:_,content:v,textFitWidth:E,textFitHeight:P}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=p,this.stretchY=_,this.content=v,this.version=u,this.textFitWidth=E,this.textFitHeight=P}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Pg{constructor(e,i){const u={},p={};this.haveRenderCallbacks=[];const _=[];this.addImages(e,u,_),this.addImages(i,p,_);const{w:v,h:E}=Cg(_),P=new zr({width:v||1,height:E||1});for(const R in e){const F=e[R],V=u[R].paddedRect;zr.copy(F.data,P,{x:0,y:0},{x:V.x+1,y:V.y+1},F.data)}for(const R in i){const F=i[R],V=p[R].paddedRect,Z=V.x+1,q=V.y+1,W=F.data.width,Q=F.data.height;zr.copy(F.data,P,{x:0,y:0},{x:Z,y:q},F.data),zr.copy(F.data,P,{x:0,y:Q-1},{x:Z,y:q-1},{width:W,height:1}),zr.copy(F.data,P,{x:0,y:0},{x:Z,y:q+Q},{width:W,height:1}),zr.copy(F.data,P,{x:W-1,y:0},{x:Z-1,y:q},{width:1,height:Q}),zr.copy(F.data,P,{x:0,y:0},{x:Z+W,y:q},{width:1,height:Q})}this.image=P,this.iconPositions=u,this.patternPositions=p}addImages(e,i,u){for(const p in e){const _=e[p],v={x:0,y:0,w:_.data.width+2,h:_.data.height+2};u.push(v),i[p]=new $d(v,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(e,i){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in e.updatedImages)this.patchUpdatedImage(this.iconPositions[u],e.getImage(u),i),this.patchUpdatedImage(this.patternPositions[u],e.getImage(u),i)}patchUpdatedImage(e,i,u){if(!e||!i||e.version===i.version)return;e.version=i.version;const[p,_]=e.tl;u.update(i.data,void 0,{x:p,y:_})}}var vc;function Sn(n,e,i,u,p,_,v,E,P,R,F,V,Z,q,W){const Q=Ql.fromFeature(n,p);let te;V===w.aA.vertical&&Q.verticalizePunctuation();let oe=Q.determineLineBreaks(R,_,e,u,q);const{processBidirectionalText:xe,processStyledBidirectionalText:le}=Os;if(xe&&Q.sections.length===1){te=[],oe=oe.map((Xe=>Q.toCodeUnitIndex(Xe)));const Me=xe(Q.toString(),oe);for(const Xe of Me){const gt=[...Xe].map((()=>0));te.push(new Ql(Xe,Q.sections,gt))}}else if(le){te=[],oe=oe.map((ut=>Q.toCodeUnitIndex(ut)));let Me=0;const Xe=[];for(const ut of Q.text)Xe.push(...Array(ut.length).fill(Q.sectionIndex[Me])),Me++;const gt=le(Q.text,Xe,oe);for(const ut of gt){const xt=[];let Rt="";for(const wt of ut[0])xt.push(ut[1][Rt.length]),Rt+=wt;te.push(new Ql(ut[0],Q.sections,xt))}}else te=(function(Me,Xe){const gt=[];let ut=0;for(const xt of Xe)gt.push(Me.substring(ut,xt)),ut=xt;return ut<Me.length()&&gt.push(Me.substring(ut,Me.length())),gt})(Q,oe);const pe=[],Te={positionedLines:pe,text:Q.toString(),top:F[1],bottom:F[1],left:F[0],right:F[0],writingMode:V,iconsInText:!1,verticalizable:!1};return(function(Me,Xe,gt,ut,xt,Rt,wt,ft,it,Ht,Gt,Xt){let Ft=0,ni=0,sn=0,Ni=0;const vr=ft==="right"?1:ft==="left"?0:.5,Lo=Tn/Xt;let _a=0;for(const En of xt){En.trim();const Ir=En.getMaxScale(),$r={positionedGlyphs:[],lineOffset:0};Me.positionedLines[_a]=$r;const ir=$r.positionedGlyphs;let qs=0;if(!En.length()){ni+=Rt,++_a;continue}const Do=n0(ut,En,Lo);let $s=0;for(const Qa of En.text){const Sr=En.getSection($s),va=Qa.codePointAt(0),Lr=r0(it,Gt,va),eo={glyph:va,imageName:null,x:Ft,y:ni+-17,vertical:Lr,scale:1,fontStack:"",sectionIndex:En.getSectionIndex($s),metrics:null,rect:null};let od;if("fontStack"in Sr){if(od=a0(Sr,va,Lr,Do,Xe,gt),!od)continue;eo.fontStack=Sr.fontStack}else{if(Me.iconsInText=!0,Sr.scale*=Lo,od=o0(Sr,Lr,Ir,Do,ut),!od)continue;qs=Math.max(qs,od.imageOffset),eo.imageName=Sr.imageName}const{rect:Ec,metrics:iy,baselineOffset:lf}=od;eo.y+=lf,eo.scale=Sr.scale,eo.metrics=iy,eo.rect=Ec,ir.push(eo),Lr?(Me.verticalizable=!0,Ft+=("imageName"in Sr?iy.advance:Tn)*Sr.scale+Ht):Ft+=iy.advance*Sr.scale+Ht,$s++}ir.length!==0&&(sn=Math.max(Ft-Ht,sn),Qp(ir,0,ir.length-1,vr)),Ft=0,$r.lineOffset=Math.max(qs,(Ir-1)*Tn);const Bu=Rt*Ir+qs;ni+=Bu,Ni=Math.max(Bu,Ni),++_a}const{horizontalAlign:br,verticalAlign:cr}=Hf(wt);(function(En,Ir,$r,ir,qs,Do,$s,Bu,Qa){const Sr=(Ir-$r)*qs;let va=0;va=Do!==$s?-Bu*ir- -17:-ir*Qa*$s+.5*$s;for(const Lr of En)for(const eo of Lr.positionedGlyphs)eo.x+=Sr,eo.y+=va})(Me.positionedLines,vr,br,cr,sn,Ni,Rt,ni,xt.length),Me.top+=-cr*ni,Me.bottom=Me.top+ni,Me.left+=-br*sn,Me.right=Me.left+sn})(Te,e,i,u,te,v,E,P,V,R,Z,W),!(function(Me){for(const Xe of Me)if(Xe.positionedGlyphs.length!==0)return!1;return!0})(pe)&&Te}function Hf(n){let e=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function n0(n,e,i){const u=e.getMaxScale()*Tn,{maxImageWidth:p,maxImageHeight:_}=e.getMaxImageSize(n),v=Math.max(u,_*i);return{verticalLineContentWidth:Math.max(u,p*i),horizontalLineContentHeight:v}}function zg(n){switch(n){case"top":return 0;case"center":return .5;default:return 1}}function r0(n,e,i){return!(n===w.aA.horizontal||!e&&!Md(i)||e&&(Tf(i)||(u=i,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(u)))));var u}function a0(n,e,i,u,p,_){const v=_[n.fontStack],E=(function(R,F,V,Z){if(R&&R.rect)return R;const q=F[V.fontStack],W=q&&q[Z];return W?{rect:null,metrics:W.metrics}:null})(v&&v[e],p,n,e);if(E===null)return null;let P;if(i)P=u.verticalLineContentWidth-n.scale*Tn;else{const R=zg(n.verticalAlign);P=(u.horizontalLineContentHeight-n.scale*Tn)*R}return{rect:E.rect,metrics:E.metrics,baselineOffset:P}}function o0(n,e,i,u,p){const _=p[n.imageName];if(!_)return null;const v=_.paddedRect,E=_.displaySize,P={width:E[0],height:E[1],left:1,top:-3,advance:e?E[1]:E[0]};let R;if(e)R=u.verticalLineContentWidth-E[1]*n.scale;else{const F=zg(n.verticalAlign);R=(u.horizontalLineContentHeight-E[1]*n.scale)*F}return{rect:v,metrics:P,baselineOffset:R,imageOffset:(e?E[0]:E[1])*n.scale-Tn*i}}function Qp(n,e,i,u){if(u===0)return;const p=n[i],_=(n[i].x+p.metrics.advance*p.scale)*u;for(let v=e;v<=i;v++)n[v].x-=_}function Hd(n,e,i){const{horizontalAlign:u,verticalAlign:p}=Hf(i),_=e[0]-n.displaySize[0]*u,v=e[1]-n.displaySize[1]*p;return{image:n,top:v,bottom:v+n.displaySize[1],left:_,right:_+n.displaySize[0]}}function em(n){var e,i;let u=n.left,p=n.top,_=n.right-u,v=n.bottom-p;const E=(e=n.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",P=(i=n.image.textFitHeight)!==null&&i!==void 0?i:"stretchOrShrink",R=(n.image.content[2]-n.image.content[0])/(n.image.content[3]-n.image.content[1]);if(P==="proportional"){if(E==="stretchOnly"&&_/v<R||E==="proportional"){const F=Math.ceil(v*R);u*=F/_,_=F}}else if(E==="proportional"&&P==="stretchOnly"&&R!==0&&_/v>R){const F=Math.ceil(_/R);p*=F/v,v=F}return{x1:u,y1:p,x2:u+_,y2:p+v}}function Xf(n,e,i,u,p,_){const v=n.image;let E;if(v.content){const te=v.content,oe=v.pixelRatio||1;E=[te[0]/oe,te[1]/oe,v.displaySize[0]-te[2]/oe,v.displaySize[1]-te[3]/oe]}const P=e.left*_,R=e.right*_;let F,V,Z,q;i==="width"||i==="both"?(q=p[0]+P-u[3],V=p[0]+R+u[1]):(q=p[0]+(P+R-v.displaySize[0])/2,V=q+v.displaySize[0]);const W=e.top*_,Q=e.bottom*_;return i==="height"||i==="both"?(F=p[1]+W-u[0],Z=p[1]+Q+u[2]):(F=p[1]+(W+Q-v.displaySize[1])/2,Z=F+v.displaySize[1]),{image:v,top:F,right:V,bottom:Z,left:q,collisionPadding:E}}Ot("ImagePosition",$d),Ot("ImageAtlas",Pg),w.aA=void 0,(vc=w.aA||(w.aA={}))[vc.none=0]="none",vc[vc.horizontal=1]="horizontal",vc[vc.vertical=2]="vertical",vc[vc.horizontalOnly=3]="horizontalOnly";const eu=128,Qo=32640;function tu(n,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new $i(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:p}=i;let _=0;for(;_<u.length&&u[_]<=n;)_++;_=Math.max(0,_-1);let v=_;for(;v<u.length&&u[v]<n+1;)v++;v=Math.min(u.length-1,v);const E=u[_],P=u[v];return i.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:P,interpolationType:p}:{kind:"camera",minZoom:E,maxZoom:P,minSize:i.evaluate(new $i(E)),maxSize:i.evaluate(new $i(P)),interpolationType:p}}}function td(n,e,i){let u="never";const p=n.get(e);return p?u=p:n.get(i)&&(u="always"),u}const s0=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yf(n,e,i,u,p,_,v,E,P,R,F,V,Z){const q=E?Math.min(Qo,Math.round(E[0])):0,W=E?Math.min(Qo,Math.round(E[1])):0;n.emplaceBack(e,i,Math.round(32*u),Math.round(32*p),_,v,(q<<1)+(P?1:0),W,16*R,16*F,256*V,256*Z)}function tm(n,e,i){n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i)}function m_(n){for(const e of n.sections)if(Cd(e.text))return!0;return!1}class im{constructor(e){this.layoutVertexArray=new be,this.indexArray=new Ke,this.programConfigurations=e,this.segments=new bt,this.dynamicLayoutVertexArray=new Ce,this.opacityVertexArray=new Ie,this.hasVisibleVertices=!1,this.placedSymbolArray=new f}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,u,p){this.isEmpty()||(u&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,yc.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,xg.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,s0,!0),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ot("SymbolBuffers",im);class Ig{constructor(e,i,u){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new u,this.segments=new bt,this.collisionVertexArray=new ke}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,wg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ot("CollisionBuffers",Ig);class fh{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((v=>v.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tu(this.zoom,i["text-size"]),this.iconSizeData=tu(this.zoom,i["icon-size"]);const u=this.layers[0].layout,p=u.get("symbol-sort-key"),_=u.get("symbol-z-order");this.canOverlap=td(u,"text-overlap","text-allow-overlap")!=="never"||td(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map((v=>w.aA[v]))),this.stateDependentLayerIds=this.layers.filter((v=>v.isStateDependent())).map((v=>v.id)),this.sourceID=e.sourceID}createArrays(){this.text=new im(new Qn(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new im(new Qn(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new C,this.lineVertexArray=new D,this.symbolInstances=new M,this.textAnchorOffsets=new U}calculateGlyphDependencies(e,i,u,p,_){for(const v of e)if(i[v.codePointAt(0)]=!0,(u||p)&&_){const E=Zd[v];E&&(i[E.codePointAt(0)]=!0)}}populate(e,i,u){const p=this.layers[0],_=p.layout,v=_.get("text-font"),E=_.get("text-field"),P=_.get("icon-image"),R=(E.value.kind!=="constant"||E.value.value instanceof Ar&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),F=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,V=_.get("symbol-sort-key");if(this.features=[],!R&&!F)return;const Z=i.iconDependencies,q=i.glyphDependencies,W=i.availableImages,Q=new $i(this.zoom);for(const{feature:te,id:oe,index:xe,sourceLayerIndex:le}of e){const pe=p._featureFilter.needGeometry,Te=Lu(te,pe);if(!p._featureFilter.filter(Q,Te,u))continue;let Me,Xe;if(pe||(Te.geometry=Jo(te)),R){const ut=p.getValueAndResolveTokens("text-field",Te,u,W),xt=Ar.factory(ut),Rt=this.hasRTLText=this.hasRTLText||m_(xt);(!Rt||Os.getRTLTextPluginStatus()==="unavailable"||Rt&&Os.isParsed())&&(Me=Sg(xt,p,Te))}if(F){const ut=p.getValueAndResolveTokens("icon-image",Te,u,W);Xe=ut instanceof ta?ut:ta.fromString(ut)}if(!Me&&!Xe)continue;const gt=this.sortFeaturesByKey?V.evaluate(Te,{},u):void 0;if(this.features.push({id:oe,text:Me,icon:Xe,index:xe,sourceLayerIndex:le,geometry:Te.geometry,properties:te.properties,type:mc.types[te.type],sortKey:gt}),Xe&&(Z[Xe.name]=!0),Me){const ut=v.evaluate(Te,{},u).join(","),xt=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(w.aA.vertical)>=0;for(const Rt of Me.sections)if(Rt.image)Z[Rt.image.name]=!0;else{const wt=_s(Me.toString()),ft=Rt.fontStack||ut,it=q[ft]=q[ft]||{};this.calculateGlyphDependencies(Rt.text,it,xt,this.allowVerticalPlacement,wt)}}}_.get("symbol-placement")==="line"&&(this.features=(function(te){const oe={},xe={},le=[];let pe=0;function Te(ut){le.push(te[ut]),pe++}function Me(ut,xt,Rt){const wt=xe[ut];return delete xe[ut],xe[xt]=wt,le[wt].geometry[0].pop(),le[wt].geometry[0]=le[wt].geometry[0].concat(Rt[0]),wt}function Xe(ut,xt,Rt){const wt=oe[xt];return delete oe[xt],oe[ut]=wt,le[wt].geometry[0].shift(),le[wt].geometry[0]=Rt[0].concat(le[wt].geometry[0]),wt}function gt(ut,xt,Rt){const wt=Rt?xt[0][xt[0].length-1]:xt[0][0];return`${ut}:${wt.x}:${wt.y}`}for(let ut=0;ut<te.length;ut++){const xt=te[ut],Rt=xt.geometry,wt=xt.text?xt.text.toString():null;if(!wt){Te(ut);continue}const ft=gt(wt,Rt),it=gt(wt,Rt,!0);if(ft in xe&&it in oe&&xe[ft]!==oe[it]){const Ht=Xe(ft,it,Rt),Gt=Me(ft,it,le[Ht].geometry);delete oe[ft],delete xe[it],xe[gt(wt,le[Gt].geometry,!0)]=Gt,le[Ht].geometry=null}else ft in xe?Me(ft,it,Rt):it in oe?Xe(ft,it,Rt):(Te(ut),oe[ft]=pe-1,xe[it]=pe-1)}return le.filter((ut=>ut.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((te,oe)=>te.sortKey-oe.sortKey))}update(e,i,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,{imagePositions:u}),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,{imagePositions:u}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const u=this.lineVertexArray.length;if(e.segment!==void 0){let p=e.dist(i[e.segment+1]),_=e.dist(i[e.segment]);const v={};for(let E=e.segment+1;E<i.length;E++)v[E]={x:i[E].x,y:i[E].y,tileUnitDistanceFromAnchor:p},E<i.length-1&&(p+=i[E+1].dist(i[E]));for(let E=e.segment||0;E>=0;E--)v[E]={x:i[E].x,y:i[E].y,tileUnitDistanceFromAnchor:_},E>0&&(_+=i[E-1].dist(i[E]));for(let E=0;E<i.length;E++){const P=v[E];this.lineVertexArray.emplaceBack(P.x,P.y,P.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(e,i,u,p,_,v,E,P,R,F,V,Z){const q=e.indexArray,W=e.layoutVertexArray,Q=e.segments.prepareSegment(4*i.length,W,q,this.canOverlap?v.sortKey:void 0),te=this.glyphOffsetArray.length,oe=Q.vertexLength,xe=this.allowVerticalPlacement&&E===w.aA.vertical?Math.PI/2:0,le=v.text&&v.text.sections;for(let pe=0;pe<i.length;pe++){const{tl:Te,tr:Me,bl:Xe,br:gt,tex:ut,pixelOffsetTL:xt,pixelOffsetBR:Rt,minFontScaleX:wt,minFontScaleY:ft,glyphOffset:it,isSDF:Ht,sectionIndex:Gt}=i[pe],Xt=Q.vertexLength,Ft=it[1];Yf(W,P.x,P.y,Te.x,Ft+Te.y,ut.x,ut.y,u,Ht,xt.x,xt.y,wt,ft),Yf(W,P.x,P.y,Me.x,Ft+Me.y,ut.x+ut.w,ut.y,u,Ht,Rt.x,xt.y,wt,ft),Yf(W,P.x,P.y,Xe.x,Ft+Xe.y,ut.x,ut.y+ut.h,u,Ht,xt.x,Rt.y,wt,ft),Yf(W,P.x,P.y,gt.x,Ft+gt.y,ut.x+ut.w,ut.y+ut.h,u,Ht,Rt.x,Rt.y,wt,ft),tm(e.dynamicLayoutVertexArray,P,xe),q.emplaceBack(Xt,Xt+2,Xt+1),q.emplaceBack(Xt+1,Xt+2,Xt+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(it[0]),pe!==i.length-1&&Gt===i[pe+1].sectionIndex||e.programConfigurations.populatePaintArrays(W.length,v,v.index,{imagePositions:{},canonical:Z,formattedSection:le&&le[Gt]})}e.placedSymbolArray.emplaceBack(P.x,P.y,te,this.glyphOffsetArray.length-te,oe,R,F,P.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],E,0,!1,0,V)}_addCollisionDebugVertex(e,i,u,p,_,v){return i.emplaceBack(0,0),e.emplaceBack(u.x,u.y,p,_,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(e,i,u,p,_,v,E){const P=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),R=P.vertexLength,F=_.layoutVertexArray,V=_.collisionVertexArray,Z=E.anchorX,q=E.anchorY;this._addCollisionDebugVertex(F,V,v,Z,q,new k(e,i)),this._addCollisionDebugVertex(F,V,v,Z,q,new k(u,i)),this._addCollisionDebugVertex(F,V,v,Z,q,new k(u,p)),this._addCollisionDebugVertex(F,V,v,Z,q,new k(e,p)),P.vertexLength+=4;const W=_.indexArray;W.emplaceBack(R,R+1),W.emplaceBack(R+1,R+2),W.emplaceBack(R+2,R+3),W.emplaceBack(R+3,R),P.primitiveLength+=4}addDebugCollisionBoxes(e,i,u,p){for(let _=e;_<i;_++){const v=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,p?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ig(we,Tg.members,He),this.iconCollisionBox=new Ig(we,Tg.members,He);for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(e,i,u,p,_,v,E,P,R){const F={};for(let V=i;V<u;V++){const Z=e.get(V);F.textBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},F.textFeatureIndex=Z.featureIndex;break}for(let V=p;V<_;V++){const Z=e.get(V);F.verticalTextBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},F.verticalTextFeatureIndex=Z.featureIndex;break}for(let V=v;V<E;V++){const Z=e.get(V);F.iconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},F.iconFeatureIndex=Z.featureIndex;break}for(let V=P;V<R;V++){const Z=e.get(V);F.verticalIconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},F.verticalIconFeatureIndex=Z.featureIndex;break}return F}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const u=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const u=e.placedSymbolArray.get(i),p=u.vertexStartIndex+4*u.numGlyphs;for(let _=u.vertexStartIndex;_<p;_+=4)e.indexArray.emplaceBack(_,_+2,_+1),e.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),u=Math.cos(e),p=[],_=[],v=[];for(let E=0;E<this.symbolInstances.length;++E){v.push(E);const P=this.symbolInstances.get(E);p.push(0|Math.round(i*P.anchorX+u*P.anchorY)),_.push(P.featureIndex)}return v.sort(((E,P)=>p[E]-p[P]||_[P]-_[E])),v}addToSortKeyRanges(e,i){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===i?u.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const u=this.symbolInstances.get(i);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach(((p,_,v)=>{p>=0&&v.indexOf(p)===_&&this.addIndicesForPlacedSymbol(this.text,p)})),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Lg,Dg;Ot("SymbolBucket",fh,{omit:["layers","collisionBoxArray","features","compareText"]}),fh.MAX_GLYPHS=65535,fh.addDynamicAttributes=tm;var Rg={get paint(){return Dg=Dg||new xr({"icon-opacity":new ai(Ze.paint_symbol["icon-opacity"]),"icon-color":new ai(Ze.paint_symbol["icon-color"]),"icon-halo-color":new ai(Ze.paint_symbol["icon-halo-color"]),"icon-halo-width":new ai(Ze.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ai(Ze.paint_symbol["icon-halo-blur"]),"icon-translate":new Jt(Ze.paint_symbol["icon-translate"]),"icon-translate-anchor":new Jt(Ze.paint_symbol["icon-translate-anchor"]),"text-opacity":new ai(Ze.paint_symbol["text-opacity"]),"text-color":new ai(Ze.paint_symbol["text-color"],{runtimeType:Ra,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new ai(Ze.paint_symbol["text-halo-color"]),"text-halo-width":new ai(Ze.paint_symbol["text-halo-width"]),"text-halo-blur":new ai(Ze.paint_symbol["text-halo-blur"]),"text-translate":new Jt(Ze.paint_symbol["text-translate"]),"text-translate-anchor":new Jt(Ze.paint_symbol["text-translate-anchor"])})},get layout(){return Lg=Lg||new xr({"symbol-placement":new Jt(Ze.layout_symbol["symbol-placement"]),"symbol-spacing":new Jt(Ze.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Jt(Ze.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ai(Ze.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Jt(Ze.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Jt(Ze.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Jt(Ze.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Jt(Ze.layout_symbol["icon-ignore-placement"]),"icon-optional":new Jt(Ze.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Jt(Ze.layout_symbol["icon-rotation-alignment"]),"icon-size":new ai(Ze.layout_symbol["icon-size"]),"icon-text-fit":new Jt(Ze.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Jt(Ze.layout_symbol["icon-text-fit-padding"]),"icon-image":new ai(Ze.layout_symbol["icon-image"]),"icon-rotate":new ai(Ze.layout_symbol["icon-rotate"]),"icon-padding":new ai(Ze.layout_symbol["icon-padding"]),"icon-keep-upright":new Jt(Ze.layout_symbol["icon-keep-upright"]),"icon-offset":new ai(Ze.layout_symbol["icon-offset"]),"icon-anchor":new ai(Ze.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Jt(Ze.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Jt(Ze.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Jt(Ze.layout_symbol["text-rotation-alignment"]),"text-field":new ai(Ze.layout_symbol["text-field"]),"text-font":new ai(Ze.layout_symbol["text-font"]),"text-size":new ai(Ze.layout_symbol["text-size"]),"text-max-width":new ai(Ze.layout_symbol["text-max-width"]),"text-line-height":new Jt(Ze.layout_symbol["text-line-height"]),"text-letter-spacing":new ai(Ze.layout_symbol["text-letter-spacing"]),"text-justify":new ai(Ze.layout_symbol["text-justify"]),"text-radial-offset":new ai(Ze.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Jt(Ze.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ai(Ze.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ai(Ze.layout_symbol["text-anchor"]),"text-max-angle":new Jt(Ze.layout_symbol["text-max-angle"]),"text-writing-mode":new Jt(Ze.layout_symbol["text-writing-mode"]),"text-rotate":new ai(Ze.layout_symbol["text-rotate"]),"text-padding":new Jt(Ze.layout_symbol["text-padding"]),"text-keep-upright":new Jt(Ze.layout_symbol["text-keep-upright"]),"text-transform":new ai(Ze.layout_symbol["text-transform"]),"text-offset":new ai(Ze.layout_symbol["text-offset"]),"text-allow-overlap":new Jt(Ze.layout_symbol["text-allow-overlap"]),"text-overlap":new Jt(Ze.layout_symbol["text-overlap"]),"text-ignore-placement":new Jt(Ze.layout_symbol["text-ignore-placement"]),"text-optional":new Jt(Ze.layout_symbol["text-optional"])})}};class nm{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:vn,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ot("FormatSectionOverride",nm,{omit:["defaultValue"]});class Xd extends po{constructor(e,i){super(e,Rg,i)}recalculate(e,i){if(super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const p=[];for(const _ of u)p.indexOf(_)<0&&p.push(_);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,i,u,p){const _=this.layout.get(e).evaluate(i,{},u,p),v=this._unevaluatedLayout._values[e];return v.isDataDriven()||dl(v.value)||!_?_:(function(E,P){return P.replace(/{([^{}]+)}/g,((R,F)=>E&&F in E?String(E[F]):""))})(i.properties,_)}createBucket(e){return new fh(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Rg.paint.overridableProperties){if(!Xd.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),u=new nm(i),p=new nc(u,i.property.specification);let _=null;_=i.value.kind==="constant"||i.value.kind==="source"?new x("source",p):new z("composite",p,i.value.zoomStops),this.paint._values[e]=new ho(i.property,_,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,u){return!(!this.layout||i.isDataDriven()||u.isDataDriven())&&Xd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const u=e.get("text-field"),p=Rg.paint.properties[i];let _=!1;const v=E=>{for(const P of E)if(p.overrides&&p.overrides.hasOverride(P))return void(_=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Ar)v(u.value.value.sections);else if(u.value.kind==="source"||u.value.kind==="composite"){const E=R=>{_||(R instanceof Na&&Ai(R.value)===Bo?v(R.value.sections):R instanceof Ku?v(R.sections):R.eachChild(E))},P=u.value;P._styleExpression&&E(P._styleExpression.expression)}return _}}let g_;var l0={get paint(){return g_=g_||new xr({"background-color":new Jt(Ze.paint_background["background-color"]),"background-pattern":new fo(Ze.paint_background["background-pattern"]),"background-opacity":new Jt(Ze.paint_background["background-opacity"])})}};class Wf extends po{constructor(e,i){super(e,l0,i)}}class u0 extends po{constructor(e,i){super(e,{},i),this.onAdd=u=>{this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},this.onRemove=u=>{this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class y_{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const tn={once:!0},Kf=63710088e-1;class iu{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new iu(fi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,u=this.lat*i,p=e.lat*i,_=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((e.lng-this.lng)*i);return Kf*Math.acos(Math.min(_,1))}static convert(e){if(e instanceof iu)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new iu(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new iu(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const rm=2*Math.PI*Kf;function kg(n){return rm*Math.cos(n*Math.PI/180)}function am(n){return(180+n)/360}function Yd(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Jf(n,e){return n/kg(e)}function __(n){return 360*n-180}function Qf(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function v_(n,e){return n*kg(Qf(e))}class ep{constructor(e,i,u=0){this.x=+e,this.y=+i,this.z=+u}static fromLngLat(e,i=0){const u=iu.convert(e);return new ep(am(u.lng),Yd(u.lat),Jf(i,u.lat))}toLngLat(){return new iu(__(this.x),Qf(this.y))}toAltitude(){return v_(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/rm*(e=Qf(this.y),1/Math.cos(e*Math.PI/180));var e}}function Og(n,e,i){var u=2*Math.PI*6378137/256/Math.pow(2,i);return[n*u-2*Math.PI*6378137/2,e*u-2*Math.PI*6378137/2]}class om{constructor(e,i,u){if(!(function(p,_,v){return!(p<0||p>25||v<0||v>=Math.pow(2,p)||_<0||_>=Math.pow(2,p))})(e,i,u))throw new Error(`x=${i}, y=${u}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=i,this.y=u,this.key=qr(0,e,e,i,u)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i,u){const p=(function(v,E,P){var R=Og(256*v,256*(E=Math.pow(2,P)-E-1),P),F=Og(256*(v+1),256*(E+1),P);return R[0]+","+R[1]+","+F[0]+","+F[1]})(this.x,this.y,this.z),_=(function(v,E,P){let R,F="";for(let V=v;V>0;V--)R=1<<V-1,F+=(E&R?1:0)+(P&R?2:0);return F})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,_).replace(/{bbox-epsg-3857}/g,p)}isChildOf(e){const i=this.z-e.z;return i>0&&e.x===this.x>>i&&e.y===this.y>>i}getTilePoint(e){const i=Math.pow(2,this.z);return new k((e.x*i-this.x)*ei,(e.y*i-this.y)*ei)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Un{constructor(e,i){this.wrap=e,this.canonical=i,this.key=qr(e,i.z,i.z,i.x,i.y)}}class es{constructor(e,i,u,p,_){if(this.terrainRttPosMatrix32f=null,e<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${u}`);this.overscaledZ=e,this.wrap=i,this.canonical=new om(u,+p,+_),this.key=qr(i,e,u,p,_)}clone(){return new es(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-e;return e>this.canonical.z?new es(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new es(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(e,i){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-e;return e>this.canonical.z?qr(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y):qr(this.wrap*+i,e,e,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(e){if(e.wrap!==this.wrap||this.overscaledZ-e.overscaledZ<=0)return!1;if(e.overscaledZ===0)return this.overscaledZ>0;const i=this.canonical.z-e.canonical.z;return!(i<0)&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new es(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new es(i,this.wrap,i,u,p),new es(i,this.wrap,i,u+1,p),new es(i,this.wrap,i,u,p+1),new es(i,this.wrap,i,u+1,p+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new es(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new es(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Un(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new ep(e.x-this.wrap,e.y))}}function qr(n,e,i,u,p){(n*=2)<0&&(n=-1*n-1);const _=1<<i;return(_*_*n+_*p+u).toString(36)+i.toString(36)+e.toString(36)}function tp(n,e){return e?n.properties[e]:n.id}function b_(n,e){const i={id:n.id};if(e.removeAllProperties&&(delete n.removeProperties,delete n.addOrUpdateProperties,delete e.removeProperties),e.removeProperties)for(const u of e.removeProperties){const p=n.addOrUpdateProperties.findIndex((_=>_.key===u));p>-1&&n.addOrUpdateProperties.splice(p,1)}return(n.removeAllProperties||e.removeAllProperties)&&(i.removeAllProperties=!0),(n.removeProperties||e.removeProperties)&&(i.removeProperties=[...n.removeProperties||[],...e.removeProperties||[]]),(n.addOrUpdateProperties||e.addOrUpdateProperties)&&(i.addOrUpdateProperties=[...n.addOrUpdateProperties||[],...e.addOrUpdateProperties||[]]),(n.newGeometry||e.newGeometry)&&(i.newGeometry=e.newGeometry||n.newGeometry),i}function x_(n){var e,i;if(!n)return{};const u={};return u.removeAll=n.removeAll,u.remove=new Set(n.remove||[]),u.add=new Map((e=n.add)===null||e===void 0?void 0:e.map((p=>[p.id,p]))),u.update=new Map((i=n.update)===null||i===void 0?void 0:i.map((p=>[p.id,p]))),u}Ot("CanonicalTileID",om),Ot("OverscaledTileID",es,{omit:["terrainRttPosMatrix32f"]});class sm{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const u=e[i];this._stringToNumber[u]=i,this._numberToString[i]=u}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class lm{constructor(e,i,u,p,_){this.type="Feature",this._vectorTileFeature=e,this._x=u,this._y=p,this._z=i,this.properties=e.properties,this.id=_}projectPoint(e,i,u,p){return[360*(e.x+i)/p-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+u)/p)*Math.PI))-90]}projectLine(e,i,u,p){return e.map((_=>this.projectPoint(_,i,u,p)))}get geometry(){if(this._geometry)return this._geometry;const e=this._vectorTileFeature,i=e.extent*Math.pow(2,this._z),u=e.extent*this._x,p=e.extent*this._y,_=e.loadGeometry();switch(e.type){case 1:{const v=[];for(const P of _)v.push(P[0]);const E=this.projectLine(v,u,p,i);this._geometry=v.length===1?{type:"Point",coordinates:E[0]}:{type:"MultiPoint",coordinates:E};break}case 2:{const v=_.map((E=>this.projectLine(E,u,p,i)));this._geometry=v.length===1?{type:"LineString",coordinates:v[0]}:{type:"MultiLineString",coordinates:v};break}case 3:{const v=jf(_),E=[];for(const P of v)E.push(P.map((R=>this.projectLine(R,u,p,i))));this._geometry=E.length===1?{type:"Polygon",coordinates:E[0]}:{type:"MultiPolygon",coordinates:E};break}default:throw new Error(`unknown feature type: ${e.type}`)}return this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&i!=="_x"&&i!=="_y"&&i!=="_z"&&(e[i]=this[i]);return e}}class bc{_name;dataBuffer;nullabilityBuffer;_size;constructor(e,i,u){this._name=e,this.dataBuffer=i,typeof u=="number"?this._size=u:(this.nullabilityBuffer=u,this._size=u.size())}getValue(e){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(e)?null:this.getValueFromBuffer(e)}has(e){return this.nullabilityBuffer&&this.nullabilityBuffer.get(e)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class ip extends bc{}class um extends ip{getValueFromBuffer(e){return this.dataBuffer[e]}}class np extends ip{getValueFromBuffer(e){return this.dataBuffer[e]}}class cm extends bc{delta;constructor(e,i,u,p){super(e,i,p),this.delta=u}}class Bg extends cm{constructor(e,i,u,p){super(e,Int32Array.of(i),u,p)}getValueFromBuffer(e){return this.dataBuffer[0]+e*this.delta}}class hm extends bc{constructor(e,i,u){super(e,Int32Array.of(i),u)}getValueFromBuffer(e){return this.dataBuffer[0]}}class c0{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(e,i,u,p,_=4096){this._name=e,this._geometryVector=i,this._idVector=u,this._propertyVectors=p,this._extent=_}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(e){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((i=>[i.name,i])))),this.propertyVectorsMap.get(e)}*[Symbol.iterator](){const e=this.geometryVector[Symbol.iterator]();let i=0;for(;i<this.numFeatures;){let u;this.idVector&&(u=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(i)):this.idVector.getValue(i));const p=e?.next().value,_={};for(const v of this.propertyVectors){if(!v)continue;const E=v.name,P=v.getValue(i);P!==null&&(_[E]=P)}i++,yield{id:u,geometry:p,properties:_}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const e=[],i=this.geometryVector.getGeometries();for(let u=0;u<this.numFeatures;u++){let p;this.idVector&&(p=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(u)):this.idVector.getValue(u));const _={coordinates:i[u],type:this.geometryVector.geometryType(u)},v={};for(const E of this.propertyVectors){if(!E)continue;const P=E.name,R=E.getValue(u);R!==null&&(v[P]=R)}e.push({id:p,geometry:_,properties:v})}return e}containsMaxSaveIntegerValues(e){return e instanceof um||e instanceof hm&&e instanceof Bg||e instanceof np}}class w_{value;constructor(e){this.value=e}get(){return this.value}set(e){this.value=e}increment(){return this.value++}add(e){this.value+=e}}var ki,xc,_r,vl,ph,Po,ga,ya,Fg,ts;function la(n,e,i){const u=new Int32Array(i);let p=0,_=e.get();for(let v=0;v<u.length;v++){let E=n[_++],P=127&E;E<128||(E=n[_++],P|=(127&E)<<7,E<128||(E=n[_++],P|=(127&E)<<14,E<128||(E=n[_++],P|=(127&E)<<21,E<128||(E=n[_++],P|=(15&E)<<28)))),u[p++]=P}return e.set(_),u}function dm(n,e,i){const u=new BigInt64Array(i);for(let p=0;p<u.length;p++)u[p]=T_(n,e);return u}function bl(n,e){let i,u;return u=n[e.get()],e.increment(),i=127&u,u<128?i:(u=n[e.get()],e.increment(),i|=(127&u)<<7,u<128?i:(u=n[e.get()],e.increment(),i|=(127&u)<<14,u<128?i:(u=n[e.get()],e.increment(),i|=(127&u)<<21,u<128?i:(u=n[e.get()],i|=(15&u)<<28,(function(p,_,v){let E,P;if(P=_[v.get()],v.increment(),E=(112&P)>>4,P<128||(P=_[v.get()],v.increment(),E|=(127&P)<<3,P<128)||(P=_[v.get()],v.increment(),E|=(127&P)<<10,P<128)||(P=_[v.get()],v.increment(),E|=(127&P)<<17,P<128)||(P=_[v.get()],v.increment(),E|=(127&P)<<24,P<128)||(P=_[v.get()],v.increment(),E|=(1&P)<<31,P<128))return 4294967296*E+(p>>>0);throw new Error("Expected varint not more than 10 bytes")})(i,n,e)))))}function fm(n,e,i,u){throw new Error("FastPFor is not implemented yet.")}function mh(n){return n>>>1^-(1&n)}function id(n){return n>>1n^-(1n&n)}function T_(n,e){let i=0n,u=0,p=e.get();for(;p<n.length;){const _=n[p++];if(i|=BigInt(127&_)<<BigInt(u),!(128&_))break;if(u+=7,u>=64)throw new Error("Varint too long")}return e.set(p),i}function Wd(n,e,i){const u=new Int32Array(i);let p=0;for(let _=0;_<e;_++){const v=n[_];u.fill(n[_+e],p,p+v),p+=v}return u}function Zs(n,e,i){const u=new BigInt64Array(i);let p=0;for(let _=0;_<e;_++){const v=Number(n[_]);u.fill(n[_+e],p,p+v),p+=v}return u}function Ng(n,e,i){const u=new Float64Array(i);let p=0;for(let _=0;_<e;_++){const v=n[_];u.fill(n[_+e],p,p+v),p+=v}return u}function Kd(n){const e=n.length/4*4;let i=1;if(e>=4)for(let u=n[0];i<e-4;i+=4)u=n[i]+=u,u=n[i+1]+=u,u=n[i+2]+=u,u=n[i+3]+=u;for(;i!=n.length;)n[i]+=n[i-1],++i}function Ou(n){n[0]=n[0]>>>1^-(1&n[0]),n[1]=n[1]>>>1^-(1&n[1]);const e=n.length/4*4;let i=2;if(e>=4)for(;i<e-4;i+=4){const u=n[i],p=n[i+1],_=n[i+2],v=n[i+3];n[i]=(u>>>1^-(1&u))+n[i-2],n[i+1]=(p>>>1^-(1&p))+n[i-1],n[i+2]=(_>>>1^-(1&_))+n[i],n[i+3]=(v>>>1^-(1&v))+n[i+1]}for(;i!=n.length;i+=2)n[i]=(n[i]>>>1^-(1&n[i]))+n[i-2],n[i+1]=(n[i+1]>>>1^-(1&n[i+1]))+n[i-1]}(function(n){n.NONE="NONE",n.DELTA="DELTA",n.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",n.RLE="RLE",n.MORTON="MORTON",n.PDE="PDE"})(ki||(ki={})),(function(n){n.NONE="NONE",n.FAST_PFOR="FAST_PFOR",n.VARINT="VARINT",n.ALP="ALP"})(xc||(xc={})),(function(n){n.PRESENT="PRESENT",n.DATA="DATA",n.OFFSET="OFFSET",n.LENGTH="LENGTH"})(_r||(_r={}));class jg{_dictionaryType;_offsetType;_lengthType;constructor(e,i,u){this._dictionaryType=e,this._offsetType=i,this._lengthType=u}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function zo(n,e){const i=(function(u,p){const _=u[p.get()],v=Object.values(_r)[_>>4];let E=null;switch(v){case _r.DATA:E=new jg(Object.values(vl)[15&_]);break;case _r.OFFSET:E=new jg(null,Object.values(ph)[15&_]);break;case _r.LENGTH:E=new jg(null,null,Object.values(Po)[15&_])}p.increment();const P=u[p.get()],R=Object.values(ki)[P>>5],F=Object.values(ki)[P>>2&7],V=Object.values(xc)[3&P];p.increment();const Z=la(u,p,2),q=Z[0];return{physicalStreamType:v,logicalStreamType:E,logicalLevelTechnique1:R,logicalLevelTechnique2:F,physicalLevelTechnique:V,numValues:q,byteLength:Z[1],decompressedCount:q}})(n,e);return i.logicalLevelTechnique1===ki.MORTON?(function(u,p,_){const v=la(p,_,2);return{physicalStreamType:u.physicalStreamType,logicalStreamType:u.logicalStreamType,logicalLevelTechnique1:u.logicalLevelTechnique1,logicalLevelTechnique2:u.logicalLevelTechnique2,physicalLevelTechnique:u.physicalLevelTechnique,numValues:u.numValues,byteLength:u.byteLength,decompressedCount:u.decompressedCount,numBits:v[0],coordinateShift:v[1]}})(i,n,e):ki.RLE!==i.logicalLevelTechnique1&&ki.RLE!==i.logicalLevelTechnique2||xc.NONE===i.physicalLevelTechnique?i:(function(u,p,_){const v=la(p,_,2);return{physicalStreamType:u.physicalStreamType,logicalStreamType:u.logicalStreamType,logicalLevelTechnique1:u.logicalLevelTechnique1,logicalLevelTechnique2:u.logicalLevelTechnique2,physicalLevelTechnique:u.physicalLevelTechnique,numValues:u.numValues,byteLength:u.byteLength,decompressedCount:v[1],runs:v[0],numRleValues:v[1]}})(i,n,e)}(function(n){n.NONE="NONE",n.SINGLE="SINGLE",n.SHARED="SHARED",n.VERTEX="VERTEX",n.MORTON="MORTON",n.FSST="FSST"})(vl||(vl={})),(function(n){n.VERTEX="VERTEX",n.INDEX="INDEX",n.STRING="STRING",n.KEY="KEY"})(ph||(ph={})),(function(n){n.VAR_BINARY="VAR_BINARY",n.GEOMETRIES="GEOMETRIES",n.PARTS="PARTS",n.RINGS="RINGS",n.TRIANGLES="TRIANGLES",n.SYMBOL="SYMBOL",n.DICTIONARY="DICTIONARY"})(Po||(Po={})),(function(n){n[n.FLAT=0]="FLAT",n[n.CONST=1]="CONST",n[n.SEQUENCE=2]="SEQUENCE",n[n.DICTIONARY=3]="DICTIONARY",n[n.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(ga||(ga={}));class Io{values;_size;constructor(e,i){this.values=e,this._size=i}get(e){const i=Math.floor(e/8);return(this.values[i]>>e%8&1)==1}set(e,i){const u=Math.floor(e/8);this.values[u]=this.values[u]|(i?1:0)<<e%8}getInt(e){const i=Math.floor(e/8);return this.values[i]>>e%8&1}size(){return this._size}getBuffer(){return this.values}}function yo(n,e,i,u,p){return(function(_,v,E){switch(v.logicalLevelTechnique1){case ki.DELTA:return v.logicalLevelTechnique2===ki.RLE?(function(P,R,F){const V=new Int32Array(F);let Z=0,q=0;for(let W=0;W<R;W++){const Q=P[W],te=mh(P[W+R]);for(let oe=0;oe<Q;oe++)q+=te,V[Z++]=q}return V})(_,v.runs,v.numRleValues):((function(P){P[0]=P[0]>>>1^-(1&P[0]);const R=P.length/4*4;let F=1;if(R>=4)for(;F<R-4;F+=4){const V=P[F],Z=P[F+1],q=P[F+2],W=P[F+3];P[F]=(V>>>1^-(1&V))+P[F-1],P[F+1]=(Z>>>1^-(1&Z))+P[F],P[F+2]=(q>>>1^-(1&q))+P[F+1],P[F+3]=(W>>>1^-(1&W))+P[F+2]}for(;F!=P.length;++F)P[F]=(P[F]>>>1^-(1&P[F]))+P[F-1]})(_),_);case ki.RLE:return(function(P,R,F){return F?(function(V,Z,q){const W=new Int32Array(q);let Q=0;for(let te=0;te<Z;te++){const oe=V[te];let xe=V[te+Z];xe=xe>>>1^-(1&xe),W.fill(xe,Q,Q+oe),Q+=oe}return W})(P,R.runs,R.numRleValues):Wd(P,R.runs,R.numRleValues)})(_,v,E);case ki.MORTON:return Kd(_),_;case ki.COMPONENTWISE_DELTA:return Ou(_),_;case ki.NONE:return E&&(function(P){for(let R=0;R<P.length;R++){const F=P[R];P[R]=F>>>1^-(1&F)}})(_),_;default:throw new Error(`The specified Logical level technique is not supported: ${v.logicalLevelTechnique1}`)}})(pm(n,e,i),i,u)}function gh(n,e,i){return(function(u,p){if(p.logicalLevelTechnique1===ki.DELTA&&p.logicalLevelTechnique2===ki.NONE)return(function(v){const E=new Int32Array(v.length+1);E[0]=0,E[1]=mh(v[0]);let P=E[1],R=2;for(;R!=E.length;++R){const F=v[R-1];P+=F>>>1^-(1&F),E[R]=E[R-1]+P}return E})(u);if(p.logicalLevelTechnique1===ki.RLE&&p.logicalLevelTechnique2===ki.NONE)return(function(v,E,P){const R=new Int32Array(P+1);R[0]=0;let F=1,V=R[0];for(let Z=0;Z<E;Z++){const q=v[Z],W=v[Z+E];for(let Q=F;Q<F+q;Q++)R[Q]=W+V,V=R[Q];F+=q}return R})(u,p.runs,p.numRleValues);if(p.logicalLevelTechnique1===ki.NONE&&p.logicalLevelTechnique2===ki.NONE){(function(v){let E=0;for(let P=0;P<v.length;P++)v[P]+=E,E=v[P]})(u);const _=new Int32Array(p.numValues+1);return _[0]=0,_.set(u,1),_}if(p.logicalLevelTechnique1===ki.DELTA&&p.logicalLevelTechnique2===ki.RLE){const _=(function(v,E,P){const R=new Int32Array(P+1);R[0]=0;let F=1,V=R[0];for(let Z=0;Z<E;Z++){const q=v[Z];let W=v[Z+E];W=W>>>1^-(1&W);for(let Q=F;Q<F+q;Q++)R[Q]=W+V,V=R[Q];F+=q}return R})(u,p.runs,p.numRleValues);return Kd(_),_}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(pm(n,e,i),i)}function pm(n,e,i){const u=i.physicalLevelTechnique;if(u===xc.FAST_PFOR)return fm();if(u===xc.VARINT)return la(n,e,i.numValues);if(u===xc.NONE){const p=e.get();e.add(i.byteLength);const _=n.subarray(p,e.get());return new Int32Array(_)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function Ug(n,e,i,u){const p=pm(n,e,i);if(p.length===1){const _=p[0];return u?mh(_):_}return u?(function(_){return mh(_[1])})(p):(function(_){return _[1]})(p)}function S_(n,e,i){return(function(u){if(u.length==2){const p=mh(u[1]);return[p,p]}return[mh(u[2]),mh(u[3])]})(pm(n,e,i))}function M_(n,e,i){return(function(u){if(u.length==2){const p=id(u[1]);return[p,p]}return[id(u[2]),id(u[3])]})(dm(n,e,i.numValues))}function E_(n,e,i,u){return(function(p,_,v){switch(_.logicalLevelTechnique1){case ki.DELTA:return _.logicalLevelTechnique2===ki.RLE?(function(E,P,R){const F=new BigInt64Array(R);let V=0,Z=0n;for(let q=0;q<P;q++){const W=Number(E[q]),Q=id(E[q+P]);for(let te=0;te<W;te++)Z+=Q,F[V++]=Z}return F})(p,_.runs,_.numRleValues):((function(E){E[0]=E[0]>>1n^-(1n&E[0]);const P=E.length/4*4;let R=1;if(P>=4)for(;R<P-4;R+=4){const F=E[R],V=E[R+1],Z=E[R+2],q=E[R+3];E[R]=(F>>1n^-(1n&F))+E[R-1],E[R+1]=(V>>1n^-(1n&V))+E[R],E[R+2]=(Z>>1n^-(1n&Z))+E[R+1],E[R+3]=(q>>1n^-(1n&q))+E[R+2]}for(;R!=E.length;++R)E[R]=(E[R]>>1n^-(1n&E[R]))+E[R-1]})(p),p);case ki.RLE:return(function(E,P,R){return R?(function(F,V,Z){const q=new BigInt64Array(Z);let W=0;for(let Q=0;Q<V;Q++){const te=Number(F[Q]);let oe=F[Q+V];oe=oe>>1n^-(1n&oe),q.fill(oe,W,W+te),W+=te}return q})(E,P.runs,P.numRleValues):Zs(E,P.runs,P.numRleValues)})(p,_,v);case ki.NONE:return v&&(function(E){for(let P=0;P<E.length;P++){const R=E[P];E[P]=R>>1n^-(1n&R)}})(p),p;default:throw new Error(`The specified Logical level technique is not supported: ${_.logicalLevelTechnique1}`)}})(dm(n,e,i.numValues),i,u)}function A_(n,e,i,u){const p=dm(n,e,i.numValues);if(p.length===1){const _=p[0];return u?id(_):_}return u?(function(_){return id(_[1])})(p):(function(_){return _[1]})(p)}function mm(n,e,i,u,p){return(function(_,v,E,P){switch(v.logicalLevelTechnique1){case ki.DELTA:return v.logicalLevelTechnique2===ki.RLE&&(_=Wd(_,v.runs,v.numRleValues)),(function(R,F){const V=new Int32Array(R.size());let Z=0;R.get(0)?(V[0]=R.get(0)?F[0]>>>1^-(1&F[0]):0,Z=1):V[0]=0;let q=1;for(;q!=V.length;++q)V[q]=R.get(q)?V[q-1]+(F[Z]>>>1^-(1&F[Z++])):V[q-1];return V})(P,_);case ki.RLE:return(function(R,F,V,Z){const q=F;return V?(function(W,Q,te){const oe=new Int32Array(W.size());let xe=0;for(let le=0;le<te;le++){const pe=Q[le];let Te=Q[le+te];Te=Te>>>1^-(1&Te);for(let Me=xe;Me<xe+pe;Me++)W.get(Me)?oe[Me]=Te:(oe[Me]=0,xe++);xe+=pe}return oe})(Z,R,q.runs):(function(W,Q,te){const oe=new Int32Array(W.size());let xe=0;for(let le=0;le<te;le++){const pe=Q[le],Te=Q[le+te];for(let Me=xe;Me<xe+pe;Me++)W.get(Me)?oe[Me]=Te:(oe[Me]=0,xe++);xe+=pe}return oe})(Z,R,q.runs)})(_,v,E,P);case ki.MORTON:return Kd(_),_;case ki.COMPONENTWISE_DELTA:return Ou(_),_;case ki.NONE:return _=E?(function(R,F){const V=new Int32Array(R.size());let Z=0,q=0;for(;q!=V.length;++q)if(R.get(q)){const W=F[Z++];V[q]=W>>>1^-(1&W)}else V[q]=0;return V})(P,_):(function(R,F){const V=new Int32Array(R.size());let Z=0,q=0;for(;q!=V.length;++q)V[q]=R.get(q)?F[Z++]:0;return V})(P,_),_;default:throw new Error("The specified Logical level technique is not supported")}})(i.physicalLevelTechnique===xc.FAST_PFOR?fm():la(n,e,i.numValues),i,u,p)}function wc(n,e,i,u){const p=n.logicalLevelTechnique1;if(p===ki.RLE)return n.runs===1?ga.CONST:ga.FLAT;const _=e instanceof Io?e.size():e;if(p===ki.DELTA&&n.logicalLevelTechnique2===ki.RLE){const v=n.runs,E=2;if(n.numRleValues!==_)return ga.FLAT;if(v===1)return ga.SEQUENCE;if(v===2){const P=u.get();let R;if(n.physicalLevelTechnique===xc.VARINT)R=la(i,u,4);else{const F=u.get();R=new Int32Array(i.buffer,i.byteOffset+F,4)}if(u.set(P),R[2]===E&&R[3]===E)return ga.SEQUENCE}}return n.numValues===1?ga.CONST:ga.FLAT}class Jd extends ip{getValueFromBuffer(e){return this.dataBuffer[e]}}class Vg extends cm{constructor(e,i,u,p){super(e,BigInt64Array.of(i),u,p)}getValueFromBuffer(e){return this.dataBuffer[0]+BigInt(e)*this.delta}}class Qd{_geometryOffsets;_partOffsets;_ringOffsets;constructor(e,i,u){this._geometryOffsets=e,this._partOffsets=i,this._ringOffsets=u}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function yh(n,e,i){return{x:ef(n,e)-i,y:ef(n>>1,e)-i}}function ef(n,e){let i=0;for(let u=0;u<e;u++)i|=(n&1<<2*u)>>u;return i}(function(n){n[n.POINT=0]="POINT",n[n.LINESTRING=1]="LINESTRING",n[n.POLYGON=2]="POLYGON",n[n.MULTIPOINT=3]="MULTIPOINT",n[n.MULTILINESTRING=4]="MULTILINESTRING",n[n.MULTIPOLYGON=5]="MULTIPOLYGON"})(ya||(ya={})),(function(n){n[n.POINT=0]="POINT",n[n.LINESTRING=1]="LINESTRING",n[n.POLYGON=2]="POLYGON"})(Fg||(Fg={})),(function(n){n[n.MORTON=0]="MORTON",n[n.VEC_2=1]="VEC_2",n[n.VEC_3=2]="VEC_3"})(ts||(ts={}));class C_{createPoint(e){return[[e]]}createMultiPoint(e){return e.map((i=>[i]))}createLineString(e){return[e]}createMultiLineString(e){return e}createPolygon(e,i){return[e].concat(i)}createMultiPolygon(e){return e.flat()}}function rp(n){const e=new Array(n.numGeometries);let i=1,u=1,p=1,_=0;const v=new C_;let E=0,P=0;const R=n.mortonSettings,F=n.topologyVector,V=F.geometryOffsets,Z=F.partOffsets,q=F.ringOffsets,W=n.vertexOffsets,Q=n.containsPolygonGeometry(),te=n.vertexBuffer;for(let oe=0;oe<n.numGeometries;oe++){const xe=n.geometryType(oe);if(xe===ya.POINT){if(W&&W.length!==0)if(n.vertexBufferType===ts.VEC_2){const le=2*W[P++],pe=new k(te[le],te[le+1]);e[_++]=v.createPoint(pe)}else{const le=yh(te[W[P++]],R.numBits,R.coordinateShift),pe=new k(le.x,le.y);e[_++]=v.createPoint(pe)}else{const le=new k(te[E++],te[E++]);e[_++]=v.createPoint(le)}V&&p++,Z&&i++,q&&u++}else if(xe===ya.MULTIPOINT){const le=V[p]-V[p-1];p++;const pe=new Array(le);if(W&&W.length!==0){for(let Te=0;Te<le;Te++){const Me=2*W[P++];pe[Te]=new k(te[Me],te[Me+1])}e[_++]=v.createMultiPoint(pe)}else{for(let Te=0;Te<le;Te++){const Me=te[E++],Xe=te[E++];pe[Te]=new k(Me,Xe)}e[_++]=v.createMultiPoint(pe)}}else if(xe===ya.LINESTRING){let le,pe=0;Q?(pe=q[u]-q[u-1],u++):pe=Z[i]-Z[i-1],i++,W&&W.length!==0?(le=n.vertexBufferType===ts.VEC_2?ym(te,W,P,pe,!1):Gg(te,W,P,pe,!1,R),P+=pe):(le=gm(te,E,pe,!1),E+=2*pe),e[_++]=v.createLineString(le),V&&p++}else if(xe===ya.POLYGON){const le=Z[i]-Z[i-1];i++;const pe=new Array(le-1);let Te=q[u]-q[u-1];if(u++,W&&W.length!==0){const Me=n.vertexBufferType===ts.VEC_2?nf(te,W,P,Te):nd(te,W,P,Te,0,R);P+=Te;for(let Xe=0;Xe<pe.length;Xe++)Te=q[u]-q[u-1],u++,pe[Xe]=n.vertexBufferType===ts.VEC_2?nf(te,W,P,Te):nd(te,W,P,Te,0,R),P+=Te;e[_++]=v.createPolygon(Me,pe)}else{const Me=tf(te,E,Te);E+=2*Te;for(let Xe=0;Xe<pe.length;Xe++)Te=q[u]-q[u-1],u++,pe[Xe]=tf(te,E,Te),E+=2*Te;e[_++]=v.createPolygon(Me,pe)}V&&p++}else if(xe===ya.MULTILINESTRING){const le=V[p]-V[p-1];p++;const pe=new Array(le);if(W&&W.length!==0){for(let Te=0;Te<le;Te++){let Me=0;Q?(Me=q[u]-q[u-1],u++):Me=Z[i]-Z[i-1],i++;const Xe=n.vertexBufferType===ts.VEC_2?ym(te,W,P,Me,!1):Gg(te,W,P,Me,!1,R);pe[Te]=Xe,P+=Me}e[_++]=v.createMultiLineString(pe)}else{for(let Te=0;Te<le;Te++){let Me=0;Q?(Me=q[u]-q[u-1],u++):Me=Z[i]-Z[i-1],i++,pe[Te]=gm(te,E,Me,!1),E+=2*Me}e[_++]=v.createMultiLineString(pe)}}else{if(xe!==ya.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const le=V[p]-V[p-1];p++;const pe=new Array(le);let Te=0;if(W&&W.length!==0){for(let Me=0;Me<le;Me++){const Xe=Z[i]-Z[i-1];i++;const gt=new Array(Xe-1);Te=q[u]-q[u-1],u++;const ut=n.vertexBufferType===ts.VEC_2?nf(te,W,P,Te):nd(te,W,P,Te,0,R);P+=Te;for(let xt=0;xt<gt.length;xt++)Te=q[u]-q[u-1],u++,gt[xt]=n.vertexBufferType===ts.VEC_2?nf(te,W,P,Te):nd(te,W,P,Te,0,R),P+=Te;pe[Me]=v.createPolygon(ut,gt)}e[_++]=v.createMultiPolygon(pe)}else{for(let Me=0;Me<le;Me++){const Xe=Z[i]-Z[i-1];i++;const gt=new Array(Xe-1);Te=q[u]-q[u-1],u++;const ut=tf(te,E,Te);E+=2*Te;for(let xt=0;xt<gt.length;xt++){const Rt=q[u]-q[u-1];u++,gt[xt]=tf(te,E,Rt),E+=2*Rt}pe[Me]=v.createPolygon(ut,gt)}e[_++]=v.createMultiPolygon(pe)}}}}return e}function tf(n,e,i){return gm(n,e,i,!0)}function nf(n,e,i,u){return ym(n,e,i,u,!0)}function nd(n,e,i,u,p,_){return Gg(n,e,i,u,!0,_)}function gm(n,e,i,u){const p=new Array(u?i+1:i);for(let _=0;_<2*i;_+=2)p[_/2]=new k(n[e+_],n[e+_+1]);return u&&(p[p.length-1]=p[0]),p}function ym(n,e,i,u,p){const _=new Array(p?u+1:u);for(let v=0;v<2*u;v+=2){const E=2*e[i+v/2];_[v/2]=new k(n[E],n[E+1])}return p&&(_[_.length-1]=_[0]),_}function Gg(n,e,i,u,p,_){const v=new Array(p?u+1:u);for(let E=0;E<u;E++){const P=yh(n[e[i+E]],_.numBits,_.coordinateShift);v[E]=new k(P.x,P.y)}return p&&(v[v.length-1]=v[0]),v}class Zg{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(e,i,u,p,_){this._vertexBufferType=e,this._topologyVector=i,this._vertexOffsets=u,this._vertexBuffer=p,this._mortonSettings=_}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const e=rp(this);let i=0;for(;i<this.numGeometries;)yield{coordinates:e[i],type:this.geometryType(i)},i++}getSimpleEncodedVertex(e){const i=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[i],this.vertexBuffer[i+1]]}getVertex(e){if(this.vertexOffsets&&this.mortonSettings){const u=yh(this.vertexBuffer[this.vertexOffsets[e]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[u.x,u.y]}const i=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[i],this.vertexBuffer[i+1]]}getGeometries(){return rp(this)}get mortonSettings(){return this._mortonSettings}}class P_ extends Zg{_numGeometries;_geometryType;constructor(e,i,u,p,_,v,E){super(u,p,_,v,E),this._numGeometries=e,this._geometryType=i}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===ya.POLYGON||this._geometryType===ya.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class _m extends Zg{_geometryTypes;constructor(e,i,u,p,_,v){super(e,u,p,_,v),this._geometryTypes=i}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let e=0;e<this.numGeometries;e++)if(this.geometryType(e)===ya.POLYGON||this.geometryType(e)===ya.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class z_{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(e,i,u,p){this._triangleOffsets=e,this._indexBuffer=i,this._vertexBuffer=u,this._topologyVector=p}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const e=new Array(this.numGeometries),i=this._topologyVector,u=i.partOffsets,p=i.ringOffsets,_=i.geometryOffsets;let v=0,E=1,P=1,R=1;for(let F=0;F<this.numGeometries;F++)switch(this.geometryType(F)){case ya.POLYGON:{const V=u[E]-u[E-1];E++;const Z=[];for(let q=0;q<V;q++){const W=p[P]-p[P-1];P++;const Q=[];for(let te=0;te<W;te++){const oe=this._vertexBuffer[v++],xe=this._vertexBuffer[v++];Q.push(new k(oe,xe))}Q.length>0&&Q.push(Q[0]),Z.push(Q)}e[F]=Z,_&&R++}break;case ya.MULTIPOLYGON:{const V=_[R]-_[R-1];R++;const Z=[];for(let q=0;q<V;q++){const W=u[E]-u[E-1];E++;for(let Q=0;Q<W;Q++){const te=p[P]-p[P-1];P++;const oe=[];for(let xe=0;xe<te;xe++){const le=this._vertexBuffer[v++],pe=this._vertexBuffer[v++];oe.push(new k(le,pe))}oe.length>0&&oe.push(oe[0]),Z.push(oe)}}e[F]=Z}}return e}[Symbol.iterator](){return null}}function ap(n,e,i,u,p,_){return new vm(n,e,i,u,p,_)}class vm extends z_{_numGeometries;_geometryType;constructor(e,i,u,p,_,v){super(u,p,_,v),this._numGeometries=e,this._geometryType=i}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function op(n,e,i,u,p){return new h0(n,e,i,u,p)}class h0 extends z_{_geometryTypes;constructor(e,i,u,p,_){super(i,u,p,_),this._geometryTypes=e}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function sp(n,e,i,u,p){const _=zo(n,i);let v=null,E=null,P=null,R=null,F=null,V=null,Z=null,q=null;if(wc(_,u,n,i)===ga.CONST){const Q=Ug(n,i,_,!1);for(let te=0;te<e-1;te++){const oe=zo(n,i);switch(oe.physicalStreamType){case _r.LENGTH:switch(oe.logicalStreamType.lengthType){case Po.GEOMETRIES:v=gh(n,i,oe);break;case Po.PARTS:E=gh(n,i,oe);break;case Po.RINGS:P=gh(n,i,oe);break;case Po.TRIANGLES:Z=gh(n,i,oe)}break;case _r.OFFSET:switch(oe.logicalStreamType.offsetType){case ph.VERTEX:R=yo(n,i,oe,!1);break;case ph.INDEX:q=yo(n,i,oe,!1)}break;case _r.DATA:vl.VERTEX===oe.logicalStreamType.dictionaryType?F=yo(n,i,oe,!0):(V={numBits:oe.numBits,coordinateShift:oe.coordinateShift},F=yo(n,i,oe,!1))}}return q!==null?v!=null||E!=null?ap(u,Q,Z,q,F,new Qd(v,E,P)):ap(u,Q,Z,q,F):V===null?(function(te,oe,xe,le,pe){return new P_(te,oe,ts.VEC_2,xe,le,pe)})(u,Q,new Qd(v,E,P),R,F):(function(te,oe,xe,le,pe,Te){return new P_(te,oe,ts.MORTON,xe,le,pe,Te)})(u,Q,new Qd(v,E,P),R,F,V)}const W=yo(n,i,_,!1);for(let Q=0;Q<e-1;Q++){const te=zo(n,i);switch(te.physicalStreamType){case _r.LENGTH:switch(te.logicalStreamType.lengthType){case Po.GEOMETRIES:v=yo(n,i,te,!1);break;case Po.PARTS:E=yo(n,i,te,!1);break;case Po.RINGS:P=yo(n,i,te,!1);break;case Po.TRIANGLES:Z=gh(n,i,te)}break;case _r.OFFSET:switch(te.logicalStreamType.offsetType){case ph.VERTEX:R=yo(n,i,te,!1);break;case ph.INDEX:q=yo(n,i,te,!1)}break;case _r.DATA:vl.VERTEX===te.logicalStreamType.dictionaryType?F=yo(n,i,te,!0):(V={numBits:te.numBits,coordinateShift:te.coordinateShift},F=yo(n,i,te,!1))}}return q!==null&&E===null?op(W,Z,q,F):(v!==null?(v=qg(W,v,2),E!==null&&P!==null?(E=$g(W,v,E,!1),P=(function(Q,te,oe,xe){const le=new Int32Array(oe[oe.length-1]+1);let pe=0;le[0]=pe;let Te=1,Me=1,Xe=0;for(let gt=0;gt<Q.length;gt++){const ut=Q[gt],xt=te[gt+1]-te[gt];if(ut!==0&&ut!==3)for(let Rt=0;Rt<xt;Rt++){const wt=oe[Te]-oe[Te-1];Te++;for(let ft=0;ft<wt;ft++)pe=le[Me++]=pe+xe[Xe++]}else for(let Rt=0;Rt<xt;Rt++)le[Me++]=++pe,Te++}return le})(W,v,E,P)):E!==null&&(E=(function(Q,te,oe){const xe=new Int32Array(te[te.length-1]+1);let le=0;xe[0]=le;let pe=1,Te=0;for(let Me=0;Me<Q.length;Me++){const Xe=Q[Me],gt=te[Me+1]-te[Me];if(Xe===4||Xe===1)for(let ut=0;ut<gt;ut++)le=xe[pe++]=le+oe[Te++];else for(let ut=0;ut<gt;ut++)xe[pe++]=++le}return xe})(W,v,E))):E!==null&&P!==null?(E=qg(W,E,1),P=$g(W,E,P,!0)):E!==null&&(E=qg(W,E,0)),q!==null?op(W,Z,q,F,new Qd(v,E,P)):V===null?(function(Q,te,oe,xe){return new _m(ts.VEC_2,Q,te,oe,xe)})(W,new Qd(v,E,P),R,F):(function(Q,te,oe,xe,le){return new _m(ts.MORTON,Q,te,oe,xe,le)})(W,new Qd(v,E,P),R,F,V))}function qg(n,e,i){const u=new Int32Array(n.length+1);let p=0;u[0]=p;let _=0;for(let v=0;v<n.length;v++)p=u[v+1]=p+(n[v]>i?e[_++]:1);return u}function $g(n,e,i,u){const p=new Int32Array(e[e.length-1]+1);let _=0;p[0]=_;let v=1,E=0;for(let P=0;P<n.length;P++){const R=n[P],F=e[P+1]-e[P];if(R===5||R===2||u&&(R===4||R===1))for(let V=0;V<F;V++)_=p[v++]=_+i[E++];else for(let V=0;V<F;V++)p[v++]=++_}return p}class I_ extends bc{dataVector;constructor(e,i,u){super(e,i.getBuffer(),u),this.dataVector=i}getValueFromBuffer(e){return this.dataVector.get(e)}}class L_ extends ip{getValueFromBuffer(e){return this.dataBuffer[e]}}class Hg extends bc{constructor(e,i,u){super(e,BigInt64Array.of(i),u)}getValueFromBuffer(e){return this.dataBuffer[0]}}function rd(n,e,i){return Xg(n,Math.ceil(e/8),i)}function Xg(n,e,i){const u=new Uint8Array(e);let p=0;for(;p<e;){const _=n[i.increment()];if(_<=127){const v=_+3,E=n[i.increment()],P=p+v;u.fill(E,p,P),p=P}else{const v=256-_;for(let E=0;E<v;E++)u[p++]=n[i.increment()]}}return u}const D_=new TextDecoder;function rf(n,e,i){return i-e>=12?D_.decode(n.subarray(e,i)):(function(u,p,_){let v="",E=p;for(;E<_;){const P=u[E];let R,F,V,Z=null,q=P>239?4:P>223?3:P>191?2:1;if(E+q>_)break;q===1?P<128&&(Z=P):q===2?(R=u[E+1],(192&R)==128&&(Z=(31&P)<<6|63&R,Z<=127&&(Z=null))):q===3?(R=u[E+1],F=u[E+2],(192&R)==128&&(192&F)==128&&(Z=(15&P)<<12|(63&R)<<6|63&F,(Z<=2047||Z>=55296&&Z<=57343)&&(Z=null))):q===4&&(R=u[E+1],F=u[E+2],V=u[E+3],(192&R)==128&&(192&F)==128&&(192&V)==128&&(Z=(15&P)<<18|(63&R)<<12|(63&F)<<6|63&V,(Z<=65535||Z>=1114112)&&(Z=null))),Z===null?(Z=65533,q=1):Z>65535&&(Z-=65536,v+=String.fromCharCode(Z>>>10&1023|55296),Z=56320|1023&Z),v+=String.fromCharCode(Z),E+=q}return v})(n,e,i)}class Yg extends bc{offsetBuffer;constructor(e,i,u,p){super(e,u,p),this.offsetBuffer=i}}class R_ extends Yg{textEncoder;constructor(e,i,u,p){super(e,i,u,p??i.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(e){return rf(this.dataBuffer,this.offsetBuffer[e],this.offsetBuffer[e+1])}}class _h extends Yg{indexBuffer;textEncoder;constructor(e,i,u,p,_){super(e,u,p,_??i.length),this.indexBuffer=i,this.indexBuffer=i,this.textEncoder=new TextEncoder}getValueFromBuffer(e){const i=this.indexBuffer[e];return rf(this.dataBuffer,this.offsetBuffer[i],this.offsetBuffer[i+1])}}class bm extends Yg{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(e,i,u,p,_,v,E){super(e,u,p,E),this.indexBuffer=i,this.symbolOffsetBuffer=_,this.symbolTableBuffer=v,this.textEncoder=new TextEncoder}getValueFromBuffer(e){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(u,p,_){const v=[],E=new Array(p.length).fill(0);for(let P=1;P<p.length;P++)E[P]=E[P-1]+p[P-1];for(let P=0;P<_.length;P++)if(_[P]===255)v.push(_[++P]);else{const R=p[_[P]],F=E[_[P]];for(let V=0;V<R;V++)v.push(u[F+V])}return new Uint8Array(v)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const i=this.indexBuffer[e];return rf(this.decodedDictionary,this.offsetBuffer[i],this.offsetBuffer[i+1])}offsetToLengthBuffer(e){const i=new Uint32Array(e.length-1);let u=e[0];for(let p=1;p<e.length;p++){const _=e[p];i[p-1]=_-u,u=_}return i}}function xm(n,e,i,u,p,_){return i.type==="scalarType"?(function(v,E,P,R,F,V){let Z=null,q=0;if(v===0)return null;if(V.nullable){const Q=zo(E,P);q=Q.numValues;const te=P.get(),oe=rd(E,q,P);P.set(te+Q.byteLength),Z=new Io(oe,Q.numValues)}const W=Z??R;switch(F.physicalType){case 4:case 3:return(function(Q,te,oe,xe,le){const pe=zo(Q,te),Te=wc(pe,le,Q,te),Me=xe.physicalType===3;if(Te===ga.FLAT){const Xe=ad(le)?mm(Q,te,pe,Me,le):yo(Q,te,pe,Me);return new um(oe.name,Xe,le)}if(Te===ga.SEQUENCE){const Xe=S_(Q,te,pe);return new Bg(oe.name,Xe[0],Xe[1],pe.numRleValues)}{const Xe=Ug(Q,te,pe,Me);return new hm(oe.name,Xe,le)}})(E,P,V,F,W);case 9:return(function(Q,te,oe,xe,le){let pe=null,Te=null,Me=null,Xe=null,gt=null,ut=null,xt=null,Rt=null;for(let wt=0;wt<xe;wt++){const ft=zo(te,oe);if(ft.byteLength!==0)switch(ft.physicalStreamType){case _r.PRESENT:{const it=rd(te,ft.numValues,oe);ut=new Io(it,ft.numValues);break}case _r.OFFSET:Te=le!=null||ut!=null?mm(te,oe,ft,!1,le??ut):yo(te,oe,ft,!1);break;case _r.LENGTH:{const it=gh(te,oe,ft);Po.DICTIONARY===ft.logicalStreamType.lengthType?pe=it:Po.SYMBOL===ft.logicalStreamType.lengthType?Xe=it:xt=it;break}case _r.DATA:{const it=te.subarray(oe.get(),oe.get()+ft.byteLength);oe.add(ft.byteLength);const Ht=ft.logicalStreamType.dictionaryType;vl.FSST===Ht?gt=it:vl.SINGLE===Ht||vl.SHARED===Ht?Me=it:vl.NONE===Ht&&(Rt=it);break}}}return(function(wt,ft,it,Ht,Gt,Xt,Ft){return ft?new bm(wt,it,Ht,Gt,Xt,ft,Ft):null})(Q,gt,Te,pe,Me,Xe,le??ut)??(function(wt,ft,it,Ht,Gt){return ft?Gt?new _h(wt,it,Ht,ft,Gt):new _h(wt,it,Ht,ft):null})(Q,Me,Te,pe,le??ut)??(function(wt,ft,it,Ht,Gt){if(!ft||!it)return null;if(Ht)return Gt?new _h(wt,Ht,ft,it,Gt):new _h(wt,Ht,ft,it);if(Gt&&Gt.size()!==ft.length-1){const Xt=new Int32Array(Gt.size());let Ft=0;for(let ni=0;ni<Gt.size();ni++)Xt[ni]=Gt.get(ni)?Ft++:0;return new _h(wt,Xt,ft,it,Gt)}return Gt?new R_(wt,ft,it,Gt):new R_(wt,ft,it)})(Q,xt,Rt,Te,le??ut)})(V.name,E,P,V.nullable?v-1:v,Z);case 0:return(function(Q,te,oe,xe,le){const pe=zo(Q,te),Te=pe.numValues,Me=te.get(),Xe=ad(le)?(function(ut,xt,Rt,wt){const ft=Xg(ut,Math.ceil(xt/8),Rt),it=new Io(ft,xt),Ht=wt.size(),Gt=new Io(new Uint8Array(Ht),Ht);let Xt=0;for(let Ft=0;Ft<wt.size();Ft++){const ni=!!wt.get(Ft)&&it.get(Xt++);Gt.set(Ft,ni)}return Gt.getBuffer()})(Q,Te,te,le):rd(Q,Te,te);te.set(Me+pe.byteLength);const gt=new Io(Xe,Te);return new I_(oe.name,gt,le)})(E,P,V,0,W);case 6:case 5:return(function(Q,te,oe,xe,le){const pe=zo(Q,te),Te=wc(pe,xe,Q,te),Me=le.physicalType===5;if(Te===ga.FLAT){const Xe=ad(xe)?(function(gt,ut,xt,Rt,wt){return(function(ft,it,Ht,Gt){switch(it.logicalLevelTechnique1){case ki.DELTA:return it.logicalLevelTechnique2===ki.RLE&&(ft=Zs(ft,it.runs,it.numRleValues)),(function(Xt,Ft){const ni=new BigInt64Array(Xt.size());let sn=0;Xt.get(0)?(ni[0]=Xt.get(0)?Ft[0]>>1n^-(1n&Ft[0]):0n,sn=1):ni[0]=0n;let Ni=1;for(;Ni!=ni.length;++Ni)ni[Ni]=Xt.get(Ni)?ni[Ni-1]+(Ft[sn]>>1n^-(1n&Ft[sn++])):ni[Ni-1];return ni})(Gt,ft);case ki.RLE:return(function(Xt,Ft,ni,sn){const Ni=Ft;return ni?(function(vr,Lo,_a){const br=new BigInt64Array(vr.size());let cr=0;for(let En=0;En<_a;En++){const Ir=Number(Lo[En]);let $r=Lo[En+_a];$r=$r>>1n^-(1n&$r);for(let ir=cr;ir<cr+Ir;ir++)vr.get(ir)?br[ir]=$r:(br[ir]=0n,cr++);cr+=Ir}return br})(sn,Xt,Ni.runs):(function(vr,Lo,_a){const br=new BigInt64Array(vr.size());let cr=0;for(let En=0;En<_a;En++){const Ir=Number(Lo[En]),$r=Lo[En+_a];for(let ir=cr;ir<cr+Ir;ir++)vr.get(ir)?br[ir]=$r:(br[ir]=0n,cr++);cr+=Ir}return br})(sn,Xt,Ni.runs)})(ft,it,Ht,Gt);case ki.NONE:return ft=Ht?(function(Xt,Ft){const ni=new BigInt64Array(Xt.size());let sn=0,Ni=0;for(;Ni!=ni.length;++Ni)if(Xt.get(Ni)){const vr=Ft[sn++];ni[Ni]=vr>>1n^-(1n&vr)}else ni[Ni]=0n;return ni})(Gt,ft):(function(Xt,Ft){const ni=new BigInt64Array(Xt.size());let sn=0,Ni=0;for(;Ni!=ni.length;++Ni)ni[Ni]=Xt.get(Ni)?Ft[sn++]:0n;return ni})(Gt,ft),ft;default:throw new Error("The specified Logical level technique is not supported")}})(dm(gt,ut,xt.numValues),xt,Rt,wt)})(Q,te,pe,Me,xe):E_(Q,te,pe,Me);return new Jd(oe.name,Xe,xe)}if(Te===ga.SEQUENCE){const Xe=M_(Q,te,pe);return new Vg(oe.name,Xe[0],Xe[1],pe.numRleValues)}{const Xe=A_(Q,te,pe,Me);return new Hg(oe.name,Xe,xe)}})(E,P,V,W,F);case 7:return(function(Q,te,oe,xe){const le=zo(Q,te),pe=ad(xe)?(function(Te,Me,Xe,gt){const ut=Me.get(),xt=ut+gt*Float32Array.BYTES_PER_ELEMENT,Rt=new Uint8Array(Te.subarray(ut,xt)).buffer,wt=new Float32Array(Rt);Me.set(xt);const ft=Xe.size(),it=new Float32Array(ft);let Ht=0;for(let Gt=0;Gt<ft;Gt++)it[Gt]=Xe.get(Gt)?wt[Ht++]:0;return it})(Q,te,xe,le.numValues):(function(Te,Me,Xe){const gt=Me.get(),ut=gt+Xe*Float32Array.BYTES_PER_ELEMENT,xt=new Uint8Array(Te.subarray(gt,ut)).buffer,Rt=new Float32Array(xt);return Me.set(ut),Rt})(Q,te,le.numValues);return new L_(oe.name,pe,xe)})(E,P,V,W);case 8:return(function(Q,te,oe,xe){const le=zo(Q,te),pe=ad(xe)?(function(Te,Me,Xe,gt){const ut=Me.get(),xt=ut+gt*Float64Array.BYTES_PER_ELEMENT,Rt=new Uint8Array(Te.subarray(ut,xt)).buffer,wt=new Float64Array(Rt);Me.set(xt);const ft=Xe.size(),it=new Float64Array(ft);let Ht=0;for(let Gt=0;Gt<ft;Gt++)it[Gt]=Xe.get(Gt)?wt[Ht++]:0;return it})(Q,te,xe,le.numValues):(function(Te,Me,Xe){const gt=Me.get(),ut=gt+Xe*Float64Array.BYTES_PER_ELEMENT,xt=new Uint8Array(Te.subarray(gt,ut)).buffer,Rt=new Float64Array(xt);return Me.set(ut),Rt})(Q,te,le.numValues);return new np(oe.name,pe,xe)})(E,P,V,W);default:throw new Error(`The specified data type for the field is currently not supported: ${F}`)}})(u,n,e,p,i.scalarType,i):u!=1?null:(function(v,E,P,R){let F=null,V=null,Z=null,q=null,W=!1;for(;!W;){const xe=zo(v,E);switch(xe.physicalStreamType){case _r.LENGTH:Po.DICTIONARY===xe.logicalStreamType.lengthType?F=gh(v,E,xe):Z=gh(v,E,xe);break;case _r.DATA:vl.SINGLE===xe.logicalStreamType.dictionaryType||vl.SHARED===xe.logicalStreamType.dictionaryType?(V=v.subarray(E.get(),E.get()+xe.byteLength),W=!0):q=v.subarray(E.get(),E.get()+xe.byteLength),E.add(xe.byteLength)}}const Q=P.complexType.children,te=[];let oe=0;for(const xe of Q){const le=la(v,E,1)[0];if(le==0)continue;const pe=`${P.name}${xe.name==="default"?"":":"+xe.name}`;if(le!==2||xe.type!=="scalarField"||xe.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const Te=zo(v,E),Me=rd(v,Te.numValues,E),Xe=zo(v,E),gt=Xe.decompressedCount!==R?mm(v,E,Xe,!1,new Io(Me,Te.numValues)):yo(v,E,Xe,!1);te[oe++]=q?new bm(pe,gt,F,V,Z,q,new Io(Me,Te.numValues)):new _h(pe,gt,F,V,new Io(Me,Te.numValues))}return te})(n,e,i,p)}function ad(n){return n instanceof Io}function k_(n){if(n.name==="id")return!1;if(n.type==="scalarType"){const e=n.scalarType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(e.type==="logicalType")return!1}else if(n.type==="complexType"){const e=n.complexType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",n),!1}const Wg=new TextDecoder;function Tc(n,e){const i=la(n,e,1)[0];if(i===0)return"";const u=e.get(),p=n.subarray(u,u+i);return e.add(i),Wg.decode(p)}function Sc(n,e){const i=la(n,e,1)[0]>>>0,u=!!(4&i),p=!!(2&i),_=la(n,e,1)[0]>>>0,v={};if(1&i&&(v.nullable=!0),p){const E={};if(u?(E.type="logicalType",E.logicalType=_):(E.type="physicalType",E.physicalType=_),8&i){const P=la(n,e,1)[0]>>>0;E.children=new Array(P);for(let R=0;R<P;R++)E.children[R]=Sc(n,e)}v.type="complexField",v.complexField=E}else{const E={};u?(E.type="logicalType",E.logicalType=_):(E.type="physicalType",E.physicalType=_),v.type="scalarField",v.scalarField=E}return v}function vh(n,e){const i=la(n,e,1)[0]>>>0,u=(function(p){switch(p){case 0:case 1:case 2:case 3:{const _={};_.nullable=!!(1&p),_.columnScope=0;const v={};return v.physicalType=p>1?6:4,v.type="physicalType",_.scalarType=v,_.type="scalarType",_}case 4:{const _={nullable:!1,columnScope:0},v={type:"physicalType",physicalType:0};return _.type="complexType",_.complexType=v,_}case 30:{const _={nullable:!1,columnScope:0},v={type:"physicalType",physicalType:1};return _.type="complexType",_.complexType=v,_}default:return(function(_){let v=null;switch(_){case 10:case 11:v=0;break;case 12:case 13:v=1;break;case 14:case 15:v=2;break;case 16:case 17:v=3;break;case 18:case 19:v=4;break;case 20:case 21:v=5;break;case 22:case 23:v=6;break;case 24:case 25:v=7;break;case 26:case 27:v=8;break;case 28:case 29:v=9;break;default:return null}const E={};E.nullable=!!(1&_),E.columnScope=0;const P={type:"physicalType"};return P.physicalType=v,E.type="scalarType",E.scalarType=P,E})(p)}})(i);if(!u)throw new Error(`Unsupported column type code: ${i}`);if((function(p){return p>=10})(i)?u.name=Tc(n,e):i>=0&&i<=3?u.name="id":i===4&&(u.name="geometry"),(function(p){return p===30})(i)){const p=la(n,e,1)[0]>>>0,_=u.complexType;_.children=new Array(p);for(let v=0;v<p;v++)_.children[v]=Sc(n,e)}return u}function lp(n,e){const i={featureTables:[]},u={};u.name=Tc(n,e);const p=la(n,e,1)[0]>>>0,_=la(n,e,1)[0]>>>0;u.columns=new Array(_);for(let v=0;v<_;v++)u.columns[v]=vh(n,e);return i.featureTables.push(u),[i,p]}function up(n,e,i,u,p,_,v=!1){const E=e.scalarType.physicalType,P=wc(p,_,n,i);if(E===4)switch(P){case ga.FLAT:{const R=yo(n,i,p,!1);return new um(u,R,_)}case ga.SEQUENCE:{const R=S_(n,i,p);return new Bg(u,R[0],R[1],p.numRleValues)}case ga.CONST:{const R=Ug(n,i,p,!1);return new hm(u,R,_)}}else switch(P){case ga.FLAT:{if(v){const F=(function(V,Z,q,W){const Q=(function(te,oe,xe){const le=new Float64Array(oe);for(let pe=0;pe<oe;pe++)le[pe]=bl(te,xe);return le})(V,q.numValues,Z);return(function(te,oe,xe){switch(oe.logicalLevelTechnique1){case ki.DELTA:return oe.logicalLevelTechnique2===ki.RLE&&(te=Ng(te,oe.runs,oe.numRleValues)),(function(le){le[0]=le[0]%2==1?(le[0]+1)/-2:le[0]/2;const pe=le.length/4*4;let Te=1;if(pe>=4)for(;Te<pe-4;Te+=4){const Me=le[Te],Xe=le[Te+1],gt=le[Te+2],ut=le[Te+3];le[Te]=(Me%2==1?(Me+1)/-2:Me/2)+le[Te-1],le[Te+1]=(Xe%2==1?(Xe+1)/-2:Xe/2)+le[Te],le[Te+2]=(gt%2==1?(gt+1)/-2:gt/2)+le[Te+1],le[Te+3]=(ut%2==1?(ut+1)/-2:ut/2)+le[Te+2]}for(;Te!=le.length;++Te)le[Te]=(le[Te]%2==1?(le[Te]+1)/-2:le[Te]/2)+le[Te-1]})(te),te;case ki.RLE:return(function(le,pe,Te){return Ng(le,pe.runs,pe.numRleValues)})(te,oe);case ki.NONE:return te;default:throw new Error(`The specified Logical level technique is not supported: ${oe.logicalLevelTechnique1}`)}})(Q,q)})(n,i,p);return new np(u,F,_)}const R=E_(n,i,p,!1);return new Jd(u,R,_)}case ga.SEQUENCE:{const R=M_(n,i,p);return new Vg(u,R[0],R[1],p.numRleValues)}case ga.CONST:{const R=A_(n,i,p,!1);return new Hg(u,R,_)}}throw new Error("Vector type not supported for id column.")}class bh{constructor(e,i){var u;switch(this._featureData=e,this.properties=this._featureData.properties||{},(u=this._featureData.geometry)===null||u===void 0?void 0:u.type){case ya.POINT:case ya.MULTIPOINT:this.type=1;break;case ya.LINESTRING:case ya.MULTILINESTRING:this.type=2;break;case ya.POLYGON:case ya.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=i,this.id=Number(this._featureData.id)}loadGeometry(){const e=[];for(const i of this._featureData.geometry.coordinates){const u=[];for(const p of i)u.push(new k(p.x,p.y));e.push(u)}return e}}class d0{constructor(e){this.features=[],this.featureTable=e,this.name=e.name,this.extent=e.extent,this.version=2,this.features=e.getFeatures(),this.length=this.features.length}feature(e){return new bh(this.features[e],this.extent)}}class Kg{constructor(e){this.layers={};const i=(function(u,p,_=!0){const v=new w_(0),E=[];for(;v.get()<u.length;){const P=la(u,v,1)[0]>>>0,R=v.get()+P;if(R>u.length)throw new Error(`Block overruns tile: ${R} > ${u.length}`);if(la(u,v,1)[0]>>>0!=1){v.set(R);continue}const F=lp(u,v),V=F[1],Z=F[0].featureTables[0];let q=null,W=null;const Q=[];let te=0;for(const xe of Z.columns){const le=xe.name;if(le==="id"){let pe=null;if(xe.nullable){const Me=zo(u,v),Xe=v.get(),gt=rd(u,Me.numValues,v);v.set(Xe+Me.byteLength),pe=new Io(gt,Me.numValues)}const Te=zo(u,v);te=Te.decompressedCount,q=up(u,xe,v,le,Te,pe??te,_)}else if(le==="geometry"){const pe=la(u,v,1)[0];if(te===0){const Te=v.get();te=zo(u,v).decompressedCount,v.set(Te)}W=sp(u,pe,v,te)}else{const pe=k_(xe)?la(u,v,1)[0]:1;if(pe===0&&xe.type==="scalarType")continue;const Te=xm(u,v,xe,pe,te);if(Te)if(Array.isArray(Te))for(const Me of Te)Q.push(Me);else Q.push(Te)}}const oe=new c0(Z.name,W,q,Q,V);E.push(oe),v.set(R)}return E})(new Uint8Array(e));this.layers=i.reduce(((u,p)=>Object.assign(Object.assign({},u),{[p.name]:new d0(p)})),{})}}class nu{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){const i=new nu;return i.extend(e(new k(this.minX,this.minY))),i.extend(e(new k(this.maxX,this.minY))),i.extend(e(new k(this.minX,this.maxY))),i.extend(e(new k(this.maxX,this.maxY))),i}static fromPoints(e){const i=new nu;for(const u of e)i.extend(u);return i}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}}class f0{constructor(e,i){this.feature=e,this.type=e.type,this.properties=e.tags?e.tags:{},this.extent=i,"id"in e&&(typeof e.id=="string"?this.id=parseInt(e.id,10):typeof e.id!="number"||isNaN(e.id)||(this.id=e.id))}loadGeometry(){const e=[],i=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const u of i){const p=[];for(const _ of u)p.push(new k(_[0],_[1]));e.push(p)}return e}}const af="_geojsonTileLayer";function wm(n,e){e.writeVarintField(15,n.version||1),e.writeStringField(1,n.name||""),e.writeVarintField(5,n.extent||4096);const i={keys:[],values:[],keycache:{},valuecache:{}};for(let _=0;_<n.length;_++)i.feature=n.feature(_),e.writeMessage(2,O_,i);const u=i.keys;for(const _ of u)e.writeStringField(3,_);const p=i.values;for(const _ of p)e.writeMessage(4,sf,_)}function O_(n,e){if(!n.feature)return;const i=n.feature;i.id!==void 0&&e.writeVarintField(1,i.id),e.writeMessage(2,p0,n),e.writeVarintField(3,i.type),e.writeMessage(4,B_,i)}function p0(n,e){for(const i in n.feature?.properties){let u=n.feature.properties[i],p=n.keycache[i];if(u===null)continue;p===void 0&&(n.keys.push(i),p=n.keys.length-1,n.keycache[i]=p),e.writeVarint(p),typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"&&(u=JSON.stringify(u));const _=typeof u+":"+u;let v=n.valuecache[_];v===void 0&&(n.values.push(u),v=n.values.length-1,n.valuecache[_]=v),e.writeVarint(v)}}function of(n,e){return(e<<3)+(7&n)}function cp(n){return n<<1^n>>31}function B_(n,e){const i=n.loadGeometry(),u=n.type;let p=0,_=0;for(const v of i){let E=1;u===1&&(E=v.length),e.writeVarint(of(1,E));const P=u===3?v.length-1:v.length;for(let R=0;R<P;R++){R===1&&u!==1&&e.writeVarint(of(2,P-1));const F=v[R].x-p,V=v[R].y-_;e.writeVarint(cp(F)),e.writeVarint(cp(V)),p+=F,_+=V}n.type===3&&e.writeVarint(of(7,1))}}function sf(n,e){const i=typeof n;i==="string"?e.writeStringField(1,n):i==="boolean"?e.writeBooleanField(7,n):i==="number"&&(n%1!=0?e.writeDoubleField(3,n):n<0?e.writeSVarintField(6,n):e.writeVarintField(5,n))}class Jg{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Mu(ei,16,0),this.grid3D=new Mu(ei,16,0),this.featureIndexArray=new X,this.promoteId=i}insert(e,i,u,p,_,v){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,_);const P=v?this.grid3D:this.grid;for(let R=0;R<i.length;R++){const F=i[R],V=[1/0,1/0,-1/0,-1/0];for(let Z=0;Z<F.length;Z++){const q=F[Z];V[0]=Math.min(V[0],q.x),V[1]=Math.min(V[1],q.y),V[2]=Math.max(V[2],q.x),V[3]=Math.max(V[3],q.y)}V[0]<ei&&V[1]<ei&&V[2]>=0&&V[3]>=0&&P.insert(E,V[0],V[1],V[2],V[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new wn(new $f(this.rawTileData)).layers:new Kg(this.rawTileData).layers,this.sourceLayerCoder=new sm(this.vtLayers?Object.keys(this.vtLayers).sort():[af])),this.vtLayers}query(e,i,u,p){this.loadVTLayers();const _=e.params,v=ei/e.tileSize/e.scale,E=jt(_.filter,_.globalState),P=e.queryGeometry,R=e.queryPadding*v,F=nu.fromPoints(P),V=this.grid.query(F.minX-R,F.minY-R,F.maxX+R,F.maxY+R),Z=nu.fromPoints(e.cameraQueryGeometry).expandBy(R),q=this.grid3D.query(Z.minX,Z.minY,Z.maxX,Z.maxY,((te,oe,xe,le)=>(function(pe,Te,Me,Xe,gt){for(const xt of pe)if(Te<=xt.x&&Me<=xt.y&&Xe>=xt.x&&gt>=xt.y)return!0;const ut=[new k(Te,Me),new k(Te,gt),new k(Xe,gt),new k(Xe,Me)];if(pe.length>2){for(const xt of ut)if(Hh(pe,xt))return!0}for(let xt=0;xt<pe.length-1;xt++)if($y(pe[xt],pe[xt+1],ut))return!0;return!1})(e.cameraQueryGeometry,te-R,oe-R,xe+R,le+R)));for(const te of q)V.push(te);V.sort(Sm);const W={};let Q;for(let te=0;te<V.length;te++){const oe=V[te];if(oe===Q)continue;Q=oe;const xe=this.featureIndexArray.get(oe);let le=null;this.loadMatchingFeature(W,xe.bucketIndex,xe.sourceLayerIndex,xe.featureIndex,E,_.layers,_.availableImages,i,u,p,((pe,Te,Me)=>(le||(le=Jo(pe)),Te.queryIntersectsFeature({queryGeometry:P,feature:pe,featureState:Me,geometry:le,zoom:this.z,transform:e.transform,pixelsToTileUnits:v,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation}))))}return W}loadMatchingFeature(e,i,u,p,_,v,E,P,R,F,V){const Z=this.bucketLayerIDs[i];if(v&&!Z.some((te=>v.has(te))))return;const q=this.sourceLayerCoder.decode(u),W=this.vtLayers[q].feature(p);if(_.needGeometry){const te=Lu(W,!0);if(!_.filter(new $i(this.tileID.overscaledZ),te,this.tileID.canonical))return}else if(!_.filter(new $i(this.tileID.overscaledZ),W))return;const Q=this.getId(W,q);for(let te=0;te<Z.length;te++){const oe=Z[te];if(v&&!v.has(oe))continue;const xe=P[oe];if(!xe)continue;let le={};Q&&F&&(le=F.getState(xe.sourceLayer||af,Q));const pe=Ei({},R[oe]);pe.paint=Tm(pe.paint,xe.paint,W,le,E),pe.layout=Tm(pe.layout,xe.layout,W,le,E);const Te=!V||V(W,xe,le);if(!Te)continue;const Me=new lm(W,this.z,this.x,this.y,Q);Me.layer=pe;let Xe=e[oe];Xe===void 0&&(Xe=e[oe]=[]),Xe.push({featureIndex:p,feature:Me,intersectionZ:Te})}}lookupSymbolFeatures(e,i,u,p,_,v,E,P){const R={};this.loadVTLayers();const F=jt(_.filterSpec,_.globalState);for(const V of e)this.loadMatchingFeature(R,u,p,V,F,v,E,P,i);return R}hasLayer(e){for(const i of this.bucketLayerIDs)for(const u of i)if(e===u)return!0;return!1}getId(e,i){var u;let p=e.id;return this.promoteId&&(p=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof p=="boolean"&&(p=Number(p)),p===void 0&&(!((u=e.properties)===null||u===void 0)&&u.cluster)&&this.promoteId&&(p=Number(e.properties.cluster_id))),p}}function Tm(n,e,i,u,p){return hr(n,((_,v)=>{const E=e instanceof sc?e.get(v):null;return E&&E.evaluate?E.evaluate(i,u,p):E}))}function Sm(n,e){return e-n}function Qg(n,e,i,u,p){const _=[];for(let v=0;v<n.length;v++){const E=n[v];let P;for(let R=0;R<E.length-1;R++){let F=E[R],V=E[R+1];F.x<e&&V.x<e||(F.x<e?F=new k(e,F.y+(e-F.x)/(V.x-F.x)*(V.y-F.y))._round():V.x<e&&(V=new k(e,F.y+(e-F.x)/(V.x-F.x)*(V.y-F.y))._round()),F.y<i&&V.y<i||(F.y<i?F=new k(F.x+(i-F.y)/(V.y-F.y)*(V.x-F.x),i)._round():V.y<i&&(V=new k(F.x+(i-F.y)/(V.y-F.y)*(V.x-F.x),i)._round()),F.x>=u&&V.x>=u||(F.x>=u?F=new k(u,F.y+(u-F.x)/(V.x-F.x)*(V.y-F.y))._round():V.x>=u&&(V=new k(u,F.y+(u-F.x)/(V.x-F.x)*(V.y-F.y))._round()),F.y>=p&&V.y>=p||(F.y>=p?F=new k(F.x+(p-F.y)/(V.y-F.y)*(V.x-F.x),p)._round():V.y>=p&&(V=new k(F.x+(p-F.y)/(V.y-F.y)*(V.x-F.x),p)._round()),P&&F.equals(P[P.length-1])||(P=[F],_.push(P)),P.push(V)))))}}return _}function F_(n,e,i,u,p){switch(e){case 1:return(function(_,v,E,P){const R=[];for(const F of _)for(const V of F){const Z=P===0?V.x:V.y;Z>=v&&Z<=E&&R.push([V])}return R})(n,i,u,p);case 2:return r(n,i,u,p,!1);case 3:return r(n,i,u,p,!0)}return[]}function Mm(n,e,i,u,p){const _=u===0?l:m;let v=[];const E=[];for(let F=0;F<n.length-1;F++){const V=n[F],Z=n[F+1],q=u===0?V.x:V.y,W=u===0?Z.x:Z.y;let Q=!1;q<e?W>e&&v.push(_(V,Z,e)):q>i?W<i&&v.push(_(V,Z,i)):v.push(V),W<e&&q>=e&&(v.push(_(V,Z,e)),Q=!0),W>i&&q<=i&&(v.push(_(V,Z,i)),Q=!0),!p&&Q&&(E.push(v),v=[])}const P=n.length-1,R=u===0?n[P].x:n[P].y;return R>=e&&R<=i&&v.push(n[P]),p&&v.length>0&&!v[0].equals(v[v.length-1])&&v.push(new k(v[0].x,v[0].y)),v.length>0&&E.push(v),E}function r(n,e,i,u,p){const _=[];for(const v of n){const E=Mm(v,e,i,u,p);E.length>0&&_.push(...E)}return _}function l(n,e,i){return new k(i,n.y+(i-n.x)/(e.x-n.x)*(e.y-n.y))}function m(n,e,i){return new k(n.x+(i-n.y)/(e.y-n.y)*(e.x-n.x),i)}Ot("FeatureIndex",Jg,{omit:["rawTileData","sourceLayerCoder"]});class T extends k{constructor(e,i,u,p){super(e,i),this.angle=u,p!==void 0&&(this.segment=p)}clone(){return new T(this.x,this.y,this.angle,this.segment)}}function I(n,e,i,u,p){if(e.segment===void 0||i===0)return!0;let _=e,v=e.segment+1,E=0;for(;E>-i/2;){if(v--,v<0)return!1;E-=n[v].dist(_),_=n[v]}E+=n[v].dist(n[v+1]),v++;const P=[];let R=0;for(;E<i/2;){const F=n[v],V=n[v+1];if(!V)return!1;let Z=n[v-1].angleTo(F)-F.angleTo(V);for(Z=Math.abs((Z+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:E,angleDelta:Z}),R+=Z;E-P[0].distance>u;)R-=P.shift().angleDelta;if(R>p)return!1;v++,E+=F.dist(V)}return!0}function B(n){let e=0;for(let i=0;i<n.length-1;i++)e+=n[i].dist(n[i+1]);return e}function J(n,e,i){return n?.6*e*i:0}function he(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function De(n,e,i,u,p,_){const v=J(i,p,_),E=he(i,u)*_;let P=0;const R=B(n)/2;for(let F=0;F<n.length-1;F++){const V=n[F],Z=n[F+1],q=V.dist(Z);if(P+q>R){const W=(R-P)/q,Q=On.number(V.x,Z.x,W),te=On.number(V.y,Z.y,W),oe=new T(Q,te,Z.angleTo(V),F);return oe._round(),!v||I(n,oe,E,v,e)?oe:void 0}P+=q}}function at(n,e,i,u,p,_,v,E,P){const R=J(u,_,v),F=he(u,p),V=F*v,Z=n[0].x===0||n[0].x===P||n[0].y===0||n[0].y===P;return e-V<e/4&&(e=V+e/4),yt(n,Z?e/2*E%e:(F/2+2*_)*v*E%e,e,R,i,V,Z,!1,P)}function yt(n,e,i,u,p,_,v,E,P){const R=_/2,F=B(n);let V=0,Z=e-i,q=[];for(let W=0;W<n.length-1;W++){const Q=n[W],te=n[W+1],oe=Q.dist(te),xe=te.angleTo(Q);for(;Z+i<V+oe;){Z+=i;const le=(Z-V)/oe,pe=On.number(Q.x,te.x,le),Te=On.number(Q.y,te.y,le);if(pe>=0&&pe<P&&Te>=0&&Te<P&&Z-R>=0&&Z+R<=F){const Me=new T(pe,Te,xe,W);Me._round(),u&&!I(n,Me,_,u,p)||q.push(Me)}}V+=oe}return E||q.length||v||(q=yt(n,V/2,i,u,p,_,v,!0,P)),q}function St(n,e,i,u){const p=[],_=n.image,v=_.pixelRatio,E=_.paddedRect.w-2,P=_.paddedRect.h-2;let R={x1:n.left,y1:n.top,x2:n.right,y2:n.bottom};const F=_.stretchX||[[0,E]],V=_.stretchY||[[0,P]],Z=(it,Ht)=>it+Ht[1]-Ht[0],q=F.reduce(Z,0),W=V.reduce(Z,0),Q=E-q,te=P-W;let oe=0,xe=q,le=0,pe=W,Te=0,Me=Q,Xe=0,gt=te;if(_.content&&u){const it=_.content,Ht=it[2]-it[0],Gt=it[3]-it[1];(_.textFitWidth||_.textFitHeight)&&(R=em(n)),oe=st(F,0,it[0]),le=st(V,0,it[1]),xe=st(F,it[0],it[2]),pe=st(V,it[1],it[3]),Te=it[0]-oe,Xe=it[1]-le,Me=Ht-xe,gt=Gt-pe}const ut=R.x1,xt=R.y1,Rt=R.x2-ut,wt=R.y2-xt,ft=(it,Ht,Gt,Xt)=>{const Ft=ti(it.stretch-oe,xe,Rt,ut),ni=mi(it.fixed-Te,Me,it.stretch,q),sn=ti(Ht.stretch-le,pe,wt,xt),Ni=mi(Ht.fixed-Xe,gt,Ht.stretch,W),vr=ti(Gt.stretch-oe,xe,Rt,ut),Lo=mi(Gt.fixed-Te,Me,Gt.stretch,q),_a=ti(Xt.stretch-le,pe,wt,xt),br=mi(Xt.fixed-Xe,gt,Xt.stretch,W),cr=new k(Ft,sn),En=new k(vr,sn),Ir=new k(vr,_a),$r=new k(Ft,_a),ir=new k(ni/v,Ni/v),qs=new k(Lo/v,br/v),Do=e*Math.PI/180;if(Do){const Qa=Math.sin(Do),Sr=Math.cos(Do),va=[Sr,-Qa,Qa,Sr];cr._matMult(va),En._matMult(va),$r._matMult(va),Ir._matMult(va)}const $s=it.stretch+it.fixed,Bu=Ht.stretch+Ht.fixed;return{tl:cr,tr:En,bl:$r,br:Ir,tex:{x:_.paddedRect.x+1+$s,y:_.paddedRect.y+1+Bu,w:Gt.stretch+Gt.fixed-$s,h:Xt.stretch+Xt.fixed-Bu},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ir,pixelOffsetBR:qs,minFontScaleX:Me/v/Rt,minFontScaleY:gt/v/wt,isSDF:i}};if(u&&(_.stretchX||_.stretchY)){const it=ht(F,Q,q),Ht=ht(V,te,W);for(let Gt=0;Gt<it.length-1;Gt++){const Xt=it[Gt],Ft=it[Gt+1];for(let ni=0;ni<Ht.length-1;ni++)p.push(ft(Xt,Ht[ni],Ft,Ht[ni+1]))}}else p.push(ft({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:P+1}));return p}function st(n,e,i){let u=0;for(const p of n)u+=Math.max(e,Math.min(i,p[1]))-Math.max(e,Math.min(i,p[0]));return u}function ht(n,e,i){const u=[{fixed:-1,stretch:0}];for(const[p,_]of n){const v=u[u.length-1];u.push({fixed:p-v.stretch,stretch:v.stretch}),u.push({fixed:p-v.stretch,stretch:v.stretch+(_-p)})}return u.push({fixed:e+1,stretch:i}),u}function ti(n,e,i,u){return n/e*i+u}function mi(n,e,i,u){return n-e*i/u}Ot("Anchor",T);class Dn{constructor(e,i,u,p,_,v,E,P,R,F){var V;if(this.boxStartIndex=e.length,R){let Z=v.top,q=v.bottom;const W=v.collisionPadding;W&&(Z-=W[1],q+=W[3]);let Q=q-Z;Q>0&&(Q=Math.max(10,Q),this.circleDiameter=Q)}else{const Z=!((V=v.image)===null||V===void 0)&&V.content&&(v.image.textFitWidth||v.image.textFitHeight)?em(v):{x1:v.left,y1:v.top,x2:v.right,y2:v.bottom};Z.y1=Z.y1*E-P[0],Z.y2=Z.y2*E+P[2],Z.x1=Z.x1*E-P[3],Z.x2=Z.x2*E+P[1];const q=v.collisionPadding;if(q&&(Z.x1-=q[0]*E,Z.y1-=q[1]*E,Z.x2+=q[2]*E,Z.y2+=q[3]*E),F){const W=new k(Z.x1,Z.y1),Q=new k(Z.x2,Z.y1),te=new k(Z.x1,Z.y2),oe=new k(Z.x2,Z.y2),xe=F*Math.PI/180;W._rotate(xe),Q._rotate(xe),te._rotate(xe),oe._rotate(xe),Z.x1=Math.min(W.x,Q.x,te.x,oe.x),Z.x2=Math.max(W.x,Q.x,te.x,oe.x),Z.y1=Math.min(W.y,Q.y,te.y,oe.y),Z.y2=Math.max(W.y,Q.y,te.y,oe.y)}e.emplaceBack(i.x,i.y,Z.x1,Z.y1,Z.x2,Z.y2,u,p,_)}this.boxEndIndex=e.length}}class Ge{constructor(e=[],i=(u,p)=>u<p?-1:u>p?1:0){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:u}=this,p=i[e];for(;e>0;){const _=e-1>>1,v=i[_];if(u(p,v)>=0)break;i[e]=v,e=_}i[e]=p}_down(e){const{data:i,compare:u}=this,p=this.length>>1,_=i[e];for(;e<p;){let v=1+(e<<1);const E=v+1;if(E<this.length&&u(i[E],i[v])<0&&(v=E),u(i[v],_)>=0)break;i[e]=i[v],e=v}i[e]=_}}function Oe(n,e=1,i=!1){const u=nu.fromPoints(n[0]),p=Math.min(u.width(),u.height());let _=p/2;const v=new Ge([],nt),{minX:E,minY:P,maxX:R,maxY:F}=u;if(p===0)return new k(E,P);for(let q=E;q<R;q+=p)for(let W=P;W<F;W+=p)v.push(new vt(q+_,W+_,_,n));let V=(function(q){let W=0,Q=0,te=0;const oe=q[0];for(let xe=0,le=oe.length,pe=le-1;xe<le;pe=xe++){const Te=oe[xe],Me=oe[pe],Xe=Te.x*Me.y-Me.x*Te.y;Q+=(Te.x+Me.x)*Xe,te+=(Te.y+Me.y)*Xe,W+=3*Xe}return new vt(Q/W,te/W,0,q)})(n),Z=v.length;for(;v.length;){const q=v.pop();(q.d>V.d||!V.d)&&(V=q,i&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,Z)),q.max-V.d<=e||(_=q.h/2,v.push(new vt(q.p.x-_,q.p.y-_,_,n)),v.push(new vt(q.p.x+_,q.p.y-_,_,n)),v.push(new vt(q.p.x-_,q.p.y+_,_,n)),v.push(new vt(q.p.x+_,q.p.y+_,_,n)),Z+=4)}return i&&(console.log(`num probes: ${Z}`),console.log(`best distance: ${V.d}`)),V.p}function nt(n,e){return e.max-n.max}function vt(n,e,i,u){this.p=new k(n,e),this.h=i,this.d=(function(p,_){let v=!1,E=1/0;for(let P=0;P<_.length;P++){const R=_[P];for(let F=0,V=R.length,Z=V-1;F<V;Z=F++){const q=R[F],W=R[Z];q.y>p.y!=W.y>p.y&&p.x<(W.x-q.x)*(p.y-q.y)/(W.y-q.y)+q.x&&(v=!v),E=Math.min(E,Ka(p,q,W))}}return(v?1:-1)*Math.sqrt(E)})(this.p,u),this.max=this.d+this.h*Math.SQRT2}var Qt;w.aQ=void 0,(Qt=w.aQ||(w.aQ={}))[Qt.center=1]="center",Qt[Qt.left=2]="left",Qt[Qt.right=3]="right",Qt[Qt.top=4]="top",Qt[Qt.bottom=5]="bottom",Qt[Qt["top-left"]=6]="top-left",Qt[Qt["top-right"]=7]="top-right",Qt[Qt["bottom-left"]=8]="bottom-left",Qt[Qt["bottom-right"]=9]="bottom-right";const yn=Number.POSITIVE_INFINITY;function oi(n,e){return e[1]!==yn?(function(i,u,p){let _=0,v=0;switch(u=Math.abs(u),p=Math.abs(p),i){case"top-right":case"top-left":case"top":v=p-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-p}switch(i){case"top-right":case"bottom-right":case"right":_=-u;break;case"top-left":case"bottom-left":case"left":_=u}return[_,v]})(n,e[0],e[1]):(function(i,u){let p=0,_=0;u<0&&(u=0);const v=u/Math.SQRT2;switch(i){case"top-right":case"top-left":_=v-7;break;case"bottom-right":case"bottom-left":_=7-v;break;case"bottom":_=7-u;break;case"top":_=u-7}switch(i){case"top-right":case"bottom-right":p=-v;break;case"top-left":case"bottom-left":p=v;break;case"left":p=u;break;case"right":p=-u}return[p,_]})(n,e[0])}function Oi(n,e,i){var u;const p=n.layout,_=(u=p.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(e,{},i);if(_){const E=_.values,P=[];for(let R=0;R<E.length;R+=2){const F=P[R]=E[R],V=E[R+1].map((Z=>Z*Tn));F.startsWith("top")?V[1]-=7:F.startsWith("bottom")&&(V[1]+=7),P[R+1]=V}return new Bn(P)}const v=p.get("text-variable-anchor");if(v){let E;E=n._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(e,{},i)*Tn,yn]:p.get("text-offset").evaluate(e,{},i).map((R=>R*Tn));const P=[];for(const R of v)P.push(R,oi(R,E));return new Bn(P)}return null}function Ki(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Mn(n,e,i,u,p,_,v,E,P,R,F,V){let Z=_.textMaxSize.evaluate(e,{});Z===void 0&&(Z=v);const q=n.layers[0].layout,W=q.get("icon-offset").evaluate(e,{},F),Q=N_(i.horizontal),te=v/24,oe=n.tilePixelRatio*te,xe=n.tilePixelRatio*Z/24,le=n.tilePixelRatio*E,pe=n.tilePixelRatio*q.get("symbol-spacing"),Te=q.get("text-padding")*n.tilePixelRatio,Me=(function(Gt,Xt,Ft,ni=1){const sn=Gt.get("icon-padding").evaluate(Xt,{},Ft),Ni=sn&&sn.values;return[Ni[0]*ni,Ni[1]*ni,Ni[2]*ni,Ni[3]*ni]})(q,e,F,n.tilePixelRatio),Xe=q.get("text-max-angle")/180*Math.PI,gt=q.get("text-rotation-alignment")!=="viewport"&&q.get("symbol-placement")!=="point",ut=q.get("icon-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",xt=q.get("symbol-placement"),Rt=pe/2,wt=q.get("icon-text-fit");let ft;u&&wt!=="none"&&(n.allowVerticalPlacement&&i.vertical&&(ft=Xf(u,i.vertical,wt,q.get("icon-text-fit-padding"),W,te)),Q&&(u=Xf(u,Q,wt,q.get("icon-text-fit-padding"),W,te)));const it=F?V.line.getGranularityForZoomLevel(F.z):1,Ht=(Gt,Xt)=>{Xt.x<0||Xt.x>=ei||Xt.y<0||Xt.y>=ei||(function(Ft,ni,sn,Ni,vr,Lo,_a,br,cr,En,Ir,$r,ir,qs,Do,$s,Bu,Qa,Sr,va,Lr,eo,od,Ec,iy){const lf=Ft.addToLineVertexArray(ni,sn);let hp,Em,Am,Cm,jx=0,Ux=0,Vx=0,Gx=0,w0=-1,T0=-1;const sd={};let Zx=jn("");if(Ft.allowVerticalPlacement&&Ni.vertical){const is=br.layout.get("text-rotate").evaluate(Lr,{},Ec)+90;Am=new Dn(cr,ni,En,Ir,$r,Ni.vertical,ir,qs,Do,is),_a&&(Cm=new Dn(cr,ni,En,Ir,$r,_a,Bu,Qa,Do,is))}if(vr){const is=br.layout.get("icon-rotate").evaluate(Lr,{}),ru=br.layout.get("icon-text-fit")!=="none",dp=St(vr,is,od,ru),Cc=_a?St(_a,is,od,ru):void 0;Em=new Dn(cr,ni,En,Ir,$r,vr,Bu,Qa,!1,is),jx=4*dp.length;const fp=Ft.iconSizeData;let xh=null;fp.kind==="source"?(xh=[eu*br.layout.get("icon-size").evaluate(Lr,{})],xh[0]>Qo&&Rn(`${Ft.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):fp.kind==="composite"&&(xh=[eu*eo.compositeIconSizes[0].evaluate(Lr,{},Ec),eu*eo.compositeIconSizes[1].evaluate(Lr,{},Ec)],(xh[0]>Qo||xh[1]>Qo)&&Rn(`${Ft.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ft.addSymbols(Ft.icon,dp,xh,va,Sr,Lr,w.aA.none,ni,lf.lineStartIndex,lf.lineLength,-1,Ec),w0=Ft.icon.placedSymbolArray.length-1,Cc&&(Ux=4*Cc.length,Ft.addSymbols(Ft.icon,Cc,xh,va,Sr,Lr,w.aA.vertical,ni,lf.lineStartIndex,lf.lineLength,-1,Ec),T0=Ft.icon.placedSymbolArray.length-1)}const qx=Object.keys(Ni.horizontal);for(const is of qx){const ru=Ni.horizontal[is];if(!hp){Zx=jn(ru.text);const Cc=br.layout.get("text-rotate").evaluate(Lr,{},Ec);hp=new Dn(cr,ni,En,Ir,$r,ru,ir,qs,Do,Cc)}const dp=ru.positionedLines.length===1;if(Vx+=Mc(Ft,ni,ru,Lo,br,Do,Lr,$s,lf,Ni.vertical?w.aA.horizontal:w.aA.horizontalOnly,dp?qx:[is],sd,w0,eo,Ec),dp)break}Ni.vertical&&(Gx+=Mc(Ft,ni,Ni.vertical,Lo,br,Do,Lr,$s,lf,w.aA.vertical,["vertical"],sd,T0,eo,Ec));const hS=hp?hp.boxStartIndex:Ft.collisionBoxArray.length,dS=hp?hp.boxEndIndex:Ft.collisionBoxArray.length,fS=Am?Am.boxStartIndex:Ft.collisionBoxArray.length,pS=Am?Am.boxEndIndex:Ft.collisionBoxArray.length,mS=Em?Em.boxStartIndex:Ft.collisionBoxArray.length,gS=Em?Em.boxEndIndex:Ft.collisionBoxArray.length,yS=Cm?Cm.boxStartIndex:Ft.collisionBoxArray.length,_S=Cm?Cm.boxEndIndex:Ft.collisionBoxArray.length;let Ac=-1;const U_=(is,ru)=>is&&is.circleDiameter?Math.max(is.circleDiameter,ru):ru;Ac=U_(hp,Ac),Ac=U_(Am,Ac),Ac=U_(Em,Ac),Ac=U_(Cm,Ac);const $x=Ac>-1?1:0;$x&&(Ac*=iy/Tn),Ft.glyphOffsetArray.length>=fh.MAX_GLYPHS&&Rn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Lr.sortKey!==void 0&&Ft.addToSortKeyRanges(Ft.symbolInstances.length,Lr.sortKey);const vS=Oi(br,Lr,Ec),[bS,xS]=(function(is,ru){const dp=is.length,Cc=ru?.values;if(Cc?.length>0)for(let fp=0;fp<Cc.length;fp+=2){const xh=Cc[fp+1];is.emplaceBack(w.aQ[Cc[fp]],xh[0],xh[1])}return[dp,is.length]})(Ft.textAnchorOffsets,vS);Ft.symbolInstances.emplaceBack(ni.x,ni.y,sd.right>=0?sd.right:-1,sd.center>=0?sd.center:-1,sd.left>=0?sd.left:-1,sd.vertical||-1,w0,T0,Zx,hS,dS,fS,pS,mS,gS,yS,_S,En,Vx,Gx,jx,Ux,$x,0,ir,Ac,bS,xS)})(n,Xt,Gt,i,u,p,ft,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,oe,[Te,Te,Te,Te],gt,P,le,Me,ut,W,e,_,R,F,v)};if(xt==="line")for(const Gt of Qg(e.geometry,0,0,ei,ei)){const Xt=js(Gt,it),Ft=at(Xt,pe,Xe,i.vertical||Q,u,24,xe,n.overscaling,ei);for(const ni of Ft)Q&&uS(n,Q.text,Rt,ni)||Ht(Xt,ni)}else if(xt==="line-center"){for(const Gt of e.geometry)if(Gt.length>1){const Xt=js(Gt,it),Ft=De(Xt,Xe,i.vertical||Q,u,24,xe);Ft&&Ht(Xt,Ft)}}else if(e.type==="Polygon")for(const Gt of Ll(e.geometry,0)){const Xt=Oe(Gt,16);Ht(js(Gt[0],it,!0),new T(Xt.x,Xt.y,0))}else if(e.type==="LineString")for(const Gt of e.geometry){const Xt=js(Gt,it);Ht(Xt,new T(Xt[0].x,Xt[0].y,0))}else if(e.type==="Point")for(const Gt of e.geometry)for(const Xt of Gt)Ht([Xt],new T(Xt.x,Xt.y,0))}function Mc(n,e,i,u,p,_,v,E,P,R,F,V,Z,q,W){const Q=(function(xe,le,pe,Te,Me,Xe,gt,ut){const xt=Te.layout.get("text-rotate").evaluate(Xe,{})*Math.PI/180,Rt=[];for(const wt of le.positionedLines)for(const ft of wt.positionedGlyphs){if(!ft.rect)continue;const it=ft.rect||{};let Ht=4,Gt=!0,Xt=1,Ft=0;const ni=(Me||ut)&&ft.vertical,sn=ft.metrics.advance*ft.scale/2;if(ut&&le.verticalizable&&(Ft=wt.lineOffset/2-(ft.imageName?-(Tn-ft.metrics.width*ft.scale)/2:(ft.scale-1)*Tn)),ft.imageName){const Qa=gt[ft.imageName];Gt=Qa.sdf,Xt=Qa.pixelRatio,Ht=1/Xt}const Ni=Me?[ft.x+sn,ft.y]:[0,0];let vr=Me?[0,0]:[ft.x+sn+pe[0],ft.y+pe[1]-Ft],Lo=[0,0];ni&&(Lo=vr,vr=[0,0]);const _a=ft.metrics.isDoubleResolution?2:1,br=(ft.metrics.left-Ht)*ft.scale-sn+vr[0],cr=(-ft.metrics.top-Ht)*ft.scale+vr[1],En=br+it.w/_a*ft.scale/Xt,Ir=cr+it.h/_a*ft.scale/Xt,$r=new k(br,cr),ir=new k(En,cr),qs=new k(br,Ir),Do=new k(En,Ir);if(ni){const Qa=new k(-sn,sn- -17),Sr=-Math.PI/2,va=12-sn,Lr=new k(22-va,-(ft.imageName?va:0)),eo=new k(...Lo);$r._rotateAround(Sr,Qa)._add(Lr)._add(eo),ir._rotateAround(Sr,Qa)._add(Lr)._add(eo),qs._rotateAround(Sr,Qa)._add(Lr)._add(eo),Do._rotateAround(Sr,Qa)._add(Lr)._add(eo)}if(xt){const Qa=Math.sin(xt),Sr=Math.cos(xt),va=[Sr,-Qa,Qa,Sr];$r._matMult(va),ir._matMult(va),qs._matMult(va),Do._matMult(va)}const $s=new k(0,0),Bu=new k(0,0);Rt.push({tl:$r,tr:ir,bl:qs,br:Do,tex:it,writingMode:le.writingMode,glyphOffset:Ni,sectionIndex:ft.sectionIndex,isSDF:Gt,pixelOffsetTL:$s,pixelOffsetBR:Bu,minFontScaleX:0,minFontScaleY:0})}return Rt})(0,i,E,p,_,v,u,n.allowVerticalPlacement),te=n.textSizeData;let oe=null;te.kind==="source"?(oe=[eu*p.layout.get("text-size").evaluate(v,{})],oe[0]>Qo&&Rn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):te.kind==="composite"&&(oe=[eu*q.compositeTextSizes[0].evaluate(v,{},W),eu*q.compositeTextSizes[1].evaluate(v,{},W)],(oe[0]>Qo||oe[1]>Qo)&&Rn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,Q,oe,E,_,v,R,e,P.lineStartIndex,P.lineLength,Z,W);for(const xe of F)V[xe]=n.text.placedSymbolArray.length-1;return 4*Q.length}function N_(n){for(const e in n)return n[e];return null}function uS(n,e,i,u){const p=n.compareText;if(e in p){const _=p[e];for(let v=_.length-1;v>=0;v--)if(u.dist(_[v])<i)return!0}else p[e]=[];return p[e].push(u),!1}const Bx=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class m0{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,u]=new Uint8Array(e,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=u>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const _=Bx[15&u];if(!_)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(e,2,1),[E]=new Uint32Array(e,4,1);return new m0(E,v,_,e)}constructor(e,i=64,u=Float64Array,p){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=u,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const _=Bx.indexOf(this.ArrayType),v=2*e*this.ArrayType.BYTES_PER_ELEMENT,E=e*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-E%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${u}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+E+P,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+v+E+P),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+E+P,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=e,this.coords[this._pos++]=i,u}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return g0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,u,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:v,nodeSize:E}=this,P=[0,_.length-1,0],R=[];for(;P.length;){const F=P.pop()||0,V=P.pop()||0,Z=P.pop()||0;if(V-Z<=E){for(let te=Z;te<=V;te++){const oe=v[2*te],xe=v[2*te+1];oe>=e&&oe<=u&&xe>=i&&xe<=p&&R.push(_[te])}continue}const q=Z+V>>1,W=v[2*q],Q=v[2*q+1];W>=e&&W<=u&&Q>=i&&Q<=p&&R.push(_[q]),(F===0?e<=W:i<=Q)&&(P.push(Z),P.push(q-1),P.push(1-F)),(F===0?u>=W:p>=Q)&&(P.push(q+1),P.push(V),P.push(1-F))}return R}within(e,i,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:_,nodeSize:v}=this,E=[0,p.length-1,0],P=[],R=u*u;for(;E.length;){const F=E.pop()||0,V=E.pop()||0,Z=E.pop()||0;if(V-Z<=v){for(let te=Z;te<=V;te++)Nx(_[2*te],_[2*te+1],e,i)<=R&&P.push(p[te]);continue}const q=Z+V>>1,W=_[2*q],Q=_[2*q+1];Nx(W,Q,e,i)<=R&&P.push(p[q]),(F===0?e-u<=W:i-u<=Q)&&(E.push(Z),E.push(q-1),E.push(1-F)),(F===0?e+u>=W:i+u>=Q)&&(E.push(q+1),E.push(V),E.push(1-F))}return P}}function g0(n,e,i,u,p,_){if(p-u<=i)return;const v=u+p>>1;Fx(n,e,v,u,p,_),g0(n,e,i,u,v-1,1-_),g0(n,e,i,v+1,p,1-_)}function Fx(n,e,i,u,p,_){for(;p>u;){if(p-u>600){const R=p-u+1,F=i-u+1,V=Math.log(R),Z=.5*Math.exp(2*V/3),q=.5*Math.sqrt(V*Z*(R-Z)/R)*(F-R/2<0?-1:1);Fx(n,e,i,Math.max(u,Math.floor(i-F*Z/R+q)),Math.min(p,Math.floor(i+(R-F)*Z/R+q)),_)}const v=e[2*i+_];let E=u,P=p;for(ey(n,e,u,i),e[2*p+_]>v&&ey(n,e,u,p);E<P;){for(ey(n,e,E,P),E++,P--;e[2*E+_]<v;)E++;for(;e[2*P+_]>v;)P--}e[2*u+_]===v?ey(n,e,u,P):(P++,ey(n,e,P,p)),P<=i&&(u=P+1),i<=P&&(p=P-1)}}function ey(n,e,i,u){y0(n,i,u),y0(e,2*i,2*u),y0(e,2*i+1,2*u+1)}function y0(n,e,i){const u=n[e];n[e]=n[i],n[i]=u}function Nx(n,e,i,u){const p=n-i,_=e-u;return p*p+_*_}var _0;w.cI=void 0,(_0=w.cI||(w.cI={})).create="create",_0.load="load",_0.fullLoad="fullLoad";let j_=null,ty=[];const v0=1e3/60,b0="loadTime",x0="fullLoadTime",cS={mark(n){performance.mark(n)},frame(n){const e=n;j_!=null&&ty.push(e-j_),j_=e},clearMetrics(){j_=null,ty=[],performance.clearMeasures(b0),performance.clearMeasures(x0);for(const n in w.cI)performance.clearMarks(w.cI[n])},getPerformanceMetrics(){performance.measure(b0,w.cI.create,w.cI.load),performance.measure(x0,w.cI.create,w.cI.fullLoad);const n=performance.getEntriesByName(b0)[0].duration,e=performance.getEntriesByName(x0)[0].duration,i=ty.length,u=1/(ty.reduce(((_,v)=>_+v),0)/i/1e3),p=ty.filter((_=>_>v0)).reduce(((_,v)=>_+(v-v0)/v0),0);return{loadTime:n,fullLoadTime:e,fps:u,percentDroppedFrames:p/(i+p)*100,totalFrames:i}}};w.$=ce,w.A=Ne,w.B=Bh,w.C=Kc,w.D=Jt,w.E=Fi,w.F=function([n,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:n*Math.cos(e)*Math.sin(i),y:n*Math.sin(e)*Math.sin(i),z:n*Math.cos(i)}},w.G=On,w.H=$i,w.I=$d,w.J=Oh,w.K=function(n){if(Cn==null){const e=n.navigator?n.navigator.userAgent:null;Cn=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Cn},w.L=class{constructor(n,e){this.target=n,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new y_((()=>this.process())),this.subscription=wl(this.target,"message",(i=>this.receive(i)),!1),this.globalScope=wa(self)?n:window}registerMessageHandler(n,e){this.messageHandlers[n]=e}unregisterMessageHandler(n){delete this.messageHandlers[n]}sendAsync(n,e){return new Promise(((i,u)=>{const p=Math.round(1e18*Math.random()).toString(36).substring(0,10),_=e?wl(e.signal,"abort",(()=>{_?.unsubscribe(),delete this.resolveRejects[p];const P={id:p,type:"<cancel>",origin:location.origin,targetMapId:n.targetMapId,sourceMapId:this.mapId};this.target.postMessage(P)}),tn):null;this.resolveRejects[p]={resolve:P=>{_?.unsubscribe(),i(P)},reject:P=>{_?.unsubscribe(),u(P)}};const v=[],E=Object.assign(Object.assign({},n),{id:p,sourceMapId:this.mapId,origin:location.origin,data:Au(n.data,v)});this.target.postMessage(E,{transfer:v})}))}receive(n){const e=n.data,i=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[i];const u=this.abortControllers[i];return delete this.abortControllers[i],void(u&&u.abort())}if(wa(self)||e.mustQueue)return this.tasks[i]=e,this.taskQueue.push(i),void this.invoker.trigger();this.processTask(i,e)}}process(){if(this.taskQueue.length===0)return;const n=this.taskQueue.shift(),e=this.tasks[n];delete this.tasks[n],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(n,e)}processTask(n,e){return c(this,void 0,void 0,(function*(){if(e.type==="<response>"){const p=this.resolveRejects[n];return delete this.resolveRejects[n],p?void(e.error?p.reject(Qc(e.error)):p.resolve(Qc(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(n,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const i=Qc(e.data),u=new AbortController;this.abortControllers[n]=u;try{const p=yield this.messageHandlers[e.type](e.sourceMapId,i,u);this.completeTask(n,null,p)}catch(p){this.completeTask(n,p)}}))}completeTask(n,e,i){const u=[];delete this.abortControllers[n];const p={id:n,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?Au(e):null,data:Au(i,u)};this.target.postMessage(p,{transfer:u})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},w.M=je,w.N=function(){var n=new Ne(16);return Ne!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},w.O=function(n,e,i){var u,p,_,v,E,P,R,F,V,Z,q,W,Q=i[0],te=i[1],oe=i[2];return e===n?(n[12]=e[0]*Q+e[4]*te+e[8]*oe+e[12],n[13]=e[1]*Q+e[5]*te+e[9]*oe+e[13],n[14]=e[2]*Q+e[6]*te+e[10]*oe+e[14],n[15]=e[3]*Q+e[7]*te+e[11]*oe+e[15]):(p=e[1],_=e[2],v=e[3],E=e[4],P=e[5],R=e[6],F=e[7],V=e[8],Z=e[9],q=e[10],W=e[11],n[0]=u=e[0],n[1]=p,n[2]=_,n[3]=v,n[4]=E,n[5]=P,n[6]=R,n[7]=F,n[8]=V,n[9]=Z,n[10]=q,n[11]=W,n[12]=u*Q+E*te+V*oe+e[12],n[13]=p*Q+P*te+Z*oe+e[13],n[14]=_*Q+R*te+q*oe+e[14],n[15]=v*Q+F*te+W*oe+e[15]),n},w.P=k,w.Q=function(n,e,i){var u=i[0],p=i[1],_=i[2];return n[0]=e[0]*u,n[1]=e[1]*u,n[2]=e[2]*u,n[3]=e[3]*u,n[4]=e[4]*p,n[5]=e[5]*p,n[6]=e[6]*p,n[7]=e[7]*p,n[8]=e[8]*_,n[9]=e[9]*_,n[10]=e[10]*_,n[11]=e[11]*_,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},w.R=zr,w.S=function(n,e,i){var u=e[0],p=e[1],_=e[2],v=e[3],E=e[4],P=e[5],R=e[6],F=e[7],V=e[8],Z=e[9],q=e[10],W=e[11],Q=e[12],te=e[13],oe=e[14],xe=e[15],le=i[0],pe=i[1],Te=i[2],Me=i[3];return n[0]=le*u+pe*E+Te*V+Me*Q,n[1]=le*p+pe*P+Te*Z+Me*te,n[2]=le*_+pe*R+Te*q+Me*oe,n[3]=le*v+pe*F+Te*W+Me*xe,n[4]=(le=i[4])*u+(pe=i[5])*E+(Te=i[6])*V+(Me=i[7])*Q,n[5]=le*p+pe*P+Te*Z+Me*te,n[6]=le*_+pe*R+Te*q+Me*oe,n[7]=le*v+pe*F+Te*W+Me*xe,n[8]=(le=i[8])*u+(pe=i[9])*E+(Te=i[10])*V+(Me=i[11])*Q,n[9]=le*p+pe*P+Te*Z+Me*te,n[10]=le*_+pe*R+Te*q+Me*oe,n[11]=le*v+pe*F+Te*W+Me*xe,n[12]=(le=i[12])*u+(pe=i[13])*E+(Te=i[14])*V+(Me=i[15])*Q,n[13]=le*p+pe*P+Te*Z+Me*te,n[14]=le*_+pe*R+Te*q+Me*oe,n[15]=le*v+pe*F+Te*W+Me*xe,n},w.T=er,w.U=function(n,e){const i={};for(let u=0;u<e.length;u++){const p=e[u];p in n&&(i[p]=n[p])}return i},w.V=iu,w.W=fi,w.X=Yd,w.Y=am,w.Z=Ee,w._=c,w.a=de,w.a$=v_,w.a0=qe,w.a1=Oo,w.a2=es,w.a3=__,w.a4=Qf,w.a5=ei,w.a6=function(n,e,i){if(!n)return e||{};if(!e)return n||{};const u=x_(n),p=x_(e);(function(v,E){E.removeAll&&(v.add.clear(),v.update.clear(),v.remove.clear(),E.remove.clear());for(const P of E.remove)v.add.delete(P),v.update.delete(P);for(const[P,R]of E.update){const F=v.update.get(P);F&&(E.update.set(P,b_(F,R)),v.update.delete(P))}})(u,p);const _={};if((u.removeAll||p.removeAll)&&(_.removeAll=!0),_.remove=new Set([...u.remove,...p.remove]),_.add=new Map([...u.add,...p.add]),_.update=new Map([...u.update,...p.update]),_.remove.size&&_.add.size)for(const v of _.add.keys())_.remove.delete(v);return(function(v){const E={};return v.removeAll&&(E.removeAll=v.removeAll),v.remove&&(E.remove=Array.from(v.remove)),v.add&&(E.add=Array.from(v.add.values())),v.update&&(E.update=Array.from(v.update.values())),E})(_)},w.a7=function(n,e){if(n==null||n.type==null)return!0;if(n.type==="Feature")return tp(n,e)!=null;if(n.type==="FeatureCollection"){const i=new Set;for(const u of n.features){const p=tp(u,e);if(p==null||i.has(p))return!1;i.add(p)}return!0}return!1},w.a8=function(n,e){const i=new Map;if(!(n==null||n.type==null))if(n.type==="Feature")i.set(tp(n,e),n);else for(const u of n.features)i.set(tp(u,e),u);return i},w.a9=function(n,e,i){var u,p;if(e.removeAll)n.clear();else if(e.remove)for(const _ of e.remove)n.delete(_);if(e.add)for(const _ of e.add){const v=tp(_,i);v!=null&&n.set(v,_)}if(e.update)for(const _ of e.update){let v=n.get(_.id);if(!v)continue;const E=!!_.newGeometry,P=_.removeAllProperties||((u=_.removeProperties)===null||u===void 0?void 0:u.length)>0||((p=_.addOrUpdateProperties)===null||p===void 0?void 0:p.length)>0;if((E||P)&&(v=Object.assign({},v),n.set(_.id,v),E&&(v.geometry=_.newGeometry),P)){if(v.properties=_.removeAllProperties?{}:Object.assign({},v.properties||{}),_.removeProperties)for(const R of _.removeProperties)delete v.properties[R];if(_.addOrUpdateProperties)for(const{key:R,value:F}of _.addOrUpdateProperties)v.properties[R]=F}}},w.aB=function(n,{uSize:e,uSizeT:i},{lowerSize:u,upperSize:p}){return n.kind==="source"?u/eu:n.kind==="composite"?On.number(u/eu,p/eu,i):e},w.aC=function(n,e){var i=e[0],u=e[1],p=e[2],_=e[3],v=e[4],E=e[5],P=e[6],R=e[7],F=e[8],V=e[9],Z=e[10],q=e[11],W=e[12],Q=e[13],te=e[14],oe=e[15],xe=i*E-u*v,le=i*P-p*v,pe=i*R-_*v,Te=u*P-p*E,Me=u*R-_*E,Xe=p*R-_*P,gt=F*Q-V*W,ut=F*te-Z*W,xt=F*oe-q*W,Rt=V*te-Z*Q,wt=V*oe-q*Q,ft=Z*oe-q*te,it=xe*ft-le*wt+pe*Rt+Te*xt-Me*ut+Xe*gt;return it?(n[0]=(E*ft-P*wt+R*Rt)*(it=1/it),n[1]=(p*wt-u*ft-_*Rt)*it,n[2]=(Q*Xe-te*Me+oe*Te)*it,n[3]=(Z*Me-V*Xe-q*Te)*it,n[4]=(P*xt-v*ft-R*ut)*it,n[5]=(i*ft-p*xt+_*ut)*it,n[6]=(te*pe-W*Xe-oe*le)*it,n[7]=(F*Xe-Z*pe+q*le)*it,n[8]=(v*wt-E*xt+R*gt)*it,n[9]=(u*xt-i*wt-_*gt)*it,n[10]=(W*Me-Q*pe+oe*xe)*it,n[11]=(V*pe-F*Me-q*xe)*it,n[12]=(E*ut-v*Rt-P*gt)*it,n[13]=(i*Rt-u*ut+p*gt)*it,n[14]=(Q*le-W*Te-te*xe)*it,n[15]=(F*Te-V*le+Z*xe)*it,n):null},w.aD=Pt,w.aE=function(n){var e=n[0],i=n[1];return Math.sqrt(e*e+i*i)},w.aF=function(n){return n[0]=0,n[1]=0,n},w.aG=function(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n},w.aH=tm,w.aI=Ci,w.aJ=function(n,e,i,u){const p=e.y-n.y,_=e.x-n.x,v=u.y-i.y,E=u.x-i.x,P=v*_-E*p;if(P===0)return null;const R=(E*(n.y-i.y)-v*(n.x-i.x))/P;return new k(n.x+R*_,n.y+R*p)},w.aK=Qg,w.aL=Dd,w.aM=function(n){let e=1/0,i=1/0,u=-1/0,p=-1/0;for(const _ of n)e=Math.min(e,_.x),i=Math.min(i,_.y),u=Math.max(u,_.x),p=Math.max(p,_.y);return[e,i,u,p]},w.aN=Tn,w.aO=Nt,w.aP=function(n,e,i,u,p=!1){if(!i[0]&&!i[1])return[0,0];const _=p?u==="map"?-n.bearingInRadians:0:u==="viewport"?n.bearingInRadians:0;if(_){const v=Math.sin(_),E=Math.cos(_);i=[i[0]*E-i[1]*v,i[0]*v+i[1]*E]}return[p?i[0]:Nt(e,i[0],n.zoom),p?i[1]:Nt(e,i[1],n.zoom)]},w.aR=td,w.aS=Ki,w.aT=Hf,w.aU=m0,w.aV=ri,w.aW=vs,w.aX=$,w.aY=bt,w.aZ=Ke,w.a_=Da,w.aa=af,w.ab=ep,w.ac=nu,w.ad=25,w.ae=om,w.af=n=>{const e=window.document.createElement("video");return e.muted=!0,new Promise((i=>{e.onloadstart=()=>{i(e)};for(const u of n){const p=window.document.createElement("source");pt(u)||(e.crossOrigin="Anonymous"),p.src=u,e.appendChild(p)}}))},w.ag=et,w.ah=function(){return rn++},w.ai=t,w.aj=fh,w.ak=jt,w.al=Lu,w.am=lm,w.an=function(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((i,u,p,_)=>{const v=p||_;return e[u]=!v||v.toLowerCase(),""})),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e},w.ao=kt,w.ap=85.051129,w.aq=Rr,w.ar=function(n){return Math.pow(2,n)},w.as=Pe,w.at=Jf,w.au=function(n){return Math.log(n)/Math.LN2},w.av=function(n){var e=n[0],i=n[1];return e*e+i*i},w.aw=function(n){if(!n.length)return new Set;const e=Math.max(...n.map((P=>P.canonical.z)));let i=1/0,u=-1/0,p=1/0,_=-1/0;const v=[];for(const P of n){const{x:R,y:F,z:V}=P.canonical,Z=Math.pow(2,e-V),q=R*Z,W=F*Z;v.push({id:P,x:q,y:W}),q<i&&(i=q),q>u&&(u=q),W<p&&(p=W),W>_&&(_=W)}const E=new Set;for(const P of v)P.x!==i&&P.x!==u&&P.y!==p&&P.y!==_||E.add(P.id);return E},w.ax=function(n,e){const i=Math.abs(2*n.wrap)-+(n.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||u-i||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x},w.ay=class{constructor(n,e){this.max=n,this.onRemove=e,this.reset()}reset(){for(const n in this.data)for(const e of this.data[n])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(n,e,i){const u=n.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const p={value:e,timeout:void 0};if(i!==void 0&&(p.timeout=setTimeout((()=>{this.remove(n,p)}),i)),this.data[u].push(p),this.order.push(u),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const e=this.data[n].shift();return e.timeout&&clearTimeout(e.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),e.value}getByKey(n){const e=this.data[n];return e?e[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,e){if(!this.has(n))return this;const i=n.wrapped().key,u=e===void 0?0:this.data[i].indexOf(e),p=this.data[i][u];return this.data[i].splice(u,1),p.timeout&&clearTimeout(p.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(p.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(n){const e=[];for(const i in this.data)for(const u of this.data[i])n(u.value)||e.push(u);for(const i of e)this.remove(i.value.tileID,i)}},w.az=function(n,e){let i=0,u=0;if(n.kind==="constant")u=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:p,minZoom:_,maxZoom:v}=n,E=p?kt(rr.interpolationFactor(p,e,_,v),0,1):0;n.kind==="camera"?u=On.number(n.minSize,n.maxSize,E):i=E}return{uSizeT:i,uSize:u}},w.b=La,w.b$=class extends za{constructor(n,e){super(n,e),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},w.b0=$t,w.b1=Ut,w.b2=function(n){var e=new Ne(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e},w.b3=function(n,e,i){return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],n},w.b4=function(n,e){var i=e[0],u=e[1],p=e[2],_=i*i+u*u+p*p;return _>0&&(_=1/Math.sqrt(_)),n[0]=e[0]*_,n[1]=e[1]*_,n[2]=e[2]*_,n},w.b5=hi,w.b6=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]},w.b7=function(n,e,i){return n[0]=e[0]*i[0],n[1]=e[1]*i[1],n[2]=e[2]*i[2],n[3]=e[3]*i[3],n},w.b8=Qe,w.b9=function(n,e,i){const u=e[0]*i[0]+e[1]*i[1]+e[2]*i[2];return u===0?null:(-(n[0]*i[0]+n[1]*i[1]+n[2]*i[2])-i[3])/u},w.bA=function(){return new Float64Array(3)},w.bB=function(n,e,i,u){return n[0]=e[0]+i[0]*u,n[1]=e[1]+i[1]*u,n[2]=e[2]+i[2]*u,n},w.bC=lt,w.bD=function(n,e,i){var u=i[0],p=i[1],_=i[2],v=i[3],E=e[0],P=e[1],R=e[2],F=p*R-_*P,V=_*E-u*R,Z=u*P-p*E;return n[0]=E+v*(F+=F)+p*(Z+=Z)-_*(V+=V),n[1]=P+v*V+_*F-u*Z,n[2]=R+v*Z+u*V-p*F,n},w.bE=function(n,e,i){const u=(function(P){var R=P[3],F=P[4],V=P[5],Z=P[6],q=P[7],W=P[8];return P[0]*(W*F-V*q)+P[1]*(-W*R+V*Z)+P[2]*(q*R-F*Z)})([n[0],n[1],n[2],e[0],e[1],e[2],i[0],i[1],i[2]]);if(u===0)return null;const p=hi([],[e[0],e[1],e[2]],[i[0],i[1],i[2]]),_=hi([],[i[0],i[1],i[2]],[n[0],n[1],n[2]]),v=hi([],[n[0],n[1],n[2]],[e[0],e[1],e[2]]),E=$t([],p,-n[3]);return Ut(E,E,$t([],_,-e[3])),Ut(E,E,$t([],v,-i[3])),$t(E,E,1/u),E},w.bF=Kf,w.bG=function(){return new Float64Array(4)},w.bH=function(n,e,i,u){var p=[],_=[];return p[0]=e[0]-i[0],p[1]=e[1]-i[1],p[2]=e[2]-i[2],_[0]=p[0]*Math.cos(u)-p[1]*Math.sin(u),_[1]=p[0]*Math.sin(u)+p[1]*Math.cos(u),_[2]=p[2],n[0]=_[0]+i[0],n[1]=_[1]+i[1],n[2]=_[2]+i[2],n},w.bI=function(n,e,i,u){var p=[],_=[];return p[0]=e[0]-i[0],p[1]=e[1]-i[1],p[2]=e[2]-i[2],_[0]=p[0],_[1]=p[1]*Math.cos(u)-p[2]*Math.sin(u),_[2]=p[1]*Math.sin(u)+p[2]*Math.cos(u),n[0]=_[0]+i[0],n[1]=_[1]+i[1],n[2]=_[2]+i[2],n},w.bJ=function(n,e,i,u){var p=[],_=[];return p[0]=e[0]-i[0],p[1]=e[1]-i[1],p[2]=e[2]-i[2],_[0]=p[2]*Math.sin(u)+p[0]*Math.cos(u),_[1]=p[1],_[2]=p[2]*Math.cos(u)-p[0]*Math.sin(u),n[0]=_[0]+i[0],n[1]=_[1]+i[1],n[2]=_[2]+i[2],n},w.bK=function(n,e,i){var u=Math.sin(i),p=Math.cos(i),_=e[0],v=e[1],E=e[2],P=e[3],R=e[8],F=e[9],V=e[10],Z=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=_*p-R*u,n[1]=v*p-F*u,n[2]=E*p-V*u,n[3]=P*p-Z*u,n[8]=_*u+R*p,n[9]=v*u+F*p,n[10]=E*u+V*p,n[11]=P*u+Z*p,n},w.bL=function(n,e){const i=ze(n,360),u=ze(e,360),p=u-i,_=u>i?p-360:p+360;return Math.abs(p)<Math.abs(_)?p:_},w.bM=function(n){return n[0]=0,n[1]=0,n[2]=0,n},w.bN=function(n,e,i,u){const p=Math.sqrt(n*n+e*e),_=Math.sqrt(i*i+u*u);n/=p,e/=p,i/=_,u/=_;const v=Math.acos(n*i+e*u);return-e*i+n*u>0?v:-v},w.bO=function(n,e){const i=ze(n,2*Math.PI),u=ze(e,2*Math.PI);return Math.min(Math.abs(i-u),Math.abs(i-u+2*Math.PI),Math.abs(i-u-2*Math.PI))},w.bP=function(){const n={},e=Ze.$version;for(const i in Ze.$root){const u=Ze.$root[i];if(u.required){let p=null;p=i==="version"?e:u.type==="array"?[]:{},p!=null&&(n[i]=p)}}return n},w.bQ=We,w.bR=Yo,w.bS=function n(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(let u=0;u<e.length;u++)if(!n(e[u],i[u]))return!1;return!0}if(typeof e=="object"&&e!==null&&i!==null){if(typeof i!="object"||Object.keys(e).length!==Object.keys(i).length)return!1;for(const u in e)if(!n(e[u],i[u]))return!1;return!0}return e===i},w.bT=function(n){n=n.slice();const e=Object.create(null);for(let i=0;i<n.length;i++)e[n[i].id]=n[i];for(let i=0;i<n.length;i++)"ref"in n[i]&&(n[i]=dr(n[i],e[n[i].ref]));return n},w.bU=function(n,e){if(n.type==="custom")return new u0(n,e);switch(n.type){case"background":return new Wf(n,e);case"circle":return new og(n,e);case"color-relief":return new Jy(n,e);case"fill":return new Nf(n,e);case"fill-extrusion":return new Gr(n,e);case"heatmap":return new Xy(n,e);case"hillshade":return new Yy(n,e);case"line":return new hh(n,e);case"raster":return new Eo(n,e);case"symbol":return new Xd(n,e)}},w.bV=n=>n.type==="raster",w.bW=Mr,w.bX=function(n,e){if(!n)return[{command:"setStyle",args:[e]}];let i=[];try{if(!gi(n.version,e.version))return[{command:"setStyle",args:[e]}];gi(n.center,e.center)||i.push({command:"setCenter",args:[e.center]}),gi(n.state,e.state)||i.push({command:"setGlobalState",args:[e.state]}),gi(n.centerAltitude,e.centerAltitude)||i.push({command:"setCenterAltitude",args:[e.centerAltitude]}),gi(n.zoom,e.zoom)||i.push({command:"setZoom",args:[e.zoom]}),gi(n.bearing,e.bearing)||i.push({command:"setBearing",args:[e.bearing]}),gi(n.pitch,e.pitch)||i.push({command:"setPitch",args:[e.pitch]}),gi(n.roll,e.roll)||i.push({command:"setRoll",args:[e.roll]}),gi(n.sprite,e.sprite)||i.push({command:"setSprite",args:[e.sprite]}),gi(n.glyphs,e.glyphs)||i.push({command:"setGlyphs",args:[e.glyphs]}),gi(n.transition,e.transition)||i.push({command:"setTransition",args:[e.transition]}),gi(n.light,e.light)||i.push({command:"setLight",args:[e.light]}),gi(n.terrain,e.terrain)||i.push({command:"setTerrain",args:[e.terrain]}),gi(n.sky,e.sky)||i.push({command:"setSky",args:[e.sky]}),gi(n.projection,e.projection)||i.push({command:"setProjection",args:[e.projection]});const u={},p=[];(function(v,E,P,R){let F;for(F in E=E||{},v=v||{})Object.prototype.hasOwnProperty.call(v,F)&&(Object.prototype.hasOwnProperty.call(E,F)||an(F,P,R));for(F in E)Object.prototype.hasOwnProperty.call(E,F)&&(Object.prototype.hasOwnProperty.call(v,F)?gi(v[F],E[F])||(v[F].type==="geojson"&&E[F].type==="geojson"&&_n(v,E,F)?un(P,{command:"setGeoJSONSourceData",args:[F,E[F].data]}):nr(F,E,P,R)):Er(F,E,P))})(n.sources,e.sources,p,u);const _=[];n.layers&&n.layers.forEach((v=>{"source"in v&&u[v.source]?i.push({command:"removeLayer",args:[v.id]}):_.push(v)})),i=i.concat(p),(function(v,E,P){E=E||[];const R=(v=v||[]).map(du),F=E.map(du),V=v.reduce(ha,{}),Z=E.reduce(ha,{}),q=R.slice(),W=Object.create(null);let Q,te,oe,xe,le;for(let pe=0,Te=0;pe<R.length;pe++)Q=R[pe],Object.prototype.hasOwnProperty.call(Z,Q)?Te++:(un(P,{command:"removeLayer",args:[Q]}),q.splice(q.indexOf(Q,Te),1));for(let pe=0,Te=0;pe<F.length;pe++)Q=F[F.length-1-pe],q[q.length-1-pe]!==Q&&(Object.prototype.hasOwnProperty.call(V,Q)?(un(P,{command:"removeLayer",args:[Q]}),q.splice(q.lastIndexOf(Q,q.length-Te),1)):Te++,xe=q[q.length-pe],un(P,{command:"addLayer",args:[Z[Q],xe]}),q.splice(q.length-pe,0,Q),W[Q]=!0);for(let pe=0;pe<F.length;pe++)if(Q=F[pe],te=V[Q],oe=Z[Q],!W[Q]&&!gi(te,oe))if(gi(te.source,oe.source)&&gi(te["source-layer"],oe["source-layer"])&&gi(te.type,oe.type)){for(le in fr(te.layout,oe.layout,P,Q,null,"setLayoutProperty"),fr(te.paint,oe.paint,P,Q,null,"setPaintProperty"),gi(te.filter,oe.filter)||un(P,{command:"setFilter",args:[Q,oe.filter]}),gi(te.minzoom,oe.minzoom)&&gi(te.maxzoom,oe.maxzoom)||un(P,{command:"setLayerZoomRange",args:[Q,oe.minzoom,oe.maxzoom]}),te)Object.prototype.hasOwnProperty.call(te,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?fr(te[le],oe[le],P,Q,le.slice(6),"setPaintProperty"):gi(te[le],oe[le])||un(P,{command:"setLayerProperty",args:[Q,le,oe[le]]}));for(le in oe)Object.prototype.hasOwnProperty.call(oe,le)&&!Object.prototype.hasOwnProperty.call(te,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?fr(te[le],oe[le],P,Q,le.slice(6),"setPaintProperty"):gi(te[le],oe[le])||un(P,{command:"setLayerProperty",args:[Q,le,oe[le]]}))}else un(P,{command:"removeLayer",args:[Q]}),xe=q[q.lastIndexOf(Q)+1],un(P,{command:"addLayer",args:[oe,xe]})})(_,e.layers,i)}catch(u){console.warn("Unable to compute style diff:",u),i=[{command:"setStyle",args:[e]}]}return i},w.bY=function(n){const e=[],i=n.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),n.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},w.bZ=hr,w.b_=_o,w.ba=nn,w.bb=function(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n},w.bc=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]},w.bd=Un,w.be=qr,w.bf=function(n,e,i,u,p){var _=1/Math.tan(e/2);if(n[0]=_/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=_,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,p!=null&&p!==1/0){var v=1/(u-p);n[10]=(p+u)*v,n[14]=2*p*u*v}else n[10]=-1,n[14]=-2*u;return n},w.bg=function(n){var e=new Ne(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},w.bh=function(n,e,i){var u=Math.sin(i),p=Math.cos(i),_=e[0],v=e[1],E=e[2],P=e[3],R=e[4],F=e[5],V=e[6],Z=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=_*p+R*u,n[1]=v*p+F*u,n[2]=E*p+V*u,n[3]=P*p+Z*u,n[4]=R*p-_*u,n[5]=F*p-v*u,n[6]=V*p-E*u,n[7]=Z*p-P*u,n},w.bi=function(n,e,i){var u=Math.sin(i),p=Math.cos(i),_=e[4],v=e[5],E=e[6],P=e[7],R=e[8],F=e[9],V=e[10],Z=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=_*p+R*u,n[5]=v*p+F*u,n[6]=E*p+V*u,n[7]=P*p+Z*u,n[8]=R*p-_*u,n[9]=F*p-v*u,n[10]=V*p-E*u,n[11]=Z*p-P*u,n},w.bj=function(){const n=new Float32Array(16);return Pe(n),n},w.bk=function(){const n=new Float64Array(16);return Pe(n),n},w.bl=function(){return new Float64Array(16)},w.bm=function(n,e,i){const u=new Float64Array(4);return lt(u,n,e-90,i),u},w.bn=function(n,e,i,u){var p,_,v,E,P,R=e[0],F=e[1],V=e[2],Z=e[3],q=i[0],W=i[1],Q=i[2],te=i[3];return(_=R*q+F*W+V*Q+Z*te)<0&&(_=-_,q=-q,W=-W,Q=-Q,te=-te),1-_>Fe?(p=Math.acos(_),v=Math.sin(p),E=Math.sin((1-u)*p)/v,P=Math.sin(u*p)/v):(E=1-u,P=u),n[0]=E*R+P*q,n[1]=E*F+P*W,n[2]=E*V+P*Q,n[3]=E*Z+P*te,n},w.bo=function(n){const e=new Float64Array(9);(function(_,v){var E=v[0],P=v[1],R=v[2],F=v[3],V=E+E,Z=P+P,q=R+R,W=E*V,Q=P*V,te=P*Z,oe=R*V,xe=R*Z,le=R*q,pe=F*V,Te=F*Z,Me=F*q;_[0]=1-te-le,_[3]=Q-Me,_[6]=oe+Te,_[1]=Q+Me,_[4]=1-W-le,_[7]=xe-pe,_[2]=oe-Te,_[5]=xe+pe,_[8]=1-W-te})(e,n);const i=Da(-Math.asin(kt(e[2],-1,1)));let u,p;return Math.hypot(e[5],e[8])<.001?(u=0,p=-Da(Math.atan2(e[3],e[4]))):(u=Da(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),p=Da(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:u,pitch:i+90,bearing:p}},w.bp=function(n,e){return n.roll==e.roll&&n.pitch==e.pitch&&n.bearing==e.bearing},w.bq=xi,w.br=Ns,w.bs=Wh,w.bt=Ja,w.bu=Ia,w.bv=dt,w.bw=It,w.bx=Fn,w.by=function(n,e,i,u,p){return dt(u,p,kt((n-e)/(i-e),0,1))},w.bz=ze,w.c=Le,w.c$=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},w.c0=cc,w.c1=class extends za{constructor(n,e){super(n,e),this.current=zd}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},w.c2=Kl,w.c3=class extends za{constructor(n,e){super(n,e),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},w.c4=class extends za{constructor(n,e){super(n,e),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},w.c5=Be,w.c6=function(n,e){var i=Math.sin(e),u=Math.cos(e);return n[0]=u,n[1]=i,n[2]=0,n[3]=-i,n[4]=u,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},w.c7=function(n,e,i){var u=e[0],p=e[1],_=e[2];return n[0]=u*i[0]+p*i[3]+_*i[6],n[1]=u*i[1]+p*i[4]+_*i[7],n[2]=u*i[2]+p*i[5]+_*i[8],n},w.c8=function(n,e,i,u,p,_,v){var E=1/(e-i),P=1/(u-p),R=1/(_-v);return n[0]=-2*E,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*P,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*R,n[11]=0,n[12]=(e+i)*E,n[13]=(p+u)*P,n[14]=(v+_)*R,n[15]=1,n},w.c9=class extends za{constructor(n,e){super(n,e),this.current=new Array}set(n){if(n!=this.current){this.current=n;const e=new Float32Array(4*n.length);for(let i=0;i<n.length;i++)e[4*i]=n[i].r,e[4*i+1]=n[i].g,e[4*i+2]=n[i].b,e[4*i+3]=n[i].a;this.gl.uniform4fv(this.location,e)}}},w.cA=function(n,e){return ne[e]&&(n instanceof MouseEvent||n instanceof WheelEvent)},w.cB=function(n,e){return Ve[e]&&"touches"in n},w.cC=function(n){return Ve[n]||ne[n]},w.cD=function(n,e,i){var u=e[0],p=e[1];return n[0]=i[0]*u+i[4]*p+i[12],n[1]=i[1]*u+i[5]*p+i[13],n},w.cE=function(n,e){const{x:i,y:u}=ep.fromLngLat(e);return!(n<0||n>25||u<0||u>=1||i<0||i>=1)},w.cF=function(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},w.cG=class extends lc{},w.cH=cS,w.cJ=Re,w.cK=function(n,e){Le.REGISTERED_PROTOCOLS[n]=e},w.cL=function(n){delete Le.REGISTERED_PROTOCOLS[n]},w.cM=function(n,e){const i={};for(let p=0;p<n.length;p++){const _=e&&e[n[p].id]||Ds(n[p]);e&&(e[n[p].id]=_);let v=i[_];v||(v=i[_]=[]),v.push(n[p])}const u=[];for(const p in i)u.push(i[p]);return u},w.cN=Ot,w.cO=sm,w.cP=Jg,w.cQ=Pg,w.cR=function(n){n.bucket.createArrays(),n.bucket.tilePixelRatio=ei/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const e=n.bucket.layers[0],i=e.layout,u=e._unevaluatedLayout._values,p={layoutIconSize:u["icon-size"].possiblyEvaluate(new $i(n.bucket.zoom+1),n.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new $i(n.bucket.zoom+1),n.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new $i(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:R,maxZoom:F}=n.bucket.textSizeData;p.compositeTextSizes=[u["text-size"].possiblyEvaluate(new $i(R),n.canonical),u["text-size"].possiblyEvaluate(new $i(F),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:R,maxZoom:F}=n.bucket.iconSizeData;p.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new $i(R),n.canonical),u["icon-size"].possiblyEvaluate(new $i(F),n.canonical)]}const _=i.get("text-line-height")*Tn,v=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",E=i.get("text-keep-upright"),P=i.get("text-size");for(const R of n.bucket.features){const F=i.get("text-font").evaluate(R,{},n.canonical).join(","),V=P.evaluate(R,{},n.canonical),Z=p.layoutTextSize.evaluate(R,{},n.canonical),q=p.layoutIconSize.evaluate(R,{},n.canonical),W={horizontal:{},vertical:void 0},Q=R.text;let te,oe=[0,0];if(Q){const pe=Q.toString(),Te=i.get("text-letter-spacing").evaluate(R,{},n.canonical)*Tn,Me=jh(pe)?Te:0,Xe=i.get("text-anchor").evaluate(R,{},n.canonical),gt=Oi(e,R,n.canonical);if(!gt){const wt=i.get("text-radial-offset").evaluate(R,{},n.canonical);oe=wt?oi(Xe,[wt*Tn,yn]):i.get("text-offset").evaluate(R,{},n.canonical).map((ft=>ft*Tn))}let ut=v?"center":i.get("text-justify").evaluate(R,{},n.canonical);const xt=i.get("symbol-placement")==="point"?i.get("text-max-width").evaluate(R,{},n.canonical)*Tn:1/0,Rt=()=>{n.bucket.allowVerticalPlacement&&_s(pe)&&(W.vertical=Sn(Q,n.glyphMap,n.glyphPositions,n.imagePositions,F,xt,_,Xe,"left",Me,oe,w.aA.vertical,!0,Z,V))};if(!v&&gt){const wt=new Set;if(ut==="auto")for(let it=0;it<gt.values.length;it+=2)wt.add(Ki(gt.values[it]));else wt.add(ut);let ft=!1;for(const it of wt)if(!W.horizontal[it])if(ft)W.horizontal[it]=W.horizontal[0];else{const Ht=Sn(Q,n.glyphMap,n.glyphPositions,n.imagePositions,F,xt,_,"center",it,Me,oe,w.aA.horizontal,!1,Z,V);Ht&&(W.horizontal[it]=Ht,ft=Ht.positionedLines.length===1)}Rt()}else{ut==="auto"&&(ut=Ki(Xe));const wt=Sn(Q,n.glyphMap,n.glyphPositions,n.imagePositions,F,xt,_,Xe,ut,Me,oe,w.aA.horizontal,!1,Z,V);wt&&(W.horizontal[ut]=wt),Rt(),_s(pe)&&v&&E&&(W.vertical=Sn(Q,n.glyphMap,n.glyphPositions,n.imagePositions,F,xt,_,Xe,ut,Me,oe,w.aA.vertical,!1,Z,V))}}let xe=!1;if(R.icon&&R.icon.name){const pe=n.imageMap[R.icon.name];pe&&(te=Hd(n.imagePositions[R.icon.name],i.get("icon-offset").evaluate(R,{},n.canonical),i.get("icon-anchor").evaluate(R,{},n.canonical)),xe=!!pe.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=xe:n.bucket.sdfIcons!==xe&&Rn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pe.pixelRatio!==n.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const le=N_(W.horizontal)||W.vertical;n.bucket.iconsInText=!!le&&le.iconsInText,(le||te)&&Mn(n.bucket,R,W,te,n.imageMap,p,Z,q,oe,xe,n.canonical,n.subdivisionGranularity)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},w.cS=Us,w.cT=Ln,w.cU=Gd,w.cV=function(n){const e=new $f;return(function(i,u){for(const p in i.layers)u.writeMessage(3,wm,i.layers[p])})(n,e),e.finish()},w.cW=function(n,e,i,u,p,_){let v=F_(n,e,i,p,0);return v=F_(v,e,u,_,1),v},w.cX=class{constructor(n){this.maxEntries=n,this.map=new Map}get(n){const e=this.map.get(n);return e!==void 0&&(this.map.delete(n),this.map.set(n,e)),e}set(n,e){if(this.map.has(n))this.map.delete(n);else if(this.map.size>=this.maxEntries){const i=this.map.keys().next().value;this.map.delete(i)}this.map.set(n,e)}clear(){this.map.clear()}},w.cY=wn,w.cZ=$f,w.c_=Kg,w.ca=class extends za{constructor(n,e){super(n,e),this.current=new Array}set(n){if(n!=this.current){this.current=n;const e=new Float32Array(n);this.gl.uniform1fv(this.location,e)}}},w.cb=class extends qh{},w.cc=Zf,w.cd=class extends Yl{},w.ce=ug,w.cf=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},w.cg=Gp,w.ch=function(n,e,i){var u=e[0],p=e[1],_=e[2],v=i[3]*u+i[7]*p+i[11]*_+i[15];return n[0]=(i[0]*u+i[4]*p+i[8]*_+i[12])/(v=v||1),n[1]=(i[1]*u+i[5]*p+i[9]*_+i[13])/v,n[2]=(i[2]*u+i[6]*p+i[10]*_+i[14])/v,n},w.ci=class extends Wo{},w.cj=class extends ah{},w.ck=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]&&n[9]===e[9]&&n[10]===e[10]&&n[11]===e[11]&&n[12]===e[12]&&n[13]===e[13]&&n[14]===e[14]&&n[15]===e[15]},w.cl=function(n,e){var i=n[0],u=n[1],p=n[2],_=n[3],v=n[4],E=n[5],P=n[6],R=n[7],F=n[8],V=n[9],Z=n[10],q=n[11],W=n[12],Q=n[13],te=n[14],oe=n[15],xe=e[0],le=e[1],pe=e[2],Te=e[3],Me=e[4],Xe=e[5],gt=e[6],ut=e[7],xt=e[8],Rt=e[9],wt=e[10],ft=e[11],it=e[12],Ht=e[13],Gt=e[14],Xt=e[15];return Math.abs(i-xe)<=Fe*Math.max(1,Math.abs(i),Math.abs(xe))&&Math.abs(u-le)<=Fe*Math.max(1,Math.abs(u),Math.abs(le))&&Math.abs(p-pe)<=Fe*Math.max(1,Math.abs(p),Math.abs(pe))&&Math.abs(_-Te)<=Fe*Math.max(1,Math.abs(_),Math.abs(Te))&&Math.abs(v-Me)<=Fe*Math.max(1,Math.abs(v),Math.abs(Me))&&Math.abs(E-Xe)<=Fe*Math.max(1,Math.abs(E),Math.abs(Xe))&&Math.abs(P-gt)<=Fe*Math.max(1,Math.abs(P),Math.abs(gt))&&Math.abs(R-ut)<=Fe*Math.max(1,Math.abs(R),Math.abs(ut))&&Math.abs(F-xt)<=Fe*Math.max(1,Math.abs(F),Math.abs(xt))&&Math.abs(V-Rt)<=Fe*Math.max(1,Math.abs(V),Math.abs(Rt))&&Math.abs(Z-wt)<=Fe*Math.max(1,Math.abs(Z),Math.abs(wt))&&Math.abs(q-ft)<=Fe*Math.max(1,Math.abs(q),Math.abs(ft))&&Math.abs(W-it)<=Fe*Math.max(1,Math.abs(W),Math.abs(it))&&Math.abs(Q-Ht)<=Fe*Math.max(1,Math.abs(Q),Math.abs(Ht))&&Math.abs(te-Gt)<=Fe*Math.max(1,Math.abs(te),Math.abs(Gt))&&Math.abs(oe-Xt)<=Fe*Math.max(1,Math.abs(oe),Math.abs(Xt))},w.cm=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},w.cn=n=>n.type==="symbol",w.co=n=>n.type==="circle",w.cp=n=>n.type==="heatmap",w.cq=n=>n.type==="line",w.cr=n=>n.type==="fill",w.cs=n=>n.type==="fill-extrusion",w.ct=n=>n.type==="hillshade",w.cu=n=>n.type==="color-relief",w.cv=n=>n.type==="background",w.cw=n=>n.type==="custom",w.cx=zt,w.cy=function(n,e,i){const u=Mt(e.x-i.x,e.y-i.y),p=Mt(n.x-i.x,n.y-i.y),_=Math.atan2(u[0]*p[1]-u[1]*p[0],(function(v,E){return v[0]*E[0]+v[1]*E[1]})(u,p));return Da(_)},w.cz=Dt,w.d=pt,w.d0=function(n,e,i,u,p){return c(this,void 0,void 0,(function*(){if(qe())try{return yield Oo(n,e,i,u,p)}catch{}return(function(_,v,E,P,R){const F=_.width,V=_.height;no&&vo||(no=new OffscreenCanvas(F,V),vo=no.getContext("2d",{willReadFrequently:!0})),no.width=F,no.height=V,vo.drawImage(_,0,0,F,V);const Z=vo.getImageData(v,E,P,R);return vo.clearRect(0,0,F,V),Z.data})(n,e,i,u,p)}))},w.d1=Wy,w.d2=N,w.d3=class{constructor(n,e){this.layers={[af]:this},this.name=af,this.version=e?e.version:1,this.extent=e?e.extent:4096,this.length=n.length,this.features=n}feature(n){return new f0(this.features[n],this.extent)}},w.d4=d,w.d5=Os,w.e=Ei,w.f=n=>c(void 0,void 0,void 0,(function*(){if(n.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(n)],{type:"image/png"});try{return createImageBitmap(e)}catch(i){throw new Error(`Could not load image because of ${i.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),w.g=Ye,w.h=n=>new Promise(((e,i)=>{const u=new Image;u.onload=()=>{e(u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame((()=>{u.src=ko}))},u.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(n)],{type:"image/png"});u.src=n.byteLength?URL.createObjectURL(p):ko})),w.i=wa,w.j=(n,e)=>mt(Ei(n,{type:"json"}),e),w.k=en,w.l=di,w.m=mt,w.n=(n,e)=>mt(Ei(n,{type:"arrayBuffer"}),e),w.o=function(n){return new $f(n).readFields(d_,[])},w.p=Cg,w.q=function(n){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))},w.r=Od,w.s=wl,w.t=xr,w.u=Ze,w.v=Wc,w.w=Rn,w.x=oc,w.y=Jc,w.z=Pu})),S("worker",["./shared"],(function(w){class c{constructor(ne,ie){this.keyCache={},ne&&this.replace(ne,ie)}replace(ne,ie){this._layerConfigs={},this._layers={},this.update(ne,[],ie)}update(ne,ie,de){for(const Le of ne){this._layerConfigs[Le.id]=Le;const Ye=this._layers[Le.id]=w.bU(Le,de);Ye._featureFilter=w.ak(Ye.filter,de),this.keyCache[Le.id]&&delete this.keyCache[Le.id]}for(const Le of ie)delete this.keyCache[Le],delete this._layerConfigs[Le],delete this._layers[Le];this.familiesBySource={};const Ee=w.cM(Object.values(this._layerConfigs),this.keyCache);for(const Le of Ee){const Ye=Le.map((Vt=>this._layers[Vt.id])),je=Ye[0];if(je.visibility==="none")continue;const Re=je.source||"";let We=this.familiesBySource[Re];We||(We=this.familiesBySource[Re]={});const mt=je.sourceLayer||w.aa;let pt=We[mt];pt||(pt=We[mt]=[]),pt.push(Ye)}}}class k{constructor(ne){const ie={},de=[];for(const je in ne){const Re=ne[je],We=ie[je]={};for(const mt in Re){const pt=Re[+mt];if(!pt||pt.bitmap.width===0||pt.bitmap.height===0)continue;const Vt={x:0,y:0,w:pt.bitmap.width+2,h:pt.bitmap.height+2};de.push(Vt),We[mt]={rect:Vt,metrics:pt.metrics}}}const{w:Ee,h:Le}=w.p(de),Ye=new w.r({width:Ee||1,height:Le||1});for(const je in ne){const Re=ne[je];for(const We in Re){const mt=Re[+We];if(!mt||mt.bitmap.width===0||mt.bitmap.height===0)continue;const pt=ie[je][We].rect;w.r.copy(mt.bitmap,Ye,{x:0,y:0},{x:pt.x+1,y:pt.y+1},mt.bitmap)}}this.image=Ye,this.positions=ie}}w.cN("GlyphAtlas",k);class N{constructor(ne){this.tileID=new w.a2(ne.tileID.overscaledZ,ne.tileID.wrap,ne.tileID.canonical.z,ne.tileID.canonical.x,ne.tileID.canonical.y),this.uid=ne.uid,this.zoom=ne.zoom,this.pixelRatio=ne.pixelRatio,this.tileSize=ne.tileSize,this.source=ne.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ne.showCollisionBoxes,this.collectResourceTiming=!!ne.collectResourceTiming,this.returnDependencies=!!ne.returnDependencies,this.promoteId=ne.promoteId,this.inFlightDependencies=[]}parse(ne,ie,de,Ee,Le){return w._(this,void 0,void 0,(function*(){this.status="parsing",this.data=ne,this.collisionBoxArray=new w.ai;const Ye=new w.cO(Object.keys(ne.layers).sort()),je=new w.cP(this.tileID,this.promoteId);je.bucketLayerIDs=[];const Re={},We={featureIndex:je,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:de,subdivisionGranularity:Le},mt=ie.familiesBySource[this.source];for(const _n in mt){const fr=ne.layers[_n];if(!fr)continue;fr.version===1&&w.w(`Vector tile source "${this.source}" layer "${_n}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const du=Ye.encode(_n),ha=[];for(let et=0;et<fr.length;et++){const Qr=fr.feature(et),ea=je.getId(Qr,_n);ha.push({feature:Qr,id:ea,index:et,sourceLayerIndex:du})}for(const et of mt[_n]){const Qr=et[0];Qr.source!==this.source&&w.w(`layer.source = ${Qr.source} does not equal this.source = ${this.source}`),Qr.isHidden(this.zoom,!0)||(H(et,this.zoom,de),(Re[Qr.id]=Qr.createBucket({index:je.bucketLayerIDs.length,layers:et,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:du,sourceID:this.source})).populate(ha,We,this.tileID.canonical),je.bucketLayerIDs.push(et.map((ea=>ea.id))))}}const pt=w.bZ(We.glyphDependencies,(_n=>Object.keys(_n).map(Number)));this.inFlightDependencies.forEach((_n=>_n?.abort())),this.inFlightDependencies=[];let Vt=Promise.resolve({});if(Object.keys(pt).length){const _n=new AbortController;this.inFlightDependencies.push(_n),Vt=Ee.sendAsync({type:"GG",data:{stacks:pt,source:this.source,tileID:this.tileID,type:"glyphs"}},_n)}const Kt=Object.keys(We.iconDependencies);let di=Promise.resolve({});if(Kt.length){const _n=new AbortController;this.inFlightDependencies.push(_n),di=Ee.sendAsync({type:"GI",data:{icons:Kt,source:this.source,tileID:this.tileID,type:"icons"}},_n)}const en=Object.keys(We.patternDependencies);let Fi=Promise.resolve({});if(en.length){const _n=new AbortController;this.inFlightDependencies.push(_n),Fi=Ee.sendAsync({type:"GI",data:{icons:en,source:this.source,tileID:this.tileID,type:"patterns"}},_n)}const Ze=We.dashDependencies;let ln=Promise.resolve({});if(Object.keys(Ze).length){const _n=new AbortController;this.inFlightDependencies.push(_n),ln=Ee.sendAsync({type:"GDA",data:{dashes:Ze}},_n)}const[dr,gi,un,Er]=yield Promise.all([Vt,di,Fi,ln]),an=new k(dr),nr=new w.cQ(gi,un);for(const _n in Re){const fr=Re[_n];fr instanceof w.aj?(H(fr.layers,this.zoom,de),w.cR({bucket:fr,glyphMap:dr,glyphPositions:an.positions,imageMap:gi,imagePositions:nr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:We.subdivisionGranularity})):fr.hasDependencies&&(fr instanceof w.cS||fr instanceof w.cT||fr instanceof w.cU)&&(H(fr.layers,this.zoom,de),fr.addFeatures(We,this.tileID.canonical,nr.patternPositions,Er))}return this.status="done",{buckets:Object.values(Re).filter((_n=>!_n.isEmpty())),featureIndex:je,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:an.image,imageAtlas:nr,dashPositions:Er,glyphMap:this.returnDependencies?dr:null,iconMap:this.returnDependencies?gi:null,glyphPositions:this.returnDependencies?an.positions:null}}))}}function H(Ve,ne,ie){const de=new w.H(ne);for(const Ee of Ve)Ee.recalculate(de,ie)}class K{constructor(ne,ie,de,Ee,Le){this.type=ne,this.properties=de||{},this.extent=Le,this.pointsArray=ie,this.id=Ee}loadGeometry(){return this.pointsArray.map((ne=>ne.map((ie=>new w.P(ie.x,ie.y)))))}}class ae{constructor(ne,ie,de){this.version=2,this._myFeatures=ne,this.name=ie,this.length=ne.length,this.extent=de}feature(ne){return this._myFeatures[ne]}}class ue{constructor(){this.layers={}}addLayer(ne){this.layers[ne.name]=ne}}function ge(Ve){let ne=w.cV(Ve);return ne.byteOffset===0&&ne.byteLength===ne.buffer.byteLength||(ne=new Uint8Array(ne)),{vectorTile:Ve,rawData:ne.buffer}}function fe(Ve,ne,ie){const{extent:de}=Ve,Ee=Math.pow(2,ie.z-ne.z),Le=(ie.x-ne.x*Ee)*de,Ye=(ie.y-ne.y*Ee)*de,je=[];for(let Re=0;Re<Ve.length;Re++){const We=Ve.feature(Re);let mt=We.loadGeometry();for(const Vt of mt)for(const Kt of Vt)Kt.x=Kt.x*Ee-Le,Kt.y=Kt.y*Ee-Ye;const pt=128;mt=w.cW(mt,We.type,-pt,-pt,de+pt,de+pt),mt.length!==0&&je.push(new K(We.type,mt,We.properties,We.id,de))}return new ae(je,Ve.name,de)}class ce{constructor(ne,ie,de){this.actor=ne,this.layerIndex=ie,this.availableImages=de,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new w.cX(1e3)}loadVectorTile(ne,ie){return w._(this,void 0,void 0,(function*(){const de=yield w.n(ne.request,ie);try{return{vectorTile:ne.encoding!=="mlt"?new w.cY(new w.cZ(de.data)):new w.c_(de.data),rawData:de.data,cacheControl:de.cacheControl,expires:de.expires}}catch(Ee){const Le=new Uint8Array(de.data);let Ye=`Unable to parse the tile at ${ne.request.url}, `;throw Ye+=Le[0]===31&&Le[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Ee.message}`,new Error(Ye)}}))}loadTile(ne){return w._(this,void 0,void 0,(function*(){const{uid:ie,overzoomParameters:de}=ne;de&&(ne.request=de.overzoomRequest);const Ee=!!(ne&&ne.request&&ne.request.collectResourceTiming)&&new w.c$(ne.request),Le=new N(ne);this.loading[ie]=Le;const Ye=new AbortController;Le.abort=Ye;try{const je=yield this.loadVectorTile(ne,Ye);if(delete this.loading[ie],!je)return null;if(de){const Vt=this._getOverzoomTile(ne,je.vectorTile);je.rawData=Vt.rawData,je.vectorTile=Vt.vectorTile}const Re=je.rawData,We={};je.expires&&(We.expires=je.expires),je.cacheControl&&(We.cacheControl=je.cacheControl);const mt={};if(Ee){const Vt=Ee.finish();Vt&&(mt.resourceTiming=JSON.parse(JSON.stringify(Vt)))}Le.vectorTile=je.vectorTile;const pt=Le.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity);this.loaded[ie]=Le,this.fetching[ie]={rawTileData:Re,cacheControl:We,resourceTiming:mt};try{const Vt=yield pt;return w.e({rawTileData:Re.slice(0),encoding:ne.encoding},Vt,We,mt)}finally{delete this.fetching[ie]}}catch(je){throw delete this.loading[ie],Le.status="done",this.loaded[ie]=Le,je}}))}_getOverzoomTile(ne,ie){const{tileID:de,source:Ee,overzoomParameters:Le}=ne,{maxZoomTileID:Ye}=Le,je=`${Ye.key}_${de.key}`,Re=this.overzoomedTileResultCache.get(je);if(Re)return Re;const We=new ue,mt=this.layerIndex.familiesBySource[Ee];for(const Vt in mt){const Kt=ie.layers[Vt];if(!Kt)continue;const di=fe(Kt,Ye,de.canonical);di.length>0&&We.addLayer(di)}const pt=ge(We);return this.overzoomedTileResultCache.set(je,pt),pt}reloadTile(ne){return w._(this,void 0,void 0,(function*(){const ie=ne.uid;if(!this.loaded||!this.loaded[ie])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const de=this.loaded[ie];if(de.showCollisionBoxes=ne.showCollisionBoxes,de.status==="parsing"){const Ee=yield de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity);let Le;if(this.fetching[ie]){const{rawTileData:Ye,cacheControl:je,resourceTiming:Re}=this.fetching[ie];delete this.fetching[ie],Le=w.e({rawTileData:Ye.slice(0),encoding:ne.encoding},Ee,je,Re)}else Le=Ee;return Le}if(de.status==="done"&&de.vectorTile)return de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity)}))}abortTile(ne){return w._(this,void 0,void 0,(function*(){const ie=this.loading,de=ne.uid;ie&&ie[de]&&ie[de].abort&&(ie[de].abort.abort(),delete ie[de])}))}removeTile(ne){return w._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[ne.uid]&&delete this.loaded[ne.uid]}))}}class qe{constructor(){this.loaded={}}loadTile(ne){return w._(this,void 0,void 0,(function*(){const{uid:ie,encoding:de,rawImageData:Ee,redFactor:Le,greenFactor:Ye,blueFactor:je,baseShift:Re}=ne,We=Ee.width+2,mt=Ee.height+2,pt=w.b(Ee)?new w.R({width:We,height:mt},yield w.d0(Ee,-1,-1,We,mt)):Ee,Vt=new w.d1(ie,pt,de,Le,Ye,je,Re);return this.loaded=this.loaded||{},this.loaded[ie]=Vt,Vt}))}removeTile(ne){const ie=this.loaded,de=ne.uid;ie&&ie[de]&&delete ie[de]}}var Fe,Ne,Be=(function(){if(Ne)return Fe;function Ve(ie,de){if(ie.length!==0){ne(ie[0],de);for(var Ee=1;Ee<ie.length;Ee++)ne(ie[Ee],!de)}}function ne(ie,de){for(var Ee=0,Le=0,Ye=0,je=ie.length,Re=je-1;Ye<je;Re=Ye++){var We=(ie[Ye][0]-ie[Re][0])*(ie[Re][1]+ie[Ye][1]),mt=Ee+We;Le+=Math.abs(Ee)>=Math.abs(We)?Ee-mt+We:We-mt+Ee,Ee=mt}Ee+Le>=0!=!!de&&ie.reverse()}return Ne=1,Fe=function ie(de,Ee){var Le,Ye=de&&de.type;if(Ye==="FeatureCollection")for(Le=0;Le<de.features.length;Le++)ie(de.features[Le],Ee);else if(Ye==="GeometryCollection")for(Le=0;Le<de.geometries.length;Le++)ie(de.geometries[Le],Ee);else if(Ye==="Feature")ie(de.geometry,Ee);else if(Ye==="Polygon")Ve(de.coordinates,Ee);else if(Ye==="MultiPolygon")for(Le=0;Le<de.coordinates.length;Le++)Ve(de.coordinates[Le],Ee);return de}})(),Pe=w.d2(Be);const $e={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ve=>Ve},Qe=Math.fround||(Et=new Float32Array(1),Ve=>(Et[0]=+Ve,Et[0]));var Et;class Ut{constructor(ne){this.options=Object.assign(Object.create($e),ne),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ne){const{log:ie,minZoom:de,maxZoom:Ee}=this.options;ie&&console.time("total time");const Le=`prepare ${ne.length} points`;ie&&console.time(Le),this.points=ne;const Ye=[];for(let Re=0;Re<ne.length;Re++){const We=ne[Re];if(!We.geometry)continue;const[mt,pt]=We.geometry.coordinates,Vt=Qe(li(mt)),Kt=Qe(nn(pt));Ye.push(Vt,Kt,1/0,Re,-1,1),this.options.reduce&&Ye.push(0)}let je=this.trees[Ee+1]=this._createTree(Ye);ie&&console.timeEnd(Le);for(let Re=Ee;Re>=de;Re--){const We=+Date.now();je=this.trees[Re]=this._createTree(this._cluster(je,Re)),ie&&console.log("z%d: %d clusters in %dms",Re,je.numItems,+Date.now()-We)}return ie&&console.timeEnd("total time"),this}getClusters(ne,ie){let de=((ne[0]+180)%360+360)%360-180;const Ee=Math.max(-90,Math.min(90,ne[1]));let Le=ne[2]===180?180:((ne[2]+180)%360+360)%360-180;const Ye=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)de=-180,Le=180;else if(de>Le){const pt=this.getClusters([de,Ee,180,Ye],ie),Vt=this.getClusters([-180,Ee,Le,Ye],ie);return pt.concat(Vt)}const je=this.trees[this._limitZoom(ie)],Re=je.range(li(de),nn(Ye),li(Le),nn(Ee)),We=je.data,mt=[];for(const pt of Re){const Vt=this.stride*pt;mt.push(We[Vt+5]>1?$t(We,Vt,this.clusterProps):this.points[We[Vt+3]])}return mt}getChildren(ne){const ie=this._getOriginId(ne),de=this._getOriginZoom(ne),Ee="No cluster with the specified id.",Le=this.trees[de];if(!Le)throw new Error(Ee);const Ye=Le.data;if(ie*this.stride>=Ye.length)throw new Error(Ee);const je=this.options.radius/(this.options.extent*Math.pow(2,de-1)),Re=Le.within(Ye[ie*this.stride],Ye[ie*this.stride+1],je),We=[];for(const mt of Re){const pt=mt*this.stride;Ye[pt+4]===ne&&We.push(Ye[pt+5]>1?$t(Ye,pt,this.clusterProps):this.points[Ye[pt+3]])}if(We.length===0)throw new Error(Ee);return We}getLeaves(ne,ie,de){const Ee=[];return this._appendLeaves(Ee,ne,ie=ie||10,de=de||0,0),Ee}getTile(ne,ie,de){const Ee=this.trees[this._limitZoom(ne)],Le=Math.pow(2,ne),{extent:Ye,radius:je}=this.options,Re=je/Ye,We=(de-Re)/Le,mt=(de+1+Re)/Le,pt={features:[]};return this._addTileFeatures(Ee.range((ie-Re)/Le,We,(ie+1+Re)/Le,mt),Ee.data,ie,de,Le,pt),ie===0&&this._addTileFeatures(Ee.range(1-Re/Le,We,1,mt),Ee.data,Le,de,Le,pt),ie===Le-1&&this._addTileFeatures(Ee.range(0,We,Re/Le,mt),Ee.data,-1,de,Le,pt),pt.features.length?pt:null}getClusterExpansionZoom(ne){let ie=this._getOriginZoom(ne)-1;for(;ie<=this.options.maxZoom;){const de=this.getChildren(ne);if(ie++,de.length!==1)break;ne=de[0].properties.cluster_id}return ie}_appendLeaves(ne,ie,de,Ee,Le){const Ye=this.getChildren(ie);for(const je of Ye){const Re=je.properties;if(Re&&Re.cluster?Le+Re.point_count<=Ee?Le+=Re.point_count:Le=this._appendLeaves(ne,Re.cluster_id,de,Ee,Le):Le<Ee?Le++:ne.push(je),ne.length===de)break}return Le}_createTree(ne){const ie=new w.aU(ne.length/this.stride|0,this.options.nodeSize,Float32Array);for(let de=0;de<ne.length;de+=this.stride)ie.add(ne[de],ne[de+1]);return ie.finish(),ie.data=ne,ie}_addTileFeatures(ne,ie,de,Ee,Le,Ye){for(const je of ne){const Re=je*this.stride,We=ie[Re+5]>1;let mt,pt,Vt;if(We)mt=hi(ie,Re,this.clusterProps),pt=ie[Re],Vt=ie[Re+1];else{const en=this.points[ie[Re+3]];mt=en.properties;const[Fi,Ze]=en.geometry.coordinates;pt=li(Fi),Vt=nn(Ze)}const Kt={type:1,geometry:[[Math.round(this.options.extent*(pt*Le-de)),Math.round(this.options.extent*(Vt*Le-Ee))]],tags:mt};let di;di=We||this.options.generateId?ie[Re+3]:this.points[ie[Re+3]].id,di!==void 0&&(Kt.id=di),Ye.features.push(Kt)}}_limitZoom(ne){return Math.max(this.options.minZoom,Math.min(Math.floor(+ne),this.options.maxZoom+1))}_cluster(ne,ie){const{radius:de,extent:Ee,reduce:Le,minPoints:Ye}=this.options,je=de/(Ee*Math.pow(2,ie)),Re=ne.data,We=[],mt=this.stride;for(let pt=0;pt<Re.length;pt+=mt){if(Re[pt+2]<=ie)continue;Re[pt+2]=ie;const Vt=Re[pt],Kt=Re[pt+1],di=ne.within(Re[pt],Re[pt+1],je),en=Re[pt+5];let Fi=en;for(const Ze of di){const ln=Ze*mt;Re[ln+2]>ie&&(Fi+=Re[ln+5])}if(Fi>en&&Fi>=Ye){let Ze,ln=Vt*en,dr=Kt*en,gi=-1;const un=(pt/mt<<5)+(ie+1)+this.points.length;for(const Er of di){const an=Er*mt;if(Re[an+2]<=ie)continue;Re[an+2]=ie;const nr=Re[an+5];ln+=Re[an]*nr,dr+=Re[an+1]*nr,Re[an+4]=un,Le&&(Ze||(Ze=this._map(Re,pt,!0),gi=this.clusterProps.length,this.clusterProps.push(Ze)),Le(Ze,this._map(Re,an)))}Re[pt+4]=un,We.push(ln/Fi,dr/Fi,1/0,un,-1,Fi),Le&&We.push(gi)}else{for(let Ze=0;Ze<mt;Ze++)We.push(Re[pt+Ze]);if(Fi>1)for(const Ze of di){const ln=Ze*mt;if(!(Re[ln+2]<=ie)){Re[ln+2]=ie;for(let dr=0;dr<mt;dr++)We.push(Re[ln+dr])}}}}return We}_getOriginId(ne){return ne-this.points.length>>5}_getOriginZoom(ne){return(ne-this.points.length)%32}_map(ne,ie,de){if(ne[ie+5]>1){const Ye=this.clusterProps[ne[ie+6]];return de?Object.assign({},Ye):Ye}const Ee=this.points[ne[ie+3]].properties,Le=this.options.map(Ee);return de&&Le===Ee?Object.assign({},Le):Le}}function $t(Ve,ne,ie){return{type:"Feature",id:Ve[ne+3],properties:hi(Ve,ne,ie),geometry:{type:"Point",coordinates:[(de=Ve[ne],360*(de-.5)),Ci(Ve[ne+1])]}};var de}function hi(Ve,ne,ie){const de=Ve[ne+5],Ee=de>=1e4?`${Math.round(de/1e3)}k`:de>=1e3?Math.round(de/100)/10+"k":de,Le=Ve[ne+6],Ye=Le===-1?{}:Object.assign({},ie[Le]);return Object.assign(Ye,{cluster:!0,cluster_id:Ve[ne+3],point_count:de,point_count_abbreviated:Ee})}function li(Ve){return Ve/360+.5}function nn(Ve){const ne=Math.sin(Ve*Math.PI/180),ie=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return ie<0?0:ie>1?1:ie}function Ci(Ve){const ne=(180-360*Ve)*Math.PI/180;return 360*Math.atan(Math.exp(ne))/Math.PI-90}function Qi(Ve,ne,ie,de){let Ee=de;const Le=ne+(ie-ne>>1);let Ye,je=ie-ne;const Re=Ve[ne],We=Ve[ne+1],mt=Ve[ie],pt=Ve[ie+1];for(let Vt=ne+3;Vt<ie;Vt+=3){const Kt=lt(Ve[Vt],Ve[Vt+1],Re,We,mt,pt);if(Kt>Ee)Ye=Vt,Ee=Kt;else if(Kt===Ee){const di=Math.abs(Vt-Le);di<je&&(Ye=Vt,je=di)}}Ee>de&&(Ye-ne>3&&Qi(Ve,ne,Ye,de),Ve[Ye+2]=Ee,ie-Ye>3&&Qi(Ve,Ye,ie,de))}function lt(Ve,ne,ie,de,Ee,Le){let Ye=Ee-ie,je=Le-de;if(Ye!==0||je!==0){const Re=((Ve-ie)*Ye+(ne-de)*je)/(Ye*Ye+je*je);Re>1?(ie=Ee,de=Le):Re>0&&(ie+=Ye*Re,de+=je*Re)}return Ye=Ve-ie,je=ne-de,Ye*Ye+je*je}function Pt(Ve,ne,ie,de){const Ee={id:Ve??null,type:ne,geometry:ie,tags:de,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ne==="Point"||ne==="MultiPoint"||ne==="LineString")Mt(Ee,ie);else if(ne==="Polygon")Mt(Ee,ie[0]);else if(ne==="MultiLineString")for(const Le of ie)Mt(Ee,Le);else if(ne==="MultiPolygon")for(const Le of ie)Mt(Ee,Le[0]);return Ee}function Mt(Ve,ne){for(let ie=0;ie<ne.length;ie+=3)Ve.minX=Math.min(Ve.minX,ne[ie]),Ve.minY=Math.min(Ve.minY,ne[ie+1]),Ve.maxX=Math.max(Ve.maxX,ne[ie]),Ve.maxY=Math.max(Ve.maxY,ne[ie+1])}function ei(Ve,ne,ie,de){if(!ne.geometry)return;const Ee=ne.geometry.coordinates;if(Ee&&Ee.length===0)return;const Le=ne.geometry.type,Ye=Math.pow(ie.tolerance/((1<<ie.maxZoom)*ie.extent),2);let je=[],Re=ne.id;if(ie.promoteId?Re=ne.properties[ie.promoteId]:ie.generateId&&(Re=de||0),Le==="Point")Nt(Ee,je);else if(Le==="MultiPoint")for(const We of Ee)Nt(We,je);else if(Le==="LineString")ze(Ee,je,Ye,!1);else if(Le==="MultiLineString"){if(ie.lineMetrics){for(const We of Ee)je=[],ze(We,je,Ye,!1),Ve.push(Pt(Re,"LineString",je,ne.properties));return}dt(Ee,je,Ye,!1)}else if(Le==="Polygon")dt(Ee,je,Ye,!0);else{if(Le!=="MultiPolygon"){if(Le==="GeometryCollection"){for(const We of ne.geometry.geometries)ei(Ve,{id:Re,geometry:We,properties:ne.properties},ie,de);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const We of Ee){const mt=[];dt(We,mt,Ye,!0),je.push(mt)}}Ve.push(Pt(Re,Le,je,ne.properties))}function Nt(Ve,ne){ne.push(It(Ve[0]),zt(Ve[1]),0)}function ze(Ve,ne,ie,de){let Ee,Le,Ye=0;for(let Re=0;Re<Ve.length;Re++){const We=It(Ve[Re][0]),mt=zt(Ve[Re][1]);ne.push(We,mt,0),Re>0&&(Ye+=de?(Ee*mt-We*Le)/2:Math.sqrt(Math.pow(We-Ee,2)+Math.pow(mt-Le,2))),Ee=We,Le=mt}const je=ne.length-3;ne[2]=1,Qi(ne,0,je,ie),ne[je+2]=1,ne.size=Math.abs(Ye),ne.start=0,ne.end=ne.size}function dt(Ve,ne,ie,de){for(let Ee=0;Ee<Ve.length;Ee++){const Le=[];ze(Ve[Ee],Le,ie,de),ne.push(Le)}}function It(Ve){return Ve/360+.5}function zt(Ve){const ne=Math.sin(Ve*Math.PI/180),ie=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return ie<0?0:ie>1?1:ie}function Dt(Ve,ne,ie,de,Ee,Le,Ye,je){if(de/=ne,Le>=(ie/=ne)&&Ye<de)return Ve;if(Ye<ie||Le>=de)return null;const Re=[];for(const We of Ve){const mt=We.geometry;let pt=We.type;const Vt=Ee===0?We.minX:We.minY,Kt=Ee===0?We.maxX:We.maxY;if(Vt>=ie&&Kt<de){Re.push(We);continue}if(Kt<ie||Vt>=de)continue;let di=[];if(pt==="Point"||pt==="MultiPoint")kt(mt,di,ie,de,Ee);else if(pt==="LineString")fi(mt,di,ie,de,Ee,!1,je.lineMetrics);else if(pt==="MultiLineString")rn(mt,di,ie,de,Ee,!1);else if(pt==="Polygon")rn(mt,di,ie,de,Ee,!0);else if(pt==="MultiPolygon")for(const en of mt){const Fi=[];rn(en,Fi,ie,de,Ee,!0),Fi.length&&di.push(Fi)}if(di.length){if(je.lineMetrics&&pt==="LineString"){for(const en of di)Re.push(Pt(We.id,pt,en,We.tags));continue}pt!=="LineString"&&pt!=="MultiLineString"||(di.length===1?(pt="LineString",di=di[0]):pt="MultiLineString"),pt!=="Point"&&pt!=="MultiPoint"||(pt=di.length===3?"Point":"MultiPoint"),Re.push(Pt(We.id,pt,di,We.tags))}}return Re.length?Re:null}function kt(Ve,ne,ie,de,Ee){for(let Le=0;Le<Ve.length;Le+=3){const Ye=Ve[Le+Ee];Ye>=ie&&Ye<=de&&hr(ne,Ve[Le],Ve[Le+1],Ve[Le+2])}}function fi(Ve,ne,ie,de,Ee,Le,Ye){let je=Ei(Ve);const Re=Ee===0?_o:Mr;let We,mt,pt=Ve.start;for(let Fi=0;Fi<Ve.length-3;Fi+=3){const Ze=Ve[Fi],ln=Ve[Fi+1],dr=Ve[Fi+2],gi=Ve[Fi+3],un=Ve[Fi+4],Er=Ee===0?Ze:ln,an=Ee===0?gi:un;let nr=!1;Ye&&(We=Math.sqrt(Math.pow(Ze-gi,2)+Math.pow(ln-un,2))),Er<ie?an>ie&&(mt=Re(je,Ze,ln,gi,un,ie),Ye&&(je.start=pt+We*mt)):Er>de?an<de&&(mt=Re(je,Ze,ln,gi,un,de),Ye&&(je.start=pt+We*mt)):hr(je,Ze,ln,dr),an<ie&&Er>=ie&&(mt=Re(je,Ze,ln,gi,un,ie),nr=!0),an>de&&Er<=de&&(mt=Re(je,Ze,ln,gi,un,de),nr=!0),!Le&&nr&&(Ye&&(je.end=pt+We*mt),ne.push(je),je=Ei(Ve)),Ye&&(pt+=We)}let Vt=Ve.length-3;const Kt=Ve[Vt],di=Ve[Vt+1],en=Ee===0?Kt:di;en>=ie&&en<=de&&hr(je,Kt,di,Ve[Vt+2]),Vt=je.length-3,Le&&Vt>=3&&(je[Vt]!==je[0]||je[Vt+1]!==je[1])&&hr(je,je[0],je[1],je[2]),je.length&&ne.push(je)}function Ei(Ve){const ne=[];return ne.size=Ve.size,ne.start=Ve.start,ne.end=Ve.end,ne}function rn(Ve,ne,ie,de,Ee,Le){for(const Ye of Ve)fi(Ye,ne,ie,de,Ee,Le,!1)}function hr(Ve,ne,ie,de){Ve.push(ne,ie,de)}function _o(Ve,ne,ie,de,Ee,Le){const Ye=(Le-ne)/(de-ne);return hr(Ve,Le,ie+(Ee-ie)*Ye,1),Ye}function Mr(Ve,ne,ie,de,Ee,Le){const Ye=(Le-ie)/(Ee-ie);return hr(Ve,ne+(de-ne)*Ye,Le,1),Ye}function as(Ve,ne){const ie=[];for(let de=0;de<Ve.length;de++){const Ee=Ve[de],Le=Ee.type;let Ye;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")Ye=Rn(Ee.geometry,ne);else if(Le==="MultiLineString"||Le==="Polygon"){Ye=[];for(const je of Ee.geometry)Ye.push(Rn(je,ne))}else if(Le==="MultiPolygon"){Ye=[];for(const je of Ee.geometry){const Re=[];for(const We of je)Re.push(Rn(We,ne));Ye.push(Re)}}ie.push(Pt(Ee.id,Le,Ye,Ee.tags))}return ie}function Rn(Ve,ne){const ie=[];ie.size=Ve.size,Ve.start!==void 0&&(ie.start=Ve.start,ie.end=Ve.end);for(let de=0;de<Ve.length;de+=3)ie.push(Ve[de]+ne,Ve[de+1],Ve[de+2]);return ie}function Jr(Ve,ne){if(Ve.transformed)return Ve;const ie=1<<Ve.z,de=Ve.x,Ee=Ve.y;for(const Le of Ve.features){const Ye=Le.geometry,je=Le.type;if(Le.geometry=[],je===1)for(let Re=0;Re<Ye.length;Re+=2)Le.geometry.push(wa(Ye[Re],Ye[Re+1],ne,ie,de,Ee));else for(let Re=0;Re<Ye.length;Re++){const We=[];for(let mt=0;mt<Ye[Re].length;mt+=2)We.push(wa(Ye[Re][mt],Ye[Re][mt+1],ne,ie,de,Ee));Le.geometry.push(We)}}return Ve.transformed=!0,Ve}function wa(Ve,ne,ie,de,Ee,Le){return[Math.round(ie*(Ve*de-Ee)),Math.round(ie*(ne*de-Le))]}function Cn(Ve,ne,ie,de,Ee){const Le=ne===Ee.maxZoom?0:Ee.tolerance/((1<<ne)*Ee.extent),Ye={features:[],numPoints:0,numSimplified:0,numFeatures:Ve.length,source:null,x:ie,y:de,z:ne,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const je of Ve)La(Ye,je,Le,Ee);return Ye}function La(Ve,ne,ie,de){const Ee=ne.geometry,Le=ne.type,Ye=[];if(Ve.minX=Math.min(Ve.minX,ne.minX),Ve.minY=Math.min(Ve.minY,ne.minY),Ve.maxX=Math.max(Ve.maxX,ne.maxX),Ve.maxY=Math.max(Ve.maxY,ne.maxY),Le==="Point"||Le==="MultiPoint")for(let je=0;je<Ee.length;je+=3)Ye.push(Ee[je],Ee[je+1]),Ve.numPoints++,Ve.numSimplified++;else if(Le==="LineString")ko(Ye,Ee,Ve,ie,!1,!1);else if(Le==="MultiLineString"||Le==="Polygon")for(let je=0;je<Ee.length;je++)ko(Ye,Ee[je],Ve,ie,Le==="Polygon",je===0);else if(Le==="MultiPolygon")for(let je=0;je<Ee.length;je++){const Re=Ee[je];for(let We=0;We<Re.length;We++)ko(Ye,Re[We],Ve,ie,!0,We===0)}if(Ye.length){let je=ne.tags||null;if(Le==="LineString"&&de.lineMetrics){je={};for(const We in ne.tags)je[We]=ne.tags[We];je.mapbox_clip_start=Ee.start/Ee.size,je.mapbox_clip_end=Ee.end/Ee.size}const Re={geometry:Ye,type:Le==="Polygon"||Le==="MultiPolygon"?3:Le==="LineString"||Le==="MultiLineString"?2:1,tags:je};ne.id!==null&&(Re.id=ne.id),Ve.features.push(Re)}}function ko(Ve,ne,ie,de,Ee,Le){const Ye=de*de;if(de>0&&ne.size<(Ee?Ye:de))return void(ie.numPoints+=ne.length/3);const je=[];for(let Re=0;Re<ne.length;Re+=3)(de===0||ne[Re+2]>Ye)&&(ie.numSimplified++,je.push(ne[Re],ne[Re+1])),ie.numPoints++;Ee&&(function(Re,We){let mt=0;for(let pt=0,Vt=Re.length,Kt=Vt-2;pt<Vt;Kt=pt,pt+=2)mt+=(Re[pt]-Re[Kt])*(Re[pt+1]+Re[Kt+1]);if(mt>0===We)for(let pt=0,Vt=Re.length;pt<Vt/2;pt+=2){const Kt=Re[pt],di=Re[pt+1];Re[pt]=Re[Vt-2-pt],Re[pt+1]=Re[Vt-1-pt],Re[Vt-2-pt]=Kt,Re[Vt-1-pt]=di}})(je,Le),Ve.push(je)}const Oo={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class no{constructor(ne,ie){const de=(ie=this.options=(function(Le,Ye){for(const je in Ye)Le[je]=Ye[je];return Le})(Object.create(Oo),ie)).debug;if(de&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ee=(function(Le,Ye){const je=[];if(Le.type==="FeatureCollection")for(let Re=0;Re<Le.features.length;Re++)ei(je,Le.features[Re],Ye,Re);else ei(je,Le.type==="Feature"?Le:{geometry:Le},Ye);return je})(ne,ie);this.tiles={},this.tileCoords=[],de&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ee=(function(Le,Ye){const je=Ye.buffer/Ye.extent;let Re=Le;const We=Dt(Le,1,-1-je,je,0,-1,2,Ye),mt=Dt(Le,1,1-je,2+je,0,-1,2,Ye);return(We||mt)&&(Re=Dt(Le,1,-je,1+je,0,-1,2,Ye)||[],We&&(Re=as(We,1).concat(Re)),mt&&(Re=Re.concat(as(mt,-1)))),Re})(Ee,ie),Ee.length&&this.splitTile(Ee,0,0,0),de&&(Ee.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ne,ie,de,Ee,Le,Ye,je){const Re=[ne,ie,de,Ee],We=this.options,mt=We.debug;for(;Re.length;){Ee=Re.pop(),de=Re.pop(),ie=Re.pop(),ne=Re.pop();const pt=1<<ie,Vt=vo(ie,de,Ee);let Kt=this.tiles[Vt];if(!Kt&&(mt>1&&console.time("creation"),Kt=this.tiles[Vt]=Cn(ne,ie,de,Ee,We),this.tileCoords.push({z:ie,x:de,y:Ee}),mt)){mt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,de,Ee,Kt.numFeatures,Kt.numPoints,Kt.numSimplified),console.timeEnd("creation"));const nr=`z${ie}`;this.stats[nr]=(this.stats[nr]||0)+1,this.total++}if(Kt.source=ne,Le==null){if(ie===We.indexMaxZoom||Kt.numPoints<=We.indexMaxPoints)continue}else{if(ie===We.maxZoom||ie===Le)continue;if(Le!=null){const nr=Le-ie;if(de!==Ye>>nr||Ee!==je>>nr)continue}}if(Kt.source=null,ne.length===0)continue;mt>1&&console.time("clipping");const di=.5*We.buffer/We.extent,en=.5-di,Fi=.5+di,Ze=1+di;let ln=null,dr=null,gi=null,un=null,Er=Dt(ne,pt,de-di,de+Fi,0,Kt.minX,Kt.maxX,We),an=Dt(ne,pt,de+en,de+Ze,0,Kt.minX,Kt.maxX,We);ne=null,Er&&(ln=Dt(Er,pt,Ee-di,Ee+Fi,1,Kt.minY,Kt.maxY,We),dr=Dt(Er,pt,Ee+en,Ee+Ze,1,Kt.minY,Kt.maxY,We),Er=null),an&&(gi=Dt(an,pt,Ee-di,Ee+Fi,1,Kt.minY,Kt.maxY,We),un=Dt(an,pt,Ee+en,Ee+Ze,1,Kt.minY,Kt.maxY,We),an=null),mt>1&&console.timeEnd("clipping"),Re.push(ln||[],ie+1,2*de,2*Ee),Re.push(dr||[],ie+1,2*de,2*Ee+1),Re.push(gi||[],ie+1,2*de+1,2*Ee),Re.push(un||[],ie+1,2*de+1,2*Ee+1)}}getTile(ne,ie,de){ne=+ne,ie=+ie,de=+de;const Ee=this.options,{extent:Le,debug:Ye}=Ee;if(ne<0||ne>24)return null;const je=1<<ne,Re=vo(ne,ie=ie+je&je-1,de);if(this.tiles[Re])return Jr(this.tiles[Re],Le);Ye>1&&console.log("drilling down to z%d-%d-%d",ne,ie,de);let We,mt=ne,pt=ie,Vt=de;for(;!We&&mt>0;)mt--,pt>>=1,Vt>>=1,We=this.tiles[vo(mt,pt,Vt)];return We&&We.source?(Ye>1&&(console.log("found parent tile z%d-%d-%d",mt,pt,Vt),console.time("drilling down")),this.splitTile(We.source,mt,pt,Vt,ne,ie,de),Ye>1&&console.timeEnd("drilling down"),this.tiles[Re]?Jr(this.tiles[Re],Le):null):null}}function vo(Ve,ne,ie){return 32*((1<<Ve)*ie+ne)+Ve}class wl extends ce{constructor(ne,ie,de,Ee=Rr){super(ne,ie,de),this._dataUpdateable=new Map,this._createGeoJSONIndex=Ee}loadVectorTile(ne,ie){return w._(this,void 0,void 0,(function*(){const de=ne.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Ee=this._geoJSONIndex.getTile(de.z,de.x,de.y);return Ee?ge(new w.d3(Ee.features,{version:2,extent:w.a5})):null}))}loadData(ne){return w._(this,void 0,void 0,(function*(){var ie;(ie=this._pendingRequest)===null||ie===void 0||ie.abort();const de=this._startPerformance(ne);this._pendingRequest=new AbortController;try{(!this._pendingData||ne.request||ne.data||ne.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(ne,this._pendingRequest));const Ee=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(Ee,ne),this.loaded={};const Le={};return this._finishPerformance(de,ne,Le),Le}catch(Ee){if(delete this._pendingRequest,w.Z(Ee))return{abandoned:!0};throw Ee}}))}_startPerformance(ne){var ie;if(!((ie=ne?.request)===null||ie===void 0)&&ie.collectResourceTiming)return new w.c$(ne.request)}_finishPerformance(ne,ie,de){if(!ne)return;const Ee=ne.finish();Ee&&(de.resourceTiming={},de.resourceTiming[ie.source]=JSON.parse(JSON.stringify(Ee)))}getData(){return w._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(ne){const ie=this.loaded;return ie&&ie[ne.uid]?super.reloadTile(ne):this.loadTile(ne)}loadAndProcessGeoJSON(ne,ie){return w._(this,void 0,void 0,(function*(){let de;if(ne.request?de=yield this.loadGeoJSONFromUrl(ne.request,ne.promoteId,ie):ne.data?de=this._loadGeoJSONFromObject(ne.data,ne.promoteId):ne.dataDiff&&(de=this._loadGeoJSONFromDiff(ne.dataDiff,ne.promoteId,ne.source)),delete this._pendingRequest,typeof de!="object")throw new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`);return Pe(de,!0),ne.filter&&(de=this._filterGeoJSON(de,ne.filter)),de}))}loadGeoJSONFromUrl(ne,ie,de){return w._(this,void 0,void 0,(function*(){const Ee=yield w.j(ne,de);return this._dataUpdateable=w.a7(Ee.data,ie)?w.a8(Ee.data,ie):void 0,Ee.data}))}_loadGeoJSONFromObject(ne,ie){return this._dataUpdateable=w.a7(ne,ie)?w.a8(ne,ie):void 0,ne}_loadGeoJSONFromDiff(ne,ie,de){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${de}`);w.a9(this._dataUpdateable,ne,ie);const Ee=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(Ee)}_filterGeoJSON(ne,ie){const de=w.d4(ie,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(de.result==="error")throw new Error(de.value.map((Le=>`${Le.key}: ${Le.message}`)).join(", "));const Ee=ne.features.filter((Le=>de.value.evaluate({zoom:0},Le)));return this._toFeatureCollection(Ee)}_toFeatureCollection(ne){return{type:"FeatureCollection",features:ne}}removeSource(ne){return w._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(ne){return this._geoJSONIndex.getClusterExpansionZoom(ne.clusterId)}getClusterChildren(ne){return this._geoJSONIndex.getChildren(ne.clusterId)}getClusterLeaves(ne){return this._geoJSONIndex.getLeaves(ne.clusterId,ne.limit,ne.offset)}}function Rr(Ve,ne){return ne.cluster?new Ut((function({superclusterOptions:ie,clusterProperties:de}){if(!de||!ie)return ie;const Ee={},Le={},Ye={accumulated:null,zoom:0},je={properties:null},Re=Object.keys(de);for(const We of Re){const[mt,pt]=de[We],Vt=w.d4(pt),Kt=w.d4(typeof mt=="string"?[mt,["accumulated"],["get",We]]:mt);Ee[We]=Vt.value,Le[We]=Kt.value}return ie.map=We=>{je.properties=We;const mt={};for(const pt of Re)mt[pt]=Ee[pt].evaluate(Ye,je);return mt},ie.reduce=(We,mt)=>{je.properties=mt;for(const pt of Re)Ye.accumulated=We[pt],We[pt]=Le[pt].evaluate(Ye,je)},ie})(ne)).load(Ve.features):(function(ie,de){return new no(ie,de)})(Ve,ne.geojsonVtOptions)}class Da{constructor(ne){this.self=ne,this.actor=new w.L(ne),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(ie,de)=>{if(this.externalWorkerSourceTypes[ie])throw new Error(`Worker source with name "${ie}" already registered.`);this.externalWorkerSourceTypes[ie]=de},this.self.addProtocol=w.cK,this.self.removeProtocol=w.cL,this.self.registerRTLTextPlugin=ie=>{w.d5.setMethods(ie)},this.actor.registerMessageHandler("LDT",((ie,de)=>this._getDEMWorkerSource(ie,de.source).loadTile(de))),this.actor.registerMessageHandler("RDT",((ie,de)=>w._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(ie,de.source).removeTile(de)})))),this.actor.registerMessageHandler("GCEZ",((ie,de)=>w._(this,void 0,void 0,(function*(){return this._getWorkerSource(ie,de.type,de.source).getClusterExpansionZoom(de)})))),this.actor.registerMessageHandler("GCC",((ie,de)=>w._(this,void 0,void 0,(function*(){return this._getWorkerSource(ie,de.type,de.source).getClusterChildren(de)})))),this.actor.registerMessageHandler("GCL",((ie,de)=>w._(this,void 0,void 0,(function*(){return this._getWorkerSource(ie,de.type,de.source).getClusterLeaves(de)})))),this.actor.registerMessageHandler("LD",((ie,de)=>this._getWorkerSource(ie,de.type,de.source).loadData(de))),this.actor.registerMessageHandler("GD",((ie,de)=>this._getWorkerSource(ie,de.type,de.source).getData())),this.actor.registerMessageHandler("LT",((ie,de)=>this._getWorkerSource(ie,de.type,de.source).loadTile(de))),this.actor.registerMessageHandler("RT",((ie,de)=>this._getWorkerSource(ie,de.type,de.source).reloadTile(de))),this.actor.registerMessageHandler("AT",((ie,de)=>this._getWorkerSource(ie,de.type,de.source).abortTile(de))),this.actor.registerMessageHandler("RMT",((ie,de)=>this._getWorkerSource(ie,de.type,de.source).removeTile(de))),this.actor.registerMessageHandler("RS",((ie,de)=>w._(this,void 0,void 0,(function*(){if(!this.workerSources[ie]||!this.workerSources[ie][de.type]||!this.workerSources[ie][de.type][de.source])return;const Ee=this.workerSources[ie][de.type][de.source];delete this.workerSources[ie][de.type][de.source],Ee.removeSource!==void 0&&Ee.removeSource(de)})))),this.actor.registerMessageHandler("RM",(ie=>w._(this,void 0,void 0,(function*(){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.workerSources[ie],delete this.demWorkerSources[ie],this.globalStates.delete(ie)})))),this.actor.registerMessageHandler("SR",((ie,de)=>w._(this,void 0,void 0,(function*(){this.referrer=de})))),this.actor.registerMessageHandler("SRPS",((ie,de)=>this._syncRTLPluginState(ie,de))),this.actor.registerMessageHandler("IS",((ie,de)=>w._(this,void 0,void 0,(function*(){this.self.importScripts(de)})))),this.actor.registerMessageHandler("SI",((ie,de)=>this._setImages(ie,de))),this.actor.registerMessageHandler("UL",((ie,de)=>w._(this,void 0,void 0,(function*(){this._getLayerIndex(ie).update(de.layers,de.removedIds,this._getGlobalState(ie))})))),this.actor.registerMessageHandler("UGS",((ie,de)=>w._(this,void 0,void 0,(function*(){const Ee=this._getGlobalState(ie);for(const Le in de)Ee[Le]=de[Le]})))),this.actor.registerMessageHandler("SL",((ie,de)=>w._(this,void 0,void 0,(function*(){this._getLayerIndex(ie).replace(de,this._getGlobalState(ie))}))))}_getGlobalState(ne){let ie=this.globalStates.get(ne);return ie||(ie={},this.globalStates.set(ne,ie)),ie}_setImages(ne,ie){return w._(this,void 0,void 0,(function*(){this.availableImages[ne]=ie;for(const de in this.workerSources[ne]){const Ee=this.workerSources[ne][de];for(const Le in Ee)Ee[Le].availableImages=ie}}))}_syncRTLPluginState(ne,ie){return w._(this,void 0,void 0,(function*(){return yield w.d5.syncState(ie,this.self.importScripts)}))}_getAvailableImages(ne){let ie=this.availableImages[ne];return ie||(ie=[]),ie}_getLayerIndex(ne){let ie=this.layerIndexes[ne];return ie||(ie=this.layerIndexes[ne]=new c),ie}_getWorkerSource(ne,ie,de){if(this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][ie]||(this.workerSources[ne][ie]={}),!this.workerSources[ne][ie][de]){const Ee={sendAsync:(Le,Ye)=>(Le.targetMapId=ne,this.actor.sendAsync(Le,Ye))};switch(ie){case"vector":this.workerSources[ne][ie][de]=new ce(Ee,this._getLayerIndex(ne),this._getAvailableImages(ne));break;case"geojson":this.workerSources[ne][ie][de]=new wl(Ee,this._getLayerIndex(ne),this._getAvailableImages(ne));break;default:this.workerSources[ne][ie][de]=new this.externalWorkerSourceTypes[ie](Ee,this._getLayerIndex(ne),this._getAvailableImages(ne))}}return this.workerSources[ne][ie][de]}_getDEMWorkerSource(ne,ie){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][ie]||(this.demWorkerSources[ne][ie]=new qe),this.demWorkerSources[ne][ie]}}return w.i(self)&&(self.worker=new Da(self)),Da})),S("index",["exports","./shared"],(function(w,c){var k="5.14.0";function N(){var b=new c.A(4);return c.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let H,K,ae;const ue={frame(b,t,o){const f=requestAnimationFrame((M=>{y(),t(M)})),{unsubscribe:y}=c.s(b.signal,"abort",(()=>{y(),cancelAnimationFrame(f),o(new c.a(b.signal.reason))}),!1)},frameAsync(b){return new Promise(((t,o)=>{this.frame(b,t,o)}))},getImageData(b,t=0){return this.getImageCanvasContext(b).getImageData(-t,-t,b.width+2*t,b.height+2*t)},getImageCanvasContext(b){const t=window.document.createElement("canvas"),o=t.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return t.width=b.width,t.height=b.height,o.drawImage(b,0,0,b.width,b.height),o},resolveURL:b=>(H||(H=document.createElement("a")),H.href=b,H.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return ae!==void 0?ae:!!matchMedia&&(K==null&&(K=matchMedia("(prefers-reduced-motion: reduce)")),K.matches)},set prefersReducedMotion(b){ae=b}},ge=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(b){this._frozenAt=b}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function fe(){return ge.getCurrentTime()}class ce{static testProp(t){if(!ce.docStyle)return t[0];for(let o=0;o<t.length;o++)if(t[o]in ce.docStyle)return t[o];return t[0]}static create(t,o,f){const y=window.document.createElement(t);return o!==void 0&&(y.className=o),f&&f.appendChild(y),y}static createNS(t,o){return window.document.createElementNS(t,o)}static disableDrag(){ce.docStyle&&ce.selectProp&&(ce.userSelect=ce.docStyle[ce.selectProp],ce.docStyle[ce.selectProp]="none")}static enableDrag(){ce.docStyle&&ce.selectProp&&(ce.docStyle[ce.selectProp]=ce.userSelect)}static setTransform(t,o){t.style[ce.transformProp]=o}static addEventListener(t,o,f,y={}){t.addEventListener(o,f,"passive"in y?y:y.capture)}static removeEventListener(t,o,f,y={}){t.removeEventListener(o,f,"passive"in y?y:y.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",ce.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ce.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",ce.suppressClickInternal,!0)}),0)}static getScale(t){const o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}static getPoint(t,o,f){const y=o.boundingClientRect;return new c.P((f.clientX-y.left)/o.x-t.clientLeft,(f.clientY-y.top)/o.y-t.clientTop)}static mousePos(t,o){const f=ce.getScale(t);return ce.getPoint(t,f,o)}static touchPos(t,o){const f=[],y=ce.getScale(t);for(let M=0;M<o.length;M++)f.push(ce.getPoint(t,y,o[M]));return f}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const o=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),f=o.querySelectorAll("script");for(const y of f)y.remove();return ce.clean(o),o.innerHTML}static isPossiblyDangerous(t,o){const f=o.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!f.includes("javascript:")&&!f.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const o=t.children;for(const f of o)ce.removeAttributes(f),ce.clean(f)}static removeAttributes(t){for(const{name:o,value:f}of t.attributes)ce.isPossiblyDangerous(o,f)&&t.removeAttribute(o)}}ce.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ce.selectProp=ce.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ce.transformProp=ce.testProp(["transform","WebkitTransform"]);const qe={supported:!1,testSupport:function(b){!Be&&Ne&&(Pe?$e(b):Fe=b)}};let Fe,Ne,Be=!1,Pe=!1;function $e(b){const t=b.createTexture();b.bindTexture(b.TEXTURE_2D,t);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,Ne),b.isContextLost())return;qe.supported=!0}catch{}b.deleteTexture(t),Be=!0}var Qe;typeof document<"u"&&(Ne=document.createElement("img"),Ne.onload=()=>{Fe&&$e(Fe),Fe=null,Pe=!0},Ne.onerror=()=>{Be=!0,Fe=null},Ne.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(b){let t,o,f,y;b.resetRequestQueue=()=>{t=[],o=0,f=0,y={}},b.addThrottleControl=O=>{const U=f++;return y[U]=O,U},b.removeThrottleControl=O=>{delete y[O],C()},b.getImage=(O,U,G=!0)=>new Promise(((X,$)=>{qe.supported&&(O.headers||(O.headers={}),O.headers.accept="image/webp,*/*"),c.e(O,{type:"image"}),t.push({abortController:U,requestParameters:O,supportImageRefresh:G,state:"queued",onError:ee=>{$(ee)},onSuccess:ee=>{X(ee)}}),C()}));const M=O=>c._(this,void 0,void 0,(function*(){O.state="running";const{requestParameters:U,supportImageRefresh:G,onError:X,onSuccess:$,abortController:ee}=O,re=G===!1&&!c.i(self)&&!c.g(U.url)&&(!U.headers||Object.keys(U.headers).reduce(((ye,ve)=>ye&&ve==="accept"),!0));o++;const me=re?D(U,ee):c.m(U,ee);try{const ye=yield me;delete O.abortController,O.state="completed",ye.data instanceof HTMLImageElement||c.b(ye.data)?$(ye):ye.data&&$({data:yield(_e=ye.data,typeof createImageBitmap=="function"?c.f(_e):c.h(_e)),cacheControl:ye.cacheControl,expires:ye.expires})}catch(ye){delete O.abortController,X(ye)}finally{o--,C()}var _e})),C=()=>{const O=(()=>{for(const U of Object.keys(y))if(y[U]())return!0;return!1})()?c.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let U=o;U<O&&t.length>0;U++){const G=t.shift();G.abortController.signal.aborted?U--:M(G)}},D=(O,U)=>new Promise(((G,X)=>{const $=new Image,ee=O.url,re=O.credentials;re&&re==="include"?$.crossOrigin="use-credentials":(re&&re==="same-origin"||!c.d(ee))&&($.crossOrigin="anonymous"),U.signal.addEventListener("abort",(()=>{$.src="",X(new c.a(U.signal.reason))})),$.fetchPriority="high",$.onload=()=>{$.onerror=$.onload=null,G({data:$})},$.onerror=()=>{$.onerror=$.onload=null,U.signal.aborted||X(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},$.src=ee}))})(Qe||(Qe={})),Qe.resetRequestQueue();class Et{constructor(t){this._transformRequestFn=t??null}transformRequest(t,o){return this._transformRequestFn&&this._transformRequestFn(t,o)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Ut(b){const t=[];if(typeof b=="string")t.push({id:"default",url:b});else if(b&&b.length>0){const o=[];for(const{id:f,url:y}of b){const M=`${f}${y}`;o.indexOf(M)===-1&&(o.push(M),t.push({id:f,url:y}))}}return t}function $t(b,t,o){try{const f=new URL(b);return f.pathname+=`${t}${o}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function hi(b){const{userImage:t}=b;return!!(t&&t.render&&t.render())&&(b.data.replace(new Uint8Array(t.data.buffer)),!0)}class li extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const t of Object.keys(this.images))this.removeImage(t);this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:o,promiseResolve:f}of this.requestors)f(this._getImagesForIds(o));this.requestors=[]}}getImage(t){const o=this.images[t];if(o&&!o.data&&o.spriteData){const f=o.spriteData;o.data=new c.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),o.spriteData=null}return o}addImage(t,o){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,o)&&(this.images[t]=o)}_validate(t,o){let f=!0;const y=o.data||o.spriteData;return this._validateStretch(o.stretchX,y&&y.width)||(this.fire(new c.k(new Error(`Image "${t}" has invalid "stretchX" value`))),f=!1),this._validateStretch(o.stretchY,y&&y.height)||(this.fire(new c.k(new Error(`Image "${t}" has invalid "stretchY" value`))),f=!1),this._validateContent(o.content,o)||(this.fire(new c.k(new Error(`Image "${t}" has invalid "content" value`))),f=!1),f}_validateStretch(t,o){if(!t)return!0;let f=0;for(const y of t){if(y[0]<f||y[1]<y[0]||o<y[1])return!1;f=y[1]}return!0}_validateContent(t,o){if(!t)return!0;if(t.length!==4)return!1;const f=o.spriteData,y=f&&f.width||o.data.width,M=f&&f.height||o.data.height;return!(t[0]<0||y<t[0]||t[1]<0||M<t[1]||t[2]<0||y<t[2]||t[3]<0||M<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,o,f=!0){const y=this.getImage(t);if(f&&(y.data.width!==o.data.width||y.data.height!==o.data.height))throw new Error(`size mismatch between old image (${y.data.width}x${y.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=y.version+1,this.images[t]=o,this.updatedImages[t]=!0}removeImage(t){const o=this.images[t];delete this.images[t],delete this.patterns[t],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((o,f)=>{let y=!0;if(!this.isLoaded())for(const M of t)this.images[M]||(y=!1);this.isLoaded()||y?o(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:o})}))}_getImagesForIds(t){const o={};for(const f of t){let y=this.getImage(f);y||(this.fire(new c.l("styleimagemissing",{id:f})),y=this.getImage(f)),y?o[f]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,textFitWidth:y.textFitWidth,textFitHeight:y.textFitHeight,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:c.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:t,height:o}=this.atlasImage;return{width:t,height:o}}getPattern(t){const o=this.patterns[t],f=this.getImage(t);if(!f)return null;if(o&&o.position.version===f.version)return o.position;if(o)o.position.version=f.version;else{const y={w:f.data.width+2,h:f.data.height+2,x:0,y:0},M=new c.I(y,f);this.patterns[t]={bin:y,position:M}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const o=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(t,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const M in this.patterns)t.push(this.patterns[M].bin);const{w:o,h:f}=c.p(t),y=this.atlasImage;y.resize({width:o||1,height:f||1});for(const M in this.patterns){const{bin:C}=this.patterns[M],D=C.x+1,O=C.y+1,U=this.getImage(M).data,G=U.width,X=U.height;c.R.copy(U,y,{x:0,y:0},{x:D,y:O},{width:G,height:X}),c.R.copy(U,y,{x:0,y:X-1},{x:D,y:O-1},{width:G,height:1}),c.R.copy(U,y,{x:0,y:0},{x:D,y:O+X},{width:G,height:1}),c.R.copy(U,y,{x:G-1,y:0},{x:D-1,y:O},{width:1,height:X}),c.R.copy(U,y,{x:0,y:0},{x:D+G,y:O},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const o of t){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const f=this.getImage(o);f||c.w(`Image with ID: "${o}" was not found`),hi(f)&&this.updateImage(o,f)}}cloneImages(){const t={};for(const o in this.images){const f=this.images[o];t[o]=Object.assign(Object.assign({},f),{data:f.data?f.data.clone():null})}return t}}const nn=1e20;function Ci(b,t,o,f,y,M,C,D,O){for(let U=t;U<t+f;U++)Qi(b,o*M+U,M,y,C,D,O);for(let U=o;U<o+y;U++)Qi(b,U*M+t,1,f,C,D,O)}function Qi(b,t,o,f,y,M,C){M[0]=0,C[0]=-nn,C[1]=nn,y[0]=b[t];for(let D=1,O=0,U=0;D<f;D++){y[D]=b[t+D*o];const G=D*D;do{const X=M[O];U=(y[D]-y[X]+G-X*X)/(D-X)/2}while(U<=C[O]&&--O>-1);O++,M[O]=D,C[O]=U,C[O+1]=nn}for(let D=0,O=0;D<f;D++){for(;C[O+1]<D;)O++;const U=M[O],G=D-U;b[t+D*o]=y[U]+G*G}}const lt=c.v.layout_symbol["text-font"].default.join(",");class Pt{constructor(t,o,f){this.requestManager=t,this.localIdeographFontFamily=o,this.entries={},this.lang=f}setURL(t){this.url=t}getGlyphs(t){return c._(this,void 0,void 0,(function*(){const o=[];for(const M in t)for(const C of t[M])o.push(this._getAndCacheGlyphsPromise(M,C));const f=yield Promise.all(o),y={};for(const{stack:M,id:C,glyph:D}of f)y[M]||(y[M]={}),y[M][C]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics};return y}))}_getAndCacheGlyphsPromise(t,o){return c._(this,void 0,void 0,(function*(){let f=this.entries[t];f||(f=this.entries[t]={glyphs:{},requests:{},ranges:{}});let y=f.glyphs[o];return y!==void 0?{stack:t,id:o,glyph:y}:!this.url||this._charUsesLocalIdeographFontFamily(o)?(y=f.glyphs[o]=this._drawGlyph(f,t,o),{stack:t,id:o,glyph:y}):yield this._downloadAndCacheRangePromise(t,o)}))}_downloadAndCacheRangePromise(t,o){return c._(this,void 0,void 0,(function*(){const f=this.entries[t],y=Math.floor(o/256);if(f.ranges[y])return{stack:t,id:o,glyph:null};if(!f.requests[y]){const M=Pt.loadGlyphRange(t,y,this.url,this.requestManager);f.requests[y]=M}try{const M=yield f.requests[y];for(const C in M)f.glyphs[+C]=M[+C];return f.ranges[y]=!0,{stack:t,id:o,glyph:M[o]||null}}catch(M){const C=f.glyphs[o]=this._drawGlyph(f,t,o);return this._warnOnMissingGlyphRange(C,y,o,M),{stack:t,id:o,glyph:C}}}))}_warnOnMissingGlyphRange(t,o,f,y){const M=256*o,C=M+255,D=f.toString(16).padStart(4,"0").toUpperCase();c.w(`Unable to load glyph range ${o}, ${M}-${C}. Rendering codepoint U+${D} locally instead. ${y}`)}_charUsesLocalIdeographFontFamily(t){return!!this.localIdeographFontFamily&&c.q(t)}_drawGlyph(t,o,f){const y=o===lt&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(f),M=y?"ideographTinySDF":"tinySDF";t[M]||(t[M]=this._createTinySDF(y?this.localIdeographFontFamily:o));const C=t[M].draw(String.fromCodePoint(f));return{id:f,bitmap:new c.r({width:C.width||60,height:C.height||60},C.data),metrics:{width:C.glyphWidth/2||24,height:C.glyphHeight/2||24,left:C.glyphLeft/2+.5||0,top:C.glyphTop/2-27.5||-8,advance:C.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(t){const o=t?t.split(","):[];o.push("sans-serif");const f=o.map((y=>/[-\w]+/.test(y)?y:`'${CSS.escape(y)}'`)).join(",");return new Pt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:this._fontWeight(o[0]),fontStyle:this._fontStyle(o[0]),lang:this.lang})}_fontStyle(t){return/italic/i.test(t)?"italic":/oblique/i.test(t)?"oblique":"normal"}_fontWeight(t){const o={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let f;for(const[y,M]of Object.entries(o))new RegExp(`\\b${y}\\b`,"i").test(t)&&(f=`${M}`);return f}destroy(){for(const t in this.entries){const o=this.entries[t];o.tinySDF&&(o.tinySDF=null),o.ideographTinySDF&&(o.ideographTinySDF=null),o.glyphs={},o.requests={},o.ranges={}}this.entries={}}}Pt.loadGlyphRange=function(b,t,o,f){return c._(this,void 0,void 0,(function*(){const y=256*t,M=y+255,C=f.transformRequest(o.replace("{fontstack}",b).replace("{range}",`${y}-${M}`),"Glyphs"),D=yield c.n(C,new AbortController);if(!D||!D.data)throw new Error(`Could not load glyph range. range: ${t}, ${y}-${M}`);const O={};for(const U of c.o(D.data))O[U.id]=U;return O}))},Pt.TinySDF=class{constructor({fontSize:b=24,buffer:t=3,radius:o=8,cutoff:f=.25,fontFamily:y="sans-serif",fontWeight:M="normal",fontStyle:C="normal",lang:D=null}={}){this.buffer=t,this.cutoff=f,this.radius=o,this.lang=D;const O=this.size=b+4*t,U=this._createCanvas(O),G=this.ctx=U.getContext("2d",{willReadFrequently:!0});G.font=`${C} ${M} ${b}px ${y}`,G.textBaseline="alphabetic",G.textAlign="left",G.fillStyle="black",this.gridOuter=new Float64Array(O*O),this.gridInner=new Float64Array(O*O),this.f=new Float64Array(O),this.z=new Float64Array(O+1),this.v=new Uint16Array(O)}_createCanvas(b){const t=document.createElement("canvas");return t.width=t.height=b,t}draw(b){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:f,actualBoundingBoxLeft:y,actualBoundingBoxRight:M}=this.ctx.measureText(b),C=Math.ceil(o),D=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(M-y))),O=Math.min(this.size-this.buffer,C+Math.ceil(f)),U=D+2*this.buffer,G=O+2*this.buffer,X=Math.max(U*G,0),$=new Uint8ClampedArray(X),ee={data:$,width:U,height:G,glyphWidth:D,glyphHeight:O,glyphTop:C,glyphLeft:0,glyphAdvance:t};if(D===0||O===0)return ee;const{ctx:re,buffer:me,gridInner:_e,gridOuter:ye}=this;this.lang&&(re.lang=this.lang),re.clearRect(me,me,D,O),re.fillText(b,me,me+C);const ve=re.getImageData(me,me,D,O);ye.fill(nn,0,X),_e.fill(0,0,X);for(let Se=0;Se<O;Se++)for(let be=0;be<D;be++){const Ce=ve.data[4*(Se*D+be)+3]/255;if(Ce===0)continue;const Ie=(Se+me)*U+be+me;if(Ce===1)ye[Ie]=0,_e[Ie]=nn;else{const we=.5-Ce;ye[Ie]=we>0?we*we:0,_e[Ie]=we<0?we*we:0}}Ci(ye,0,0,U,G,U,this.f,this.v,this.z),Ci(_e,me,me,D,O,U,this.f,this.v,this.z);for(let Se=0;Se<X;Se++){const be=Math.sqrt(ye[Se])-Math.sqrt(_e[Se]);$[Se]=Math.round(255-255*(be/this.radius+this.cutoff))}return ee}};class Mt{constructor(){this.specification=c.u.light.position}possiblyEvaluate(t,o){return c.F(t.expression.evaluate(o))}interpolate(t,o,f){return{x:c.G.number(t.x,o.x,f),y:c.G.number(t.y,o.y,f),z:c.G.number(t.z,o.z,f)}}}let ei;class Nt extends c.E{constructor(t){super(),ei=ei||new c.t({anchor:new c.D(c.u.light.anchor),position:new Mt,color:new c.D(c.u.light.color),intensity:new c.D(c.u.light.intensity)}),this._transitionable=new c.x(ei,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,o={}){if(!this._validate(c.y,t,o))for(const f in t){const y=t[f];f.endsWith(c.z)?this._transitionable.setTransition(f.slice(0,-c.z.length),y):this._transitionable.setValue(f,y)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,f){return(!f||f.validate!==!1)&&c.B(this,t.call(c.C,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:c.u}))}}const ze=new c.t({"sky-color":new c.D(c.u.sky["sky-color"]),"horizon-color":new c.D(c.u.sky["horizon-color"]),"fog-color":new c.D(c.u.sky["fog-color"]),"fog-ground-blend":new c.D(c.u.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.u.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.u.sky["atmosphere-blend"])});class dt extends c.E{constructor(t){super(),this._transitionable=new c.x(ze,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.H(0))}setSky(t,o={}){if(!this._validate(c.J,t,o)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in t){const y=t[f];f.endsWith(c.z)?this._transitionable.setTransition(f.slice(0,-c.z.length),y):this._transitionable.setValue(f,y)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,f={}){return f?.validate!==!1&&c.B(this,t.call(c.C,c.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:c.u})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class It{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,o){const f=t.join(",")+String(o);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(t,o)),this.dashEntry[f]}getDashRanges(t,o,f){const y=[];let M=t.length%2==1?-t[t.length-1]*f:0,C=t[0]*f,D=!0;y.push({left:M,right:C,isDash:D,zeroLength:t[0]===0});let O=t[0];for(let U=1;U<t.length;U++){D=!D;const G=t[U];M=O*f,O+=G,C=O*f,y.push({left:M,right:C,isDash:D,zeroLength:G===0})}return y}addRoundDash(t,o,f){const y=o/2;for(let M=-f;M<=f;M++){const C=this.width*(this.nextRow+f+M);let D=0,O=t[D];for(let U=0;U<this.width;U++){U/O.right>1&&(O=t[++D]);const G=Math.abs(U-O.left),X=Math.abs(U-O.right),$=Math.min(G,X);let ee;const re=M/f*(y+1);if(O.isDash){const me=y-Math.abs(re);ee=Math.sqrt($*$+me*me)}else ee=y-Math.sqrt($*$+re*re);this.data[C+U]=Math.max(0,Math.min(255,ee+128))}}}addRegularDash(t){for(let D=t.length-1;D>=0;--D){const O=t[D],U=t[D+1];O.zeroLength?t.splice(D,1):U&&U.isDash===O.isDash&&(U.left=O.left,t.splice(D,1))}const o=t[0],f=t[t.length-1];o.isDash===f.isDash&&(o.left=f.left-this.width,f.right=o.right+this.width);const y=this.width*this.nextRow;let M=0,C=t[M];for(let D=0;D<this.width;D++){D/C.right>1&&(C=t[++M]);const O=Math.abs(D-C.left),U=Math.abs(D-C.right),G=Math.min(O,U);this.data[y+D]=Math.max(0,Math.min(255,(C.isDash?G:-G)+128))}}addDash(t,o){const f=o?7:0,y=2*f+1;if(this.nextRow+y>this.height)return c.w("LineAtlas out of space"),null;let M=0;for(let D=0;D<t.length;D++)M+=t[D];if(M!==0){const D=this.width/M,O=this.getDashRanges(t,this.width,D);o?this.addRoundDash(O,D,f):this.addRegularDash(O)}const C={y:this.nextRow+f,height:2*f,width:M};return this.nextRow+=y,this.dirty=!0,C}bind(t){const o=t.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const zt="maplibre_preloaded_worker_pool";class Dt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Dt.workerCount;)this.workers.push(new Worker(c.c.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((o=>{o.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[zt]}numActive(){return Object.keys(this.active).length}}const kt=Math.floor(ue.hardwareConcurrency/2);let fi,Ei;function rn(){return fi||(fi=new Dt),fi}Dt.workerCount=c.K(globalThis)?Math.max(Math.min(kt,3),1):1;class hr{constructor(t,o){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=o;const f=this.workerPool.acquire(o);for(let y=0;y<f.length;y++){const M=new c.L(f[y],o);M.name=`Worker ${y}`,this.actors.push(M)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,o){const f=[];for(const y of this.actors)f.push(y.sendAsync({type:t,data:o}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((o=>{o.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,o){for(const f of this.actors)f.registerMessageHandler(t,o)}unregisterMessageHandler(t){for(const o of this.actors)o.unregisterMessageHandler(t)}}function _o(){return Ei||(Ei=new hr(rn(),c.M),Ei.registerMessageHandler("GR",((b,t,o)=>c.m(t,o)))),Ei}function Mr(b,t){const o=c.N();return c.O(o,o,[1,1,0]),c.Q(o,o,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?c.S(o,o,b.calculatePosMatrix(t.toUnwrapped())):o}function as(b,t,o,f,y,M,C){var D;const O=(function($,ee,re){if($)for(const me of $){const _e=ee[me];if(_e&&_e.source===re&&_e.type==="fill-extrusion")return!0}else for(const me in ee){const _e=ee[me];if(_e.source===re&&_e.type==="fill-extrusion")return!0}return!1})((D=y?.layers)!==null&&D!==void 0?D:null,t,b.id),U=M.maxPitchScaleFactor(),G=b.tilesIn(f,U,O);G.sort(Rn);const X=[];for(const $ of G)X.push({wrappedTileID:$.tileID.wrapped().key,queryResults:$.tile.queryRenderedFeatures(t,o,b.getState(),$.queryGeometry,$.cameraQueryGeometry,$.scale,y,M,U,Mr(M,$.tileID),C?(ee,re)=>C($.tileID,ee,re):void 0)});return(function($,ee){for(const re in $)for(const me of $[re])Jr(me,ee);return $})((function($){const ee={},re={};for(const me of $){const _e=me.queryResults,ye=me.wrappedTileID,ve=re[ye]=re[ye]||{};for(const Se in _e){const be=_e[Se],Ce=ve[Se]=ve[Se]||{},Ie=ee[Se]=ee[Se]||[];for(const we of be)Ce[we.featureIndex]||(Ce[we.featureIndex]=!0,Ie.push(we))}}return ee})(X),b)}function Rn(b,t){const o=b.tileID,f=t.tileID;return o.overscaledZ-f.overscaledZ||o.canonical.y-f.canonical.y||o.wrap-f.wrap||o.canonical.x-f.canonical.x}function Jr(b,t){const o=b.feature,f=t.getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=f}function wa(b,t,o){return c._(this,void 0,void 0,(function*(){let f=b;if(b.url?f=(yield c.j(t.transformRequest(b.url,"Source"),o)).data:yield ue.frameAsync(o),!f)return null;const y=c.U(c.e(f,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(y.vectorLayerIds=f.vector_layers.map((M=>M.id))),y}))}class Cn{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof c.V?new c.V(t.lng,t.lat):c.V.convert(t),this}setSouthWest(t){return this._sw=t instanceof c.V?new c.V(t.lng,t.lat):c.V.convert(t),this}extend(t){const o=this._sw,f=this._ne;let y,M;if(t instanceof c.V)y=t,M=t;else{if(!(t instanceof Cn))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Cn.convert(t)):this.extend(c.V.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(c.V.convert(t)):this;if(y=t._sw,M=t._ne,!y||!M)return this}return o||f?(o.lng=Math.min(y.lng,o.lng),o.lat=Math.min(y.lat,o.lat),f.lng=Math.max(M.lng,f.lng),f.lat=Math.max(M.lat,f.lat)):(this._sw=new c.V(y.lng,y.lat),this._ne=new c.V(M.lng,M.lat)),this}getCenter(){return new c.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.V(this.getWest(),this.getNorth())}getSouthEast(){return new c.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:f}=c.V.convert(t);let y=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&y}intersects(t){if(!((t=Cn.convert(t)).getNorth()>=this.getSouth()&&t.getSouth()<=this.getNorth()))return!1;const o=c.W(this.getWest(),-180,180),f=c.W(this.getEast(),-180,180),y=c.W(t.getWest(),-180,180),M=c.W(t.getEast(),-180,180),C=o>=f,D=y>=M;return!(!C||!D)||(C?M>=o||y<=f:D?f>=y||o<=M:y<=f&&M>=o)}static convert(t){return t instanceof Cn?t:t&&new Cn(t)}static fromLngLat(t,o=0){const f=360*o/40075017,y=f/Math.cos(Math.PI/180*t.lat);return new Cn(new c.V(t.lng-y,t.lat-f),new c.V(t.lng+y,t.lat+f))}adjustAntiMeridian(){const t=new c.V(this._sw.lng,this._sw.lat),o=new c.V(this._ne.lng,this._ne.lat);return new Cn(t,t.lng>o.lng?new c.V(o.lng+360,o.lat):o)}}class La{constructor(t,o,f){this.bounds=Cn.convert(this.validateBounds(t)),this.minzoom=o||0,this.maxzoom=f||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const o=Math.pow(2,t.z),f=Math.floor(c.Y(this.bounds.getWest())*o),y=Math.floor(c.X(this.bounds.getNorth())*o),M=Math.ceil(c.Y(this.bounds.getEast())*o),C=Math.ceil(c.X(this.bounds.getSouth())*o);return t.x>=f&&t.x<M&&t.y>=y&&t.y<C}}class ko extends c.E{constructor(t,o,f,y){if(super(),this.id=t,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.U(o,["url","scheme","tileSize","promoteId","encoding"])),this._options=c.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield wa(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),t&&(c.e(this,t),t.bounds&&(this.tileBounds=new La(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,c.Z(t)||this.fire(new c.k(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(t){return c._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(o,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(t)};f.request.collectResourceTiming=this._collectResourceTiming;let y="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((M,C)=>{t.reloadPromise={resolve:M,reject:C}}))}else t.actor=this.dispatcher.getActor(),y="LT";t.abortController=new AbortController;try{const M=yield t.actor.sendAsync({type:y,data:f},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,M)}catch(M){if(delete t.abortController,t.aborted)return;if(M&&M.status!==404)throw M;this._afterTileLoadWorkerResponse(t,null)}}))}_getOverzoomParameters(t){if(t.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const o=t.tileID.scaledTo(this.maxzoom).canonical,f=o.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:o,overzoomRequest:this.map._requestManager.transformRequest(f,"Tile")}}_afterTileLoadWorkerResponse(t,o){if(o&&o.resourceTiming&&(t.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&t.setExpiryData(o),t.loadVectorData(o,this.map.painter),t.reloadPromise){const f=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(f.resolve).catch(f.reject)}}abortTile(t){return c._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return c._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Oo extends c.E{constructor(t,o,f,y){super(),this.id=t,this.dispatcher=f,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},o),c.e(this,c.U(o,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,(function*(t=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield wa(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,o&&(c.e(this,o),o.bounds&&(this.tileBounds=new La(o.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(o){this._tileJSONRequest=null,this._loaded=!0,c.Z(o)||this.fire(new c.k(o))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return c.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return c._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const f=yield Qe.getImage(this.map._requestManager.transformRequest(o,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&t.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const y=this.map.painter.context,M=y.gl,C=f.data;t.texture=this.map.painter.getTileTexture(C.width),t.texture?t.texture.update(C,{useMipmap:!0}):(t.texture=new c.T(y,C,M.RGBA,{useMipmap:!0}),t.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(f){if(delete t.abortController,t.aborted)t.state="unloaded";else if(f)throw t.state="errored",f}}))}abortTile(t){return c._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return c._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class no extends Oo{constructor(t,o,f,y){super(t,o,f,y),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(t){return c._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(o,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const y=yield Qe.getImage(f,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(y&&y.data){const M=y.data;this.map._refreshExpiredTiles&&(y.cacheControl||y.expires)&&t.setExpiryData({cacheControl:y.cacheControl,expires:y.expires});const C=c.b(M)&&c.$()?M:yield this.readImageNow(M),D={type:this.type,uid:t.uid,source:this.id,rawImageData:C,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const O=yield t.actor.sendAsync({type:"LDT",data:D});t.dem=O,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(y){if(delete t.abortController,t.aborted)t.state="unloaded";else if(y)throw t.state="errored",y}}))}readImageNow(t){return c._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&c.a0()){const o=t.width+2,f=t.height+2;try{return new c.R({width:o,height:f},yield c.a1(t,-1,-1,o,f))}catch{}}return ue.getImageData(t,1)}))}_getNeighboringTiles(t){const o=t.canonical,f=Math.pow(2,o.z),y=(o.x-1+f)%f,M=o.x===0?t.wrap-1:t.wrap,C=(o.x+1+f)%f,D=o.x+1===f?t.wrap+1:t.wrap,O={};return O[new c.a2(t.overscaledZ,M,o.z,y,o.y).key]={backfilled:!1},O[new c.a2(t.overscaledZ,D,o.z,C,o.y).key]={backfilled:!1},o.y>0&&(O[new c.a2(t.overscaledZ,M,o.z,y,o.y-1).key]={backfilled:!1},O[new c.a2(t.overscaledZ,t.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},O[new c.a2(t.overscaledZ,D,o.z,C,o.y-1).key]={backfilled:!1}),o.y+1<f&&(O[new c.a2(t.overscaledZ,M,o.z,y,o.y+1).key]={backfilled:!1},O[new c.a2(t.overscaledZ,t.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},O[new c.a2(t.overscaledZ,D,o.z,C,o.y+1).key]={backfilled:!1}),O}unloadTile(t){return c._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}function vo(b){return b.type==="GeometryCollection"?b.geometries.map((t=>t.coordinates)).flat(1/0):b.coordinates.flat(1/0)}function wl(b){const t=new Cn;let o;switch(b.type){case"FeatureCollection":o=b.features.map((f=>vo(f.geometry))).flat(1/0);break;case"Feature":o=vo(b.geometry);break;default:o=vo(b)}if(o.length==0)return t;for(let f=0;f<o.length-1;f+=2)t.extend([o[f],o[f+1]]);return t}class Rr extends c.E{constructor(t,o,f,y){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:o.data},this.actor=f.getActor(),this.setEventedParent(y),this._data=typeof o.data=="string"?{url:o.data}:{geojson:o.data},this._options=c.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId,o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(o.buffer!==void 0?o.buffer:128),tolerance:this._pixelsToTileUnits(o.tolerance!==void 0?o.tolerance:.375),extent:c.a5,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(o.clusterMaxZoom),minPoints:Math.max(2,o.clusterMinPoints||2),extent:c.a5,radius:this._pixelsToTileUnits(o.clusterRadius||50),log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(t){return t*(c.a5/this.tileSize)}_getClusterMaxZoom(t){const o=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${o}"`),o}load(){return c._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t,o){this._data=typeof t=="string"?{url:t}:{geojson:t},this._pendingWorkerUpdate={data:t};const f=this._updateWorkerData();return o?f:this}updateData(t,o){this._pendingWorkerUpdate.diff=c.a6(this._pendingWorkerUpdate.diff,t);const f=this._updateWorkerData();return o?f:this}getData(){return c._(this,void 0,void 0,(function*(){const t=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}getBounds(){return c._(this,void 0,void 0,(function*(){return wl(yield this.getData())}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,o,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:o,offset:f}})}_updateWorkerData(){return c._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void c.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:t,diff:o}=this._pendingWorkerUpdate,f=c.e({type:this.type},this.workerOptions);t!==void 0?(typeof t=="string"?(f.request=this.map._requestManager.transformRequest(ue.resolveURL(t),"Source"),f.request.collectResourceTiming=this._collectResourceTiming):f.data=t,this._pendingWorkerUpdate.data=void 0):o&&(f.dataDiff=o,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new c.l("dataloading",{dataType:"source"}));try{const y=yield this.actor.sendAsync({type:"LD",data:f});if(this._isUpdatingWorker=!1,this._removed||y.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));o&&this._applyDiff(o);let M=null;y.resourceTiming&&y.resourceTiming[this.id]&&(M=y.resourceTiming[this.id].slice(0));const C={dataType:"source"};this._collectResourceTiming&&M&&M.length>0&&c.e(C,{resourceTiming:M}),this.fire(new c.l("data",Object.assign(Object.assign({},C),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},C),{sourceDataType:"content",shouldReloadTileOptions:this._getShouldReloadTileOptions(o)})))}catch(y){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(y))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyDiff(t){const o=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){if(!c.a7(this._data.geojson,o))throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:c.a8(this._data.geojson,o)}}this._data.updateable&&c.a9(this._data.updateable,t,o)}_getShouldReloadTileOptions(t){if(this._options.cluster||!t||t.removeAll)return;const{add:o=[],update:f=[],remove:y=[]}=t||{},M=new Set([...f.map((C=>C.id)),...y]);for(const C of M.values())if(typeof C!="number"&&this.promoteId==null)return void c.w(`GeoJSONSource "${this.id}": updateData is slower when using string GeoJSON feature IDs. Consider using promoteId or numeric IDs for better performance.`);return{nextBounds:[...f.map((C=>C.newGeometry)),...o.map((C=>C.geometry))].filter(Boolean).map((C=>wl(C))),prevIds:M}}shouldReloadTile(t,{nextBounds:o,prevIds:f}){if(!t.latestFeatureIndex)return t.state!=="unloaded";const y=t.latestFeatureIndex.loadVTLayers();for(let O=0;O<t.latestFeatureIndex.featureIndexArray.length;O++){const U=t.latestFeatureIndex.featureIndexArray.get(O),G=y[c.aa].feature(U.featureIndex),X=t.latestFeatureIndex.getId(G,c.aa);if(f.has(X))return!0}const{buffer:M,extent:C}=this.workerOptions.geojsonVtOptions,D=(function({x:O,y:U,z:G},X=0){const $=c.a3((O-X)/Math.pow(2,G)),ee=c.a4((U+1+X)/Math.pow(2,G)),re=c.a3((O+1+X)/Math.pow(2,G)),me=c.a4((U-X)/Math.pow(2,G));return new Cn([$,ee],[re,me])})(t.tileID.canonical,M/C);for(const O of o)if(D.intersects(O))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(t){return c._(this,void 0,void 0,(function*(){const o=t.actor?"RT":"LT";t.actor=this.actor;const f={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const y=yield this.actor.sendAsync({type:o,data:f},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(y,this.map.painter,o==="RT")}))}abortTile(t){return c._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return c._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class Da extends c.E{constructor(t,o,f,y){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=f,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=o}load(t){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield Qe.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,t&&(this.coordinates=t),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,c.Z(o)||this.fire(new c.k(o))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const o=t.map(c.ab.fromLngLat);var f;return this.tileID=(function(y){const M=c.ac.fromPoints(y),C=M.width(),D=M.height(),O=Math.max(C,D),U=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),G=Math.pow(2,U);return new c.ae(U,Math.floor((M.minX+M.maxX)/2*G),Math.floor((M.minY+M.maxY)/2*G))})(o),this.terrainTileRanges=this._getOverlappingTileRanges(o),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=o.map((y=>this.tileID.getTilePoint(y)._round())),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,o=t.gl;this.texture||(this.texture=new c.T(t,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let f=!1;for(const y in this.tiles){const M=this.tiles[y];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return c._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:o,minY:f,maxX:y,maxY:M}=c.ac.fromPoints(t),C={};for(let D=0;D<=c.ad;D++){const O=Math.pow(2,D),U=Math.floor(o*O),G=Math.floor(f*O),X=Math.floor(y*O),$=Math.floor(M*O);C[D]={minTileX:U,minTileY:G,maxTileX:X,maxTileY:$}}return C}}class Ve extends Da{constructor(t,o,f,y){super(t,o,f,y),this.roundZoom=!0,this.type="video",this.options=o}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const o of t.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield c.af(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new c.k(o))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const o=this.video.seekable;t<o.start(0)||t>o.end(0)?this.fire(new c.k(new c.ag(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,o=t.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(t,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let f=!1;for(const y in this.tiles){const M=this.tiles[y];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ne extends Da{constructor(t,o,f,y){super(t,o,f,y),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some((M=>!Array.isArray(M)||M.length!==2||M.some((C=>typeof C!="number"))))||this.fire(new c.k(new c.ag(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.ag(`sources.${t}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new c.k(new c.ag(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.ag(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.ag(`sources.${t}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,f=o.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new c.T(o,this.canvas,f.RGBA,{premultiply:!0}),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));let y=!1;for(const M in this.tiles){const C=this.tiles[M];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture,y=!0)}y&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const ie={},de=b=>{switch(b){case"geojson":return Rr;case"image":return Da;case"raster":return Oo;case"raster-dem":return no;case"vector":return ko;case"video":return Ve;case"canvas":return ne}return ie[b]},Ee="RTLPluginLoaded";class Le extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=_o()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((o=>{throw this.status="error",o}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return c._(this,arguments,void 0,(function*(o,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ue.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return c._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(Ee))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ye=null;function je(){return Ye||(Ye=new Le),Ye}var Re,We;(function(b){b[b.Base=0]="Base",b[b.Parent=1]="Parent"})(Re||(Re={})),(function(b){b[b.Departing=0]="Departing",b[b.Incoming=1]="Incoming"})(We||(We={}));class mt{constructor(t,o){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=c.ah(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:o,fadingParentID:f,fadeEndTime:y}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=o,this.fadingParentID=f,this.fadeEndTime=y}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=fe(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,o,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData,this.latestFeatureIndex.encoding=t.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(y,M){const C={};if(!M)return C;for(const D of y){const O=D.layerIds.map((U=>M.getLayer(U))).filter(Boolean);if(O.length!==0){D.layers=O,D.stateDependentLayerIds&&(D.stateDependentLayers=D.stateDependentLayerIds.map((U=>O.filter((G=>G.id===U))[0])));for(const U of O)C[U.id]=D}}return C})(t.buckets,o?.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const M=this.buckets[y];if(M instanceof c.aj){if(this.hasSymbolBuckets=!0,!f)break;M.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const M=this.buckets[y];if(M instanceof c.aj&&M.hasRTLText){this.hasRTLText=!0,je().lazyLoad();break}}this.queryPadding=0;for(const y in this.buckets){const M=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(y).queryRadius(M))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new c.ai}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const f in this.buckets){const y=this.buckets[f];y.uploadPending()&&y.upload(t)}const o=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(t,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(t,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,o,f,y,M,C,D,O,U,G,X){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:M,scale:C,tileSize:this.tileSize,pixelPosMatrix:G,transform:O,params:D,queryPadding:this.queryPadding*U,getElevation:X},t,o,f):{}}querySourceFeatures(t,o){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const y=f.loadVTLayers(),M=o&&o.sourceLayer?o.sourceLayer:"",C=y[c.aa]||y[M];if(!C)return;const D=c.ak(o?.filter,o?.globalState),{z:O,x:U,y:G}=this.tileID.canonical,X={z:O,x:U,y:G};for(let $=0;$<C.length;$++){const ee=C.feature($);if(D.needGeometry){const _e=c.al(ee,!0);if(!D.filter(new c.H(this.tileID.overscaledZ),_e,this.tileID.canonical))continue}else if(!D.filter(new c.H(this.tileID.overscaledZ),ee))continue;const re=f.getId(ee,M),me=new c.am(ee,O,U,G,re);me.tile=X,t.push(me)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const o=this.expirationTime;if(t.cacheControl){const f=c.an(t.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const f=Date.now();let y=!1;if(this.expirationTime>f)y=!1;else if(o)if(this.expirationTime<o)y=!0;else{const M=this.expirationTime-o;M?this.expirationTime=f+Math.max(M,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!o.style.hasLayer(y))continue;const M=this.buckets[y],C=M.layers[0].sourceLayer||c.aa,D=f[C],O=t[C];if(!D||!O||Object.keys(O).length===0)continue;M.update(O,D,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const U=o&&o.style&&o.style.getLayer(y);U&&(this.queryPadding=Math.max(this.queryPadding,U.queryRadius(M)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<fe()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=fe()+t}setDependencies(t,o){const f={};for(const y of o)f[y]=!0;this.dependencies[t]=f}hasDependency(t,o){for(const f of t){const y=this.dependencies[f];if(y){for(const M of o)if(y[M])return!0}}return!1}}class pt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,o,f){const y=String(o);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][y]=this.stateChanges[t][y]||{},c.e(this.stateChanges[t][y],f),this.deletedStates[t]===null){this.deletedStates[t]={};for(const M in this.state[t])M!==y&&(this.deletedStates[t][M]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][y]===null){this.deletedStates[t][y]={};for(const M in this.state[t][y])f[M]||(this.deletedStates[t][y][M]=null)}else for(const M in f)this.deletedStates[t]&&this.deletedStates[t][y]&&this.deletedStates[t][y][M]===null&&delete this.deletedStates[t][y][M]}removeFeatureState(t,o,f){if(this.deletedStates[t]===null)return;const y=String(o);if(this.deletedStates[t]=this.deletedStates[t]||{},f&&o!==void 0)this.deletedStates[t][y]!==null&&(this.deletedStates[t][y]=this.deletedStates[t][y]||{},this.deletedStates[t][y][f]=null);else if(o!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][y])for(f in this.deletedStates[t][y]={},this.stateChanges[t][y])this.deletedStates[t][y][f]=null;else this.deletedStates[t][y]=null;else this.deletedStates[t]=null}getState(t,o){const f=String(o),y=c.e({},(this.state[t]||{})[f],(this.stateChanges[t]||{})[f]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const M=this.deletedStates[t][o];if(M===null)return{};for(const C in M)delete y[C]}return y}initializeTileState(t,o){t.setFeatureState(this.state,o)}coalesceChanges(t,o){const f={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const M={};for(const C in this.stateChanges[y])this.state[y][C]||(this.state[y][C]={}),c.e(this.state[y][C],this.stateChanges[y][C]),M[C]=this.state[y][C];f[y]=M}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const M={};if(this.deletedStates[y]===null)for(const C in this.state[y])M[C]={},this.state[y][C]={};else for(const C in this.deletedStates[y]){if(this.deletedStates[y][C]===null)this.state[y][C]={};else for(const D of Object.keys(this.deletedStates[y][C]))delete this.state[y][C][D];M[C]=this.state[y][C]}f[y]=f[y]||{},c.e(f[y],M)}this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0&&t.setFeatureState(f,o)}}const Vt=89.25;function Kt(b,t){const o=c.ao(t.lat,-c.ap,c.ap);return new c.P(c.Y(t.lng)*b,c.X(o)*b)}function di(b,t){return new c.ab(t.x/b,t.y/b).toLngLat()}function en(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(c.aq(90-b.pitch)),Math.tan(c.aq(Vt-b.pitch)))}function Fi(b,t){const o=b.canonical,f=t/c.ar(o.z),y=o.x+Math.pow(2,o.z)*b.wrap,M=c.as(new Float64Array(16));return c.O(M,M,[y*f,o.y*f,0]),c.Q(M,M,[f/c.a5,f/c.a5,1]),M}function Ze(b,t,o,f,y){const M=c.ab.fromLngLat(b,t),C=y*c.at(1,b.lat),{x:D,y:O,z:U}=ln(o,f);return new c.ab(M.x+C*-D,M.y+C*-O,M.z+C*-U)}function ln(b,t){const o=c.aq(b),f=c.aq(t),y=Math.cos(-o),M=Math.sin(o);return{x:M*Math.sin(f),y:-M*Math.cos(f),z:y}}function dr(b,t,o){const f=t.intersectsFrustum(b);if(!o||f===0)return f;const y=t.intersectsPlane(o);return y===0?0:f===2&&y===2?2:1}function gi(b,t,o){let f=0;const y=(o-t)/10;for(let M=0;M<10;M++)f+=y*Math.pow(Math.cos(t+(M+.5)/10*(o-t)),b);return f}function un(b,t){return function(o,f,y,M,C){const D=2*((b-1)/c.au(Math.cos(c.aq(Vt-C))/Math.cos(c.aq(Vt)))-1),O=Math.acos(y/M),U=2*gi(D-1,0,c.aq(C/2)),G=Math.min(c.aq(Vt),O+c.aq(C/2)),X=gi(D-1,Math.min(G,O-c.aq(C/2)),G),$=Math.atan(f/y),ee=Math.hypot(f,y);let re=o;return re+=c.au(M/ee/Math.max(.5,Math.cos(c.aq(C/2)))),re+=D*c.au(Math.cos($))/2,re-=c.au(Math.max(1,X/U/t))/2,re}}const Er=un(9.314,3);function an(b,t){const o=(t.roundZoom?Math.round:Math.floor)(b.zoom+c.au(b.tileSize/t.tileSize));return Math.max(0,o)}function nr(b,t){const o=b.getCameraFrustum(),f=b.getClippingPlane(),y=b.screenPointToMercatorCoordinate(b.getCameraPoint()),M=c.ab.fromLngLat(b.center,b.elevation);y.z=M.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const C=b.getCoveringTilesDetailsProvider(),D=C.allowVariableZoom(b,t),O=an(b,t),U=t.minzoom||0,G=t.maxzoom!==void 0?t.maxzoom:b.maxZoom,X=Math.min(Math.max(0,O),G),$=Math.pow(2,X),ee=[$*y.x,$*y.y,0],re=[$*M.x,$*M.y,0],me=Math.hypot(M.x-y.x,M.y-y.y),_e=Math.abs(M.z-y.z),ye=Math.hypot(me,_e),ve=Ce=>({zoom:0,x:0,y:0,wrap:Ce,fullyVisible:!1}),Se=[],be=[];if(b.renderWorldCopies&&C.allowWorldCopies())for(let Ce=1;Ce<=3;Ce++)Se.push(ve(-Ce)),Se.push(ve(Ce));for(Se.push(ve(0));Se.length>0;){const Ce=Se.pop(),Ie=Ce.x,we=Ce.y;let ke=Ce.fullyVisible;const Ke={x:Ie,y:we,z:Ce.zoom},He=C.getTileBoundingVolume(Ke,Ce.wrap,b.elevation,t);if(!ke){const Ct=dr(o,He,f);if(Ct===0)continue;ke=Ct===2}const Je=C.distanceToTile2d(y.x,y.y,Ke,He);let tt=O;D&&(tt=(t.calculateTileZoom||Er)(b.zoom+c.au(b.tileSize/t.tileSize),Je,_e,ye,b.fov)),tt=(t.roundZoom?Math.round:Math.floor)(tt),tt=Math.max(0,tt);const bt=Math.min(tt,G);if(Ce.wrap=C.getWrap(M,Ke,Ce.wrap),Ce.zoom>=bt){if(Ce.zoom<U)continue;const Ct=X-Ce.zoom,_t=ee[0]-.5-(Ie<<Ct),Yt=ee[1]-.5-(we<<Ct),wi=t.reparseOverscaled?Math.max(Ce.zoom,tt):Ce.zoom;be.push({tileID:new c.a2(Ce.zoom===G?wi:Ce.zoom,Ce.wrap,Ce.zoom,Ie,we),distanceSq:c.av([re[0]-.5-Ie,re[1]-.5-we]),tileDistanceToCamera:Math.sqrt(_t*_t+Yt*Yt)})}else for(let Ct=0;Ct<4;Ct++)Se.push({zoom:Ce.zoom+1,x:(Ie<<1)+Ct%2,y:(we<<1)+(Ct>>1),wrap:Ce.wrap,fullyVisible:ke})}return be.sort(((Ce,Ie)=>Ce.distanceSq-Ie.distanceSq)).map((Ce=>Ce.tileID))}const _n=c.ac.fromPoints([new c.P(0,0),new c.P(c.a5,c.a5)]);function fr(b){return b==="raster"||b==="image"||b==="video"}function du(b,t,o,f,y,M,C){if(!t.hasData())return!1;const{tileID:D,fadingRole:O,fadingDirection:U,fadingParentID:G}=t;if(O===Re.Base&&U===We.Incoming&&G)return o[G.key]=G,!0;const X=Math.max(D.overscaledZ-y,M);for(let $=D.overscaledZ-1;$>=X;$--){const ee=D.scaledTo($),re=b.getLoadedTile(ee);if(re)return t.setCrossFadeLogic({fadingRole:Re.Base,fadingDirection:We.Incoming,fadingParentID:re.tileID,fadeEndTime:f+C}),re.setCrossFadeLogic({fadingRole:Re.Parent,fadingDirection:We.Departing,fadeEndTime:f+C}),o[ee.key]=ee,!0}return!1}function ha(b,t,o,f,y,M){if(!t.hasData())return!1;const C=t.tileID.children(y);let D=et(b,t,C,o,f,y,M);if(D)return!0;for(const O of C)et(b,t,O.children(y),o,f,y,M)&&(D=!0);return D}function et(b,t,o,f,y,M,C){if(o[0].overscaledZ>=M)return!1;let D=!1;for(const O of o){const U=b.getLoadedTile(O);if(!U)continue;const{fadingRole:G,fadingDirection:X,fadingParentID:$}=U;G===Re.Base&&X===We.Departing&&$||(U.setCrossFadeLogic({fadingRole:Re.Base,fadingDirection:We.Departing,fadingParentID:t.tileID,fadeEndTime:y+C}),t.setCrossFadeLogic({fadingRole:Re.Parent,fadingDirection:We.Incoming,fadeEndTime:y+C})),f[O.key]=O,D=!0}return D}function Qr(b,t,o,f){const y=b.tileID;return!!b.selfFading||!b.hasData()&&!!t.has(y)&&(b.setSelfFadeLogic(o+f),!0)}function ea(b,t){var o;b.needsHillshadePrepare=!0,b.needsTerrainPrepare=!0;let f=t.tileID.canonical.x-b.tileID.canonical.x;const y=t.tileID.canonical.y-b.tileID.canonical.y,M=Math.pow(2,b.tileID.canonical.z),C=t.tileID.key;f===0&&y===0||Math.abs(y)>1||(Math.abs(f)>1&&(Math.abs(f+M)===1?f+=M:Math.abs(f-M)===1&&(f-=M)),t.dem&&b.dem&&(b.dem.backfillBorder(t.dem,f,y),!((o=b.neighboringTiles)===null||o===void 0)&&o[C]&&(b.neighboringTiles[C].backfilled=!0)))}class bo{constructor(){this._tiles={}}handleWrapJump(t){const o={};for(const f in this._tiles){const y=this._tiles[f];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+t),o[y.tileID.key]=y}this._tiles=o}setFeatureState(t,o){for(const f in this._tiles)this._tiles[f].setFeatureState(t,o)}getAllTiles(){return Object.values(this._tiles)}getAllIds(t=!1){return t?Object.values(this._tiles).map((o=>o.tileID)).sort(c.ax).map((o=>o.key)):Object.keys(this._tiles)}getTileById(t){return this._tiles[t]}setTile(t,o){this._tiles[t]=o}deleteTileById(t){delete this._tiles[t]}getLoadedTile(t){const o=this.getTileById(t.key);return o?.hasData()?o:null}isIdRenderable(t,o=!1){var f;return(f=this.getTileById(t))===null||f===void 0?void 0:f.isRenderable(o)}getRenderableIds(t=0,o){const f=[];for(const y of this.getAllIds())this.isIdRenderable(y,o)&&f.push(this.getTileById(y));return o?f.sort(((y,M)=>{const C=y.tileID,D=M.tileID,O=new c.P(C.canonical.x,C.canonical.y)._rotate(-t),U=new c.P(D.canonical.x,D.canonical.y)._rotate(-t);return C.overscaledZ-D.overscaledZ||U.y-O.y||U.x-O.x})).map((y=>y.tileID.key)):f.map((y=>y.tileID)).sort(c.ax).map((y=>y.key))}}class vn extends c.E{constructor(t,o,f){super(),this.id=t,this.dispatcher=f,this.on("data",(y=>this._dataHandler(y))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((y,M,C,D)=>{const O=new(de(M.type))(y,M,C,D);if(O.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${O.id}`);return O})(t,o,f,this),this._inViewTiles=new bo,this._outOfViewCache=new c.ay(0,(y=>this._unloadTile(y))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new pt,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){for(const o of this._inViewTiles.getAllTiles())o.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t),this._inViewTiles=new bo}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,o,f){return c._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,o,f)}catch(y){t.state="errored",y.status!==404?this._source.fire(new c.k(y,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new c.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const o of this._inViewTiles.getAllTiles())o.upload(t),o.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(t){var o;return this._inViewTiles.getRenderableIds((o=this.transform)===null||o===void 0?void 0:o.bearingInRadians,t)}hasRenderableParent(t){const o=t.overscaledZ-1;if(o>=this._source.minzoom){const f=this.getLoadedTile(t.scaledTo(o));if(f)return this._inViewTiles.isIdRenderable(f.tileID.key)}return!1}reload(t,o=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const f of this._inViewTiles.getAllIds()){const y=this._inViewTiles.getTileById(f);o&&!this._source.shouldReloadTile(y,o)||(t?this._reloadTile(f,"expired"):y.state!=="errored"&&this._reloadTile(f,"reloading"))}}}_reloadTile(t,o){return c._(this,void 0,void 0,(function*(){const f=this._inViewTiles.getTileById(t);f&&(f.state!=="loading"&&(f.state=o),yield this._loadTile(f,t,o))}))}_tileLoaded(t,o,f){t.timeAdded=fe(),t.selfFading&&(t.fadeEndTime=t.timeAdded+this._rasterFadeDuration),f==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(o,t),this.getSource().type==="raster-dem"&&t.dem&&(function(y,M){var C,D;const O=M.getRenderableIds();for(const U of O){if(!y.neighboringTiles||!y.neighboringTiles[U])continue;const G=M.getTileById(U);y.neighboringTiles[U].backfilled||ea(y,G),!((D=(C=G.neighboringTiles)===null||C===void 0?void 0:C[y.tileID.key])===null||D===void 0)&&D.backfilled||ea(G,y)}})(t,this._inViewTiles),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:t,coord:t.tileID}))}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._inViewTiles.getTileById(t)}_retainLoadedChildren(t,o){const f=this._getLoadedDescendents(o),y=new Set;for(const M of o){const C=f[M.key];if(!C?.length){y.add(M);continue}const D=M.overscaledZ+vn.maxOverzooming,O=C.filter((X=>X.tileID.overscaledZ<=D));if(!O.length){y.add(M);continue}const U=Math.min(...O.map((X=>X.tileID.overscaledZ))),G=O.filter((X=>X.tileID.overscaledZ===U)).map((X=>X.tileID));for(const X of G)t[X.key]=X;this._areDescendentsComplete(G,U,M.overscaledZ)||y.add(M)}return y}_getLoadedDescendents(t){var o;const f={};for(const y of this._inViewTiles.getAllTiles().filter((M=>M.hasData())))for(const M of t)y.tileID.isChildOf(M)&&(f[o=M.key]||(f[o]=[])).push(y);return f}_areDescendentsComplete(t,o,f){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===o:Math.pow(4,o-f)===t.length}getLoadedTile(t){return this._inViewTiles.getLoadedTile(t)}updateCacheSize(t){const o=Math.ceil(t.width/this._source.tileSize)+1,f=Math.ceil(t.height/this._source.tileSize)+1,y=Math.floor(o*f*(this._maxTileCacheZoomLevels===null?c.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._outOfViewCache.setMaxSize(M)}handleWrapJump(t){const o=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);this._prevLng=t,o&&(this._inViewTiles.handleWrapJump(o),this._resetTileReloadTimers())}update(t,o){if(!this._sourceLoaded||this._paused)return;let f;this.transform=t,this.terrain=o,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?f=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((O=>new c.a2(O.canonical.z,O.wrap,O.canonical.z,O.canonical.x,O.canonical.y))):(f=nr(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?t.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter((O=>this._source.hasTile(O))))):f=[],this.usedForTerrain&&(f=this._addTerrainIdealTiles(f));const y=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,y&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=an(t,this._source),C=this._updateRetainedTiles(f,M),D=fr(this._source.type);D&&this._rasterFadeDuration>0&&!o&&(function(O,U,G,X,$,ee,re){const me=fe(),_e=c.aw(U);for(const ye of U){const ve=O.getTileById(ye.key);ve.fadingDirection!==We.Departing&&ve.fadeOpacity!==0||ve.resetFadeLogic(),du(O,ve,G,me,X,$,re)||ha(O,ve,G,me,ee,re)||Qr(ve,_e,me,re)||ve.resetFadeLogic()}})(this._inViewTiles,f,C,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),D?this._cleanUpRasterTiles(C):this._cleanUpVectorTiles(C)}_cleanUpRasterTiles(t){for(const o of this._inViewTiles.getAllIds())t[o]||this._removeTile(o)}_cleanUpVectorTiles(t){for(const o of this._inViewTiles.getAllIds()){const f=this._inViewTiles.getTileById(o);t[o]?f.clearSymbolFadeHold():f.hasSymbolBuckets?f.holdingForSymbolFade()?f.symbolFadeFinished()&&this._removeTile(o):f.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(o)}}_addTerrainIdealTiles(t){const o=[];for(const f of t)if(f.canonical.z>this._source.minzoom){const y=f.scaledTo(f.canonical.z-1);o.push(y);const M=f.scaledTo(Math.max(this._source.minzoom,Math.min(f.canonical.z,5)));o.push(M)}return t.concat(o)}releaseSymbolFadeTiles(){for(const t of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(t).holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,o){var f;const y=new Set;for(const U of t)this._addTile(U).hasData()||y.add(U);const M=t.reduce(((U,G)=>(U[G.key]=G,U)),{}),C=this._retainLoadedChildren(M,y),D={},O=Math.max(o-vn.maxUnderzooming,this._source.minzoom);for(const U of C){let G=this._inViewTiles.getTileById(U.key),X=G?.wasRequested();for(let $=U.overscaledZ-1;$>=O;--$){const ee=U.scaledTo($);if(D[ee.key])break;if(D[ee.key]=!0,G=this.getTile(ee),!G&&X&&(G=this._addTile(ee)),G){const re=G.hasData();if((re||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||X)&&(M[ee.key]=ee),X=G.wasRequested(),re)break}}}return M}_addTile(t){let o=this._inViewTiles.getTileById(t.key);if(o)return o;o=this._outOfViewCache.getAndRemove(t),o&&(o.resetFadeLogic(),this._setTileReloadTimer(t.key,o),o.tileID=t,this._state.initializeTileState(o,this.map?this.map.painter:null));const f=o;return o||(o=new mt(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(o,t.key,o.state)),o.uses++,this._inViewTiles.setTile(t.key,o),f||this._source.fire(new c.l("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(t,o){this._clearTileReloadTimer(t);const f=o.getExpiryTimeout();f&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),f))}_clearTileReloadTimer(t){const o=this._timers[t];o&&(clearTimeout(o),delete this._timers[t])}_resetTileReloadTimers(){for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t of this._inViewTiles.getAllIds()){const o=this._inViewTiles.getTileById(t);this._setTileReloadTimer(t,o)}}refreshTiles(t){for(const o of this._inViewTiles.getAllIds()){const f=this._inViewTiles.getTileById(o);(this._inViewTiles.isIdRenderable(o)||f.state=="errored")&&t.some((y=>y.equals(f.tileID.canonical)))&&this._reloadTile(o,"expired")}}_removeTile(t){const o=this._inViewTiles.getTileById(t);o&&(o.uses--,this._inViewTiles.deleteTileById(t),this._clearTileReloadTimer(t),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._outOfViewCache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged,t.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t of this._inViewTiles.getAllIds())this._removeTile(t);this._outOfViewCache.reset()}tilesIn(t,o,f){const y=[],M=this.transform;if(!M)return y;const C=M.getCoveringTilesDetailsProvider().allowWorldCopies(),D=f?M.getCameraQueryGeometry(t):t,O=ee=>M.screenPointToMercatorCoordinate(ee,this.terrain),U=this.transformBbox(t,O,!C),G=this.transformBbox(D,O,!C),X=this.getIds(),$=c.ac.fromPoints(G);for(let ee=0;ee<X.length;ee++){const re=this._inViewTiles.getTileById(X[ee]);if(re.holdingForSymbolFade())continue;const me=C?[re.tileID]:[re.tileID.unwrapTo(-1),re.tileID.unwrapTo(0)],_e=Math.pow(2,M.zoom-re.tileID.overscaledZ),ye=o*re.queryPadding*c.a5/re.tileSize/_e;for(const ve of me){const Se=$.map((be=>ve.getTilePoint(new c.ab(be.x,be.y))));if(Se.expandBy(ye),Se.intersects(_n)){const be=U.map((Ie=>ve.getTilePoint(Ie))),Ce=G.map((Ie=>ve.getTilePoint(Ie)));y.push({tile:re,tileID:C?ve:ve.unwrapTo(0),queryGeometry:be,cameraQueryGeometry:Ce,scale:_e})}}}return y}transformBbox(t,o,f){let y=t.map(o);if(f){const M=c.ac.fromPoints(t);M.shrinkBy(.001*Math.min(M.width(),M.height()));const C=M.map(o);c.ac.fromPoints(y).covers(C)||(y=y.map((D=>D.x>.5?new c.ab(D.x-1,D.y,D.z):D)))}return y}getVisibleCoordinates(t){const o=this.getRenderableIds(t).map((f=>this._inViewTiles.getTileById(f).tileID));return this.transform&&this.transform.populateCache(o),o}hasTransition(){return!!this._source.hasTransition()||!(!fr(this._source.type)||!(function(t,o){if(o<=0)return!1;const f=fe();for(const y of t.getAllTiles())if(y.fadeEndTime>=f)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,o,f){this._state.updateState(t=t||c.aa,o,f)}removeFeatureState(t,o,f){this._state.removeFeatureState(t=t||c.aa,o,f)}getFeatureState(t,o){return this._state.getState(t=t||c.aa,o)}setDependencies(t,o,f){const y=this._inViewTiles.getTileById(t);y&&y.setDependencies(o,f)}reloadTilesForDependencies(t,o){for(const f of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(f).hasDependency(t,o)&&this._reloadTile(f,"reloading");this._outOfViewCache.filter((f=>!f.hasDependency(t,o)))}areTilesLoaded(){for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}}vn.maxUnderzooming=10,vn.maxOverzooming=3;class At{constructor(t,o){this.reset(t,o)}reset(t,o){this.points=t||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=c.ao(t,0,1);let o=1,f=this._distances[o];const y=t*this.paddedLength+this.padding;for(;f<y&&o<this._distances.length;)f=this._distances[++o];const M=o-1,C=this._distances[M],D=f-C,O=D>0?(y-C)/D:0;return this.points[M].mult(1-O).add(this.points[o].mult(O))}}function yi(b,t){let o=!0;return b==="always"||b!=="never"&&t!=="never"||(o=!1),o}class pi{constructor(t,o,f){const y=this.boxCells=[],M=this.circleCells=[];this.xCellCount=Math.ceil(t/f),this.yCellCount=Math.ceil(o/f);for(let C=0;C<this.xCellCount*this.yCellCount;C++)y.push([]),M.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=o,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,o,f,y,M){this._forEachCell(o,f,y,M,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(o),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(M)}insertCircle(t,o,f,y){this._forEachCell(o-y,f-y,o+y,f+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(o),this.circles.push(f),this.circles.push(y)}_insertBoxCell(t,o,f,y,M,C){this.boxCells[M].push(C)}_insertCircleCell(t,o,f,y,M,C){this.circleCells[M].push(C)}_query(t,o,f,y,M,C,D){if(f<0||t>this.width||y<0||o>this.height)return[];const O=[];if(t<=0&&o<=0&&this.width<=f&&this.height<=y){if(M)return[{key:null,x1:t,y1:o,x2:f,y2:y}];for(let U=0;U<this.boxKeys.length;U++)O.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const G=this.circles[3*U],X=this.circles[3*U+1],$=this.circles[3*U+2];O.push({key:this.circleKeys[U],x1:G-$,y1:X-$,x2:G+$,y2:X+$})}}else this._forEachCell(t,o,f,y,this._queryCell,O,{hitTest:M,overlapMode:C,seenUids:{box:{},circle:{}}},D);return O}query(t,o,f,y){return this._query(t,o,f,y,!1,null)}hitTest(t,o,f,y,M,C){return this._query(t,o,f,y,!0,M,C).length>0}hitTestCircle(t,o,f,y,M){const C=t-f,D=t+f,O=o-f,U=o+f;if(D<0||C>this.width||U<0||O>this.height)return!1;const G=[];return this._forEachCell(C,O,D,U,this._queryCellCircle,G,{hitTest:!0,overlapMode:y,circle:{x:t,y:o,radius:f},seenUids:{box:{},circle:{}}},M),G.length>0}_queryCell(t,o,f,y,M,C,D,O){const{seenUids:U,hitTest:G,overlapMode:X}=D,$=this.boxCells[M];if($!==null){const re=this.bboxes;for(const me of $)if(!U.box[me]){U.box[me]=!0;const _e=4*me,ye=this.boxKeys[me];if(t<=re[_e+2]&&o<=re[_e+3]&&f>=re[_e+0]&&y>=re[_e+1]&&(!O||O(ye))&&(!G||!yi(X,ye.overlapMode))&&(C.push({key:ye,x1:re[_e],y1:re[_e+1],x2:re[_e+2],y2:re[_e+3]}),G))return!0}}const ee=this.circleCells[M];if(ee!==null){const re=this.circles;for(const me of ee)if(!U.circle[me]){U.circle[me]=!0;const _e=3*me,ye=this.circleKeys[me];if(this._circleAndRectCollide(re[_e],re[_e+1],re[_e+2],t,o,f,y)&&(!O||O(ye))&&(!G||!yi(X,ye.overlapMode))){const ve=re[_e],Se=re[_e+1],be=re[_e+2];if(C.push({key:ye,x1:ve-be,y1:Se-be,x2:ve+be,y2:Se+be}),G)return!0}}}return!1}_queryCellCircle(t,o,f,y,M,C,D,O){const{circle:U,seenUids:G,overlapMode:X}=D,$=this.boxCells[M];if($!==null){const re=this.bboxes;for(const me of $)if(!G.box[me]){G.box[me]=!0;const _e=4*me,ye=this.boxKeys[me];if(this._circleAndRectCollide(U.x,U.y,U.radius,re[_e+0],re[_e+1],re[_e+2],re[_e+3])&&(!O||O(ye))&&!yi(X,ye.overlapMode))return C.push(!0),!0}}const ee=this.circleCells[M];if(ee!==null){const re=this.circles;for(const me of ee)if(!G.circle[me]){G.circle[me]=!0;const _e=3*me,ye=this.circleKeys[me];if(this._circlesCollide(re[_e],re[_e+1],re[_e+2],U.x,U.y,U.radius)&&(!O||O(ye))&&!yi(X,ye.overlapMode))return C.push(!0),!0}}}_forEachCell(t,o,f,y,M,C,D,O){const U=this._convertToXCellCoord(t),G=this._convertToYCellCoord(o),X=this._convertToXCellCoord(f),$=this._convertToYCellCoord(y);for(let ee=U;ee<=X;ee++)for(let re=G;re<=$;re++)if(M.call(this,t,o,f,y,this.xCellCount*re+ee,C,D,O))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,o,f,y,M,C){const D=y-t,O=M-o,U=f+C;return U*U>D*D+O*O}_circleAndRectCollide(t,o,f,y,M,C,D){const O=(C-y)/2,U=Math.abs(t-(y+O));if(U>O+f)return!1;const G=(D-M)/2,X=Math.abs(o-(M+G));if(X>G+f)return!1;if(U<=O||X<=G)return!0;const $=U-O,ee=X-G;return $*$+ee*ee<=f*f}}function Ra(b,t,o){const f=c.N();if(!b){const{vecSouth:X,vecEast:$}=os(t),ee=N();ee[0]=$[0],ee[1]=$[1],ee[2]=X[0],ee[3]=X[1],y=ee,(G=(C=(M=ee)[0])*(U=M[3])-(O=M[2])*(D=M[1]))&&(y[0]=U*(G=1/G),y[1]=-D*G,y[2]=-O*G,y[3]=C*G),f[0]=ee[0],f[1]=ee[1],f[4]=ee[2],f[5]=ee[3]}var y,M,C,D,O,U,G;return c.Q(f,f,[1/o,1/o,1]),f}function Bc(b,t,o,f){if(b){const y=c.N();if(!t){const{vecSouth:M,vecEast:C}=os(o);y[0]=C[0],y[1]=C[1],y[4]=M[0],y[5]=M[1]}return c.Q(y,y,[f,f,1]),y}return o.pixelsToClipSpaceMatrix}function os(b){const t=Math.cos(b.rollInRadians),o=Math.sin(b.rollInRadians),f=Math.cos(b.pitchInRadians),y=Math.cos(b.bearingInRadians),M=Math.sin(b.bearingInRadians),C=c.aD();C[0]=-y*f*o-M*t,C[1]=-M*f*o+y*t;const D=c.aE(C);D<1e-9?c.aF(C):c.aG(C,C,1/D);const O=c.aD();O[0]=y*f*t-M*o,O[1]=M*f*t+y*o;const U=c.aE(O);return U<1e-9?c.aF(O):c.aG(O,O,1/U),{vecEast:O,vecSouth:C}}function _i(b,t,o,f){let y;f?(y=[b,t,f(b,t),1],c.aI(y,y,o)):(y=[b,t,0,1],Sa(y,y,o));const M=y[3];return{point:new c.P(y[0]/M,y[1]/M),signedDistanceFromCamera:M,isOccluded:!1}}function Tl(b,t){return .5+b/t*.5}function Bo(b,t){return b.x>=-t[0]&&b.x<=t[0]&&b.y>=-t[1]&&b.y<=t[1]}function Ts(b,t,o,f,y,M,C,D,O,U,G,X,$){const ee=o?b.textSizeData:b.iconSizeData,re=c.az(ee,t.transform.zoom),me=[256/t.width*2+1,256/t.height*2+1],_e=o?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;_e.clear();const ye=b.lineVertexArray,ve=o?b.text.placedSymbolArray:b.icon.placedSymbolArray,Se=t.transform.width/t.transform.height;let be=!1;for(let Ce=0;Ce<ve.length;Ce++){const Ie=ve.get(Ce);if(Ie.hidden||Ie.writingMode===c.aA.vertical&&!be){on(Ie.numGlyphs,_e);continue}be=!1;const we=new c.P(Ie.anchorX,Ie.anchorY),ke={getElevation:$,pitchedLabelPlaneMatrix:f,lineVertexArray:ye,pitchWithMap:M,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:we,unwrappedTileID:O,width:U,height:G,translation:X},Ke=ls(Ie.anchorX,Ie.anchorY,ke);if(!Bo(Ke.point,me)){on(Ie.numGlyphs,_e);continue}const He=Tl(t.transform.cameraToCenterDistance,Ke.signedDistanceFromCamera),Je=c.aB(ee,re,Ie),tt=M?Je*t.transform.getPitchedTextCorrection(Ie.anchorX,Ie.anchorY,O)/He:Je*He,bt=Xn({projectionContext:ke,pitchedLabelPlaneMatrixInverse:y,symbol:Ie,fontSize:tt,flip:!1,keepUpright:C,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:_e,aspectRatio:Se,rotateToLine:D});be=bt.useVertical,(bt.notEnoughRoom||be||bt.needsFlipping&&Xn({projectionContext:ke,pitchedLabelPlaneMatrixInverse:y,symbol:Ie,fontSize:tt,flip:!0,keepUpright:C,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:_e,aspectRatio:Se,rotateToLine:D}).notEnoughRoom)&&on(Ie.numGlyphs,_e)}o?b.text.dynamicLayoutVertexBuffer.updateData(_e):b.icon.dynamicLayoutVertexBuffer.updateData(_e)}function ro(b,t,o,f,y,M,C,D){const O=M.glyphStartIndex+M.numGlyphs,U=M.lineStartIndex,G=M.lineStartIndex+M.lineLength,X=t.getoffsetX(M.glyphStartIndex),$=t.getoffsetX(O-1),ee=Ta(b*X,o,f,y,M.segment,U,G,D,C);if(!ee)return null;const re=Ta(b*$,o,f,y,M.segment,U,G,D,C);return re?D.projectionCache.anyProjectionOccluded?null:{first:ee,last:re}:null}function ss(b,t,o,f){return b===c.aA.horizontal&&Math.abs(o.y-t.y)>Math.abs(o.x-t.x)*f?{useVertical:!0}:(b===c.aA.vertical?t.y<o.y:t.x>o.x)?{needsFlipping:!0}:null}function Xn(b){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:o,symbol:f,fontSize:y,flip:M,keepUpright:C,glyphOffsetArray:D,dynamicLayoutVertexArray:O,aspectRatio:U,rotateToLine:G}=b,X=y/24,$=f.lineOffsetX*X,ee=f.lineOffsetY*X;let re;if(f.numGlyphs>1){const me=f.glyphStartIndex+f.numGlyphs,_e=f.lineStartIndex,ye=f.lineStartIndex+f.lineLength,ve=ro(X,D,$,ee,M,f,G,t);if(!ve)return{notEnoughRoom:!0};const Se=Fo(ve.first.point.x,ve.first.point.y,t,o),be=Fo(ve.last.point.x,ve.last.point.y,t,o);if(C&&!M){const Ce=ss(f.writingMode,Se,be,U);if(Ce)return Ce}re=[ve.first];for(let Ce=f.glyphStartIndex+1;Ce<me-1;Ce++){const Ie=Ta(X*D.getoffsetX(Ce),$,ee,M,f.segment,_e,ye,t,G);if(!Ie)return{notEnoughRoom:!0};re.push(Ie)}re.push(ve.last)}else{if(C&&!M){const _e=Vi(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,ye=f.lineStartIndex+f.segment+1,ve=new c.P(t.lineVertexArray.getx(ye),t.lineVertexArray.gety(ye)),Se=Vi(ve.x,ve.y,t),be=Se.signedDistanceFromCamera>0?Se.point:fu(t.tileAnchorPoint,ve,_e,1,t),Ce=Fo(_e.x,_e.y,t,o),Ie=Fo(be.x,be.y,t,o),we=ss(f.writingMode,Ce,Ie,U);if(we)return we}const me=Ta(X*D.getoffsetX(f.glyphStartIndex),$,ee,M,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,t,G);if(!me||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};re=[me]}for(const me of re)c.aH(O,me.point,me.angle);return{}}function fu(b,t,o,f,y){const M=b.add(b.sub(t)._unit()),C=Vi(M.x,M.y,y).point,D=o.sub(C);return o.add(D._mult(f/D.mag()))}function da(b,t,o){const f=t.projectionCache;if(f.projections[b])return f.projections[b];const y=new c.P(t.lineVertexArray.getx(b),t.lineVertexArray.gety(b)),M=Vi(y.x,y.y,t);if(M.signedDistanceFromCamera>0)return f.projections[b]=M.point,f.anyProjectionOccluded=f.anyProjectionOccluded||M.isOccluded,M.point;const C=b-o.direction;return fu(o.distanceFromAnchor===0?t.tileAnchorPoint:new c.P(t.lineVertexArray.getx(C),t.lineVertexArray.gety(C)),y,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,t)}function Vi(b,t,o){const f=b+o.translation[0],y=t+o.translation[1];let M;return o.pitchWithMap?(M=_i(f,y,o.pitchedLabelPlaneMatrix,o.getElevation),M.isOccluded=!1):(M=o.transform.projectTileCoordinates(f,y,o.unwrappedTileID,o.getElevation),M.point.x=(.5*M.point.x+.5)*o.width,M.point.y=(.5*-M.point.y+.5)*o.height),M}function Fo(b,t,o,f){if(o.pitchWithMap){const y=[b,t,0,1];return c.aI(y,y,f),o.transform.projectTileCoordinates(y[0]/y[3],y[1]/y[3],o.unwrappedTileID,o.getElevation).point}return{x:b/o.width*2-1,y:1-t/o.height*2}}function ls(b,t,o){return o.transform.projectTileCoordinates(b,t,o.unwrappedTileID,o.getElevation)}function Sl(b,t,o){return b._unit()._perp()._mult(t*o)}function Ss(b,t,o,f,y,M,C,D,O){if(D.projectionCache.offsets[b])return D.projectionCache.offsets[b];const U=o.add(t);if(b+O.direction<f||b+O.direction>=y)return D.projectionCache.offsets[b]=U,U;const G=da(b+O.direction,D,O),X=Sl(G.sub(o),C,O.direction),$=o.add(X),ee=G.add(X);return D.projectionCache.offsets[b]=c.aJ(M,U,$,ee)||U,D.projectionCache.offsets[b]}function Ta(b,t,o,f,y,M,C,D,O){const U=f?b-t:b+t;let G=U>0?1:-1,X=0;f&&(G*=-1,X=Math.PI),G<0&&(X+=Math.PI);let $,ee=G>0?M+y:M+y+1;D.projectionCache.cachedAnchorPoint?$=D.projectionCache.cachedAnchorPoint:($=Vi(D.tileAnchorPoint.x,D.tileAnchorPoint.y,D).point,D.projectionCache.cachedAnchorPoint=$);let re,me,_e=$,ye=$,ve=0,Se=0;const be=Math.abs(U),Ce=[];let Ie;for(;ve+Se<=be;){if(ee+=G,ee<M||ee>=C)return null;ve+=Se,ye=_e,me=re;const Ke={absOffsetX:be,direction:G,distanceFromAnchor:ve,previousVertex:ye};if(_e=da(ee,D,Ke),o===0)Ce.push(ye),Ie=_e.sub(ye);else{let He;const Je=_e.sub(ye);He=Je.mag()===0?Sl(da(ee+G,D,Ke).sub(_e),o,G):Sl(Je,o,G),me||(me=ye.add(He)),re=Ss(ee,He,_e,M,C,me,o,D,Ke),Ce.push(me),Ie=re.sub(me)}Se=Ie.mag()}const we=Ie._mult((be-ve)/Se)._add(me||ye),ke=X+Math.atan2(_e.y-ye.y,_e.x-ye.x);return Ce.push(we),{point:we,angle:O?ke:0,path:Ce}}const Gi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function on(b,t){for(let o=0;o<b;o++){const f=t.length;t.resize(f+4),t.float32.set(Gi,3*f)}}function Sa(b,t,o){const f=t[0],y=t[1];return b[0]=o[0]*f+o[4]*y+o[12],b[1]=o[1]*f+o[5]*y+o[13],b[3]=o[3]*f+o[7]*y+o[15],b}const Li=100;class Ks{constructor(t,o=new pi(t.width+200,t.height+200,25),f=new pi(t.width+200,t.height+200,25)){this.transform=t,this.grid=o,this.ignoredGrid=f,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Li,this.screenBottomBoundary=t.height+Li,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,o,f,y,M,C,D,O,U,G,X,$){const ee=this.projectAndGetPerspectiveRatio(t.anchorPointX+O[0],t.anchorPointY+O[1],M,G,$),re=f*ee.perspectiveRatio;let me;if(C||D)me=this._projectCollisionBox(t,re,y,M,C,D,O,ee,G,X,$);else{const Ie=ee.x+(X?X.x*re:0),we=ee.y+(X?X.y*re:0);me={allPointsOccluded:!1,box:[Ie+t.x1*re,we+t.y1*re,Ie+t.x2*re,we+t.y2*re]}}const[_e,ye,ve,Se]=me.box,be=C?me.allPointsOccluded:ee.isOccluded;let Ce=be;return Ce||(Ce=ee.perspectiveRatio<this.perspectiveRatioCutoff),Ce||(Ce=!this.isInsideGrid(_e,ye,ve,Se)),Ce||o!=="always"&&this.grid.hitTest(_e,ye,ve,Se,o,U)?{box:[_e,ye,ve,Se],placeable:!1,offscreen:!1,occluded:be}:{box:[_e,ye,ve,Se],placeable:!0,offscreen:this.isOffscreen(_e,ye,ve,Se),occluded:be}}placeCollisionCircles(t,o,f,y,M,C,D,O,U,G,X,$,ee,re){const me=[],_e=new c.P(o.anchorX,o.anchorY),ye=this.getPerspectiveRatio(_e.x,_e.y,C,re),ve=(U?M*this.transform.getPitchedTextCorrection(o.anchorX,o.anchorY,C)/ye:M*ye)/c.aN,Se={getElevation:re,pitchedLabelPlaneMatrix:D,lineVertexArray:f,pitchWithMap:U,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:_e,unwrappedTileID:C,width:this.transform.width,height:this.transform.height,translation:ee},be=ro(ve,y,o.lineOffsetX*ve,o.lineOffsetY*ve,!1,o,!1,Se);let Ce=!1,Ie=!1,we=!0;if(be){const ke=.5*X*ye+$,Ke=new c.P(-100,-100),He=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Je=new At,tt=be.first,bt=be.last;let Ct=[];for(let wi=tt.path.length-1;wi>=1;wi--)Ct.push(tt.path[wi]);for(let wi=1;wi<bt.path.length;wi++)Ct.push(bt.path[wi]);const _t=2.5*ke;if(U){const wi=this.projectPathToScreenSpace(Ct,Se);Ct=wi.some((hn=>hn.signedDistanceFromCamera<=0))?[]:wi.map((hn=>hn.point))}let Yt=[];if(Ct.length>0){const wi=Ct[0].clone(),hn=Ct[0].clone();for(let In=1;In<Ct.length;In++)wi.x=Math.min(wi.x,Ct[In].x),wi.y=Math.min(wi.y,Ct[In].y),hn.x=Math.max(hn.x,Ct[In].x),hn.y=Math.max(hn.y,Ct[In].y);Yt=wi.x>=Ke.x&&hn.x<=He.x&&wi.y>=Ke.y&&hn.y<=He.y?[Ct]:hn.x<Ke.x||wi.x>He.x||hn.y<Ke.y||wi.y>He.y?[]:c.aK([Ct],Ke.x,Ke.y,He.x,He.y)}for(const wi of Yt){Je.reset(wi,.25*ke);let hn=0;hn=Je.length<=.5*ke?1:Math.ceil(Je.paddedLength/_t)+1;for(let In=0;In<hn;In++){const gn=In/Math.max(hn-1,1),qn=Je.lerp(gn),xn=qn.x+Li,Or=qn.y+Li;me.push(xn,Or,ke,0);const jn=xn-ke,Br=Or-ke,lr=xn+ke,gr=Or+ke;if(we=we&&this.isOffscreen(jn,Br,lr,gr),Ie=Ie||this.isInsideGrid(jn,Br,lr,gr),t!=="always"&&this.grid.hitTestCircle(xn,Or,ke,t,G)&&(Ce=!0,!O))return{circles:[],offscreen:!1,collisionDetected:Ce}}}}return{circles:!O&&Ce||!Ie||ye<this.perspectiveRatioCutoff?[]:me,offscreen:we,collisionDetected:Ce}}projectPathToScreenSpace(t,o){const f=(function(y,M){const C=c.N();return c.aC(C,M.pitchedLabelPlaneMatrix),y.map((D=>{const O=_i(D.x,D.y,C,M.getElevation),U=M.transform.projectTileCoordinates(O.point.x,O.point.y,M.unwrappedTileID,M.getElevation);return U.point.x=(.5*U.point.x+.5)*M.width,U.point.y=(.5*-U.point.y+.5)*M.height,U}))})(t,o);return(function(y){let M=0,C=0,D=0,O=0;for(let U=0;U<y.length;U++)y[U].isOccluded?(D=U+1,O=0):(O++,O>C&&(C=O,M=D));return y.slice(M,M+C)})(f)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[],f=new c.ac;for(const X of t){const $=new c.P(X.x+Li,X.y+Li);f.extend($),o.push($)}const{minX:y,minY:M,maxX:C,maxY:D}=f,O=this.grid.query(y,M,C,D).concat(this.ignoredGrid.query(y,M,C,D)),U={},G={};for(const X of O){const $=X.key;if(U[$.bucketInstanceId]===void 0&&(U[$.bucketInstanceId]={}),U[$.bucketInstanceId][$.featureIndex])continue;const ee=[new c.P(X.x1,X.y1),new c.P(X.x2,X.y1),new c.P(X.x2,X.y2),new c.P(X.x1,X.y2)];c.aL(o,ee)&&(U[$.bucketInstanceId][$.featureIndex]=!0,G[$.bucketInstanceId]===void 0&&(G[$.bucketInstanceId]=[]),G[$.bucketInstanceId].push($.featureIndex))}return G}insertCollisionBox(t,o,f,y,M,C){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:M,collisionGroupID:C,overlapMode:o},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,o,f,y,M,C){const D=f?this.ignoredGrid:this.grid,O={bucketInstanceId:y,featureIndex:M,collisionGroupID:C,overlapMode:o};for(let U=0;U<t.length;U+=4)D.insertCircle(O,t[U],t[U+1],t[U+2])}projectAndGetPerspectiveRatio(t,o,f,y,M){if(M){let C;y?(C=[t,o,y(t,o),1],c.aI(C,C,M)):(C=[t,o,0,1],Sa(C,C,M));const D=C[3];return{x:(C[0]/D+1)/2*this.transform.width+Li,y:(-C[1]/D+1)/2*this.transform.height+Li,perspectiveRatio:.5+this.transform.cameraToCenterDistance/D*.5,isOccluded:!1,signedDistanceFromCamera:D}}{const C=this.transform.projectTileCoordinates(t,o,f,y);return{x:(C.point.x+1)/2*this.transform.width+Li,y:(1-C.point.y)/2*this.transform.height+Li,perspectiveRatio:.5+this.transform.cameraToCenterDistance/C.signedDistanceFromCamera*.5,isOccluded:C.isOccluded,signedDistanceFromCamera:C.signedDistanceFromCamera}}}getPerspectiveRatio(t,o,f,y){const M=this.transform.projectTileCoordinates(t,o,f,y);return .5+this.transform.cameraToCenterDistance/M.signedDistanceFromCamera*.5}isOffscreen(t,o,f,y){return f<Li||t>=this.screenRightBoundary||y<Li||o>this.screenBottomBoundary}isInsideGrid(t,o,f,y){return f>=0&&t<this.gridRightBoundary&&y>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const t=c.as([]);return c.O(t,t,[-100,-100,0]),t}_projectCollisionBox(t,o,f,y,M,C,D,O,U,G,X){let $=1,ee=0,re=0,me=1;const _e=t.anchorPointX+D[0],ye=t.anchorPointY+D[1];if(C&&!M){const Ct=this.projectAndGetPerspectiveRatio(_e+1,ye,y,U,X),_t=Ct.x-O.x,Yt=Math.atan((Ct.y-O.y)/_t)+(_t<0?Math.PI:0),wi=Math.sin(Yt),hn=Math.cos(Yt);$=hn,ee=wi,re=-wi,me=hn}else if(!C&&M){const Ct=os(this.transform);$=Ct.vecEast[0],ee=Ct.vecEast[1],re=Ct.vecSouth[0],me=Ct.vecSouth[1]}let ve=O.x,Se=O.y,be=o;M&&(ve=_e,Se=ye,be=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),be*=this.transform.getPitchedTextCorrection(_e,ye,y),G||(be*=c.ao(.5+O.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),G&&(ve+=$*G.x*be+re*G.y*be,Se+=ee*G.x*be+me*G.y*be);const Ce=t.x1*be,Ie=t.x2*be,we=(Ce+Ie)/2,ke=t.y1*be,Ke=t.y2*be,He=(ke+Ke)/2,Je=[{offsetX:Ce,offsetY:ke},{offsetX:we,offsetY:ke},{offsetX:Ie,offsetY:ke},{offsetX:Ie,offsetY:He},{offsetX:Ie,offsetY:Ke},{offsetX:we,offsetY:Ke},{offsetX:Ce,offsetY:Ke},{offsetX:Ce,offsetY:He}];let tt=[];for(const{offsetX:Ct,offsetY:_t}of Je)tt.push(new c.P(ve+$*Ct+re*_t,Se+ee*Ct+me*_t));let bt=!1;if(M){const Ct=tt.map((_t=>this.projectAndGetPerspectiveRatio(_t.x,_t.y,y,U,X)));bt=Ct.some((_t=>!_t.isOccluded)),tt=Ct.map((_t=>new c.P(_t.x,_t.y)))}else bt=!0;return{box:c.aM(tt),allPointsOccluded:!bt}}}class Fc{constructor(t,o,f,y){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?o:-o))):y&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class Ti{constructor(t,o,f,y,M){this.text=new Fc(t?t.text:null,o,f,M),this.icon=new Fc(t?t.icon:null,o,y,M)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Yn{constructor(t,o,f){this.text=t,this.icon=o,this.skipFade=f}}class Ml{constructor(t,o,f,y,M){this.bucketInstanceId=t,this.featureIndex=o,this.sourceLayerIndex=f,this.bucketIndex=y,this.tileID=M}}class Zu{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const o=++this.maxGroupID;this.collisionGroups[t]={ID:o,predicate:f=>f.collisionGroupID===o}}return this.collisionGroups[t]}}function kn(b,t,o,f,y){const{horizontalAlign:M,verticalAlign:C}=c.aT(b);return new c.P(-(M-.5)*t+f[0]*y,-(C-.5)*o+f[1]*y)}class qu{constructor(t,o,f,y,M){this.transform=t.clone(),this.terrain=o,this.collisionIndex=new Ks(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Zu(y),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=M,M&&(M.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const o=this.terrain;return o?(f,y)=>o.getElevation(t,f,y):null}getBucketParts(t,o,f,y){const M=f.getBucket(o),C=f.latestFeatureIndex;if(!M||!C||o.id!==M.layerIds[0])return;const D=f.collisionBoxArray,O=M.layers[0].layout,U=M.layers[0].paint,G=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),X=f.tileSize/c.a5,$=f.tileID.toUnwrapped(),ee=O.get("text-rotation-alignment")==="map",re=c.aO(f,1,this.transform.zoom),me=c.aP(this.collisionIndex.transform,f,U.get("text-translate"),U.get("text-translate-anchor")),_e=c.aP(this.collisionIndex.transform,f,U.get("icon-translate"),U.get("icon-translate-anchor")),ye=Ra(ee,this.transform,re);this.retainedQueryData[M.bucketInstanceId]=new Ml(M.bucketInstanceId,C,M.sourceLayerIndex,M.index,f.tileID);const ve={bucket:M,layout:O,translationText:me,translationIcon:_e,unwrappedTileID:$,pitchedLabelPlaneMatrix:ye,scale:G,textPixelRatio:X,holdingForFade:f.holdingForSymbolFade(),collisionBoxArray:D,partiallyEvaluatedTextSize:c.az(M.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(M.sourceID)};if(y)for(const Se of M.sortKeyRanges){const{sortKey:be,symbolInstanceStart:Ce,symbolInstanceEnd:Ie}=Se;t.push({sortKey:be,symbolInstanceStart:Ce,symbolInstanceEnd:Ie,parameters:ve})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:ve})}attemptAnchorPlacement(t,o,f,y,M,C,D,O,U,G,X,$,ee,re,me,_e,ye,ve,Se,be){const Ce=c.aQ[t.textAnchor],Ie=[t.textOffset0,t.textOffset1],we=kn(Ce,f,y,Ie,M),ke=this.collisionIndex.placeCollisionBox(o,$,O,U,G,D,C,_e,X.predicate,Se,we,be);if((!ve||this.collisionIndex.placeCollisionBox(ve,$,O,U,G,D,C,ye,X.predicate,Se,we,be).placeable)&&ke.placeable){let Ke;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID].text&&(Ke=this.prevPlacement.variableOffsets[ee.crossTileID].anchor),ee.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ee.crossTileID]={textOffset:Ie,width:f,height:y,anchor:Ce,textBoxScale:M,prevAnchor:Ke},this.markUsedJustification(re,Ce,ee,me),re.allowVerticalPlacement&&(this.markUsedOrientation(re,me,ee),this.placedOrientations[ee.crossTileID]=me),{shift:we,placedGlyphBoxes:ke}}}placeLayerBucketPart(t,o,f){const{bucket:y,layout:M,translationText:C,translationIcon:D,unwrappedTileID:O,pitchedLabelPlaneMatrix:U,textPixelRatio:G,holdingForFade:X,collisionBoxArray:$,partiallyEvaluatedTextSize:ee,collisionGroup:re}=t.parameters,me=M.get("text-optional"),_e=M.get("icon-optional"),ye=c.aR(M,"text-overlap","text-allow-overlap"),ve=ye==="always",Se=c.aR(M,"icon-overlap","icon-allow-overlap"),be=Se==="always",Ce=M.get("text-rotation-alignment")==="map",Ie=M.get("text-pitch-alignment")==="map",we=M.get("icon-text-fit")!=="none",ke=M.get("symbol-z-order")==="viewport-y",Ke=ve&&(be||!y.hasIconData()||_e),He=be&&(ve||!y.hasTextData()||me);!y.collisionArrays&&$&&y.deserializeCollisionBoxes($);const Je=this.retainedQueryData[y.bucketInstanceId].tileID,tt=this._getTerrainElevationFunc(Je),bt=this.transform.getFastPathSimpleProjectionMatrix(Je),Ct=(_t,Yt,wi)=>{var hn,In;if(o[_t.crossTileID])return;if(X)return void(this.placements[_t.crossTileID]=new Yn(!1,!1,!1));let gn=!1,qn=!1,xn=!0,Or=null,jn={box:null,placeable:!1,offscreen:null,occluded:!1},Br={placeable:!1},lr=null,gr=null,pa=null,za=0,Ns=0,Kl=0;Yt.textFeatureIndex?za=Yt.textFeatureIndex:_t.useRuntimeCollisionCircles&&(za=_t.featureIndex),Yt.verticalTextFeatureIndex&&(Ns=Yt.verticalTextFeatureIndex);const cc=Yt.textBox;if(cc){const Fr=ur=>{let Nr=c.aA.horizontal;if(y.allowVerticalPlacement&&!ur&&this.prevPlacement){const mo=this.prevPlacement.placedOrientations[_t.crossTileID];mo&&(this.placedOrientations[_t.crossTileID]=mo,Nr=mo,this.markUsedOrientation(y,Nr,_t))}return Nr},sa=(ur,Nr)=>{if(y.allowVerticalPlacement&&_t.numVerticalGlyphVertices>0&&Yt.verticalTextBox){for(const mo of y.writingModes)if(mo===c.aA.vertical?(jn=Nr(),Br=jn):jn=ur(),jn&&jn.placeable)break}else jn=ur()},ma=_t.textAnchorOffsetStartIndex,Ko=_t.textAnchorOffsetEndIndex;if(Ko===ma){const ur=(Nr,mo)=>{const Qn=this.collisionIndex.placeCollisionBox(Nr,ye,G,Je,O,Ie,Ce,C,re.predicate,tt,void 0,bt);return Qn&&Qn.placeable&&(this.markUsedOrientation(y,mo,_t),this.placedOrientations[_t.crossTileID]=mo),Qn};sa((()=>ur(cc,c.aA.horizontal)),(()=>{const Nr=Yt.verticalTextBox;return y.allowVerticalPlacement&&_t.numVerticalGlyphVertices>0&&Nr?ur(Nr,c.aA.vertical):{box:null,offscreen:null}})),Fr(jn&&jn.placeable)}else{let ur=c.aQ[(In=(hn=this.prevPlacement)===null||hn===void 0?void 0:hn.variableOffsets[_t.crossTileID])===null||In===void 0?void 0:In.anchor];const Nr=(Qn,Af,Id)=>{const Ld=Qn.x2-Qn.x1,Cf=Qn.y2-Qn.y1,Jo=_t.textBoxScale,Lu=we&&Se==="never"?Af:null;let Jl=null,Pf=ye==="never"?1:2,dc="never";ur&&Pf++;for(let Dd=0;Dd<Pf;Dd++){for(let Du=ma;Du<Ko;Du++){const Rd=y.textAnchorOffsets.get(Du);if(ur&&Rd.textAnchor!==ur)continue;const kd=this.attemptAnchorPlacement(Rd,Qn,Ld,Cf,Jo,Ce,Ie,G,Je,O,re,dc,_t,y,Id,C,D,Lu,tt);if(kd&&(Jl=kd.placedGlyphBoxes,Jl&&Jl.placeable))return gn=!0,Or=kd.shift,Jl}ur?ur=null:dc=ye}return f&&!Jl&&(Jl={box:this.collisionIndex.placeCollisionBox(cc,"always",G,Je,O,Ie,Ce,C,re.predicate,tt,void 0,bt).box,offscreen:!1,placeable:!1,occluded:!1}),Jl};sa((()=>Nr(cc,Yt.iconBox,c.aA.horizontal)),(()=>{const Qn=Yt.verticalTextBox;return y.allowVerticalPlacement&&(!jn||!jn.placeable)&&_t.numVerticalGlyphVertices>0&&Qn?Nr(Qn,Yt.verticalIconBox,c.aA.vertical):{box:null,occluded:!0,offscreen:null}})),jn&&(gn=jn.placeable,xn=jn.offscreen);const mo=Fr(jn&&jn.placeable);if(!gn&&this.prevPlacement){const Qn=this.prevPlacement.variableOffsets[_t.crossTileID];Qn&&(this.variableOffsets[_t.crossTileID]=Qn,this.markUsedJustification(y,Qn.anchor,_t,mo))}}}if(lr=jn,gn=lr&&lr.placeable,xn=lr&&lr.offscreen,_t.useRuntimeCollisionCircles&&_t.centerJustifiedTextSymbolIndex>=0){const Fr=y.text.placedSymbolArray.get(_t.centerJustifiedTextSymbolIndex),sa=c.aB(y.textSizeData,ee,Fr),ma=M.get("text-padding");gr=this.collisionIndex.placeCollisionCircles(ye,Fr,y.lineVertexArray,y.glyphOffsetArray,sa,O,U,f,Ie,re.predicate,_t.collisionCircleDiameter,ma,C,tt),gr.circles.length&&gr.collisionDetected&&!f&&c.w("Collisions detected, but collision boxes are not shown"),gn=ve||gr.circles.length>0&&!gr.collisionDetected,xn=xn&&gr.offscreen}if(Yt.iconFeatureIndex&&(Kl=Yt.iconFeatureIndex),Yt.iconBox){const Fr=sa=>this.collisionIndex.placeCollisionBox(sa,Se,G,Je,O,Ie,Ce,D,re.predicate,tt,we&&Or?Or:void 0,bt);Br&&Br.placeable&&Yt.verticalIconBox?(pa=Fr(Yt.verticalIconBox),qn=pa.placeable):(pa=Fr(Yt.iconBox),qn=pa.placeable),xn=xn&&pa.offscreen}const zd=me||_t.numHorizontalGlyphVertices===0&&_t.numVerticalGlyphVertices===0,hc=_e||_t.numIconVertices===0;zd||hc?hc?zd||(qn=qn&&gn):gn=qn&&gn:qn=gn=qn&&gn;const Ao=qn&&pa.placeable;if(gn&&lr.placeable&&this.collisionIndex.insertCollisionBox(lr.box,ye,M.get("text-ignore-placement"),y.bucketInstanceId,Br&&Br.placeable&&Ns?Ns:za,re.ID),Ao&&this.collisionIndex.insertCollisionBox(pa.box,Se,M.get("icon-ignore-placement"),y.bucketInstanceId,Kl,re.ID),gr&&gn&&this.collisionIndex.insertCollisionCircles(gr.circles,ye,M.get("text-ignore-placement"),y.bucketInstanceId,za,re.ID),f&&this.storeCollisionData(y.bucketInstanceId,wi,Yt,lr,pa,gr),_t.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[_t.crossTileID]=new Yn((gn||Ke)&&!lr?.occluded,(qn||He)&&!pa?.occluded,xn||y.justReloaded),o[_t.crossTileID]=!0};if(ke){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const _t=y.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Yt=_t.length-1;Yt>=0;--Yt){const wi=_t[Yt];Ct(y.symbolInstances.get(wi),y.collisionArrays[wi],wi)}}else for(let _t=t.symbolInstanceStart;_t<t.symbolInstanceEnd;_t++)Ct(y.symbolInstances.get(_t),y.collisionArrays[_t],_t);y.justReloaded=!1}storeCollisionData(t,o,f,y,M,C){if(f.textBox||f.iconBox){let D,O;this.collisionBoxArrays.has(t)?D=this.collisionBoxArrays.get(t):(D=new Map,this.collisionBoxArrays.set(t,D)),D.has(o)?O=D.get(o):(O={text:null,icon:null},D.set(o,O)),f.textBox&&(O.text=y.box),f.iconBox&&(O.icon=M.box)}if(C){let D=this.collisionCircleArrays[t];D===void 0&&(D=this.collisionCircleArrays[t]=[]);for(let O=0;O<C.circles.length;O+=4)D.push(C.circles[O+0]-Li),D.push(C.circles[O+1]-Li),D.push(C.circles[O+2]),D.push(C.collisionDetected?1:0)}}markUsedJustification(t,o,f,y){let M;M=y===c.aA.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[c.aS(o)];const C=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const D of C)D>=0&&(t.text.placedSymbolArray.get(D).crossTileID=M>=0&&D!==M?0:f.crossTileID)}markUsedOrientation(t,o,f){const y=o===c.aA.horizontal||o===c.aA.horizontalOnly?o:0,M=o===c.aA.vertical?o:0,C=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const D of C)t.text.placedSymbolArray.get(D).placedOrientation=y;f.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=M)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let f=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const y=o?o.symbolFadeChange(t):1,M=o?o.opacities:{},C=o?o.variableOffsets:{},D=o?o.placedOrientations:{};for(const O in this.placements){const U=this.placements[O],G=M[O];G?(this.opacities[O]=new Ti(G,y,U.text,U.icon),f=f||U.text!==G.text.placed||U.icon!==G.icon.placed):(this.opacities[O]=new Ti(null,y,U.text,U.icon,U.skipFade),f=f||U.text||U.icon)}for(const O in M){const U=M[O];if(!this.opacities[O]){const G=new Ti(U,y,!1,!1);G.isHidden()||(this.opacities[O]=G,f=f||U.text.placed||U.icon.placed)}}for(const O in C)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=C[O]);for(const O in D)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=D[O]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:t)}updateLayerOpacities(t,o){const f={};for(const y of o){const M=y.getBucket(t);M&&y.latestFeatureIndex&&t.id===M.layerIds[0]&&this.updateBucketOpacities(M,y.tileID,f,y.collisionBoxArray)}}updateBucketOpacities(t,o,f,y){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const M=t.layers[0],C=M.layout,D=new Ti(null,0,!1,!1,!0),O=C.get("text-allow-overlap"),U=C.get("icon-allow-overlap"),G=M._unevaluatedLayout.hasValue("text-variable-anchor")||M._unevaluatedLayout.hasValue("text-variable-anchor-offset"),X=C.get("text-rotation-alignment")==="map",$=C.get("text-pitch-alignment")==="map",ee=C.get("icon-text-fit")!=="none",re=new Ti(null,0,O&&(U||!t.hasIconData()||C.get("icon-optional")),U&&(O||!t.hasTextData()||C.get("text-optional")),!0);!t.collisionArrays&&y&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(y);const me=(ye,ve,Se)=>{for(let be=0;be<ve/4;be++)ye.opacityVertexArray.emplaceBack(Se);ye.hasVisibleVertices=ye.hasVisibleVertices||Se!==Ms},_e=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ye=0;ye<t.symbolInstances.length;ye++){const ve=t.symbolInstances.get(ye),{numHorizontalGlyphVertices:Se,numVerticalGlyphVertices:be,crossTileID:Ce}=ve;let Ie=this.opacities[Ce];f[Ce]?Ie=D:Ie||(Ie=re,this.opacities[Ce]=Ie),f[Ce]=!0;const we=ve.numIconVertices>0,ke=this.placedOrientations[ve.crossTileID],Ke=ke===c.aA.vertical,He=ke===c.aA.horizontal||ke===c.aA.horizontalOnly;if(Se>0||be>0){const tt=pu(Ie.text);me(t.text,Se,Ke?Ms:tt),me(t.text,be,He?Ms:tt);const bt=Ie.text.isHidden();[ve.rightJustifiedTextSymbolIndex,ve.centerJustifiedTextSymbolIndex,ve.leftJustifiedTextSymbolIndex].forEach((Yt=>{Yt>=0&&(t.text.placedSymbolArray.get(Yt).hidden=bt||Ke?1:0)})),ve.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(ve.verticalPlacedTextSymbolIndex).hidden=bt||He?1:0);const Ct=this.variableOffsets[ve.crossTileID];Ct&&this.markUsedJustification(t,Ct.anchor,ve,ke);const _t=this.placedOrientations[ve.crossTileID];_t&&(this.markUsedJustification(t,"left",ve,_t),this.markUsedOrientation(t,_t,ve))}if(we){const tt=pu(Ie.icon),bt=!(ee&&ve.verticalPlacedIconSymbolIndex&&Ke);ve.placedIconSymbolIndex>=0&&(me(t.icon,ve.numIconVertices,bt?tt:Ms),t.icon.placedSymbolArray.get(ve.placedIconSymbolIndex).hidden=Ie.icon.isHidden()),ve.verticalPlacedIconSymbolIndex>=0&&(me(t.icon,ve.numVerticalIconVertices,bt?Ms:tt),t.icon.placedSymbolArray.get(ve.verticalPlacedIconSymbolIndex).hidden=Ie.icon.isHidden())}const Je=_e&&_e.has(ye)?_e.get(ye):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const tt=t.collisionArrays[ye];if(tt){let bt=new c.P(0,0);if(tt.textBox||tt.verticalTextBox){let Ct=!0;if(G){const _t=this.variableOffsets[Ce];_t?(bt=kn(_t.anchor,_t.width,_t.height,_t.textOffset,_t.textBoxScale),X&&bt._rotate($?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Ct=!1}if(tt.textBox||tt.verticalTextBox){let _t;tt.textBox&&(_t=Ke),tt.verticalTextBox&&(_t=He),El(t.textCollisionBox.collisionVertexArray,Ie.text.placed,!Ct||_t,Je.text,bt.x,bt.y)}}if(tt.iconBox||tt.verticalIconBox){const Ct=!!(!He&&tt.verticalIconBox);let _t;tt.iconBox&&(_t=Ct),tt.verticalIconBox&&(_t=!Ct),El(t.iconCollisionBox.collisionVertexArray,Ie.icon.placed,_t,Je.icon,ee?bt.x:0,ee?bt.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,o){const f=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*f>t}setStale(){this.stale=!0}}function El(b,t,o,f,y,M){f&&f.length!==0||(f=[0,0,0,0]);const C=f[0]-Li,D=f[1]-Li,O=f[2]-Li,U=f[3]-Li;b.emplaceBack(t?1:0,o?1:0,y||0,M||0,C,D),b.emplaceBack(t?1:0,o?1:0,y||0,M||0,O,D),b.emplaceBack(t?1:0,o?1:0,y||0,M||0,O,U),b.emplaceBack(t?1:0,o?1:0,y||0,M||0,C,U)}const No=Math.pow(2,25),Pn=Math.pow(2,24),Js=Math.pow(2,17),us=Math.pow(2,16),ao=Math.pow(2,9),Nc=Math.pow(2,8),jo=Math.pow(2,1);function pu(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const t=b.placed?1:0,o=Math.floor(127*b.opacity);return o*No+t*Pn+o*Js+t*us+o*ao+t*Nc+o*jo+t}const Ms=0;class Uo{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,o,f,y,M){const C=this._bucketParts;for(;this._currentTileIndex<t.length;)if(o.getBucketParts(C,y,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,M())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort(((D,O)=>D.sortKey-O.sortKey)));this._currentPartIndex<C.length;)if(o.placeLayerBucketPart(C[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,M())return!0;return!1}}class Qs{constructor(t,o,f,y,M,C,D,O){this.placement=new qu(t,o,C,D,O),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=M,this._done=!1}isDone(){return this._done}continuePlacement(t,o,f){const y=fe(),M=()=>!this._forceFullPlacement&&fe()-y>2;for(;this._currentPlacementIndex>=0;){const C=o[t[this._currentPlacementIndex]],D=this.placement.collisionIndex.transform.zoom;if(C.type==="symbol"&&(!C.minzoom||C.minzoom<=D)&&(!C.maxzoom||C.maxzoom>D)){if(this._inProgressLayer||(this._inProgressLayer=new Uo(C)),this._inProgressLayer.continuePlacement(f[C.source],this.placement,this._showCollisionBoxes,C,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const xi=512/c.a5/2;class ka{constructor(t,o,f){this.tileID=t,this.bucketInstanceId=f,this._symbolsByKey={};const y=new Map;for(let M=0;M<o.length;M++){const C=o.get(M),D=C.key,O=y.get(D);O?O.push(C):y.set(D,[C])}for(const[M,C]of y){const D={positions:C.map((O=>({x:Math.floor(O.anchorX*xi),y:Math.floor(O.anchorY*xi)}))),crossTileIDs:C.map((O=>O.crossTileID))};if(D.positions.length>128){const O=new c.aU(D.positions.length,16,Uint16Array);for(const{x:U,y:G}of D.positions)O.add(U,G);O.finish(),delete D.positions,D.index=O}this._symbolsByKey[M]=D}}getScaledCoordinates(t,o){const{x:f,y,z:M}=this.tileID.canonical,{x:C,y:D,z:O}=o.canonical,U=xi/Math.pow(2,O-M),G=(D*c.a5+t.anchorY)*U,X=y*c.a5*xi;return{x:Math.floor((C*c.a5+t.anchorX)*U-f*c.a5*xi),y:Math.floor(G-X)}}findMatches(t,o,f){const y=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let M=0;M<t.length;M++){const C=t.get(M);if(C.crossTileID)continue;const D=this._symbolsByKey[C.key];if(!D)continue;const O=this.getScaledCoordinates(C,o);if(D.index){const U=D.index.range(O.x-y,O.y-y,O.x+y,O.y+y).sort();for(const G of U){const X=D.crossTileIDs[G];if(!f[X]){f[X]=!0,C.crossTileID=X;break}}}else if(D.positions)for(let U=0;U<D.positions.length;U++){const G=D.positions[U],X=D.crossTileIDs[U];if(Math.abs(G.x-O.x)<=y&&Math.abs(G.y-O.y)<=y&&!f[X]){f[X]=!0,C.crossTileID=X;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class jc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Al{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const o=Math.round((t-this.lng)/360);if(o!==0)for(const f in this.indexes){const y=this.indexes[f],M={};for(const C in y){const D=y[C];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+o),M[D.tileID.key]=D}this.indexes[f]=M}this.lng=t}addBucket(t,o,f){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let M=0;M<o.symbolInstances.length;M++)o.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const y=this.usedCrossTileIDs[t.overscaledZ];for(const M in this.indexes){const C=this.indexes[M];if(Number(M)>t.overscaledZ)for(const D in C){const O=C[D];O.tileID.isChildOf(t)&&O.findMatches(o.symbolInstances,t,y)}else{const D=C[t.scaledTo(Number(M)).key];D&&D.findMatches(o.symbolInstances,t,y)}}for(let M=0;M<o.symbolInstances.length;M++){const C=o.symbolInstances.get(M);C.crossTileID||(C.crossTileID=f.generate(),y[C.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new ka(t,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(t,o){for(const f of o.getCrossTileIDsLists())for(const y of f)delete this.usedCrossTileIDs[t][y]}removeStaleBuckets(t){let o=!1;for(const f in this.indexes){const y=this.indexes[f];for(const M in y)t[y[M].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,y[M]),delete y[M],o=!0)}return o}}class Ar{constructor(){this.layerIndexes={},this.crossTileIDs=new jc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,o,f){let y=this.layerIndexes[t.id];y===void 0&&(y=this.layerIndexes[t.id]=new Al);let M=!1;const C={};y.handleWrapJump(f);for(const D of o){const O=D.getBucket(t);O&&t.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(D.tileID,O,this.crossTileIDs)&&(M=!0),C[O.bucketInstanceId]=!0)}return y.removeStaleBuckets(C)&&(M=!0),M}pruneUnusedLayers(t){const o={};t.forEach((f=>{o[f]=!0}));for(const f in this.layerIndexes)o[f]||delete this.layerIndexes[f]}}var ii="void main() {fragColor=vec4(1.0);}";const Xi={prelude:Zt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Zt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Zt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Zt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Zt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Zt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Zt(ii,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Zt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Zt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Zt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Zt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Zt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Zt(ii,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Zt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Zt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Zt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Zt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Zt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Zt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Zt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Zt(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:Zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:Zt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Zt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Zt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Zt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Zt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Zt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Zt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Zt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Zt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Zt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Zt(b,t){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=t.match(/in ([\w]+) ([\w]+)/g),y=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),C=M?M.concat(y):y,D={};return{fragmentSource:b=b.replace(o,((O,U,G,X,$)=>(D[$]=!0,U==="define"?`
#ifndef HAS_UNIFORM_u_${$}
in ${G} ${X} ${$};
#else
uniform ${G} ${X} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${G} ${X} ${$} = u_${$};
#endif
`))),vertexSource:t=t.replace(o,((O,U,G,X,$)=>{const ee=X==="float"?"vec2":"vec4",re=$.match(/color/)?"color":ee;return D[$]?U==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
in ${G} ${ee} a_${$};
out ${G} ${X} ${$};
#else
uniform ${G} ${X} u_${$};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${G} ${X} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${re}(a_${$}, u_${$}_t);
#else
    ${G} ${X} ${$} = u_${$};
#endif
`:U==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
in ${G} ${ee} a_${$};
#else
uniform ${G} ${X} u_${$};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${G} ${X} ${$} = a_${$};
#else
    ${G} ${X} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${G} ${X} ${$} = unpack_mix_${re}(a_${$}, u_${$}_t);
#else
    ${G} ${X} ${$} = u_${$};
#endif
`})),staticAttributes:f,staticUniforms:C}}class fn{constructor(t,o,f){this.vertexBuffer=t,this.indexBuffer=o,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Oa=c.aV([{name:"a_pos",type:"Int16",components:2}]);const Bn="#define PROJECTION_MERCATOR",ta="mercator";class Fn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return ta}get shaderDefine(){return Bn}get shaderPreludeCode(){return Xi.projectionMercator}get vertexShaderPreludeCode(){return Xi.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aW.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,o,f,y,M){if(this._cachedMesh)return this._cachedMesh;const C=new c.aX;C.emplaceBack(0,0),C.emplaceBack(c.a5,0),C.emplaceBack(0,c.a5),C.emplaceBack(c.a5,c.a5);const D=t.createVertexBuffer(C,Oa.members),O=c.aY.simpleSegment(0,0,4,2),U=new c.aZ;U.emplaceBack(1,0,2),U.emplaceBack(1,2,3);const G=t.createIndexBuffer(U);return this._cachedMesh=new fn(D,G,O),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class Ma{constructor(t=0,o=0,f=0,y=0){if(isNaN(t)||t<0||isNaN(o)||o<0||isNaN(f)||f<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=o,this.left=f,this.right=y}interpolate(t,o,f){return o.top!=null&&t.top!=null&&(this.top=c.G.number(t.top,o.top,f)),o.bottom!=null&&t.bottom!=null&&(this.bottom=c.G.number(t.bottom,o.bottom,f)),o.left!=null&&t.left!=null&&(this.left=c.G.number(t.left,o.left,f)),o.right!=null&&t.right!=null&&(this.right=c.G.number(t.right,o.right,f)),this}getCenter(t,o){const f=c.ao((this.left+t-this.right)/2,0,t),y=c.ao((this.top+o-this.bottom)/2,0,o);return new c.P(f,y)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Ma(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ba(b,t){if(!b.renderWorldCopies||b.lngRange)return;const o=t.lng-b.center.lng;t.lng+=o>180?-360:o<-180?360:0}function Ai(b){return Math.max(0,Math.floor(b))}class Fa{constructor(t,o){var f;this.applyConstrain=(y,M)=>this._constrainOverride!==null?this._constrainOverride(y,M):this._callbacks.defaultConstrain(y,M),this._callbacks=t,this._tileSize=512,this._renderWorldCopies=o?.renderWorldCopies===void 0||!!o?.renderWorldCopies,this._minZoom=o?.minZoom||0,this._maxZoom=o?.maxZoom||22,this._minPitch=o?.minPitch==null?0:o?.minPitch,this._maxPitch=o?.maxPitch==null?60:o?.maxPitch,this._constrainOverride=(f=o?.constrainOverride)!==null&&f!==void 0?f:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ai(this._zoom),this._scale=c.ar(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Ma,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,o,f){this._constrainOverride=t.constrainOverride,this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Ai(this._zoom),this._scale=c.ar(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new Ma(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!f&&t.autoCalculateNearFarZ,o&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get constrainOverride(){return this._constrainOverride}setConstrainOverride(t){t===void 0&&(t=null),this._constrainOverride!==t&&(this._constrainOverride=t,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const o=c.W(t,-180,180)*Math.PI/180;var f,y,M,C,D,O,U,G,X;this._bearingInRadians!==o&&(this._unmodified=!1,this._bearingInRadians=o,this._calcMatrices(),this._rotationMatrix=N(),f=this._rotationMatrix,M=-this._bearingInRadians,C=(y=this._rotationMatrix)[0],D=y[1],O=y[2],U=y[3],G=Math.sin(M),X=Math.cos(M),f[0]=C*X+O*G,f[1]=D*X+U*G,f[2]=C*-G+O*X,f[3]=D*-G+U*X)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const o=c.ao(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==o&&(this._unmodified=!1,this._pitchInRadians=o,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const o=t/180*Math.PI;this._rollInRadians!==o&&(this._unmodified=!1,this._rollInRadians=o,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.a_(this._fovInRadians)}setFov(t){t=c.ao(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=c.aq(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const o=this.applyConstrain(this._center,t).zoom;this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this._tileZoom=Math.max(0,Math.floor(o)),this._scale=c.ar(o),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,o){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=o,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,o,f){this._unmodified=!1,this._edgeInsets.interpolate(t,o,f),this.constrainInternal(),this._calcMatrices()}resize(t,o,f=!0){this._width=t,this._height=o,f&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Cn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-c.ap,c.ap])}getCameraQueryGeometry(t,o){if(o.length===1)return[o[0],t];{const{minX:f,minY:y,maxX:M,maxY:C}=c.ac.fromPoints(o).extend(t);return[new c.P(f,y),new c.P(M,y),new c.P(M,C),new c.P(f,C),new c.P(f,y)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:o,zoom:f}=this.applyConstrain(this.center,this.zoom);this.setCenter(o),this.setZoom(f),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=c.as(new Float64Array(16));c.Q(t,t,[this._width/2,-this._height/2,1]),c.O(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=c.as(new Float64Array(16)),c.Q(t,t,[1,-1,1]),c.O(t,t,[-1,-1,0]),c.Q(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,o,f,y){const M=f!==void 0?f:this.bearing,C=y=y!==void 0?y:this.pitch,{distanceToCenter:D,clampedElevation:O}=this._distanceToCenterFromAltElevationPitch(o,this.elevation,C),{x:U,y:G}=ln(C,M),X=c.ab.fromLngLat(t,o);let $,ee,re=c.a$(1,X.y),me=0;do{if(me+=1,me>10)break;ee=D/re,$=new c.ab(X.x+U*ee,X.y+G*ee),re=1/$.meterInMercatorCoordinateUnits()}while(Math.abs(D-ee*re)>1e-12);return{center:$.toLngLat(),elevation:O,zoom:c.au(this.height/2/Math.tan(this.fovInRadians/2)/ee/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const o=1/this.worldSize,f=c.at(1,this.center.lat)*this.worldSize,y=c.ab.fromLngLat(this.center,this.elevation),M=y.x/o,C=y.y/o,D=y.z/o,O=this.pitch,U=this.bearing,{x:G,y:X,z:$}=ln(O,U),ee=this.cameraToCenterDistance,re=M+ee*-G,me=C+ee*-X,_e=D+ee*$,{distanceToCenter:ye,clampedElevation:ve}=this._distanceToCenterFromAltElevationPitch(_e/f,t,O),Se=ye*f,be=new c.ab((re+G*Se)*o,(me+X*Se)*o,0).toLngLat(),Ce=c.at(1,be.lat),Ie=c.au(this.height/2/Math.tan(this.fovInRadians/2)/ye/Ce/this.tileSize);this._elevation=ve,this._center=be,this.setZoom(Ie)}_distanceToCenterFromAltElevationPitch(t,o,f){const y=-Math.cos(c.aq(f)),M=t-o;let C,D=o;return y*M>=0||Math.abs(y)<.1?(C=1e4,D=t+C*y):C=-M/y,{distanceToCenter:C,clampedElevation:D}}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=c.at(1,this.center.lat)*this.worldSize;return Ze(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const o=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/o,t.canonical.y/o,1/o/c.a5,1/o/c.a5]}}class Na{constructor(t,o){this.min=t,this.max=o,this.center=c.b0([],c.b1([],this.min,this.max),.5)}quadrant(t){const o=[t%2==0,t<2],f=c.b2(this.min),y=c.b2(this.max);for(let M=0;M<o.length;M++)f[M]=o[M]?this.min[M]:this.center[M],y[M]=o[M]?this.center[M]:this.max[M];return y[2]=this.max[2],new Na(f,y)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let o=!0;for(let f=0;f<t.planes.length;f++){const y=this.intersectsPlane(t.planes[f]);if(y===0)return 0;y===1&&(o=!1)}return o?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let o=t[3],f=t[3];for(let y=0;y<3;y++)t[y]>0?(o+=t[y]*this.min[y],f+=t[y]*this.max[y]):(f+=t[y]*this.min[y],o+=t[y]*this.max[y]);return o>=0?2:f<0?0:1}}class el{distanceToTile2d(t,o,f,y){const M=y.distanceX([t,o]),C=y.distanceY([t,o]);return Math.hypot(M,C)}getWrap(t,o,f){return f}getTileBoundingVolume(t,o,f,y){var M,C;let D=0,O=0;if(y?.terrain){const G=new c.a2(t.z,o,t.z,t.x,t.y),X=y.terrain.getMinMaxElevation(G);D=(M=X.minElevation)!==null&&M!==void 0?M:Math.min(0,f),O=(C=X.maxElevation)!==null&&C!==void 0?C:Math.max(0,f)}const U=1<<t.z;return new Na([o+t.x/U,t.y/U,D],[o+(t.x+1)/U,(t.y+1)/U,O])}allowVariableZoom(t,o){const f=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,y=c.ao(78.5-f/2,0,60);return!!o.terrain||t.pitch>y}allowWorldCopies(){return!0}prepareNextFrame(){}}class Ea{constructor(t,o,f){this.points=t,this.planes=o,this.aabb=f}static fromInvProjectionMatrix(t,o=1,f=0,y,M){const C=M?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],D=Math.pow(2,f),O=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(($=>(function(ee,re,me,_e){const ye=c.aI([],ee,re),ve=1/ye[3]/me*_e;return c.b7(ye,ye,[ve,ve,1/ye[3],ve])})($,t,o,D)));y&&(function($,ee,re,me){const _e=me?4:0,ye=me?0:4;let ve=0;const Se=[],be=[];for(let we=0;we<4;we++){const ke=c.b3([],$[we+ye],$[we+_e]),Ke=c.b8(ke);c.b0(ke,ke,1/Ke),Se.push(Ke),be.push(ke)}for(let we=0;we<4;we++){const ke=c.b9($[we+_e],be[we],re);ve=ke!==null&&ke>=0?Math.max(ve,ke):Math.max(ve,Se[we])}const Ce=(function(we,ke){const Ke=c.b3([],we[ke[0]],we[ke[1]]),He=c.b3([],we[ke[2]],we[ke[1]]),Je=[0,0,0,0];return c.b4(Je,c.b5([],Ke,He)),Je[3]=-c.b6(Je,we[ke[0]]),Je})($,ee),Ie=(function(we,ke){const Ke=c.ba(we),He=c.bb([],we,1/Ke),Je=c.b3([],ke,c.b0([],He,c.b6(ke,He))),tt=c.ba(Je);if(tt>0){const bt=Math.sqrt(1-He[3]*He[3]),Ct=c.b0([],He,-He[3]),_t=c.b1([],Ct,c.b0([],Je,bt/tt));return c.bc(ke,_t)}return null})(re,Ce);if(Ie!==null){const we=Ie/c.b6(be[0],Ce);ve=Math.min(ve,we)}for(let we=0;we<4;we++){const ke=Math.min(ve,Se[we]);$[we+ye]=[$[we+_e][0]+be[we][0]*ke,$[we+_e][1]+be[we][1]*ke,$[we+_e][2]+be[we][2]*ke,1]}})(O,C[0],y,M);const U=C.map(($=>{const ee=c.b3([],O[$[0]],O[$[1]]),re=c.b3([],O[$[2]],O[$[1]]),me=c.b4([],c.b5([],ee,re)),_e=-c.b6(me,O[$[1]]);return me.concat(_e)})),G=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],X=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const $ of O)for(let ee=0;ee<3;ee++)G[ee]=Math.min(G[ee],$[ee]),X[ee]=Math.max(X[ee],$[ee]);return new Ea(O,U,new Na(G,X))}}class pr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,f){return this._helper.interpolatePadding(t,o,f)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o,f=!0){this._helper.resize(t,o,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,o){}constructor(t){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(o,f)=>{f=c.ao(+f,this.minZoom,this.maxZoom);const y={center:new c.V(o.lng,o.lat),zoom:f};let M=this._helper._lngRange;if(!this._helper._renderWorldCopies&&M===null){const be=179.9999999999;M=[-be,be]}const C=this.tileSize*c.ar(y.zoom);let D=0,O=C,U=0,G=C,X=0,$=0;const{x:ee,y:re}=this.size;if(this._helper._latRange){const be=this._helper._latRange;D=c.X(be[1])*C,O=c.X(be[0])*C,O-D<re&&(X=re/(O-D))}M&&(U=c.W(c.Y(M[0])*C,0,C),G=c.W(c.Y(M[1])*C,0,C),G<U&&(G+=C),G-U<ee&&($=ee/(G-U)));const{x:me,y:_e}=Kt(C,o);let ye,ve;const Se=Math.max($||0,X||0);if(Se){const be=new c.P($?(G+U)/2:me,X?(O+D)/2:_e);return y.center=di(C,be).wrap(),y.zoom+=c.au(Se),y}if(this._helper._latRange){const be=re/2;_e-be<D&&(ve=D+be),_e+be>O&&(ve=O-be)}if(M){const be=(U+G)/2;let Ce=me;this._helper._renderWorldCopies&&(Ce=c.W(me,be-C/2,be+C/2));const Ie=ee/2;Ce-Ie<U&&(ye=U+Ie),Ce+Ie>G&&(ye=G-Ie)}if(ye!==void 0||ve!==void 0){const be=new c.P(ye??me,ve??_e);y.center=di(C,be).wrap()}return y},this.applyConstrain=(o,f)=>this._helper.applyConstrain(o,f),this._helper=new Fa({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(o,f)=>this.defaultConstrain(o,f)},t),this._coveringTilesDetailsProvider=new el}clone(){const t=new pr;return t.apply(this),t}apply(t,o,f){this._helper.apply(t,o,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const o=[new c.bd(0,t)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new c.P(0,0)),y=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),M=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),C=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),D=Math.floor(Math.min(f.x,y.x,M.x,C.x)),O=Math.floor(Math.max(f.x,y.x,M.x,C.x)),U=1;for(let G=D-U;G<=O+U;G++)G!==0&&o.push(new c.bd(G,t))}return o}getCameraFrustum(){return Ea.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const o=this.screenPointToLocation(this.centerPoint,t),f=t?t.getElevationForLngLatZoom(o,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(t,o){const f=c.at(this.elevation,this.center.lat),y=this.screenPointToMercatorCoordinateAtZ(o,f),M=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),C=c.ab.fromLngLat(t),D=new c.ab(C.x-(y.x-M.x),C.y-(y.y-M.y));this.setCenter(D?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,o){return o?this.coordinatePoint(c.ab.fromLngLat(t),o.getElevationForLngLat(t),this._pixelMatrix3D):this.coordinatePoint(c.ab.fromLngLat(t))}screenPointToLocation(t,o){var f;return(f=this.screenPointToMercatorCoordinate(t,o))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(t,o){if(o){const f=o.pointCoordinate(t);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,o){const f=o||0,y=[t.x,t.y,0,1],M=[t.x,t.y,1,1];c.aI(y,y,this._pixelMatrixInverse),c.aI(M,M,this._pixelMatrixInverse);const C=y[3],D=M[3],O=y[1]/C,U=M[1]/D,G=y[2]/C,X=M[2]/D,$=G===X?0:(f-G)/(X-G);return new c.ab(c.G.number(y[0]/C,M[0]/D,$)/this.worldSize,c.G.number(O,U,$)/this.worldSize,f)}coordinatePoint(t,o=0,f=this._pixelMatrix){const y=[t.x*this.worldSize,t.y*this.worldSize,o,1];return c.aI(y,y,f),new c.P(y[0]/y[3],y[1]/y[3])}getBounds(){const t=Math.max(0,this._helper._height/2-en(this));return new Cn().extend(this.screenPointToLocation(new c.P(0,t))).extend(this.screenPointToLocation(new c.P(this._helper._width,t))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(t,o){return o?o.pointCoordinate(t)!=null:t.y>this.height/2-en(this)}calculatePosMatrix(t,o=!1,f){var y;const M=(y=t.key)!==null&&y!==void 0?y:c.be(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),C=o?this._alignedPosMatrixCache:this._posMatrixCache;if(C.has(M)){const U=C.get(M);return f?U.f32:U.f64}const D=Fi(t,this.worldSize);c.S(D,o?this._alignedProjMatrix:this._viewProjMatrix,D);const O={f64:D,f32:new Float32Array(D)};return C.set(M,O),f?O.f32:O.f64}calculateFogMatrix(t){const o=t.key,f=this._fogMatrixCacheF32;if(f.has(o))return f.get(o);const y=Fi(t,this.worldSize);return c.S(y,this._fogMatrix,y),f.set(o,new Float32Array(y)),f.get(o)}calculateCenterFromCameraLngLatAlt(t,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,f,y)}_calculateNearFarZIfNeeded(t,o,f){if(!this._helper.autoCalculateNearFarZ)return;const y=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),M=t-y*this._helper._pixelPerMeter/Math.cos(o),C=y<0?M:t,D=Math.PI/2+this.pitchInRadians,O=c.aq(this.fov)*(Math.abs(Math.cos(c.aq(this.roll)))*this.height+Math.abs(Math.sin(c.aq(this.roll)))*this.width)/this.height*(.5+f.y/this.height),U=Math.sin(O)*C/Math.sin(c.ao(Math.PI-D-O,.01,Math.PI-.01)),G=en(this),X=Math.atan(G/this._helper.cameraToCenterDistance),$=c.aq(.75),ee=X>$?2*X*(.5+f.y/(2*G)):$,re=Math.sin(ee)*C/Math.sin(c.ao(Math.PI-D-ee,.01,Math.PI-.01)),me=Math.min(U,re);this._helper._farZ=1.01*(Math.cos(Math.PI/2-o)*me+C),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,o=Kt(this.worldSize,this.center),f=o.x,y=o.y;this._helper._pixelPerMeter=c.at(1,this.center.lat)*this.worldSize;const M=c.aq(Math.min(this.pitch,Vt)),C=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(M));let D;this._calculateNearFarZIfNeeded(C,M,t),D=new Float64Array(16),c.bf(D,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.aC(this._invProjMatrix,D),D[8]=2*-t.x/this._helper._width,D[9]=2*t.y/this._helper._height,this._projectionMatrix=c.bg(D),c.Q(D,D,[1,-1,1]),c.O(D,D,[0,0,-this._helper.cameraToCenterDistance]),c.bh(D,D,-this.rollInRadians),c.bi(D,D,this.pitchInRadians),c.bh(D,D,-this.bearingInRadians),c.O(D,D,[-f,-y,0]),this._mercatorMatrix=c.Q([],D,[this.worldSize,this.worldSize,this.worldSize]),c.Q(D,D,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,D),c.O(D,D,[0,0,-this.elevation]),this._viewProjMatrix=D,this._invViewProjMatrix=c.aC([],D);const O=[0,0,-1,1];c.aI(O,O,this._invViewProjMatrix),this._cameraPosition=[O[0]/O[3],O[1]/O[3],O[2]/O[3]],this._fogMatrix=new Float64Array(16),c.bf(this._fogMatrix,this.fovInRadians,this.width/this.height,C,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,c.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.bh(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.bi(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.bh(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.O(this._fogMatrix,this._fogMatrix,[-f,-y,0]),c.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,D);const U=this._helper._width%2/2,G=this._helper._height%2/2,X=Math.cos(this.bearingInRadians),$=Math.sin(-this.bearingInRadians),ee=f-Math.round(f)+X*U+$*G,re=y-Math.round(y)+X*G+$*U,me=new Float64Array(D);if(c.O(me,me,[ee>.5?ee-1:ee,re>.5?re-1:re,0]),this._alignedProjMatrix=me,D=c.aC(new Float64Array(16),this._pixelMatrix),!D)throw new Error("failed to invert matrix");this._pixelMatrixInverse=D,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new c.P(0,0)),o=[t.x*this.worldSize,t.y*this.worldSize,0,1];return c.aI(o,o,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=c.at(1,this.center.lat)*this.worldSize;return Ze(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,o){const f=c.ab.fromLngLat(t),y=[f.x*this.worldSize,f.y*this.worldSize,o,1];return c.aI(y,y,this._viewProjMatrix),y[2]/y[3]}getProjectionData(t){const{overscaledTileID:o,aligned:f,applyTerrainMatrix:y}=t,M=this._helper.getMercatorTileCoordinates(o),C=o?this.calculatePosMatrix(o,f,!0):null;let D;return D=o&&o.terrainRttPosMatrix32f&&y?o.terrainRttPosMatrix32f:C||c.bj(),{mainMatrix:D,tileMercatorCoords:M,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:D}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,o,f){return 1}transformLightDirection(t){return c.b2(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,o,f,y){const M=this.calculatePosMatrix(f);let C;y?(C=[t,o,y(t,o),1],c.aI(C,C,M)):(C=[t,o,0,1],Sa(C,C,M));const D=C[3];return{point:new c.P(C[0]/D,C[1]/D),signedDistanceFromCamera:D,isOccluded:!1}}populateCache(t){for(const o of t)this.calculatePosMatrix(o)}getMatrixForModel(t,o){const f=c.ab.fromLngLat(t,o),y=f.meterInMercatorCoordinateUnits(),M=c.bk();return c.O(M,M,[f.x,f.y,f.z]),c.bh(M,M,Math.PI),c.bi(M,M,Math.PI/2),c.Q(M,M,[-y,y,y]),M}getProjectionDataForCustomLayer(t=!0){const o=new c.a2(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:o,applyGlobeMatrix:t}),y=Fi(o,this.worldSize);c.S(y,this._viewProjMatrix,y),f.tileMercatorCoords=[0,0,1,1];const M=[c.a5,c.a5,this.worldSize/this._helper.pixelsPerMeter],C=c.bl();return c.Q(C,y,M),f.fallbackMatrix=C,f.mainMatrix=C,f}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function ia(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function $u(b){if(b.useSlerp)if(b.k<1){const t=c.bm(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),o=c.bm(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),f=new Float64Array(4);c.bn(f,t,o,b.k);const y=c.bo(f);b.tr.setRoll(y.roll),b.tr.setPitch(y.pitch),b.tr.setBearing(y.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(c.G.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(c.G.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(c.G.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function tl(b,t,o,f,y){const M=y.padding,C=Kt(y.worldSize,o.getNorthWest()),D=Kt(y.worldSize,o.getNorthEast()),O=Kt(y.worldSize,o.getSouthEast()),U=Kt(y.worldSize,o.getSouthWest()),G=c.aq(-f),X=C.rotate(G),$=D.rotate(G),ee=O.rotate(G),re=U.rotate(G),me=new c.P(Math.max(X.x,$.x,re.x,ee.x),Math.max(X.y,$.y,re.y,ee.y)),_e=new c.P(Math.min(X.x,$.x,re.x,ee.x),Math.min(X.y,$.y,re.y,ee.y)),ye=me.sub(_e),ve=(y.width-(M.left+M.right+t.left+t.right))/ye.x,Se=(y.height-(M.top+M.bottom+t.top+t.bottom))/ye.y;if(Se<0||ve<0)return void ia();const be=Math.min(c.au(y.scale*Math.min(ve,Se)),b.maxZoom),Ce=c.P.convert(b.offset),Ie=new c.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(c.aq(f)),we=Ce.add(Ie).mult(y.scale/c.ar(be));return{center:di(y.worldSize,C.add(O).div(2).sub(we)),zoom:be,bearing:f}}class Pi{get useGlobeControls(){return!1}handlePanInertia(t,o){const f=t.mag(),y=Math.abs(en(o));return{easingOffset:t.mult(Math.min(.75*y/f,1)),easingCenter:o.center}}handleMapControlsRollPitchBearingZoom(t,o){t.bearingDelta&&o.setBearing(o.bearing+t.bearingDelta),t.pitchDelta&&o.setPitch(o.pitch+t.pitchDelta),t.rollDelta&&o.setRoll(o.roll+t.rollDelta),t.zoomDelta&&o.setZoom(o.zoom+t.zoomDelta)}handleMapControlsPan(t,o,f){t.around.distSqr(o.centerPoint)<.01||o.setLocationAtPoint(f,t.around)}cameraForBoxAndBearing(t,o,f,y,M){return tl(t,o,f,y,M)}handleJumpToCenterZoom(t,o){t.zoom!==(o.zoom!==void 0?+o.zoom:t.zoom)&&t.setZoom(+o.zoom),o.center!==void 0&&t.setCenter(c.V.convert(o.center))}handleEaseTo(t,o){const f=t.zoom,y=t.padding,M={roll:t.roll,pitch:t.pitch,bearing:t.bearing},C={roll:o.roll===void 0?t.roll:o.roll,pitch:o.pitch===void 0?t.pitch:o.pitch,bearing:o.bearing===void 0?t.bearing:o.bearing},D=o.zoom!==void 0,O=!t.isPaddingEqual(o.padding);let U=!1;const G=D?+o.zoom:t.zoom;let X=t.centerPoint.add(o.offsetAsPoint);const $=t.screenPointToLocation(X),{center:ee,zoom:re}=t.applyConstrain(c.V.convert(o.center||$),G??f);Ba(t,ee);const me=Kt(t.worldSize,$),_e=Kt(t.worldSize,ee).sub(me),ye=c.ar(re-f);return U=re!==f,{easeFunc:ve=>{if(U&&t.setZoom(c.G.number(f,re,ve)),c.bp(M,C)||$u({startEulerAngles:M,endEulerAngles:C,tr:t,k:ve,useSlerp:M.roll!=C.roll}),O&&(t.interpolatePadding(y,o.padding,ve),X=t.centerPoint.add(o.offsetAsPoint)),o.around)t.setLocationAtPoint(o.around,o.aroundPoint);else{const Se=c.ar(t.zoom-f),be=re>f?Math.min(2,ye):Math.max(.5,ye),Ce=Math.pow(be,1-ve),Ie=di(t.worldSize,me.add(_e.mult(ve*Ce)).mult(Se));t.setLocationAtPoint(t.renderWorldCopies?Ie.wrap():Ie,X)}},isZooming:U,elevationCenter:ee}}handleFlyTo(t,o){const f=o.zoom!==void 0,y=t.zoom,M=t.applyConstrain(c.V.convert(o.center||o.locationAtOffset),f?+o.zoom:y),C=M.center,D=M.zoom;Ba(t,C);const O=Kt(t.worldSize,o.locationAtOffset),U=Kt(t.worldSize,C).sub(O),G=U.mag(),X=c.ar(D-y);let $;if(o.minZoom!==void 0){const ee=Math.min(+o.minZoom,y,D),re=t.applyConstrain(C,ee).zoom;$=c.ar(re-y)}return{easeFunc:(ee,re,me,_e)=>{t.setZoom(ee===1?D:y+c.au(re));const ye=ee===1?C:di(t.worldSize,O.add(U.mult(me)).mult(re));t.setLocationAtPoint(t.renderWorldCopies?ye.wrap():ye,_e)},scaleOfZoom:X,targetCenter:C,scaleOfMinZoom:$,pixelPathLength:G}}}class pn{constructor(t,o,f){this.blendFunction=t,this.blendColor=o,this.mask=f}}pn.Replace=[1,0],pn.disabled=new pn(pn.Replace,c.bq.transparent,[!1,!1,!1,!1]),pn.unblended=new pn(pn.Replace,c.bq.transparent,[!0,!0,!0,!0]),pn.alphaBlended=new pn([1,771],c.bq.transparent,[!0,!0,!0,!0]);const kr=2305;class Mi{constructor(t,o,f){this.enable=t,this.mode=o,this.frontFace=f}}Mi.disabled=new Mi(!1,1029,kr),Mi.backCCW=new Mi(!0,1029,kr),Mi.frontCCW=new Mi(!0,1028,kr);class vi{constructor(t,o,f){this.func=t,this.mask=o,this.range=f}}vi.ReadOnly=!1,vi.ReadWrite=!0,vi.disabled=new vi(519,vi.ReadOnly,[0,1]);const Cl=7680;class Di{constructor(t,o,f,y,M,C){this.test=t,this.ref=o,this.mask=f,this.fail=y,this.depthFail=M,this.pass=C}}Di.disabled=new Di({func:519,mask:0},0,0,Cl,Cl,Cl);const Hu=new WeakMap;function oo(b){var t;if(Hu.has(b))return Hu.get(b);{const o=(t=b.getParameter(b.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Hu.set(b,o),o}}class il{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const o=t.context,f=o.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const y=new c.aX;y.emplaceBack(-1,-1),y.emplaceBack(2,-1),y.emplaceBack(-1,2);const M=new c.aZ;M.emplaceBack(0,1,2),this._fullscreenTriangle=new fn(o.createVertexBuffer(y,Oa.members),o.createIndexBuffer(M),c.aY.simpleSegment(0,0,y.length,M.length)),this._resultBuffer=new Uint8Array(4),o.activeTexture.set(f.TEXTURE1);const C=f.createTexture();f.bindTexture(f.TEXTURE_2D,C),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=o.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(C),oo(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,o){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,o),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,o=t.gl;t.activeTexture.set(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,o){const f=this._cachedRenderContext.context,y=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:c.bq.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,y.TRIANGLES,vi.disabled,Di.disabled,pn.unblended,Mi.disabled,((M,C)=>({u_input:M,u_output_expected:C}))(t,o),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&oo(y)){y.bindBuffer(y.PIXEL_PACK_BUFFER,this._pbo),y.readBuffer(y.COLOR_ATTACHMENT0),y.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),y.bindBuffer(y.PIXEL_PACK_BUFFER,null);const M=y.fenceSync(y.SYNC_GPU_COMMANDS_COMPLETE,0);y.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:M}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&oo(t)){const o=t.clientWaitSync(this._readbackQueue.sync,0,0);if(o===t.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(o===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=il._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let o=0;return o+=t[0]/256,o+=t[1]/65536,o+=t[2]/16777216,t[3]<127&&(o=-o),o/128}}const nl=c.a5/128;function Uc(b,t){const o=b.granularity!==void 0?Math.max(b.granularity,1):1,f=o+(b.generateBorders?2:0),y=o+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),M=f+1,C=y+1,D=b.generateBorders?-1:0,O=b.generateBorders||b.extendToNorthPole?-1:0,U=o+(b.generateBorders?1:0),G=o+(b.generateBorders||b.extendToSouthPole?1:0),X=M*C,$=f*y*6,ee=M*C>65536;if(ee&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const re=ee||t==="32bit",me=new Int16Array(2*X);let _e=0;for(let Se=O;Se<=G;Se++)for(let be=D;be<=U;be++){let Ce=be/o*c.a5;be===-1&&(Ce=-nl),be===o+1&&(Ce=c.a5+nl);let Ie=Se/o*c.a5;Se===-1&&(Ie=b.extendToNorthPole?c.bs:-nl),Se===o+1&&(Ie=b.extendToSouthPole?c.bt:c.a5+nl),me[_e++]=Ce,me[_e++]=Ie}const ye=re?new Uint32Array($):new Uint16Array($);let ve=0;for(let Se=0;Se<y;Se++)for(let be=0;be<f;be++){const Ce=be+1+Se*M,Ie=be+(Se+1)*M,we=be+1+(Se+1)*M;ye[ve++]=be+Se*M,ye[ve++]=Ie,ye[ve++]=Ce,ye[ve++]=Ce,ye[ve++]=Ie,ye[ve++]=we}return{vertices:me.buffer.slice(0),indices:ye.buffer.slice(0),uses32bitIndices:re}}const Xu=new c.aW({fill:new c.bu(128,2),line:new c.bu(512,0),tile:new c.bu(128,32),stencil:new c.bu(128,1),circle:3});class xo{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Xi.projectionGlobe}get vertexShaderPreludeCode(){return Xi.projectionMercator.vertexSource}get subdivisionGranularity(){return Xu}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new il(t));const o=c.X(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-o*Math.PI*2))-.5*Math.PI,y=this._errorMeasurement.updateErrorLoop(o,f),M=fe();y!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=y,this._errorMeasurementLastChangeTime=M);const C=Math.min(Math.max((M-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bv(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bw(C))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,o,f,y,M){const C=(M==="stencil"?Xu.stencil:Xu.tile).getGranularityForZoomLevel(o.z);return this._getMesh(t,{granularity:C,generateBorders:f,extendToNorthPole:o.y===0&&y,extendToSouthPole:o.y===(1<<o.z)-1&&y})}_getMesh(t,o){const f=this._getMeshKey(o);if(f in this._tileMeshCache)return this._tileMeshCache[f];const y=(function(M,C){const D=Uc(C,"16bit"),O=c.aX.deserialize({arrayBuffer:D.vertices,length:D.vertices.byteLength/2/2}),U=c.aZ.deserialize({arrayBuffer:D.indices,length:D.indices.byteLength/2/3});return new fn(M.createVertexBuffer(O,Oa.members),M.createIndexBuffer(U),c.aY.simpleSegment(0,0,O.length,U.length))})(t,o);return this._tileMeshCache[f]=y,y}recalculate(t){}hasTransition(){const t=fe();let o=!1;return o=o||(t-this._errorMeasurementLastChangeTime)/1e3<.7,o=o||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,o}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const vf=new c.t({type:new c.D(c.u.projection.type)});class Vc extends c.E{constructor(t){super(),this._transitionable=new c.x(vf,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.H(0)),this._mercatorProjection=new Fn,this._verticalPerspectiveProjection=new xo}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof c.bx){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,o,f,y,M){return this.currentProjection.getMeshFromTileID(t,o,f,y,M)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function rr(b){const t=Es(b.worldSize,b.center.lat);return 2*Math.PI*t}function Vo(b,t,o,f,y){const M=1/(1<<y),C=t/c.a5*M+f*M,D=c.bz((b/c.a5*M+o*M)*Math.PI*2+Math.PI,2*Math.PI),O=2*Math.atan(Math.exp(Math.PI-C*Math.PI*2))-.5*Math.PI,U=Math.cos(O),G=new Float64Array(3);return G[0]=Math.sin(D)*U,G[1]=Math.sin(O),G[2]=Math.cos(D)*U,G}function On(b){return(function(t,o){const f=Math.cos(o),y=new Float64Array(3);return y[0]=Math.sin(t)*f,y[1]=Math.sin(o),y[2]=Math.cos(t)*f,y})(b.lng*Math.PI/180,b.lat*Math.PI/180)}function Es(b,t){return b/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Yu(b){const t=Math.asin(b[1])/Math.PI*180,o=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(o>1e-6){const f=b[0]/o,y=Math.acos(b[2]/o),M=(f>0?y:-y)/Math.PI*180;return new c.V(c.W(M,-180,180),t)}return new c.V(0,t)}function mu(b){return Math.cos(b*Math.PI/180)}function Gn(b,t){const o=mu(b),f=mu(t);return c.au(f/o)}function pd(b,t){const o=b.rotate(t.bearingInRadians),f=t.zoom+Gn(t.center.lat,0),y=c.bv(1/mu(t.center.lat),1/mu(Math.min(Math.abs(t.center.lat),60)),c.by(f,7,3,0,1)),M=360/rr({worldSize:t.worldSize,center:{lat:t.center.lat}});return new c.V(t.center.lng-o.x*M*y,c.ao(t.center.lat+o.y*M,-c.ap,c.ap))}function Gc(b){const t=.5*b,o=Math.sin(t),f=Math.cos(t);return Math.log(o+f)-Math.log(f-o)}function Zc(b,t,o,f){const y=b.lat+o*f;if(Math.abs(o)>1){const M=(Math.sign(b.lat+o)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,C=Math.abs(b.lat+o)*Math.PI/180,D=Gc(M+f*(C-M)),O=Gc(M),U=Gc(C);return new c.V(b.lng+t*((D-O)/(U-O)),y)}return new c.V(b.lng+t*f,y)}class bf{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,o,f,y){const M=`${t.z}_${t.x}_${t.y}_${y?.terrain?"t":""}`,C=this._cache.get(M);if(C)return C;const D=this._cachePrevious.get(M);if(D)return this._cache.set(M,D),D;const O=this._boundingVolumeFactory(t,o,f,y);return this._cache.set(M,O),this._hadAnyChanges=!0,O}}class Pl{constructor(t,o,f,y){this.min=f,this.max=y,this.points=t,this.planes=o}static fromAabb(t,o){const f=[];for(let y=0;y<8;y++)f.push([1&~y?t[0]:o[0],(y>>1&1)==1?o[1]:t[1],(y>>2&1)==1?o[2]:t[2]]);return new Pl(f,[[-1,0,0,o[0]],[1,0,0,-t[0]],[0,-1,0,o[1]],[0,1,0,-t[1]],[0,0,-1,o[2]],[0,0,1,-t[2]]],t,o)}static fromCenterSizeAngles(t,o,f){const y=c.bC([],f[0],f[1],f[2]),M=c.bD([],[o[0],0,0],y),C=c.bD([],[0,o[1],0],y),D=c.bD([],[0,0,o[2]],y),O=[...t],U=[...t];for(let X=0;X<8;X++)for(let $=0;$<3;$++){const ee=t[$]+M[$]*(1&~X?-1:1)+C[$]*((X>>1&1)==1?1:-1)+D[$]*((X>>2&1)==1?1:-1);O[$]=Math.min(O[$],ee),U[$]=Math.max(U[$],ee)}const G=[];for(let X=0;X<8;X++){const $=[...t];c.b1($,$,c.b0([],M,1&~X?-1:1)),c.b1($,$,c.b0([],C,(X>>1&1)==1?1:-1)),c.b1($,$,c.b0([],D,(X>>2&1)==1?1:-1)),G.push($)}return new Pl(G,[[...M,-c.b6(M,G[0])],[...C,-c.b6(C,G[0])],[...D,-c.b6(D,G[0])],[-M[0],-M[1],-M[2],-c.b6(M,G[7])],[-C[0],-C[1],-C[2],-c.b6(C,G[7])],[-D[0],-D[1],-D[2],-c.b6(D,G[7])]],O,U)}intersectsFrustum(t){let o=!0;const f=this.points.length,y=this.planes.length,M=t.planes.length,C=t.points.length;for(let D=0;D<M;D++){const O=t.planes[D];let U=0;for(let G=0;G<f;G++){const X=this.points[G];O[0]*X[0]+O[1]*X[1]+O[2]*X[2]+O[3]>=0&&U++}if(U===0)return 0;U<f&&(o=!1)}if(o)return 2;for(let D=0;D<y;D++){const O=this.planes[D];let U=0;for(let G=0;G<C;G++){const X=t.points[G];O[0]*X[0]+O[1]*X[1]+O[2]*X[2]+O[3]>=0&&U++}if(U===0)return 0}return 1}intersectsPlane(t){const o=this.points.length;let f=0;for(let y=0;y<o;y++){const M=this.points[y];t[0]*M[0]+t[1]*M[1]+t[2]*M[2]+t[3]>=0&&f++}return f===o?2:f===0?0:1}}function Wu(b,t,o){const f=b-t;return f<0?-f:Math.max(0,f-o)}function As(b,t,o,f,y){const M=b-o;let C;return C=M<0?Math.min(-M,1+M-y):M>1?Math.min(Math.max(M-y,0),1-M):0,Math.max(C,Wu(t,f,y))}class Cs{constructor(){this._boundingVolumeCache=new bf(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,o,f,y){const M=1<<f.z,C=1/M,D=f.x/M,O=f.y/M;let U=2;return U=Math.min(U,As(t,o,D,O,C)),U=Math.min(U,As(t,o,D+.5,-O-C,C)),U=Math.min(U,As(t,o,D+.5,2-O-C,C)),U}getWrap(t,o,f){const y=1<<o.z,M=1/y,C=o.x/y,D=Wu(t.x,C,M),O=Wu(t.x,C-1,M),U=Wu(t.x,C+1,M),G=Math.min(D,O,U);return G===U?1:G===O?-1:0}allowVariableZoom(t,o){return an(t,o)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,o,f,y){return this._boundingVolumeCache.getTileBoundingVolume(t,o,f,y)}_computeTileBoundingVolume(t,o,f,y){var M,C;let D=0,O=0;if(y?.terrain){const U=new c.a2(t.z,o,t.z,t.x,t.y),G=y.terrain.getMinMaxElevation(U);D=(M=G.minElevation)!==null&&M!==void 0?M:Math.min(0,f),O=(C=G.maxElevation)!==null&&C!==void 0?C:Math.max(0,f)}if(D/=c.bF,O/=c.bF,D+=1,O+=1,t.z<=0)return Pl.fromAabb([-O,-O,-O],[O,O,O]);if(t.z===1)return Pl.fromAabb([t.x===0?-O:0,t.y===0?0:-O,-O],[t.x===0?0:O,t.y===0?O:0,O]);{const U=[Vo(0,0,t.x,t.y,t.z),Vo(c.a5,0,t.x,t.y,t.z),Vo(c.a5,c.a5,t.x,t.y,t.z),Vo(0,c.a5,t.x,t.y,t.z)],G=[];for(const Je of U)G.push(c.b0([],Je,O));if(O!==D)for(const Je of U)G.push(c.b0([],Je,D));t.y===0&&G.push([0,1,0]),t.y===(1<<t.z)-1&&G.push([0,-1,0]);const X=[1,1,1],$=[-1,-1,-1];for(const Je of G)for(let tt=0;tt<3;tt++)X[tt]=Math.min(X[tt],Je[tt]),$[tt]=Math.max($[tt],Je[tt]);const ee=Vo(c.a5/2,c.a5/2,t.x,t.y,t.z),re=c.b5([],[0,1,0],ee);c.b4(re,re);const me=c.b5([],ee,re);c.b4(me,me);const _e=c.b5([],U[2],U[1]);c.b4(_e,_e);const ye=c.b5([],U[0],U[3]);c.b4(ye,ye),G.push(c.b0([],ee,O)),t.y>=(1<<t.z)/2&&G.push(c.b0([],Vo(c.a5/2,0,t.x,t.y,t.z),O)),t.y<(1<<t.z)/2&&G.push(c.b0([],Vo(c.a5/2,c.a5,t.x,t.y,t.z),O));const ve=Ku(ee,G),Se=Ku(me,G),be=[-ee[0],-ee[1],-ee[2],ve.max],Ce=[ee[0],ee[1],ee[2],-ve.min],Ie=[-me[0],-me[1],-me[2],Se.max],we=[me[0],me[1],me[2],-Se.min],ke=[..._e,0],Ke=[...ye,0],He=[];return t.y===0?He.push(c.bE(Ke,ke,be),c.bE(Ke,ke,Ce)):He.push(c.bE(Ie,ke,be),c.bE(Ie,ke,Ce),c.bE(Ie,Ke,be),c.bE(Ie,Ke,Ce)),t.y===(1<<t.z)-1?He.push(c.bE(Ke,ke,be),c.bE(Ke,ke,Ce)):He.push(c.bE(we,ke,be),c.bE(we,ke,Ce),c.bE(we,Ke,be),c.bE(we,Ke,Ce)),new Pl(He,[be,Ce,Ie,we,ke,Ke],X,$)}}}function Ku(b,t){let o=1/0,f=-1/0;for(const y of t){const M=c.b6(b,y);o=Math.min(o,M),f=Math.max(f,M)}return{min:o,max:f}}class cs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,f){return this._helper.interpolatePadding(t,o,f)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o){this._helper.resize(t,o)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(t){this._cachedClippingPlane=c.bG(),this._projectionMatrix=c.bk(),this._globeViewProjMatrix32f=c.bj(),this._globeViewProjMatrixNoCorrection=c.bk(),this._globeViewProjMatrixNoCorrectionInverted=c.bk(),this._globeProjMatrixInverted=c.bk(),this._cameraPosition=c.bA(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(o,f)=>{const y=c.ao(o.lat,-c.ap,c.ap),M=c.ao(+f,this.minZoom+Gn(0,y),this.maxZoom);return{center:new c.V(o.lng,y),zoom:M}},this.applyConstrain=(o,f)=>this._helper.applyConstrain(o,f),this._helper=new Fa({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(o,f)=>this.defaultConstrain(o,f)},t),this._coveringTilesDetailsProvider=new Cs}clone(){const t=new cs;return t.apply(this),t}apply(t,o){this._globeLatitudeErrorCorrectionRadians=o||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=c.bA();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:o,applyGlobeMatrix:f}=t,y=this._helper.getMercatorTileCoordinates(o);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:y,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const o=this.pitchInRadians,f=this.cameraToCenterDistance/t,y=Math.sin(o)*f,M=Math.cos(o)*f+1,C=1/Math.sqrt(y*y+M*M)*1;let D=-y,O=M;const U=Math.sqrt(D*D+O*O);D/=U,O/=U;const G=[0,D,O];c.bH(G,G,[0,0,0],-this.bearingInRadians),c.bI(G,G,[0,0,0],-1*this.center.lat*Math.PI/180),c.bJ(G,G,[0,0,0],this.center.lng*Math.PI/180);const X=1/c.b8(G);return c.b0(G,G,X),[...G,-C*X]}isLocationOccluded(t){return!this.isSurfacePointVisible(On(t))}transformLightDirection(t){const o=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,y=Math.cos(f),M=[Math.sin(o)*y,Math.sin(f),Math.cos(o)*y],C=[M[2],0,-M[0]],D=[0,0,0];c.b5(D,C,M),c.b4(C,C),c.b4(D,D);const O=[0,0,0];return c.b4(O,[C[0]*t[0]+D[0]*t[1]+M[0]*t[2],C[1]*t[0]+D[1]*t[1]+M[1]*t[2],C[2]*t[0]+D[2]*t[1]+M[2]*t[2]]),O}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,o,f){const y=(function(D,O,U){const G=1/(1<<U.z);return new c.ab(D/c.a5*G+U.x*G,O/c.a5*G+U.y*G)})(t,o,f.canonical),M=(C=y.y,[c.bz(y.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-C*Math.PI*2))-.5*Math.PI]);var C;return this.getCircleRadiusCorrection()/Math.cos(M[1])}projectTileCoordinates(t,o,f,y){const M=f.canonical,C=Vo(t,o,M.x,M.y,M.z),D=1+(y?y(t,o):0)/c.bF,O=[C[0]*D,C[1]*D,C[2]*D,1];c.aI(O,O,this._globeViewProjMatrixNoCorrection);const U=this._cachedClippingPlane,G=U[0]*C[0]+U[1]*C[1]+U[2]*C[2]+U[3]<0;return{point:new c.P(O[0]/O[3],O[1]/O[3]),signedDistanceFromCamera:O[3],isOccluded:G}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=Es(this.worldSize,this.center.lat),o=c.bl(),f=c.bl();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),c.bf(o,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const y=this.centerOffset;o[8]=2*-y.x/this._helper._width,o[9]=2*y.y/this._helper._height,this._projectionMatrix=c.bg(o),this._globeProjMatrixInverted=c.bl(),c.aC(this._globeProjMatrixInverted,o),c.O(o,o,[0,0,-this.cameraToCenterDistance]),c.bh(o,o,this.rollInRadians),c.bi(o,o,-this.pitchInRadians),c.bh(o,o,this.bearingInRadians),c.O(o,o,[0,0,-t]);const M=c.bA();M[0]=t,M[1]=t,M[2]=t,c.bi(f,o,this.center.lat*Math.PI/180),c.bK(f,f,-this.center.lng*Math.PI/180),c.Q(f,f,M),this._globeViewProjMatrixNoCorrection=f,c.bi(o,o,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bK(o,o,-this.center.lng*Math.PI/180),c.Q(o,o,M),this._globeViewProjMatrix32f=new Float32Array(o),this._globeViewProjMatrixNoCorrectionInverted=c.bl(),c.aC(this._globeViewProjMatrixNoCorrectionInverted,f);const C=c.bA();this._cameraPosition=c.bA(),this._cameraPosition[2]=this.cameraToCenterDistance/t,c.bH(this._cameraPosition,this._cameraPosition,C,-this.rollInRadians),c.bI(this._cameraPosition,this._cameraPosition,C,this.pitchInRadians),c.bH(this._cameraPosition,this._cameraPosition,C,-this.bearingInRadians),c.b1(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bI(this._cameraPosition,this._cameraPosition,C,-this.center.lat*Math.PI/180),c.bJ(this._cameraPosition,this._cameraPosition,C,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const D=c.bg(this._globeViewProjMatrixNoCorrectionInverted);c.Q(D,D,[1,1,-1]),this._cachedFrustum=Ea.fromInvProjectionMatrix(D,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){c.w("calculateFogMatrix is not supported on globe projection.");const o=c.bl();return c.as(o),o}getVisibleUnwrappedCoordinates(t){return[new c.bd(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,o){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=On(t);c.b0(f,f,1+o/c.bF);const y=c.bG();return c.aI(y,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),y[2]/y[3]}populateCache(t){}getBounds(){const t=.5*this.width,o=.5*this.height,f=[new c.P(0,0),new c.P(t,0),new c.P(this.width,0),new c.P(this.width,o),new c.P(this.width,this.height),new c.P(t,this.height),new c.P(0,this.height),new c.P(0,o)],y=[];for(const X of f)y.push(this.unprojectScreenPoint(X));let M=0,C=0,D=0,O=0;const U=this.center;for(const X of y){const $=c.bL(U.lng,X.lng),ee=c.bL(U.lat,X.lat);$<C&&(C=$),$>M&&(M=$),ee<O&&(O=ee),ee>D&&(D=ee)}const G=[U.lng+C,U.lat+O,U.lng+M,U.lat+D];return this.isSurfacePointOnScreen([0,1,0])&&(G[3]=90,G[0]=-180,G[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(G[1]=-90,G[0]=-180,G[2]=180),new Cn(G)}calculateCenterFromCameraLngLatAlt(t,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,f,y)}setLocationAtPoint(t,o){const f=On(this.unprojectScreenPoint(o)),y=On(t),M=c.bA();c.bM(M);const C=c.bA();c.bJ(C,f,M,-this.center.lng*Math.PI/180),c.bI(C,C,M,this.center.lat*Math.PI/180);const D=y[0]*y[0]+y[2]*y[2],O=C[0]*C[0];if(D<O)return;const U=Math.sqrt(D-O),G=-U,X=c.bN(y[0],y[2],C[0],U),$=c.bN(y[0],y[2],C[0],G),ee=c.bA();c.bJ(ee,y,M,-X);const re=c.bN(ee[1],ee[2],C[1],C[2]),me=c.bA();c.bJ(me,y,M,-$);const _e=c.bN(me[1],me[2],C[1],C[2]),ye=.5*Math.PI,ve=re>=-ye&&re<=ye,Se=_e>=-ye&&_e<=ye;let be,Ce;if(ve&&Se){const Ke=this.center.lng*Math.PI/180,He=this.center.lat*Math.PI/180;c.bO(X,Ke)+c.bO(re,He)<c.bO($,Ke)+c.bO(_e,He)?(be=X,Ce=re):(be=$,Ce=_e)}else if(ve)be=X,Ce=re;else{if(!Se)return;be=$,Ce=_e}const Ie=be/Math.PI*180,we=Ce/Math.PI*180,ke=this.center.lat;this.setCenter(new c.V(Ie,c.ao(we,-90,90))),this.setZoom(this.zoom+Gn(ke,this.center.lat))}locationToScreenPoint(t,o){const f=On(t);if(o){const y=o.getElevationForLngLatZoom(t,this._helper._tileZoom);c.b0(f,f,1+y/c.bF)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(t){const o=c.bG();return c.aI(o,[...t,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],new c.P((.5*o[0]+.5)*this.width,(.5*-o[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,o){if(o){const f=o.pointCoordinate(t);if(f)return f}return c.ab.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,o){var f;return(f=this.screenPointToMercatorCoordinate(t,o))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(t,o){const f=this._cameraPosition,y=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(f,y)}getRayDirectionFromPixel(t){const o=c.bG();o[0]=t.x/this.width*2-1,o[1]=-1*(t.y/this.height*2-1),o[2]=1,o[3]=1,c.aI(o,o,this._globeViewProjMatrixNoCorrectionInverted),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3];const f=c.bA();f[0]=o[0]-this._cameraPosition[0],f[1]=o[1]-this._cameraPosition[1],f[2]=o[2]-this._cameraPosition[2];const y=c.bA();return c.b4(y,f),y}isSurfacePointVisible(t){const o=this._cachedClippingPlane;return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const o=c.bG();return c.aI(o,[...t,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3],o[0]>-1&&o[0]<1&&o[1]>-1&&o[1]<1&&o[2]>-1&&o[2]<1}rayPlanetIntersection(t,o){const f=c.b6(t,o),y=c.bA(),M=c.bA();c.b0(M,o,f),c.b3(y,t,M);const C=1-c.b6(y,y);if(C<0)return null;const D=c.b6(t,t)-1,O=-f+(f<0?1:-1)*Math.sqrt(C),U=D/O,G=O;return{tMin:Math.min(U,G),tMax:Math.max(U,G)}}unprojectScreenPoint(t){const o=this._cameraPosition,f=this.getRayDirectionFromPixel(t),y=this.rayPlanetIntersection(o,f);if(y){const G=c.bA();c.b1(G,o,[f[0]*y.tMin,f[1]*y.tMin,f[2]*y.tMin]);const X=c.bA();return c.b4(X,G),Yu(X)}const M=this._cachedClippingPlane,C=M[0]*f[0]+M[1]*f[1]+M[2]*f[2],D=-c.bc(M,o)/C,O=c.bA();if(D>0)c.b1(O,o,[f[0]*D,f[1]*D,f[2]*D]);else{const G=c.bA();c.b1(G,o,[2*f[0],2*f[1],2*f[2]]);const X=c.bc(this._cachedClippingPlane,G);c.b3(O,G,[this._cachedClippingPlane[0]*X,this._cachedClippingPlane[1]*X,this._cachedClippingPlane[2]*X])}const U=(function(G){const X=c.bA();return X[0]=G[0]*-G[3],X[1]=G[1]*-G[3],X[2]=G[2]*-G[3],{center:X,radius:Math.sqrt(1-G[3]*G[3])}})(M);return Yu((function(G,X,$){const ee=c.bA();c.b3(ee,$,G);const re=c.bA();return c.bB(re,G,ee,X/c.ba(ee)),re})(U.center,U.radius,O))}getMatrixForModel(t,o){const f=c.V.convert(t),y=1/c.bF,M=c.bk();return c.bK(M,M,f.lng/180*Math.PI),c.bi(M,M,-f.lat/180*Math.PI),c.O(M,M,[0,0,1+o/c.bF]),c.bi(M,M,.5*Math.PI),c.Q(M,M,[y,y,y]),M}getProjectionDataForCustomLayer(t=!0){const o=this.getProjectionData({overscaledTileID:new c.a2(0,0,0,0,0),applyGlobeMatrix:t});return o.tileMercatorCoords=[0,0,1,1],o}getFastPathSimpleProjectionMatrix(t){}}class na{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,f){return this._helper.interpolatePadding(t,o,f)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o,f=!0){this._helper.resize(t,o,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,o){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=o,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(t){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(o,f)=>this.currentTransform.defaultConstrain(o,f),this.applyConstrain=(o,f)=>this._helper.applyConstrain(o,f),this._helper=new Fa({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(o,f)=>this.defaultConstrain(o,f)},t),this._globeness=1,this._mercatorTransform=new pr,this._verticalPerspectiveTransform=new cs}clone(){const t=new na;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const o=this._mercatorTransform.getProjectionData(t),f=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:o.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:o.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return c.bv(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bv(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,o,f){const y=this._mercatorTransform.getPitchedTextCorrection(t,o,f),M=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,o,f);return c.bv(y,M,this._globeness)}projectTileCoordinates(t,o,f,y){return this.currentTransform.projectTileCoordinates(t,o,f,y)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,o){return this.currentTransform.lngLatToCameraDepth(t,o)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(t,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,f,y)}setLocationAtPoint(t,o){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,o),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,o),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,o){return this.currentTransform.locationToScreenPoint(t,o)}screenPointToMercatorCoordinate(t,o){return this.currentTransform.screenPointToMercatorCoordinate(t,o)}screenPointToLocation(t,o){return this.currentTransform.screenPointToLocation(t,o)}isPointOnMapSurface(t,o){return this.currentTransform.isPointOnMapSurface(t,o)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,o){return this.currentTransform.getMatrixForModel(t,o)}getProjectionDataForCustomLayer(t=!0){const o=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return o;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return f.fallbackMatrix=o.mainMatrix,f}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class Wn{get useGlobeControls(){return!0}handlePanInertia(t,o){const f=pd(t,o);return Math.abs(f.lng-o.center.lng)>180&&(f.lng=o.center.lng+179.5*Math.sign(f.lng-o.center.lng)),{easingCenter:f,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,o){const f=t.around,y=o.screenPointToLocation(f);t.bearingDelta&&o.setBearing(o.bearing+t.bearingDelta),t.pitchDelta&&o.setPitch(o.pitch+t.pitchDelta),t.rollDelta&&o.setRoll(o.roll+t.rollDelta);const M=o.zoom;t.zoomDelta&&o.setZoom(o.zoom+t.zoomDelta);const C=o.zoom-M;if(C===0)return;const D=c.bL(o.center.lng,y.lng),O=D/(Math.abs(D/180)+1),U=c.bL(o.center.lat,y.lat),G=o.getRayDirectionFromPixel(f),X=o.cameraPosition,$=-1*c.b6(X,G),ee=c.bA();c.b1(ee,X,[G[0]*$,G[1]*$,G[2]*$]);const re=c.b8(ee)-1,me=Math.exp(.5*-Math.max(re-.3,0)),_e=Es(o.worldSize,o.center.lat)/Math.min(o.width,o.height),ye=c.by(_e,.9,.5,1,.25),ve=(1-c.ar(-C))*Math.min(me,ye),Se=o.center.lat,be=o.zoom,Ce=new c.V(o.center.lng+O*ve,c.ao(o.center.lat+U*ve,-c.ap,c.ap));o.setLocationAtPoint(y,f);const Ie=o.center,we=c.by(Math.abs(D),45,85,0,1),ke=c.by(_e,.75,.35,0,1),Ke=Math.pow(Math.max(we,ke),.25),He=c.bL(Ie.lng,Ce.lng),Je=c.bL(Ie.lat,Ce.lat);o.setCenter(new c.V(Ie.lng+He*Ke,Ie.lat+Je*Ke).wrap()),o.setZoom(be+Gn(Se,o.center.lat))}handleMapControlsPan(t,o,f){if(!t.panDelta)return;const y=o.center.lat,M=o.zoom;o.setCenter(pd(t.panDelta,o).wrap()),o.setZoom(M+Gn(y,o.center.lat))}cameraForBoxAndBearing(t,o,f,y,M){const C=tl(t,o,f,y,M),D=o.left/M.width*2-1,O=(M.width-o.right)/M.width*2-1,U=o.top/M.height*-2+1,G=(M.height-o.bottom)/M.height*-2+1,X=c.bL(f.getWest(),f.getEast())<0,$=X?f.getEast():f.getWest(),ee=X?f.getWest():f.getEast(),re=Math.max(f.getNorth(),f.getSouth()),me=Math.min(f.getNorth(),f.getSouth()),_e=$+.5*c.bL($,ee),ye=re+.5*c.bL(re,me),ve=M.clone();ve.setCenter(C.center),ve.setBearing(C.bearing),ve.setPitch(0),ve.setRoll(0),ve.setZoom(C.zoom);const Se=ve.modelViewProjectionMatrix,be=[On(f.getNorthWest()),On(f.getNorthEast()),On(f.getSouthWest()),On(f.getSouthEast()),On(new c.V(ee,ye)),On(new c.V($,ye)),On(new c.V(_e,re)),On(new c.V(_e,me))],Ce=On(C.center);let Ie=Number.POSITIVE_INFINITY;for(const we of be)D<0&&(Ie=Wn.getLesserNonNegativeNonNull(Ie,Wn.solveVectorScale(we,Ce,Se,"x",D))),O>0&&(Ie=Wn.getLesserNonNegativeNonNull(Ie,Wn.solveVectorScale(we,Ce,Se,"x",O))),U>0&&(Ie=Wn.getLesserNonNegativeNonNull(Ie,Wn.solveVectorScale(we,Ce,Se,"y",U))),G<0&&(Ie=Wn.getLesserNonNegativeNonNull(Ie,Wn.solveVectorScale(we,Ce,Se,"y",G)));if(Number.isFinite(Ie)&&Ie!==0)return C.zoom=ve.zoom+c.au(Ie),C;ia()}handleJumpToCenterZoom(t,o){const f=t.center.lat,y=t.applyConstrain(o.center?c.V.convert(o.center):t.center,t.zoom).center;t.setCenter(y.wrap());const M=o.zoom!==void 0?+o.zoom:t.zoom+Gn(f,y.lat);t.zoom!==M&&t.setZoom(M)}handleEaseTo(t,o){const f=t.zoom,y=t.center,M=t.padding,C={roll:t.roll,pitch:t.pitch,bearing:t.bearing},D={roll:o.roll===void 0?t.roll:o.roll,pitch:o.pitch===void 0?t.pitch:o.pitch,bearing:o.bearing===void 0?t.bearing:o.bearing},O=o.zoom!==void 0,U=!t.isPaddingEqual(o.padding);let G=!1;const X=o.center?c.V.convert(o.center):y,$=t.applyConstrain(X,f).center;Ba(t,$);const ee=t.clone();ee.setCenter($),ee.setZoom(O?+o.zoom:f+Gn(y.lat,X.lat)),ee.setBearing(o.bearing);const re=new c.P(c.ao(t.centerPoint.x+o.offsetAsPoint.x,0,t.width),c.ao(t.centerPoint.y+o.offsetAsPoint.y,0,t.height));ee.setLocationAtPoint($,re);const me=(o.offset&&o.offsetAsPoint.mag())>0?ee.center:$,_e=O?+o.zoom:f+Gn(y.lat,me.lat),ye=f+Gn(y.lat,0),ve=_e+Gn(me.lat,0),Se=c.bL(y.lng,me.lng),be=c.bL(y.lat,me.lat),Ce=c.ar(ve-ye);return G=_e!==f,{easeFunc:Ie=>{if(c.bp(C,D)||$u({startEulerAngles:C,endEulerAngles:D,tr:t,k:Ie,useSlerp:C.roll!=D.roll}),U&&t.interpolatePadding(M,o.padding,Ie),o.around)c.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(o.around,o.aroundPoint);else{const we=ve>ye?Math.min(2,Ce):Math.max(.5,Ce),ke=Math.pow(we,1-Ie),Ke=Zc(y,Se,be,Ie*ke);t.setCenter(Ke.wrap())}if(G){const we=c.G.number(ye,ve,Ie)+Gn(0,t.center.lat);t.setZoom(we)}},isZooming:G,elevationCenter:me}}handleFlyTo(t,o){const f=o.zoom!==void 0,y=t.center,M=t.zoom,C=t.padding,D=!t.isPaddingEqual(o.padding),O=t.applyConstrain(c.V.convert(o.center||o.locationAtOffset),M).center,U=f?+o.zoom:t.zoom+Gn(t.center.lat,O.lat),G=t.clone();G.setCenter(O),G.setZoom(U),G.setBearing(o.bearing);const X=new c.P(c.ao(t.centerPoint.x+o.offsetAsPoint.x,0,t.width),c.ao(t.centerPoint.y+o.offsetAsPoint.y,0,t.height));G.setLocationAtPoint(O,X);const $=G.center;Ba(t,$);const ee=(function(be,Ce,Ie){const we=On(Ce),ke=On(Ie),Ke=c.b6(we,ke),He=Math.acos(Ke),Je=rr(be);return He/(2*Math.PI)*Je})(t,y,$),re=M+Gn(y.lat,0),me=U+Gn($.lat,0),_e=c.ar(me-re);let ye;if(typeof o.minZoom=="number"){const be=+o.minZoom+Gn($.lat,0),Ce=Math.min(be,re,me)+Gn(0,$.lat),Ie=t.applyConstrain($,Ce).zoom+Gn($.lat,0);ye=c.ar(Ie-re)}const ve=c.bL(y.lng,$.lng),Se=c.bL(y.lat,$.lat);return{easeFunc:(be,Ce,Ie,we)=>{const ke=Zc(y,ve,Se,Ie);D&&t.interpolatePadding(C,o.padding,be);const Ke=be===1?$:ke;t.setCenter(Ke.wrap());const He=re+c.au(Ce);t.setZoom(be===1?U:He+Gn(0,Ke.lat))},scaleOfZoom:_e,targetCenter:$,scaleOfMinZoom:ye,pixelPathLength:ee}}static solveVectorScale(t,o,f,y,M){const C=y==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],D=[f[3],f[7],f[11],f[15]],O=t[0]*C[0]+t[1]*C[1]+t[2]*C[2],U=t[0]*D[0]+t[1]*D[1]+t[2]*D[2],G=o[0]*C[0]+o[1]*C[1]+o[2]*C[2],X=o[0]*D[0]+o[1]*D[1]+o[2]*D[2];return G+M*U===O+M*X||D[3]*(O-G)+C[3]*(X-U)+O*X==G*U?null:(G+C[3]-M*X-M*D[3])/(G-O-M*X+M*U)}static getLesserNonNegativeNonNull(t,o){return o!==null&&o>=0&&o<t?o:t}}class zl{constructor(t){this._globe=t,this._mercatorCameraHelper=new Pi,this._verticalPerspectiveCameraHelper=new Wn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,o){return this.currentHelper.handlePanInertia(t,o)}handleMapControlsRollPitchBearingZoom(t,o){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,o)}handleMapControlsPan(t,o,f){this.currentHelper.handleMapControlsPan(t,o,f)}cameraForBoxAndBearing(t,o,f,y,M){return this.currentHelper.cameraForBoxAndBearing(t,o,f,y,M)}handleJumpToCenterZoom(t,o){this.currentHelper.handleJumpToCenterZoom(t,o)}handleEaseTo(t,o){return this.currentHelper.handleEaseTo(t,o)}handleFlyTo(t,o){return this.currentHelper.handleFlyTo(t,o)}}const gu=(b,t)=>c.B(b,t&&t.filter((o=>o.identifier!=="source.canvas"))),rl=c.bP();class hs extends c.E{constructor(t,o={}){var f,y;super(),this._rtlPluginLoaded=()=>{for(const C in this.tileManagers){const D=this.tileManagers[C].getSource().type;D!=="vector"&&D!=="geojson"||this.tileManagers[C].reload()}},this.map=t,this.dispatcher=new hr(rn(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((C,D)=>this.getGlyphs(C,D))),this.dispatcher.registerMessageHandler("GI",((C,D)=>this.getImages(C,D))),this.dispatcher.registerMessageHandler("GDA",((C,D)=>this.getDashes(C,D))),this.imageManager=new li,this.imageManager.setEventedParent(this);const M=((f=t._container)===null||f===void 0?void 0:f.lang)||typeof document<"u"&&((y=document.documentElement)===null||y===void 0?void 0:y.lang)||void 0;this.glyphManager=new Pt(t._requestManager,o.localIdeographFontFamily,M),this.lineAtlas=new It(256,512),this.crossTileSymbolIndex=new Ar,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",c.bQ()),je().on(Ee,this._rtlPluginLoaded),this.on("data",(C=>{if(C.dataType!=="source"||C.sourceDataType!=="metadata")return;const D=this.tileManagers[C.sourceId];if(!D)return;const O=D.getSource();if(O&&O.vectorLayerIds)for(const U in this._layers){const G=this._layers[U];G.source===O.id&&this._validateLayer(G)}}))}_setInitialValues(){var t;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new c.bR,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((t=this.crossTileSymbolIndex)===null||t===void 0?void 0:t.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(t,o){var f,y,M;this._checkLoaded();const C=o===null?(M=(y=(f=this.stylesheet.state)===null||f===void 0?void 0:f[t])===null||y===void 0?void 0:y.default)!==null&&M!==void 0?M:null:o;if(c.bS(C,this._globalState[t]))return this;this._globalState[t]=C,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const o=[];for(const f in t)!c.bS(this._globalState[f],t[f].default)&&(o.push(f),this._globalState[f]=t[f].default);this._applyGlobalStateChanges(o)}_applyGlobalStateChanges(t){if(t.length===0)return;const o=new Set,f={};for(const y of t){f[y]=this._globalState[y];for(const M in this._layers){const C=this._layers[M],D=C.getLayoutAffectingGlobalStateRefs(),O=C.getPaintAffectingGlobalStateRefs();if(D.has(y)&&o.add(C.source),O.has(y))for(const{name:U,value:G}of O.get(y))this._updatePaintProperty(C,U,G)}}this.dispatcher.broadcast("UGS",f);for(const y in this.tileManagers)o.has(y)&&(this._reloadSource(y),this._changed=!0)}loadURL(t,o={},f){this.fire(new c.l("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const y=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const M=this._loadStyleRequest;c.j(y,this._loadStyleRequest).then((C=>{this._loadStyleRequest=null,this._load(C.data,o,f)})).catch((C=>{this._loadStyleRequest=null,C&&!M.signal.aborted&&this.fire(new c.k(C))}))}loadJSON(t,o={},f){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ue.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(t,o,f)})).catch((()=>{}))}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(rl,{validate:!1})}_load(t,o,f){var y,M;let C=o.transformStyle?o.transformStyle(f,t):t;if(!o.validate||!gu(this,c.C(C))){C=Object.assign({},C),this._loaded=!0,this.stylesheet=C;for(const D in C.sources)this.addSource(D,C.sources[D],{validate:!1});C.sprite?this._loadSprite(C.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(C.glyphs),this._createLayers(),this.light=new Nt(this.stylesheet.light),this._setProjectionInternal(((y=this.stylesheet.projection)===null||y===void 0?void 0:y.type)||"mercator"),this.sky=new dt(this.stylesheet.sky),this.map.setTerrain((M=this.stylesheet.terrain)!==null&&M!==void 0?M:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){var t,o,f;const y=c.bT(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",y),this._order=y.map((M=>M.id)),this._layers={},this._serializedLayers=null;for(const M of y){const C=c.bU(M,this._globalState);if(C.setEventedParent(this,{layer:{id:M.id}}),this._layers[M.id]=C,c.bV(C)&&this.tileManagers[C.source]){const D=(f=(o=M.paint)===null||o===void 0?void 0:o["raster-fade-duration"])!==null&&f!==void 0?f:C.paint.get("raster-fade-duration");this.tileManagers[C.source].setRasterFadeDuration(D)}}}_loadSprite(t,o=!1,f=void 0){this.imageManager.setLoaded(!1);const y=new AbortController;let M;this._spriteRequest=y,(function(C,D,O,U){return c._(this,void 0,void 0,(function*(){const G=Ut(C),X=O>1?"@2x":"",$={},ee={};for(const{id:re,url:me}of G){const _e=D.transformRequest($t(me,X,".json"),"SpriteJSON");$[re]=c.j(_e,U);const ye=D.transformRequest($t(me,X,".png"),"SpriteImage");ee[re]=Qe.getImage(ye,U)}return yield Promise.all([...Object.values($),...Object.values(ee)]),(function(re,me){return c._(this,void 0,void 0,(function*(){const _e={};for(const ye in re){_e[ye]={};const ve=ue.getImageCanvasContext((yield me[ye]).data),Se=(yield re[ye]).data;for(const be in Se){const{width:Ce,height:Ie,x:we,y:ke,sdf:Ke,pixelRatio:He,stretchX:Je,stretchY:tt,content:bt,textFitWidth:Ct,textFitHeight:_t}=Se[be];_e[ye][be]={data:null,pixelRatio:He,sdf:Ke,stretchX:Je,stretchY:tt,content:bt,textFitWidth:Ct,textFitHeight:_t,spriteData:{width:Ce,height:Ie,x:we,y:ke,context:ve}}}}return _e}))})($,ee)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((C=>{if(this._spriteRequest=null,C)for(const D in C){this._spritesImagesIds[D]=[];const O=this._spritesImagesIds[D]?this._spritesImagesIds[D].filter((U=>!(U in C))):[];for(const U of O)this.imageManager.removeImage(U),this._changedImages[U]=!0;for(const U in C[D]){const G=D==="default"?U:`${D}:${U}`;this._spritesImagesIds[D].push(G),G in this.imageManager.images?this.imageManager.updateImage(G,C[D][U],!1):this.imageManager.addImage(G,C[D][U]),o&&(this._changedImages[G]=!0)}}})).catch((C=>{this._spriteRequest=null,M=C,y.signal.aborted||this.fire(new c.k(M))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),f&&f(M)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(t){const o=this.tileManagers[t.source];if(!o)return;const f=t.sourceLayer;if(!f)return;const y=o.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(f)===-1)&&this.fire(new c.k(new Error(`Source layer "${f}" does not exist on source "${y.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.tileManagers)if(!this.tileManagers[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,o=!1){const f=this._serializedAllLayers();if(!t||t.length===0)return Object.values(o?c.bW(f):f);const y=[];for(const M of t)if(f[M]){const C=o?c.bW(f[M]):f[M];y.push(C)}return y}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const o=Object.keys(this._layers);for(const f of o){const y=this._layers[f];y.type!=="custom"&&(t[f]=y.serialize())}return t}hasTransitions(){var t,o,f;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((o=this.sky)===null||o===void 0)&&o.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(const y in this.tileManagers)if(this.tileManagers[y].hasTransition())return!0;for(const y in this._layers)if(this._layers[y].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const o=this._changed;if(o){const y=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);(y.length||M.length)&&this._updateWorkerLayers(y,M);for(const C in this._updatedSources){const D=this._updatedSources[C];if(D==="reload")this._reloadSource(C);else{if(D!=="clear")throw new Error(`Invalid action ${D}`);this._clearSource(C)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const C in this._updatedPaintProps)this._layers[C].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const f={};for(const y in this.tileManagers){const M=this.tileManagers[y];f[y]=M.used,M.used=!1}for(const y of this._order){const M=this._layers[y];M.recalculate(t,this._availableImages),!M.isHidden(t.zoom)&&M.source&&(this.tileManagers[M.source].used=!0)}for(const y in f){const M=this.tileManagers[y];!!f[y]!=!!M.used&&M.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,o&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const o in this.tileManagers)this.tileManagers[o].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.tileManagers)this.tileManagers[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,o={}){var f;this._checkLoaded();const y=this.serialize();if(t=o.transformStyle?o.transformStyle(y,t):t,((f=o.validate)===null||f===void 0||f)&&gu(this,c.C(t)))return!1;(t=c.bW(t)).layers=c.bT(t.layers);const M=c.bX(y,t),C=this._getOperationsToPerform(M);if(C.unimplemented.length>0)throw new Error(`Unimplemented: ${C.unimplemented.join(", ")}.`);if(C.operations.length===0)return!1;for(const D of C.operations)D();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const o=[],f=[];for(const y of t)switch(y.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":o.push((()=>this.addLayer.apply(this,y.args)));break;case"removeLayer":o.push((()=>this.removeLayer.apply(this,y.args)));break;case"setPaintProperty":o.push((()=>this.setPaintProperty.apply(this,y.args)));break;case"setLayoutProperty":o.push((()=>this.setLayoutProperty.apply(this,y.args)));break;case"setFilter":o.push((()=>this.setFilter.apply(this,y.args)));break;case"addSource":o.push((()=>this.addSource.apply(this,y.args)));break;case"removeSource":o.push((()=>this.removeSource.apply(this,y.args)));break;case"setLayerZoomRange":o.push((()=>this.setLayerZoomRange.apply(this,y.args)));break;case"setLight":o.push((()=>this.setLight.apply(this,y.args)));break;case"setGeoJSONSourceData":o.push((()=>this.setGeoJSONSourceData.apply(this,y.args)));break;case"setGlyphs":o.push((()=>this.setGlyphs.apply(this,y.args)));break;case"setSprite":o.push((()=>this.setSprite.apply(this,y.args)));break;case"setTerrain":o.push((()=>this.map.setTerrain.apply(this,y.args)));break;case"setSky":o.push((()=>this.setSky.apply(this,y.args)));break;case"setProjection":this.setProjection.apply(this,y.args);break;case"setGlobalState":o.push((()=>this.setGlobalState.apply(this,y.args)));break;case"setTransition":o.push((()=>{}));break;default:f.push(y.command)}return{operations:o,unimplemented:f}}addImage(t,o){if(this.getImage(t))return this.fire(new c.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,o),this._afterImageUpdated(t)}updateImage(t,o){this.imageManager.updateImage(t,o)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new c.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,o,f={}){if(this._checkLoaded(),this.tileManagers[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(c.C.source,`sources.${t}`,o,null,f))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const y=this.tileManagers[t]=new vn(t,o,this.dispatcher);y.style=this,y.setEventedParent(this,(()=>({isSourceLoaded:y.loaded(),source:y.serialize(),sourceId:t}))),y.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===t)return this.fire(new c.k(new Error(`Source "${t}" cannot be removed while layer "${f}" is using it.`)));const o=this.tileManagers[t];delete this.tileManagers[t],delete this._updatedSources[t],o.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,o){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const f=this.tileManagers[t].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(o),this._changed=!0}getSource(t){return this.tileManagers[t]&&this.tileManagers[t].getSource()}addLayer(t,o,f={}){this._checkLoaded();const y=t.id;if(this.getLayer(y))return void this.fire(new c.k(new Error(`Layer "${y}" already exists on this map.`)));let M;if(t.type==="custom"){if(gu(this,c.bY(t)))return;M=c.bU(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(y,t.source),t=c.bW(t),t=c.e(t,{source:y})),this._validate(c.C.layer,`layers.${y}`,t,{arrayIndex:-1},f))return;M=c.bU(t,this._globalState),this._validateLayer(M),M.setEventedParent(this,{layer:{id:y}})}const C=o?this._order.indexOf(o):this._order.length;if(o&&C===-1)this.fire(new c.k(new Error(`Cannot add layer "${y}" before non-existing layer "${o}".`)));else{if(this._order.splice(C,0,y),this._layerOrderChanged=!0,this._layers[y]=M,this._removedLayers[y]&&M.source&&M.type!=="custom"){const D=this._removedLayers[y];delete this._removedLayers[y],D.type!==M.type?this._updatedSources[M.source]="clear":(this._updatedSources[M.source]="reload",this.tileManagers[M.source].pause())}this._updateLayer(M),M.onAdd&&M.onAdd(this.map)}}moveLayer(t,o){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new c.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===o)return;const f=this._order.indexOf(t);this._order.splice(f,1);const y=o?this._order.indexOf(o):this._order.length;o&&y===-1?this.fire(new c.k(new Error(`Cannot move layer "${t}" before non-existing layer "${o}".`))):(this._order.splice(y,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const o=this._layers[t];if(!o)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${t}".`)));o.setEventedParent(null);const f=this._order.indexOf(t);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=o,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],o.onRemove&&o.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,o,f){this._checkLoaded();const y=this.getLayer(t);y?y.minzoom===o&&y.maxzoom===f||(o!=null&&(y.minzoom=o),f!=null&&(y.maxzoom=f),this._updateLayer(y)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,o,f={}){this._checkLoaded();const y=this.getLayer(t);if(y){if(!c.bS(y.filter,o))return o==null?(y.setFilter(void 0),void this._updateLayer(y)):void(this._validate(c.C.filter,`layers.${y.id}.filter`,o,null,f)||(y.setFilter(c.bW(o)),this._updateLayer(y)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return c.bW(this.getLayer(t).filter)}setLayoutProperty(t,o,f,y={}){this._checkLoaded();const M=this.getLayer(t);M?c.bS(M.getLayoutProperty(o),f)||(M.setLayoutProperty(o,f,y),this._updateLayer(M)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,o){const f=this.getLayer(t);if(f)return f.getLayoutProperty(o);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,o,f,y={}){this._checkLoaded();const M=this.getLayer(t);M?c.bS(M.getPaintProperty(o),f)||this._updatePaintProperty(M,o,f,y):this.fire(new c.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,o,f,y={}){t.setPaintProperty(o,f,y)&&this._updateLayer(t),c.bV(t)&&o==="raster-fade-duration"&&this.tileManagers[t.source].setRasterFadeDuration(f),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,o){return this.getLayer(t).getPaintProperty(o)}setFeatureState(t,o){this._checkLoaded();const f=t.source,y=t.sourceLayer,M=this.tileManagers[f];if(M===void 0)return void this.fire(new c.k(new Error(`The source '${f}' does not exist in the map's style.`)));const C=M.getSource().type;C==="geojson"&&y?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):C!=="vector"||y?(t.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),M.setFeatureState(y,t.id,o)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,o){this._checkLoaded();const f=t.source,y=this.tileManagers[f];if(y===void 0)return void this.fire(new c.k(new Error(`The source '${f}' does not exist in the map's style.`)));const M=y.getSource().type,C=M==="vector"?t.sourceLayer:void 0;M!=="vector"||C?o&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(C,t.id,o):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const o=t.source,f=t.sourceLayer,y=this.tileManagers[o];if(y!==void 0)return y.getSource().type!=="vector"||f?(t.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),y.getFeatureState(f,t.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=c.bZ(this.tileManagers,(M=>M.serialize())),o=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,y=this.stylesheet;return c.b_({version:y.version,name:y.name,metadata:y.metadata,light:y.light,sky:y.sky,center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch,sprite:y.sprite,glyphs:y.glyphs,transition:y.transition,projection:y.projection,sources:t,layers:o,terrain:f},(M=>M!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.tileManagers[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.tileManagers[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const o=C=>this._layers[C].type==="fill-extrusion",f={},y=[];for(let C=this._order.length-1;C>=0;C--){const D=this._order[C];if(o(D)){f[D]=C;for(const O of t){const U=O[D];if(U)for(const G of U)y.push(G)}}}y.sort(((C,D)=>D.intersectionZ-C.intersectionZ));const M=[];for(let C=this._order.length-1;C>=0;C--){const D=this._order[C];if(o(D))for(let O=y.length-1;O>=0;O--){const U=y[O].feature;if(f[U.layer.id]<C)break;M.push(U),y.pop()}else for(const O of t){const U=O[D];if(U)for(const G of U)M.push(G.feature)}}return M}queryRenderedFeatures(t,o,f){o&&o.filter&&this._validate(c.C.filter,"queryRenderedFeatures.filter",o.filter,null,o);const y={};if(o&&o.layers){if(!(Array.isArray(o.layers)||o.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const U of o.layers){const G=this._layers[U];if(!G)return this.fire(new c.k(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];y[G.source]=!0}}const M=[];o.availableImages=this._availableImages;const C=this._serializedAllLayers(),D=o.layers instanceof Set?o.layers:Array.isArray(o.layers)?new Set(o.layers):null,O=Object.assign(Object.assign({},o),{layers:D,globalState:this._globalState});for(const U in this.tileManagers)o.layers&&!y[U]||M.push(as(this.tileManagers[U],this._layers,C,t,O,f,this.map.terrain?(G,X,$)=>this.map.terrain.getElevation(G,X,$):void 0));return this.placement&&M.push((function(U,G,X,$,ee,re,me){const _e={},ye=re.queryRenderedSymbols($),ve=[];for(const Se of Object.keys(ye).map(Number))ve.push(me[Se]);ve.sort(Rn);for(const Se of ve){const be=Se.featureIndex.lookupSymbolFeatures(ye[Se.bucketInstanceId],G,Se.bucketIndex,Se.sourceLayerIndex,{filterSpec:ee.filter,globalState:ee.globalState},ee.layers,ee.availableImages,U);for(const Ce in be){const Ie=_e[Ce]=_e[Ce]||[],we=be[Ce];we.sort(((ke,Ke)=>{const He=Se.featureSortOrder;if(He){const Je=He.indexOf(ke.featureIndex);return He.indexOf(Ke.featureIndex)-Je}return Ke.featureIndex-ke.featureIndex}));for(const ke of we)Ie.push(ke)}}return(function(Se,be,Ce){for(const Ie in Se)for(const we of Se[Ie])Jr(we,Ce[be[Ie].source]);return Se})(_e,U,X)})(this._layers,C,this.tileManagers,t,O,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(M)}querySourceFeatures(t,o){o?.filter&&this._validate(c.C.filter,"querySourceFeatures.filter",o.filter,null,o);const f=this.tileManagers[t];return f?(function(y,M){const C=y.getRenderableIds().map((U=>y.getTileByID(U))),D=[],O={};for(let U=0;U<C.length;U++){const G=C[U],X=G.tileID.canonical.key;O[X]||(O[X]=!0,G.querySourceFeatures(D,M))}return D})(f,o?Object.assign(Object.assign({},o),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,o={}){this._checkLoaded();const f=this.light.getLight();let y=!1;for(const C in t)if(!c.bS(t[C],f[C])){y=!0;break}if(!y)return;const M={now:fe(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,o),this.light.updateTransitions(M)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,o={}){this._checkLoaded();const f=this.getSky();let y=!1;if(!t&&!f)return;if(t&&!f)y=!0;else if(!t&&f)y=!0;else for(const C in t)if(!c.bS(t[C],f[C])){y=!0;break}if(!y)return;const M={now:fe(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,o),this.sky.updateTransitions(M)}_setProjectionInternal(t){const o=(function(f,y){const M={constrainOverride:y};if(Array.isArray(f)){const C=new Vc({type:f});return{projection:C,transform:new na(M),cameraHelper:new zl(C)}}switch(f){case"mercator":return{projection:new Fn,transform:new pr(M),cameraHelper:new Pi};case"globe":{const C=new Vc({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:C,transform:new na(M),cameraHelper:new zl(C)}}case"vertical-perspective":return{projection:new xo,transform:new cs(M),cameraHelper:new Wn};default:return c.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new Fn,transform:new pr(M),cameraHelper:new Pi}}})(t,this.map.transformConstrain);this.projection=o.projection,this.map.migrateProjection(o.transform,o.cameraHelper);for(const f in this.tileManagers)this.tileManagers[f].reload()}_validate(t,o,f,y,M={}){return(!M||M.validate!==!1)&&gu(this,t.call(c.C,c.e({key:o,style:this.serialize(),value:f,styleSpec:c.u},y)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),je().off(Ee,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.tileManagers){const f=this.tileManagers[o];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.tileManagers[t].clearTiles()}_reloadSource(t){this.tileManagers[t].resume(),this.tileManagers[t].reload()}_updateSources(t){for(const o in this.tileManagers)this.tileManagers[o].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.tileManagers)this._reloadSource(t)}_updatePlacement(t,o,f,y,M=!1){let C=!1,D=!1;const O={};for(const U of this._order){const G=this._layers[U];if(G.type!=="symbol")continue;if(!O[G.source]){const $=this.tileManagers[G.source];O[G.source]=$.getRenderableIds(!0).map((ee=>$.getTileByID(ee))).sort(((ee,re)=>re.tileID.overscaledZ-ee.tileID.overscaledZ||(ee.tileID.isLessThan(re.tileID)?-1:1)))}const X=this.crossTileSymbolIndex.addLayer(G,O[G.source],t.center.lng);C=C||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((M=M||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(fe(),t.zoom))&&(this.pauseablePlacement=new Qs(t,this.map.terrain,this._order,M,o,f,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(fe()),D=!0),C&&this.pauseablePlacement.placement.setStale()),D||C)for(const U of this._order){const G=this._layers[U];G.type==="symbol"&&this.placement.updateLayerOpacities(G,O[G.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(fe())}_releaseSymbolFadeTiles(){for(const t in this.tileManagers)this.tileManagers[t].releaseSymbolFadeTiles()}getImages(t,o){return c._(this,void 0,void 0,(function*(){const f=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const y=this.tileManagers[o.source];return y&&y.setDependencies(o.tileID.key,o.type,o.icons),f}))}getGlyphs(t,o){return c._(this,void 0,void 0,(function*(){const f=yield this.glyphManager.getGlyphs(o.stacks),y=this.tileManagers[o.source];return y&&y.setDependencies(o.tileID.key,o.type,[""]),f}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,o={}){this._checkLoaded(),t&&this._validate(c.C.glyphs,"glyphs",t,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,o){return c._(this,void 0,void 0,(function*(){const f={};for(const[y,M]of Object.entries(o.dashes))f[y]=this.lineAtlas.getDash(M.dasharray,M.round);return f}))}addSprite(t,o,f={},y){this._checkLoaded();const M=[{id:t,url:o}],C=[...Ut(this.stylesheet.sprite),...M];this._validate(c.C.sprite,"sprite",C,null,f)||(this.stylesheet.sprite=C,this._loadSprite(M,!0,y))}removeSprite(t){this._checkLoaded();const o=Ut(this.stylesheet.sprite);if(o.find((f=>f.id===t))){if(this._spritesImagesIds[t])for(const f of this._spritesImagesIds[t])this.imageManager.removeImage(f),this._changedImages[f]=!0;o.splice(o.findIndex((f=>f.id===t)),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Ut(this.stylesheet.sprite)}setSprite(t,o={},f){this._checkLoaded(),t&&this._validate(c.C.sprite,"sprite",t,null,o)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,f):(this._unloadSprite(),f&&f(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const t in this.tileManagers){const o=this.tileManagers[t];o.setEventedParent(null),o.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const t in this._layers){const o=this._layers[t];o.setEventedParent(null),o.onRemove&&o.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var md=c.aV([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ju{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,o,f,y,M,C,D,O,U){this.context=t;let G=this.boundPaintVertexBuffers.length!==y.length;for(let X=0;!G&&X<y.length;X++)this.boundPaintVertexBuffers[X]!==y[X]&&(G=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==f||G||this.boundIndexBuffer!==M||this.boundVertexOffset!==C||this.boundDynamicVertexBuffer!==D||this.boundDynamicVertexBuffer2!==O||this.boundDynamicVertexBuffer3!==U?this.freshBind(o,f,y,M,C,D,O,U):(t.bindVertexArray.set(this.vao),D&&D.bind(),M&&M.dynamicDraw&&M.bind(),O&&O.bind(),U&&U.bind())}freshBind(t,o,f,y,M,C,D,O){const U=t.numAttributes,G=this.context,X=G.gl;this.vao&&this.destroy(),this.vao=G.createVertexArray(),G.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=y,this.boundVertexOffset=M,this.boundDynamicVertexBuffer=C,this.boundDynamicVertexBuffer2=D,this.boundDynamicVertexBuffer3=O,o.enableAttributes(X,t);for(const $ of f)$.enableAttributes(X,t);C&&C.enableAttributes(X,t),D&&D.enableAttributes(X,t),O&&O.enableAttributes(X,t),o.bind(),o.setVertexAttribPointers(X,t,M);for(const $ of f)$.bind(),$.setVertexAttribPointers(X,t,M);C&&(C.bind(),C.setVertexAttribPointers(X,t,M)),y&&y.bind(),D&&(D.bind(),D.setVertexAttribPointers(X,t,M)),O&&(O.bind(),O.setVertexAttribPointers(X,t,M)),G.currentNumAttributes=U}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const zh=(b,t,o,f,y)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:t,u_fog_color:o?o.properties.get("fog-color"):c.bq.white,u_fog_ground_blend:o?o.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:y?0:o?o.calculateFogBlendOpacity(f):0,u_horizon_color:o?o.properties.get("horizon-color"):c.bq.white,u_horizon_fog_blend:o?o.properties.get("horizon-fog-blend"):1,u_is_globe_mode:y?1:0}),Go={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ja(b){const t=[];for(let o=0;o<b.length;o++){if(b[o]===null)continue;const f=b[o].split(" ");t.push(f.pop())}return t}class Il{constructor(t,o,f,y,M,C,D,O,U=[]){const G=t.gl;this.program=G.createProgram();const X=ja(o.staticAttributes),$=f?f.getBinderAttributes():[],ee=X.concat($),re=Xi.prelude.staticUniforms?ja(Xi.prelude.staticUniforms):[],me=D.staticUniforms?ja(D.staticUniforms):[],_e=o.staticUniforms?ja(o.staticUniforms):[],ye=f?f.getBinderUniforms():[],ve=re.concat(me).concat(_e).concat(ye),Se=[];for(const He of ve)Se.indexOf(He)<0&&Se.push(He);const be=f?f.defines():[];oo(G)&&be.unshift("#version 300 es"),M&&be.push("#define OVERDRAW_INSPECTOR;"),C&&be.push("#define TERRAIN3D;"),O&&be.push(O),U&&be.push(...U);let Ce=be.concat(Xi.prelude.fragmentSource,D.fragmentSource,o.fragmentSource).join(`
`),Ie=be.concat(Xi.prelude.vertexSource,D.vertexSource,o.vertexSource).join(`
`);oo(G)||(Ce=(function(He){return He.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(Ce),Ie=(function(He){return He.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(Ie));const we=G.createShader(G.FRAGMENT_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);if(G.shaderSource(we,Ce),G.compileShader(we),!G.getShaderParameter(we,G.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${G.getShaderInfoLog(we)}`);G.attachShader(this.program,we);const ke=G.createShader(G.VERTEX_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);if(G.shaderSource(ke,Ie),G.compileShader(ke),!G.getShaderParameter(ke,G.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${G.getShaderInfoLog(ke)}`);G.attachShader(this.program,ke),this.attributes={};const Ke={};this.numAttributes=ee.length;for(let He=0;He<this.numAttributes;He++)ee[He]&&(G.bindAttribLocation(this.program,He,ee[He]),this.attributes[ee[He]]=He);if(G.linkProgram(this.program),!G.getProgramParameter(this.program,G.LINK_STATUS))throw new Error(`Program failed to link: ${G.getProgramInfoLog(this.program)}`);G.deleteShader(ke),G.deleteShader(we);for(let He=0;He<Se.length;He++){const Je=Se[He];if(Je&&!Ke[Je]){const tt=G.getUniformLocation(this.program,Je);tt&&(Ke[Je]=tt)}}this.fixedUniforms=y(t,Ke),this.terrainUniforms=((He,Je)=>({u_depth:new c.b$(He,Je.u_depth),u_terrain:new c.b$(He,Je.u_terrain),u_terrain_dim:new c.br(He,Je.u_terrain_dim),u_terrain_matrix:new c.c1(He,Je.u_terrain_matrix),u_terrain_unpack:new c.c2(He,Je.u_terrain_unpack),u_terrain_exaggeration:new c.br(He,Je.u_terrain_exaggeration)}))(t,Ke),this.projectionUniforms=((He,Je)=>({u_projection_matrix:new c.c1(He,Je.u_projection_matrix),u_projection_tile_mercator_coords:new c.c2(He,Je.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.c2(He,Je.u_projection_clipping_plane),u_projection_transition:new c.br(He,Je.u_projection_transition),u_projection_fallback_matrix:new c.c1(He,Je.u_projection_fallback_matrix)}))(t,Ke),this.binderUniforms=f?f.getUniforms(t,Ke):[]}draw(t,o,f,y,M,C,D,O,U,G,X,$,ee,re,me,_e,ye,ve,Se){const be=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(f),t.setStencilMode(y),t.setColorMode(M),t.setCullFace(C),O){t.activeTexture.set(be.TEXTURE2),be.bindTexture(be.TEXTURE_2D,O.depthTexture),t.activeTexture.set(be.TEXTURE3),be.bindTexture(be.TEXTURE_2D,O.texture);for(const Ie in this.terrainUniforms)this.terrainUniforms[Ie].set(O[Ie])}if(U)for(const Ie in U)this.projectionUniforms[Go[Ie]].set(U[Ie]);if(D)for(const Ie in this.fixedUniforms)this.fixedUniforms[Ie].set(D[Ie]);_e&&_e.setUniforms(t,this.binderUniforms,re,{zoom:me});let Ce=0;switch(o){case be.LINES:Ce=2;break;case be.TRIANGLES:Ce=3;break;case be.LINE_STRIP:Ce=1}for(const Ie of ee.get()){const we=Ie.vaos||(Ie.vaos={});(we[G]||(we[G]=new Ju)).bind(t,this,X,_e?_e.getPaintVertexBuffers():[],$,Ie.vertexOffset,ye,ve,Se),be.drawElements(o,Ie.primitiveLength*Ce,be.UNSIGNED_SHORT,Ie.primitiveOffset*Ce*2)}}}function gd(b,t,o){const f=1/c.aO(o,1,t.transform.tileZoom),y=Math.pow(2,o.tileID.overscaledZ),M=o.tileSize*Math.pow(2,t.transform.tileZoom)/y,C=M*(o.tileID.canonical.x+o.tileID.wrap*y),D=M*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[f,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[C>>16,D>>16],u_pixel_coord_lower:[65535&C,65535&D]}}const wo=(b,t,o,f)=>{const y=b.style.light,M=y.properties.get("position"),C=[M.x,M.y,M.z],D=c.c5();y.properties.get("anchor")==="viewport"&&c.c6(D,b.transform.bearingInRadians),c.c7(C,C,D);const O=b.transform.transformLightDirection(C),U=y.properties.get("color");return{u_lightpos:C,u_lightpos_globe:O,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[U.r,U.g,U.b],u_vertical_gradient:+t,u_opacity:o,u_fill_translate:f}},qc=(b,t,o,f,y,M,C)=>c.e(wo(b,t,o,f),gd(M,b,C),{u_height_factor:-Math.pow(2,y.overscaledZ)/C.tileSize/8}),To=(b,t,o,f)=>c.e(gd(t,b,o),{u_fill_translate:f}),yu=(b,t)=>({u_world:b,u_fill_translate:t}),_u=(b,t,o,f,y)=>c.e(To(b,t,o,y),{u_world:f}),vu=(b,t,o,f,y)=>{const M=b.transform;let C,D,O=0;if(o.paint.get("circle-pitch-alignment")==="map"){const U=c.aO(t,1,M.zoom);C=!0,D=[U,U],O=U/(c.a5*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*y}else C=!1,D=M.pixelsToGLUnits;return{u_camera_to_center_distance:M.cameraToCenterDistance,u_scale_with_map:+(o.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+C,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:D,u_globe_extrude_scale:O,u_translate:f}},Zo=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),Ih=b=>({u_viewport_size:[b.width,b.height]}),So=(b,t=1)=>({u_color:b,u_overlay:0,u_overlay_scale:t}),qo=(b,t,o,f)=>{const y=c.aO(b,1,t)/(c.a5*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:c.aO(b,1,t),u_intensity:o,u_globe_extrude_scale:y}},Lh=(b,t,o,f)=>{const y=c.N();c.c8(y,0,b.width,b.height,0,0,1);const M=b.context.gl;return{u_matrix:y,u_world:[M.drawingBufferWidth,M.drawingBufferHeight],u_image:o,u_color_ramp:f,u_opacity:t.paint.get("heatmap-opacity")}},Ll=(b,t,o)=>{const f=o.paint.get("hillshade-accent-color");let y;switch(o.paint.get("hillshade-method")){case"basic":y=4;break;case"combined":y=1;break;case"igor":y=2;break;case"multidirectional":y=3;break;default:y=0}const M=o.getIlluminationProperties();for(let C=0;C<M.directionRadians.length;C++)o.paint.get("hillshade-illumination-anchor")==="viewport"&&(M.directionRadians[C]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:Ps(0,t.tileID),u_exaggeration:o.paint.get("hillshade-exaggeration"),u_altitudes:M.altitudeRadians,u_azimuths:M.directionRadians,u_accent:f,u_method:y,u_highlights:M.highlightColor,u_shadows:M.shadowColor}},yd=(b,t)=>{const o=t.stride,f=c.N();return c.c8(f,0,c.a5,-c.a5,0,0,1),c.O(f,f,[0,-c.a5,0]),{u_matrix:f,u_image:1,u_dimension:[o,o],u_zoom:b.overscaledZ,u_unpack:t.getUnpackVector()}};function Ps(b,t){const o=Math.pow(2,t.canonical.z),f=t.canonical.y;return[new c.ab(0,f/o).toLngLat().lat,new c.ab(0,(f+1)/o).toLngLat().lat]}const _d=(b,t,o=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:o,u_opacity:b.paint.get("color-relief-opacity")}),ds=(b,t,o,f)=>{const y=b.transform;return{u_translation:al(b,t,o),u_ratio:f/c.aO(t,1,y.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},vd=(b,t,o,f,y)=>c.e(ds(b,t,o,f),{u_image:0,u_image_height:y}),$o=(b,t,o,f,y)=>{const M=b.transform,C=Ua(t,M);return{u_translation:al(b,t,o),u_texsize:t.imageAtlasTexture.size,u_ratio:f/c.aO(t,1,M.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[C,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]]}},ra=(b,t,o,f,y)=>{const M=Ua(t,b.transform);return c.e(ds(b,t,o,f),{u_tileratio:M,u_crossfade_from:y.fromScale,u_crossfade_to:y.toScale,u_image:0,u_mix:y.t,u_lineatlas_width:b.lineAtlas.width,u_lineatlas_height:b.lineAtlas.height})},zs=(b,t,o,f,y,M)=>{const C=Ua(t,b.transform);return c.e(ds(b,t,o,f),{u_image:0,u_image_height:M,u_tileratio:C,u_crossfade_from:y.fromScale,u_crossfade_to:y.toScale,u_image_dash:1,u_mix:y.t,u_lineatlas_width:b.lineAtlas.width,u_lineatlas_height:b.lineAtlas.height})};function Ua(b,t){return 1/c.aO(b,1,t.tileZoom)}function al(b,t,o){return c.aP(b.transform,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const bu=(b,t,o,f,y)=>{return{u_tl_parent:b,u_scale_parent:t,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(C=f.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(M=f.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:Dl(f.paint.get("raster-hue-rotate")),u_coords_top:[y[0].x,y[0].y,y[1].x,y[1].y],u_coords_bottom:[y[3].x,y[3].y,y[2].x,y[2].y]};var M,C};function Dl(b){b*=Math.PI/180;const t=Math.sin(b),o=Math.cos(b);return[(2*o+1)/3,(-Math.sqrt(3)*t-o+1)/3,(Math.sqrt(3)*t-o+1)/3]}const fs=(b,t,o,f,y,M,C,D,O,U,G,X,$)=>{const ee=C.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:ee.cameraToCenterDistance,u_pitch:ee.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:ee.width/ee.height,u_fade_change:C.options.fadeDuration?C.symbolFadeChange:1,u_label_plane_matrix:D,u_coord_matrix:O,u_is_text:+G,u_pitch_with_map:+f,u_is_along_line:y,u_is_variable_anchor:M,u_texsize:X,u_texture:0,u_translation:U,u_pitched_scale:$}},Rl=(b,t,o,f,y,M,C,D,O,U,G,X,$,ee)=>{const re=C.transform;return c.e(fs(b,t,o,f,y,M,C,D,O,U,G,X,ee),{u_gamma_scale:f?Math.cos(re.pitch*Math.PI/180)*re.cameraToCenterDistance:1,u_device_pixel_ratio:C.pixelRatio,u_is_halo:1})},Va=(b,t,o,f,y,M,C,D,O,U,G,X,$)=>c.e(Rl(b,t,o,f,y,M,C,D,O,U,!0,G,0,$),{u_texsize_icon:X,u_texture_icon:1}),xu=(b,t)=>({u_opacity:b,u_color:t}),Qu=(b,t,o,f,y)=>c.e((function(M,C,D,O){const U=D.imageManager.getPattern(M.from.toString()),G=D.imageManager.getPattern(M.to.toString()),{width:X,height:$}=D.imageManager.getPixelSize(),ee=Math.pow(2,O.tileID.overscaledZ),re=O.tileSize*Math.pow(2,D.transform.tileZoom)/ee,me=re*(O.tileID.canonical.x+O.tileID.wrap*ee),_e=re*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:U.tl,u_pattern_br_a:U.br,u_pattern_tl_b:G.tl,u_pattern_br_b:G.br,u_texsize:[X,$],u_mix:C.t,u_pattern_size_a:U.displaySize,u_pattern_size_b:G.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/c.aO(O,1,D.transform.tileZoom),u_pixel_coord_upper:[me>>16,_e>>16],u_pixel_coord_lower:[65535&me,65535&_e]}})(o,y,t,f),{u_opacity:b}),kl=(b,t)=>{},bd={fillExtrusion:(b,t)=>({u_lightpos:new c.c3(b,t.u_lightpos),u_lightpos_globe:new c.c3(b,t.u_lightpos_globe),u_lightintensity:new c.br(b,t.u_lightintensity),u_lightcolor:new c.c3(b,t.u_lightcolor),u_vertical_gradient:new c.br(b,t.u_vertical_gradient),u_opacity:new c.br(b,t.u_opacity),u_fill_translate:new c.c4(b,t.u_fill_translate)}),fillExtrusionPattern:(b,t)=>({u_lightpos:new c.c3(b,t.u_lightpos),u_lightpos_globe:new c.c3(b,t.u_lightpos_globe),u_lightintensity:new c.br(b,t.u_lightintensity),u_lightcolor:new c.c3(b,t.u_lightcolor),u_vertical_gradient:new c.br(b,t.u_vertical_gradient),u_height_factor:new c.br(b,t.u_height_factor),u_opacity:new c.br(b,t.u_opacity),u_fill_translate:new c.c4(b,t.u_fill_translate),u_image:new c.b$(b,t.u_image),u_texsize:new c.c4(b,t.u_texsize),u_pixel_coord_upper:new c.c4(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.c4(b,t.u_pixel_coord_lower),u_scale:new c.c3(b,t.u_scale),u_fade:new c.br(b,t.u_fade)}),fill:(b,t)=>({u_fill_translate:new c.c4(b,t.u_fill_translate)}),fillPattern:(b,t)=>({u_image:new c.b$(b,t.u_image),u_texsize:new c.c4(b,t.u_texsize),u_pixel_coord_upper:new c.c4(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.c4(b,t.u_pixel_coord_lower),u_scale:new c.c3(b,t.u_scale),u_fade:new c.br(b,t.u_fade),u_fill_translate:new c.c4(b,t.u_fill_translate)}),fillOutline:(b,t)=>({u_world:new c.c4(b,t.u_world),u_fill_translate:new c.c4(b,t.u_fill_translate)}),fillOutlinePattern:(b,t)=>({u_world:new c.c4(b,t.u_world),u_image:new c.b$(b,t.u_image),u_texsize:new c.c4(b,t.u_texsize),u_pixel_coord_upper:new c.c4(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.c4(b,t.u_pixel_coord_lower),u_scale:new c.c3(b,t.u_scale),u_fade:new c.br(b,t.u_fade),u_fill_translate:new c.c4(b,t.u_fill_translate)}),circle:(b,t)=>({u_camera_to_center_distance:new c.br(b,t.u_camera_to_center_distance),u_scale_with_map:new c.b$(b,t.u_scale_with_map),u_pitch_with_map:new c.b$(b,t.u_pitch_with_map),u_extrude_scale:new c.c4(b,t.u_extrude_scale),u_device_pixel_ratio:new c.br(b,t.u_device_pixel_ratio),u_globe_extrude_scale:new c.br(b,t.u_globe_extrude_scale),u_translate:new c.c4(b,t.u_translate)}),collisionBox:(b,t)=>({u_pixel_extrude_scale:new c.c4(b,t.u_pixel_extrude_scale)}),collisionCircle:(b,t)=>({u_viewport_size:new c.c4(b,t.u_viewport_size)}),debug:(b,t)=>({u_color:new c.c0(b,t.u_color),u_overlay:new c.b$(b,t.u_overlay),u_overlay_scale:new c.br(b,t.u_overlay_scale)}),depth:kl,clippingMask:kl,heatmap:(b,t)=>({u_extrude_scale:new c.br(b,t.u_extrude_scale),u_intensity:new c.br(b,t.u_intensity),u_globe_extrude_scale:new c.br(b,t.u_globe_extrude_scale)}),heatmapTexture:(b,t)=>({u_matrix:new c.c1(b,t.u_matrix),u_world:new c.c4(b,t.u_world),u_image:new c.b$(b,t.u_image),u_color_ramp:new c.b$(b,t.u_color_ramp),u_opacity:new c.br(b,t.u_opacity)}),hillshade:(b,t)=>({u_image:new c.b$(b,t.u_image),u_latrange:new c.c4(b,t.u_latrange),u_exaggeration:new c.br(b,t.u_exaggeration),u_altitudes:new c.ca(b,t.u_altitudes),u_azimuths:new c.ca(b,t.u_azimuths),u_accent:new c.c0(b,t.u_accent),u_method:new c.b$(b,t.u_method),u_shadows:new c.c9(b,t.u_shadows),u_highlights:new c.c9(b,t.u_highlights)}),hillshadePrepare:(b,t)=>({u_matrix:new c.c1(b,t.u_matrix),u_image:new c.b$(b,t.u_image),u_dimension:new c.c4(b,t.u_dimension),u_zoom:new c.br(b,t.u_zoom),u_unpack:new c.c2(b,t.u_unpack)}),colorRelief:(b,t)=>({u_image:new c.b$(b,t.u_image),u_unpack:new c.c2(b,t.u_unpack),u_dimension:new c.c4(b,t.u_dimension),u_elevation_stops:new c.b$(b,t.u_elevation_stops),u_color_stops:new c.b$(b,t.u_color_stops),u_color_ramp_size:new c.b$(b,t.u_color_ramp_size),u_opacity:new c.br(b,t.u_opacity)}),line:(b,t)=>({u_translation:new c.c4(b,t.u_translation),u_ratio:new c.br(b,t.u_ratio),u_device_pixel_ratio:new c.br(b,t.u_device_pixel_ratio),u_units_to_pixels:new c.c4(b,t.u_units_to_pixels)}),lineGradient:(b,t)=>({u_translation:new c.c4(b,t.u_translation),u_ratio:new c.br(b,t.u_ratio),u_device_pixel_ratio:new c.br(b,t.u_device_pixel_ratio),u_units_to_pixels:new c.c4(b,t.u_units_to_pixels),u_image:new c.b$(b,t.u_image),u_image_height:new c.br(b,t.u_image_height)}),linePattern:(b,t)=>({u_translation:new c.c4(b,t.u_translation),u_texsize:new c.c4(b,t.u_texsize),u_ratio:new c.br(b,t.u_ratio),u_device_pixel_ratio:new c.br(b,t.u_device_pixel_ratio),u_image:new c.b$(b,t.u_image),u_units_to_pixels:new c.c4(b,t.u_units_to_pixels),u_scale:new c.c3(b,t.u_scale),u_fade:new c.br(b,t.u_fade)}),lineSDF:(b,t)=>({u_translation:new c.c4(b,t.u_translation),u_ratio:new c.br(b,t.u_ratio),u_device_pixel_ratio:new c.br(b,t.u_device_pixel_ratio),u_units_to_pixels:new c.c4(b,t.u_units_to_pixels),u_image:new c.b$(b,t.u_image),u_mix:new c.br(b,t.u_mix),u_tileratio:new c.br(b,t.u_tileratio),u_crossfade_from:new c.br(b,t.u_crossfade_from),u_crossfade_to:new c.br(b,t.u_crossfade_to),u_lineatlas_width:new c.br(b,t.u_lineatlas_width),u_lineatlas_height:new c.br(b,t.u_lineatlas_height)}),lineGradientSDF:(b,t)=>({u_translation:new c.c4(b,t.u_translation),u_ratio:new c.br(b,t.u_ratio),u_device_pixel_ratio:new c.br(b,t.u_device_pixel_ratio),u_units_to_pixels:new c.c4(b,t.u_units_to_pixels),u_image:new c.b$(b,t.u_image),u_image_height:new c.br(b,t.u_image_height),u_tileratio:new c.br(b,t.u_tileratio),u_crossfade_from:new c.br(b,t.u_crossfade_from),u_crossfade_to:new c.br(b,t.u_crossfade_to),u_image_dash:new c.b$(b,t.u_image_dash),u_mix:new c.br(b,t.u_mix),u_lineatlas_width:new c.br(b,t.u_lineatlas_width),u_lineatlas_height:new c.br(b,t.u_lineatlas_height)}),raster:(b,t)=>({u_tl_parent:new c.c4(b,t.u_tl_parent),u_scale_parent:new c.br(b,t.u_scale_parent),u_buffer_scale:new c.br(b,t.u_buffer_scale),u_fade_t:new c.br(b,t.u_fade_t),u_opacity:new c.br(b,t.u_opacity),u_image0:new c.b$(b,t.u_image0),u_image1:new c.b$(b,t.u_image1),u_brightness_low:new c.br(b,t.u_brightness_low),u_brightness_high:new c.br(b,t.u_brightness_high),u_saturation_factor:new c.br(b,t.u_saturation_factor),u_contrast_factor:new c.br(b,t.u_contrast_factor),u_spin_weights:new c.c3(b,t.u_spin_weights),u_coords_top:new c.c2(b,t.u_coords_top),u_coords_bottom:new c.c2(b,t.u_coords_bottom)}),symbolIcon:(b,t)=>({u_is_size_zoom_constant:new c.b$(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.b$(b,t.u_is_size_feature_constant),u_size_t:new c.br(b,t.u_size_t),u_size:new c.br(b,t.u_size),u_camera_to_center_distance:new c.br(b,t.u_camera_to_center_distance),u_pitch:new c.br(b,t.u_pitch),u_rotate_symbol:new c.b$(b,t.u_rotate_symbol),u_aspect_ratio:new c.br(b,t.u_aspect_ratio),u_fade_change:new c.br(b,t.u_fade_change),u_label_plane_matrix:new c.c1(b,t.u_label_plane_matrix),u_coord_matrix:new c.c1(b,t.u_coord_matrix),u_is_text:new c.b$(b,t.u_is_text),u_pitch_with_map:new c.b$(b,t.u_pitch_with_map),u_is_along_line:new c.b$(b,t.u_is_along_line),u_is_variable_anchor:new c.b$(b,t.u_is_variable_anchor),u_texsize:new c.c4(b,t.u_texsize),u_texture:new c.b$(b,t.u_texture),u_translation:new c.c4(b,t.u_translation),u_pitched_scale:new c.br(b,t.u_pitched_scale)}),symbolSDF:(b,t)=>({u_is_size_zoom_constant:new c.b$(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.b$(b,t.u_is_size_feature_constant),u_size_t:new c.br(b,t.u_size_t),u_size:new c.br(b,t.u_size),u_camera_to_center_distance:new c.br(b,t.u_camera_to_center_distance),u_pitch:new c.br(b,t.u_pitch),u_rotate_symbol:new c.b$(b,t.u_rotate_symbol),u_aspect_ratio:new c.br(b,t.u_aspect_ratio),u_fade_change:new c.br(b,t.u_fade_change),u_label_plane_matrix:new c.c1(b,t.u_label_plane_matrix),u_coord_matrix:new c.c1(b,t.u_coord_matrix),u_is_text:new c.b$(b,t.u_is_text),u_pitch_with_map:new c.b$(b,t.u_pitch_with_map),u_is_along_line:new c.b$(b,t.u_is_along_line),u_is_variable_anchor:new c.b$(b,t.u_is_variable_anchor),u_texsize:new c.c4(b,t.u_texsize),u_texture:new c.b$(b,t.u_texture),u_gamma_scale:new c.br(b,t.u_gamma_scale),u_device_pixel_ratio:new c.br(b,t.u_device_pixel_ratio),u_is_halo:new c.b$(b,t.u_is_halo),u_translation:new c.c4(b,t.u_translation),u_pitched_scale:new c.br(b,t.u_pitched_scale)}),symbolTextAndIcon:(b,t)=>({u_is_size_zoom_constant:new c.b$(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.b$(b,t.u_is_size_feature_constant),u_size_t:new c.br(b,t.u_size_t),u_size:new c.br(b,t.u_size),u_camera_to_center_distance:new c.br(b,t.u_camera_to_center_distance),u_pitch:new c.br(b,t.u_pitch),u_rotate_symbol:new c.b$(b,t.u_rotate_symbol),u_aspect_ratio:new c.br(b,t.u_aspect_ratio),u_fade_change:new c.br(b,t.u_fade_change),u_label_plane_matrix:new c.c1(b,t.u_label_plane_matrix),u_coord_matrix:new c.c1(b,t.u_coord_matrix),u_is_text:new c.b$(b,t.u_is_text),u_pitch_with_map:new c.b$(b,t.u_pitch_with_map),u_is_along_line:new c.b$(b,t.u_is_along_line),u_is_variable_anchor:new c.b$(b,t.u_is_variable_anchor),u_texsize:new c.c4(b,t.u_texsize),u_texsize_icon:new c.c4(b,t.u_texsize_icon),u_texture:new c.b$(b,t.u_texture),u_texture_icon:new c.b$(b,t.u_texture_icon),u_gamma_scale:new c.br(b,t.u_gamma_scale),u_device_pixel_ratio:new c.br(b,t.u_device_pixel_ratio),u_is_halo:new c.b$(b,t.u_is_halo),u_translation:new c.c4(b,t.u_translation),u_pitched_scale:new c.br(b,t.u_pitched_scale)}),background:(b,t)=>({u_opacity:new c.br(b,t.u_opacity),u_color:new c.c0(b,t.u_color)}),backgroundPattern:(b,t)=>({u_opacity:new c.br(b,t.u_opacity),u_image:new c.b$(b,t.u_image),u_pattern_tl_a:new c.c4(b,t.u_pattern_tl_a),u_pattern_br_a:new c.c4(b,t.u_pattern_br_a),u_pattern_tl_b:new c.c4(b,t.u_pattern_tl_b),u_pattern_br_b:new c.c4(b,t.u_pattern_br_b),u_texsize:new c.c4(b,t.u_texsize),u_mix:new c.br(b,t.u_mix),u_pattern_size_a:new c.c4(b,t.u_pattern_size_a),u_pattern_size_b:new c.c4(b,t.u_pattern_size_b),u_scale_a:new c.br(b,t.u_scale_a),u_scale_b:new c.br(b,t.u_scale_b),u_pixel_coord_upper:new c.c4(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.c4(b,t.u_pixel_coord_lower),u_tile_units_to_pixels:new c.br(b,t.u_tile_units_to_pixels)}),terrain:(b,t)=>({u_texture:new c.b$(b,t.u_texture),u_ele_delta:new c.br(b,t.u_ele_delta),u_fog_matrix:new c.c1(b,t.u_fog_matrix),u_fog_color:new c.c0(b,t.u_fog_color),u_fog_ground_blend:new c.br(b,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.br(b,t.u_fog_ground_blend_opacity),u_horizon_color:new c.c0(b,t.u_horizon_color),u_horizon_fog_blend:new c.br(b,t.u_horizon_fog_blend),u_is_globe_mode:new c.br(b,t.u_is_globe_mode)}),terrainDepth:(b,t)=>({u_ele_delta:new c.br(b,t.u_ele_delta)}),terrainCoords:(b,t)=>({u_texture:new c.b$(b,t.u_texture),u_terrain_coords_id:new c.br(b,t.u_terrain_coords_id),u_ele_delta:new c.br(b,t.u_ele_delta)}),projectionErrorMeasurement:(b,t)=>({u_input:new c.br(b,t.u_input),u_output_expected:new c.br(b,t.u_output_expected)}),atmosphere:(b,t)=>({u_sun_pos:new c.c3(b,t.u_sun_pos),u_atmosphere_blend:new c.br(b,t.u_atmosphere_blend),u_globe_position:new c.c3(b,t.u_globe_position),u_globe_radius:new c.br(b,t.u_globe_radius),u_inv_proj_matrix:new c.c1(b,t.u_inv_proj_matrix)}),sky:(b,t)=>({u_sky_color:new c.c0(b,t.u_sky_color),u_horizon_color:new c.c0(b,t.u_horizon_color),u_horizon:new c.c4(b,t.u_horizon),u_horizon_normal:new c.c4(b,t.u_horizon_normal),u_sky_horizon_blend:new c.br(b,t.u_sky_horizon_blend),u_sky_blend:new c.br(b,t.u_sky_blend)})};class ol{constructor(t,o,f){this.context=t;const y=t.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ol={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class $c{constructor(t,o,f,y){this.length=o.length,this.attributes=f,this.itemSize=o.bytesPerElement,this.dynamicDraw=y,this.context=t;const M=t.gl;this.buffer=M.createBuffer(),t.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,o){for(let f=0;f<this.attributes.length;f++){const y=o.attributes[this.attributes[f].name];y!==void 0&&t.enableVertexAttribArray(y)}}setVertexAttribPointers(t,o,f){for(let y=0;y<this.attributes.length;y++){const M=this.attributes[y],C=o.attributes[M.name];C!==void 0&&t.vertexAttribPointer(C,M.components,t[Ol[M.type]],!1,this.itemSize,M.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Yi{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Cr extends Yi{getDefault(){return c.bq.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class sl extends Yi{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class ec extends Yi{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Bl extends Yi{getDefault(){return[!0,!0,!0,!0]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Fl extends Yi{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class wu extends Yi{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Tu extends Yi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const o=this.current;(t.func!==o.func||t.ref!==o.ref||t.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class aa extends Yi{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Dh extends Yi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=t,this.dirty=!1}}class Is extends Yi{getDefault(){return[0,1]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ga extends Yi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=t,this.dirty=!1}}class Ho extends Yi{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Aa extends Yi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.BLEND):o.disable(o.BLEND),this.current=t,this.dirty=!1}}class oa extends Yi{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class ll extends Yi{getDefault(){return c.bq.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class ul extends Yi{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Ls extends Yi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=t,this.dirty=!1}}class cl extends Yi{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Ca extends Yi{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Nl extends Yi{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class jl extends Yi{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Si extends Yi{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Hc extends Yi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Za extends Yi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class tc extends Yi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class qa extends Yi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Rh extends Yi{getDefault(){return null}set(t){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ic extends Yi{getDefault(){return null}set(t){var o;if(t===this.current&&!this.dirty)return;const f=this.gl;oo(f)?f.bindVertexArray(t):(o=f.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class hl extends Yi{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Xc extends Yi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class nc extends Yi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class dl extends Yi{constructor(t,o){super(t),this.context=t,this.parent=o}getDefault(){return null}}class d extends dl{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class x extends dl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class z extends dl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const j="Framebuffer is not complete";class Y{constructor(t,o,f,y,M){this.context=t,this.width=o,this.height=f;const C=t.gl,D=this.framebuffer=C.createFramebuffer();if(this.colorAttachment=new d(t,D),y)this.depthAttachment=M?new z(t,D):new x(t,D);else if(M)throw new Error("Stencil cannot be set without depth");if(C.checkFramebufferStatus(C.FRAMEBUFFER)!==C.FRAMEBUFFER_COMPLETE)throw new Error(j)}destroy(){const t=this.context.gl,o=this.colorAttachment.get();if(o&&t.deleteTexture(o),this.depthAttachment){const f=this.depthAttachment.get();f&&t.deleteRenderbuffer(f)}t.deleteFramebuffer(this.framebuffer)}}class se{constructor(t){var o,f;if(this.gl=t,this.clearColor=new Cr(this),this.clearDepth=new sl(this),this.clearStencil=new ec(this),this.colorMask=new Bl(this),this.depthMask=new Fl(this),this.stencilMask=new wu(this),this.stencilFunc=new Tu(this),this.stencilOp=new aa(this),this.stencilTest=new Dh(this),this.depthRange=new Is(this),this.depthTest=new Ga(this),this.depthFunc=new Ho(this),this.blend=new Aa(this),this.blendFunc=new oa(this),this.blendColor=new ll(this),this.blendEquation=new ul(this),this.cullFace=new Ls(this),this.cullFaceSide=new cl(this),this.frontFace=new Ca(this),this.program=new Nl(this),this.activeTexture=new jl(this),this.viewport=new Si(this),this.bindFramebuffer=new Hc(this),this.bindRenderbuffer=new Za(this),this.bindTexture=new tc(this),this.bindVertexBuffer=new qa(this),this.bindElementBuffer=new Rh(this),this.bindVertexArray=new ic(this),this.pixelStoreUnpack=new hl(this),this.pixelStoreUnpackPremultiplyAlpha=new Xc(this),this.pixelStoreUnpackFlipY=new nc(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),oo(t)){this.HALF_FLOAT=t.HALF_FLOAT;const y=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=t.RGBA16F)!==null&&o!==void 0?o:y?.RGBA16F_EXT,this.RGB16F=(f=t.RGB16F)!==null&&f!==void 0?f:y?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const y=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=y?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,o){return new ol(this,t,o)}createVertexBuffer(t,o,f){return new $c(this,t,o,f)}createRenderbuffer(t,o,f){const y=this.gl,M=y.createRenderbuffer();return this.bindRenderbuffer.set(M),y.renderbufferStorage(y.RENDERBUFFER,t,o,f),this.bindRenderbuffer.set(null),M}createFramebuffer(t,o,f,y){return new Y(this,t,o,f,y)}clear({color:t,depth:o,stencil:f}){const y=this.gl;let M=0;t&&(M|=y.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(M|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),f!==void 0&&(M|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),y.clear(M)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){c.bS(t.blendFunction,pn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return oo(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var o;return oo(this.gl)?this.gl.deleteVertexArray(t):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let Ae;function Ue(b,t,o,f,y){const M=b.context,C=b.transform,D=M.gl,O=b.useProgram("collisionBox"),U=[];let G=0,X=0;for(let ye=0;ye<f.length;ye++){const ve=f[ye],Se=t.getTile(ve).getBucket(o);if(!Se)continue;const be=y?Se.textCollisionBox:Se.iconCollisionBox,Ce=Se.collisionCircleArray;Ce.length>0&&(U.push({circleArray:Ce,circleOffset:X,coord:ve}),G+=Ce.length/4,X=G),be&&O.draw(M,D.LINES,vi.disabled,Di.disabled,b.colorModeForRenderPass(),Mi.disabled,Zo(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(ve),C.getProjectionData({overscaledTileID:ve,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),o.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,null,b.transform.zoom,null,null,be.collisionVertexBuffer)}if(!y||!U.length)return;const $=b.useProgram("collisionCircle"),ee=new c.cb;ee.resize(4*G),ee._trim();let re=0;for(const ye of U)for(let ve=0;ve<ye.circleArray.length/4;ve++){const Se=4*ve,be=ye.circleArray[Se+0],Ce=ye.circleArray[Se+1],Ie=ye.circleArray[Se+2],we=ye.circleArray[Se+3];ee.emplace(re++,be,Ce,Ie,we,0),ee.emplace(re++,be,Ce,Ie,we,1),ee.emplace(re++,be,Ce,Ie,we,2),ee.emplace(re++,be,Ce,Ie,we,3)}(!Ae||Ae.length<2*G)&&(Ae=(function(ye){const ve=2*ye,Se=new c.cd;Se.resize(ve),Se._trim();for(let be=0;be<ve;be++){const Ce=6*be;Se.uint16[Ce+0]=4*be+0,Se.uint16[Ce+1]=4*be+1,Se.uint16[Ce+2]=4*be+2,Se.uint16[Ce+3]=4*be+2,Se.uint16[Ce+4]=4*be+3,Se.uint16[Ce+5]=4*be+0}return Se})(G));const me=M.createIndexBuffer(Ae,!0),_e=M.createVertexBuffer(ee,c.cc.members,!0);for(const ye of U){const ve=Ih(b.transform);$.draw(M,D.TRIANGLES,vi.disabled,Di.disabled,b.colorModeForRenderPass(),Mi.disabled,ve,b.style.map.terrain&&b.style.map.terrain.getTerrainData(ye.coord),null,o.id,_e,me,c.aY.simpleSegment(0,2*ye.circleOffset,ye.circleArray.length,ye.circleArray.length/2),null,b.transform.zoom,null,null,null)}_e.destroy(),me.destroy()}const ot=c.as(new Float32Array(16));function Tt(b,t,o,f,y,M){const{horizontalAlign:C,verticalAlign:D}=c.aT(b);return new c.P((-(C-.5)*t/y+f[0])*M,(-(D-.5)*o/y+f[1])*M)}function jt(b,t,o,f,y,M){const C=t.tileAnchorPoint.add(new c.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let D=f.mult(M);o||(D=D.rotate(-y));const O=C.add(D);return _i(O.x,O.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(o){const D=Vi(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(b),O=Math.atan(D.y/D.x)+(D.x<0?Math.PI:0);return b.add(f.rotate(O))}return b.add(f)}function ui(b,t,o,f,y,M,C,D,O,U,G,X){const $=b.text.placedSymbolArray,ee=b.text.dynamicLayoutVertexArray,re=b.icon.dynamicLayoutVertexArray,me={};ee.clear();for(let _e=0;_e<$.length;_e++){const ye=$.get(_e),ve=ye.hidden||!ye.crossTileID||b.allowVerticalPlacement&&!ye.placedOrientation?null:f[ye.crossTileID];if(ve){const Se=new c.P(ye.anchorX,ye.anchorY),be={getElevation:X,width:y.width,height:y.height,pitchedLabelPlaneMatrix:M,pitchWithMap:o,transform:y,tileAnchorPoint:Se,translation:U,unwrappedTileID:G},Ce=o?ls(Se.x,Se.y,be):Vi(Se.x,Se.y,be),Ie=Tl(y.cameraToCenterDistance,Ce.signedDistanceFromCamera);let we=c.aB(b.textSizeData,D,ye)*Ie/c.aN;o&&(we*=b.tilePixelRatio/C);const{width:ke,height:Ke,anchor:He,textOffset:Je,textBoxScale:tt}=ve,bt=Tt(He,ke,Ke,Je,tt,we),Ct=y.getPitchedTextCorrection(Se.x+U[0],Se.y+U[1],G),_t=jt(Ce.point,be,t,bt,-y.bearingInRadians,Ct),Yt=b.allowVerticalPlacement&&ye.placedOrientation===c.aA.vertical?Math.PI/2:0;for(let wi=0;wi<ye.numGlyphs;wi++)c.aH(ee,_t,Yt);O&&ye.associatedIconIndex>=0&&(me[ye.associatedIconIndex]={shiftedAnchor:_t,angle:Yt})}else on(ye.numGlyphs,ee)}if(O){re.clear();const _e=b.icon.placedSymbolArray;for(let ye=0;ye<_e.length;ye++){const ve=_e.get(ye);if(ve.hidden)on(ve.numGlyphs,re);else{const Se=me[ye];if(Se)for(let be=0;be<ve.numGlyphs;be++)c.aH(re,Se.shiftedAnchor,Se.angle);else on(ve.numGlyphs,re)}}b.icon.dynamicLayoutVertexBuffer.updateData(re)}b.text.dynamicLayoutVertexBuffer.updateData(ee)}function zi(b,t,o){return o.iconsInText&&t?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function mr(b,t,o,f,y,M,C,D,O,U,G,X,$){const ee=b.context,re=ee.gl,me=b.transform,_e=D==="map",ye=O==="map",ve=D!=="viewport"&&o.layout.get("symbol-placement")!=="point",Se=_e&&!ye&&!ve,be=!o.layout.get("symbol-sort-key").isConstant();let Ce=!1;const Ie=b.getDepthModeForSublayer(0,vi.ReadOnly),we=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ke=[],Ke=me.getCircleRadiusCorrection();for(const He of f){const Je=t.getTile(He),tt=Je.getBucket(o);if(!tt)continue;const bt=y?tt.text:tt.icon;if(!bt||!bt.segments.get().length||!bt.hasVisibleVertices)continue;const Ct=bt.programConfigurations.get(o.id),_t=y||tt.sdfIcons,Yt=y?tt.textSizeData:tt.iconSizeData,wi=ye||me.pitch!==0,hn=b.useProgram(zi(_t,y,tt),Ct),In=c.az(Yt,me.zoom),gn=b.style.map.terrain&&b.style.map.terrain.getTerrainData(He);let qn,xn,Or,jn,Br=[0,0],lr=null;if(y)xn=Je.glyphAtlasTexture,Or=re.LINEAR,qn=Je.glyphAtlasTexture.size,tt.iconsInText&&(Br=Je.imageAtlasTexture.size,lr=Je.imageAtlasTexture,jn=wi||b.options.rotating||b.options.zooming||Yt.kind==="composite"||Yt.kind==="camera"?re.LINEAR:re.NEAREST);else{const ur=o.layout.get("icon-size").constantOr(0)!==1||tt.iconsNeedLinear;xn=Je.imageAtlasTexture,Or=_t||b.options.rotating||b.options.zooming||ur||wi?re.LINEAR:re.NEAREST,qn=Je.imageAtlasTexture.size}const gr=c.aO(Je,1,b.transform.zoom),pa=Ra(_e,b.transform,gr),za=c.N();c.aC(za,pa);const Ns=Bc(ye,_e,b.transform,gr),Kl=c.aP(me,Je,M,C),cc=me.getProjectionData({overscaledTileID:He,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),zd=we&&tt.hasTextData(),hc=o.layout.get("icon-text-fit")!=="none"&&zd&&tt.hasIconData();if(ve){const ur=b.style.map.terrain?(mo,Qn)=>b.style.map.terrain.getElevation(He,mo,Qn):null,Nr=o.layout.get("text-rotation-alignment")==="map";Ts(tt,b,y,pa,za,ye,U,Nr,He.toUnwrapped(),me.width,me.height,Kl,ur)}const Ao=y&&we||hc,Fr=ve||Ao?ot:ye?pa:b.transform.clipSpaceToPixelsMatrix,sa=_t&&o.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ma;ma=_t?tt.iconsInText?Va(Yt.kind,In,Se,ye,ve,Ao,b,Fr,Ns,Kl,qn,Br,Ke):Rl(Yt.kind,In,Se,ye,ve,Ao,b,Fr,Ns,Kl,y,qn,0,Ke):fs(Yt.kind,In,Se,ye,ve,Ao,b,Fr,Ns,Kl,y,qn,Ke);const Ko={program:hn,buffers:bt,uniformValues:ma,projectionData:cc,atlasTexture:xn,atlasTextureIcon:lr,atlasInterpolation:Or,atlasInterpolationIcon:jn,isSDF:_t,hasHalo:sa};if(be&&tt.canOverlap){Ce=!0;const ur=bt.segments.get();for(const Nr of ur)ke.push({segments:new c.aY([Nr]),sortKey:Nr.sortKey,state:Ko,terrainData:gn})}else ke.push({segments:bt.segments,sortKey:0,state:Ko,terrainData:gn})}Ce&&ke.sort(((He,Je)=>He.sortKey-Je.sortKey));for(const He of ke){const Je=He.state;if(ee.activeTexture.set(re.TEXTURE0),Je.atlasTexture.bind(Je.atlasInterpolation,re.CLAMP_TO_EDGE),Je.atlasTextureIcon&&(ee.activeTexture.set(re.TEXTURE1),Je.atlasTextureIcon&&Je.atlasTextureIcon.bind(Je.atlasInterpolationIcon,re.CLAMP_TO_EDGE)),Je.isSDF){const tt=Je.uniformValues;Je.hasHalo&&(tt.u_is_halo=1,Kn(Je.buffers,He.segments,o,b,Je.program,Ie,G,X,tt,Je.projectionData,He.terrainData)),tt.u_is_halo=0}Kn(Je.buffers,He.segments,o,b,Je.program,Ie,G,X,Je.uniformValues,Je.projectionData,He.terrainData)}}function Kn(b,t,o,f,y,M,C,D,O,U,G){const X=f.context;y.draw(X,X.gl.TRIANGLES,M,C,D,Mi.backCCW,O,G,U,o.id,b.layoutVertexBuffer,b.indexBuffer,t,o.paint,f.transform.zoom,b.programConfigurations.get(o.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function $a(b,t,o,f,y){const M=b.context,C=M.gl,D=Di.disabled,O=new pn([C.ONE,C.ONE],c.bq.transparent,[!0,!0,!0,!0]),U=t.getBucket(o);if(!U)return;const G=f.key;let X=o.heatmapFbos.get(G);X||(X=Wi(M,t.tileSize,t.tileSize),o.heatmapFbos.set(G,X)),M.bindFramebuffer.set(X.framebuffer),M.viewport.set([0,0,t.tileSize,t.tileSize]),M.clear({color:c.bq.transparent});const $=U.programConfigurations.get(o.id),ee=b.useProgram("heatmap",$,!y),re=b.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),me=b.style.map.terrain.getTerrainData(f);ee.draw(M,C.TRIANGLES,vi.disabled,D,O,Mi.disabled,qo(t,b.transform.zoom,o.paint.get("heatmap-intensity"),1),me,re,o.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,o.paint,b.transform.zoom,$)}function cn(b,t,o,f,y){const M=b.context,C=M.gl,D=b.transform;M.setColorMode(b.colorModeForRenderPass());const O=Ri(M,t),U=o.key,G=t.heatmapFbos.get(U);if(!G)return;M.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,G.colorAttachment.get()),M.activeTexture.set(C.TEXTURE1),O.bind(C.LINEAR,C.CLAMP_TO_EDGE);const X=D.getProjectionData({overscaledTileID:o,applyTerrainMatrix:y,applyGlobeMatrix:!f});b.useProgram("heatmapTexture").draw(M,C.TRIANGLES,vi.disabled,Di.disabled,b.colorModeForRenderPass(),Mi.disabled,Lh(b,t,0,1),null,X,t.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,t.paint,D.zoom),G.destroy(),t.heatmapFbos.delete(U)}function Wi(b,t,o){var f,y;const M=b.gl,C=M.createTexture();M.bindTexture(M.TEXTURE_2D,C),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,M.LINEAR),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,M.LINEAR);const D=(f=b.HALF_FLOAT)!==null&&f!==void 0?f:M.UNSIGNED_BYTE,O=(y=b.RGBA16F)!==null&&y!==void 0?y:M.RGBA;M.texImage2D(M.TEXTURE_2D,0,O,t,o,0,M.RGBA,D,null);const U=b.createFramebuffer(t,o,!1,!1);return U.colorAttachment.set(C),U}function Ri(b,t){return t.colorRampTexture||(t.colorRampTexture=new c.T(b,t.colorRamp,b.gl.RGBA)),t.colorRampTexture}function Ds(b,t,o,f,y,M,C,D){let O=256;if(y.stepInterpolant){const U=t.getSource().maxzoom,G=C.canonical.z===U?Math.ceil(1<<b.transform.maxZoom-C.canonical.z):1;O=c.ao(c.cf(M.maxLineLength/c.a5*1024*G),256,o.maxTextureSize)}return D.gradient=c.cg({expression:y.gradientExpression(),evaluationKey:"lineProgress",resolution:O,image:D.gradient||void 0,clips:M.lineClipsArray}),D.texture?D.texture.update(D.gradient):D.texture=new c.T(o,D.gradient,f.RGBA),D.version=y.gradientVersion,D.texture}function so(b,t,o,f,y){b.activeTexture.set(t.TEXTURE0),o.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),f.updatePaintBuffers(y)}function Nn(b,t,o,f,y,M){(y||b.lineAtlas.dirty)&&(t.activeTexture.set(o.TEXTURE0),b.lineAtlas.bind(t)),f.updatePaintBuffers(M)}function Ha(b,t,o,f,y,M,C){const D=M.gradients[y.id];let O=D.texture;y.gradientVersion!==D.version&&(O=Ds(b,t,o,f,y,M,C,D)),o.activeTexture.set(f.TEXTURE0),O.bind(y.stepInterpolant?f.NEAREST:f.LINEAR,f.CLAMP_TO_EDGE)}function Xa(b,t,o,f,y,M,C,D,O){const U=M.gradients[y.id];let G=U.texture;y.gradientVersion!==U.version&&(G=Ds(b,t,o,f,y,M,C,U)),o.activeTexture.set(f.TEXTURE0),G.bind(y.stepInterpolant?f.NEAREST:f.LINEAR,f.CLAMP_TO_EDGE),o.activeTexture.set(f.TEXTURE1),b.lineAtlas.bind(o),D.updatePaintBuffers(O)}function Zn(b,t,o,f,y){if(!o||!f||!f.imageAtlas)return;const M=f.imageAtlas.patternPositions;let C=M[o.to.toString()],D=M[o.from.toString()];if(!C&&D&&(C=D),!D&&C&&(D=C),!C||!D){const O=y.getPaintProperty(t);C=M[O],D=M[O]}C&&D&&b.setConstantPatternPositions(C,D)}function lo(b,t,o,f,y,M,C,D){const O=b.context.gl,U="fill-pattern",G=o.paint.get(U),X=G&&G.constantOr(1),$=o.getCrossfadeParameters();let ee,re,me,_e,ye;const ve=b.transform,Se=o.paint.get("fill-translate"),be=o.paint.get("fill-translate-anchor");C?(re=X&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ee=O.LINES):(re=X?"fillPattern":"fill",ee=O.TRIANGLES);const Ce=G.constantOr(null);for(const Ie of f){const we=t.getTile(Ie);if(X&&!we.patternsLoaded())continue;const ke=we.getBucket(o);if(!ke)continue;const Ke=ke.programConfigurations.get(o.id),He=b.useProgram(re,Ke),Je=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ie);X&&(b.context.activeTexture.set(O.TEXTURE0),we.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Ke.updatePaintBuffers($)),Zn(Ke,U,Ce,we,o);const tt=ve.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!D,applyTerrainMatrix:!0}),bt=c.aP(ve,we,Se,be);if(C){_e=ke.indexBuffer2,ye=ke.segments2;const _t=[O.drawingBufferWidth,O.drawingBufferHeight];me=re==="fillOutlinePattern"&&X?_u(b,$,we,_t,bt):yu(_t,bt)}else _e=ke.indexBuffer,ye=ke.segments,me=X?To(b,$,we,bt):{u_fill_translate:bt};const Ct=b.stencilModeForClipping(Ie);He.draw(b.context,ee,y,Ct,M,Mi.backCCW,me,Je,tt,o.id,ke.layoutVertexBuffer,_e,ye,o.paint,b.transform.zoom,Ke)}}function ps(b,t,o,f,y,M,C,D){const O=b.context,U=O.gl,G="fill-extrusion-pattern",X=o.paint.get(G),$=X.constantOr(1),ee=o.getCrossfadeParameters(),re=o.paint.get("fill-extrusion-opacity"),me=X.constantOr(null),_e=b.transform;for(const ye of f){const ve=t.getTile(ye),Se=ve.getBucket(o);if(!Se)continue;const be=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ye),Ce=Se.programConfigurations.get(o.id),Ie=b.useProgram($?"fillExtrusionPattern":"fillExtrusion",Ce);$&&(b.context.activeTexture.set(U.TEXTURE0),ve.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Ce.updatePaintBuffers(ee));const we=_e.getProjectionData({overscaledTileID:ye,applyGlobeMatrix:!D,applyTerrainMatrix:!0});Zn(Ce,G,me,ve,o);const ke=c.aP(_e,ve,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ke=o.paint.get("fill-extrusion-vertical-gradient"),He=$?qc(b,Ke,re,ke,ye,ee,ve):wo(b,Ke,re,ke);Ie.draw(O,O.gl.TRIANGLES,y,M,C,Mi.backCCW,He,be,we,o.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,o.paint,b.transform.zoom,Ce,b.style.map.terrain&&Se.centroidVertexBuffer)}}function ms(b,t,o,f,y,M,C,D,O){var U;const G=b.style.projection,X=b.context,$=b.transform,ee=X.gl,re=[`#define NUM_ILLUMINATION_SOURCES ${o.paint.get("hillshade-highlight-color").values.length}`],me=b.useProgram("hillshade",null,!1,re),_e=!b.options.moving;for(const ye of f){const ve=t.getTile(ye),Se=ve.fbo;if(!Se)continue;const be=G.getMeshFromTileID(X,ye.canonical,D,!0,"raster"),Ce=(U=b.style.map.terrain)===null||U===void 0?void 0:U.getTerrainData(ye);X.activeTexture.set(ee.TEXTURE0),ee.bindTexture(ee.TEXTURE_2D,Se.colorAttachment.get());const Ie=$.getProjectionData({overscaledTileID:ye,aligned:_e,applyGlobeMatrix:!O,applyTerrainMatrix:!0});me.draw(X,ee.TRIANGLES,M,y[ye.overscaledZ],C,Mi.backCCW,Ll(b,ve,o),Ce,Ie,o.id,be.vertexBuffer,be.indexBuffer,be.segments)}}function Rs(b,t,o,f,y,M,C,D,O){var U;const G=b.style.projection,X=b.context,$=b.transform,ee=X.gl,re=b.useProgram("colorRelief"),me=!b.options.moving;let _e=!0,ye=0;for(const ve of f){const Se=t.getTile(ve),be=Se.dem;if(_e){const He=ee.getParameter(ee.MAX_TEXTURE_SIZE),{elevationTexture:Je,colorTexture:tt}=o.getColorRampTextures(X,He,be.getUnpackVector());X.activeTexture.set(ee.TEXTURE1),Je.bind(ee.NEAREST,ee.CLAMP_TO_EDGE),X.activeTexture.set(ee.TEXTURE4),tt.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),_e=!1,ye=Je.size[0]}if(!be||!be.data)continue;const Ce=be.stride,Ie=be.getPixels();if(X.activeTexture.set(ee.TEXTURE0),X.pixelStoreUnpackPremultiplyAlpha.set(!1),Se.demTexture=Se.demTexture||b.getTileTexture(Ce),Se.demTexture){const He=Se.demTexture;He.update(Ie,{premultiply:!1}),He.bind(ee.LINEAR,ee.CLAMP_TO_EDGE)}else Se.demTexture=new c.T(X,Ie,ee.RGBA,{premultiply:!1}),Se.demTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const we=G.getMeshFromTileID(X,ve.canonical,D,!0,"raster"),ke=(U=b.style.map.terrain)===null||U===void 0?void 0:U.getTerrainData(ve),Ke=$.getProjectionData({overscaledTileID:ve,aligned:me,applyGlobeMatrix:!O,applyTerrainMatrix:!0});re.draw(X,ee.TRIANGLES,M,y[ve.overscaledZ],C,Mi.backCCW,_d(o,Se.dem,ye),ke,Ke,o.id,we.vertexBuffer,we.indexBuffer,we.segments)}}const Xo=[new c.P(0,0),new c.P(c.a5,0),new c.P(c.a5,c.a5),new c.P(0,c.a5)];function uo(b,t,o,f,y,M,C,D,O=!1,U=!1){const G=f[f.length-1].overscaledZ,X=b.context,$=X.gl,ee=b.useProgram("raster"),re=b.transform,me=b.style.projection,_e=b.colorModeForRenderPass(),ye=!b.options.moving,ve=o.paint.get("raster-opacity"),Se=o.paint.get("raster-resampling"),be=o.paint.get("raster-fade-duration"),Ce=!!b.style.map.terrain;for(const Ie of f){const we=b.getDepthModeForSublayer(Ie.overscaledZ-G,ve===1?vi.ReadWrite:vi.ReadOnly,$.LESS),ke=t.getTile(Ie),Ke=Se==="nearest"?$.NEAREST:$.LINEAR;X.activeTexture.set($.TEXTURE0),ke.texture.bind(Ke,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST),X.activeTexture.set($.TEXTURE1);const{parentTile:He,parentScaleBy:Je,parentTopLeft:tt,fadeValues:bt}=gs(ke,t,be,Ce);ke.fadeOpacity=bt.tileOpacity,He?(He.fadeOpacity=bt.parentTileOpacity,He.texture.bind(Ke,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST)):ke.texture.bind(Ke,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST),ke.texture.useMipmap&&X.extTextureFilterAnisotropic&&b.transform.pitch>20&&$.texParameterf($.TEXTURE_2D,X.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,X.extTextureFilterAnisotropicMax);const Ct=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ie),_t=re.getProjectionData({overscaledTileID:Ie,aligned:ye,applyGlobeMatrix:!U,applyTerrainMatrix:!0}),Yt=bu(tt,Je,bt.fadeMix,o,D),wi=me.getMeshFromTileID(X,Ie.canonical,M,C,"raster");ee.draw(X,$.TRIANGLES,we,y?y[Ie.overscaledZ]:Di.disabled,_e,O?Mi.frontCCW:Mi.backCCW,Yt,Ct,_t,o.id,wi.vertexBuffer,wi.indexBuffer,wi.segments)}}function gs(b,t,o,f){const y={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(o===0||f)return y;if(b.fadingParentID){const M=t.getLoadedTile(b.fadingParentID);if(!M)return y;const C=Math.pow(2,M.tileID.overscaledZ-b.tileID.overscaledZ),D=[b.tileID.canonical.x*C%1,b.tileID.canonical.y*C%1],O=(function(U,G,X){const $=fe(),ee=($-G.timeAdded)/X,re=U.fadingDirection===We.Incoming,me=c.ao(($-U.timeAdded)/X,0,1),_e=c.ao(1-ee,0,1),ye=re?me:_e;return{tileOpacity:ye,parentTileOpacity:re?_e:me,fadeMix:{opacity:1,mix:1-ye}}})(b,M,o);return{parentTile:M,parentScaleBy:C,parentTopLeft:D,fadeValues:O}}if(b.selfFading){const M=(function(C,D){const O=(fe()-C.timeAdded)/D,U=c.ao(O,0,1);return{tileOpacity:U,fadeMix:{opacity:U,mix:0}}})(b,o);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:M}}return y}const Ul=new c.bq(1,0,0,1),fl=new c.bq(0,1,0,1),xd=new c.bq(0,0,1,1),wd=new c.bq(1,0,1,1),ys=new c.bq(0,1,1,1);function Yc(b,t,o,f){Pr(b,0,t+o/2,b.transform.width,o,f)}function Vl(b,t,o,f){Pr(b,t-o/2,0,o,b.transform.height,f)}function Pr(b,t,o,f,y,M){const C=b.context,D=C.gl;D.enable(D.SCISSOR_TEST),D.scissor(t*b.pixelRatio,o*b.pixelRatio,f*b.pixelRatio,y*b.pixelRatio),C.clear({color:M}),D.disable(D.SCISSOR_TEST)}function kh(b,t,o){const f=b.context,y=f.gl,M=b.useProgram("debug"),C=vi.disabled,D=Di.disabled,O=b.colorModeForRenderPass(),U="$debug",G=b.style.map.terrain&&b.style.map.terrain.getTerrainData(o);f.activeTexture.set(y.TEXTURE0);const X=t.getTileByID(o.key).latestRawTileData,$=Math.floor((X&&X.byteLength||0)/1024),ee=t.getTile(o).tileSize,re=512/Math.min(ee,512)*(o.overscaledZ/b.transform.zoom)*.5;let me=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(me+=` => ${o.overscaledZ}`),(function(ye,ve){ye.initDebugOverlayCanvas();const Se=ye.debugOverlayCanvas,be=ye.context.gl,Ce=ye.debugOverlayCanvas.getContext("2d");Ce.clearRect(0,0,Se.width,Se.height),Ce.shadowColor="white",Ce.shadowBlur=2,Ce.lineWidth=1.5,Ce.strokeStyle="white",Ce.textBaseline="top",Ce.font="bold 36px Open Sans, sans-serif",Ce.fillText(ve,5,5),Ce.strokeText(ve,5,5),ye.debugOverlayTexture.update(Se),ye.debugOverlayTexture.bind(be.LINEAR,be.CLAMP_TO_EDGE)})(b,`${me} ${$}kB`);const _e=b.transform.getProjectionData({overscaledTileID:o,applyGlobeMatrix:!0,applyTerrainMatrix:!0});M.draw(f,y.TRIANGLES,C,D,pn.alphaBlended,Mi.disabled,So(c.bq.transparent,re),null,_e,U,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),M.draw(f,y.LINE_STRIP,C,D,O,Mi.disabled,So(c.bq.red),G,_e,U,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function Td(b,t,o,f){const{isRenderingGlobe:y}=f,M=b.context,C=M.gl,D=b.transform,O=b.colorModeForRenderPass(),U=b.getDepthModeFor3D(),G=b.useProgram("terrain");M.bindFramebuffer.set(null),M.viewport.set([0,0,b.width,b.height]);for(const X of o){const $=t.getTerrainMesh(X.tileID),ee=b.renderToTexture.getTexture(X),re=t.getTerrainData(X.tileID);M.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,ee.texture);const me=t.getMeshFrameDelta(D.zoom),_e=D.calculateFogMatrix(X.tileID.toUnwrapped()),ye=zh(me,_e,b.style.sky,D.pitch,y),ve=D.getProjectionData({overscaledTileID:X.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});G.draw(M,C.TRIANGLES,U,Di.disabled,O,Mi.backCCW,ye,re,ve,"terrain",$.vertexBuffer,$.indexBuffer,$.segments)}}function xf(b,t){if(!t.mesh){const o=new c.aX;o.emplaceBack(-1,-1),o.emplaceBack(1,-1),o.emplaceBack(1,1),o.emplaceBack(-1,1);const f=new c.aZ;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),t.mesh=new fn(b.createVertexBuffer(o,Oa.members),b.createIndexBuffer(f),c.aY.simpleSegment(0,0,o.length,f.length))}return t.mesh}class Op{constructor(t,o){this.context=new se(t),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.as(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=vn.maxOverzooming+vn.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ar}resize(t,o,f){if(this.width=Math.floor(t*f),this.height=Math.floor(o*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const t=this.context,o=new c.aX;o.emplaceBack(0,0),o.emplaceBack(c.a5,0),o.emplaceBack(0,c.a5),o.emplaceBack(c.a5,c.a5),this.tileExtentBuffer=t.createVertexBuffer(o,Oa.members),this.tileExtentSegments=c.aY.simpleSegment(0,0,4,2);const f=new c.aX;f.emplaceBack(0,0),f.emplaceBack(c.a5,0),f.emplaceBack(0,c.a5),f.emplaceBack(c.a5,c.a5),this.debugBuffer=t.createVertexBuffer(f,Oa.members),this.debugSegments=c.aY.simpleSegment(0,0,4,5);const y=new c.ci;y.emplaceBack(0,0,0,0),y.emplaceBack(c.a5,0,c.a5,0),y.emplaceBack(0,c.a5,0,c.a5),y.emplaceBack(c.a5,c.a5,c.a5,c.a5),this.rasterBoundsBuffer=t.createVertexBuffer(y,md.members),this.rasterBoundsSegments=c.aY.simpleSegment(0,0,4,2);const M=new c.aX;M.emplaceBack(0,0),M.emplaceBack(c.a5,0),M.emplaceBack(0,c.a5),M.emplaceBack(c.a5,c.a5),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(M,Oa.members),this.rasterBoundsSegmentsPosOnly=c.aY.simpleSegment(0,0,4,5);const C=new c.aX;C.emplaceBack(0,0),C.emplaceBack(1,0),C.emplaceBack(0,1),C.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(C,Oa.members),this.viewportSegments=c.aY.simpleSegment(0,0,4,2);const D=new c.cj;D.emplaceBack(0),D.emplaceBack(1),D.emplaceBack(3),D.emplaceBack(2),D.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(D);const O=new c.aZ;O.emplaceBack(1,0,2),O.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(O);const U=this.context.gl;this.stencilClearMode=new Di({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.tileExtentMesh=new fn(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,o=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=c.N();c.c8(f,0,this.width,this.height,0,0,1),c.Q(f,f,[o.drawingBufferWidth,o.drawingBufferHeight,0]);const y={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(t,o.TRIANGLES,vi.disabled,this.stencilClearMode,pn.disabled,Mi.disabled,null,null,y,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,o,f){if(this.currentStencilSource===t.source||!t.isTileClipped()||!o||!o.length)return;this.currentStencilSource=t.source,this.nextStencilID+o.length>256&&this.clearStencil();const y=this.context;y.setColorMode(pn.disabled),y.setDepthMode(vi.disabled);const M={};for(const C of o)M[C.key]=this.nextStencilID++;this._renderTileMasks(M,o,f,!0),this._renderTileMasks(M,o,f,!1),this._tileClippingMaskIDs=M}_renderTileMasks(t,o,f,y){const M=this.context,C=M.gl,D=this.style.projection,O=this.transform,U=this.useProgram("clippingMask");for(const G of o){const X=t[G.key],$=this.style.map.terrain&&this.style.map.terrain.getTerrainData(G),ee=D.getMeshFromTileID(this.context,G.canonical,y,!0,"stencil"),re=O.getProjectionData({overscaledTileID:G,applyGlobeMatrix:!f,applyTerrainMatrix:!0});U.draw(M,C.TRIANGLES,vi.disabled,new Di({func:C.ALWAYS,mask:0},X,255,C.KEEP,C.KEEP,C.REPLACE),pn.disabled,f?Mi.disabled:Mi.backCCW,null,$,re,"$clipping",ee.vertexBuffer,ee.indexBuffer,ee.segments)}}_renderTilesDepthBuffer(){const t=this.context,o=t.gl,f=this.style.projection,y=this.transform,M=this.useProgram("depth"),C=this.getDepthModeFor3D(),D=nr(y,{tileSize:y.tileSize});for(const O of D){const U=this.style.map.terrain&&this.style.map.terrain.getTerrainData(O),G=f.getMeshFromTileID(this.context,O.canonical,!0,!0,"raster"),X=y.getProjectionData({overscaledTileID:O,applyGlobeMatrix:!0,applyTerrainMatrix:!0});M.draw(t,o.TRIANGLES,C,Di.disabled,pn.disabled,Mi.backCCW,null,U,X,"$clipping",G.vertexBuffer,G.indexBuffer,G.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,o=this.context.gl;return new Di({func:o.NOTEQUAL,mask:255},t,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(t){const o=this.context.gl;return new Di({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,o.KEEP,o.KEEP,o.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const o=this.context.gl,f=t.sort(((C,D)=>D.overscaledZ-C.overscaledZ)),y=f[f.length-1].overscaledZ,M=f[0].overscaledZ-y+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();const C={};for(let D=0;D<M;D++)C[D+y]=new Di({func:o.GEQUAL,mask:255},D+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=M,[C,f]}return[{[y]:Di.disabled},f]}stencilConfigForOverlapTwoPass(t){const o=this.context.gl,f=t.sort(((C,D)=>D.overscaledZ-C.overscaledZ)),y=f[f.length-1].overscaledZ,M=f[0].overscaledZ-y+1;if(this.clearStencil(),M>1){const C={},D={};for(let O=0;O<M;O++)C[O+y]=new Di({func:o.GREATER,mask:255},M+1+O,255,o.KEEP,o.KEEP,o.REPLACE),D[O+y]=new Di({func:o.GREATER,mask:255},1+O,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID=2*M+1,[C,D,f]}return this.nextStencilID=3,[{[y]:new Di({func:o.GREATER,mask:255},2,255,o.KEEP,o.KEEP,o.REPLACE)},{[y]:new Di({func:o.GREATER,mask:255},1,255,o.KEEP,o.KEEP,o.REPLACE)},f]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new pn([t.CONSTANT_COLOR,t.ONE],new c.bq(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?pn.unblended:pn.alphaBlended}getDepthModeForSublayer(t,o,f){if(!this.opaquePassEnabledForLayer())return vi.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new vi(f||this.context.gl.LEQUAL,o,[y,y])}getDepthModeFor3D(){return new vi(this.context.gl.LEQUAL,vi.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,o){var f,y;this.style=t,this.options=o,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(fe()),this.imageManager.beginFrame();const M=this.style._order,C=this.style.tileManagers,D={},O={},U={},G={isRenderingToTexture:!1,isRenderingGlobe:((f=t.projection)===null||f===void 0?void 0:f.transitionState)>0};for(const $ in C){const ee=C[$];ee.used&&ee.prepare(this.context),D[$]=ee.getVisibleCoordinates(!1),O[$]=D[$].slice().reverse(),U[$]=ee.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let $=0;$<M.length;$++)if(this.style._layers[M[$]].is3D()){this.opaquePassCutoff=$;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const $ of M){const ee=this.style._layers[$];if(!ee.hasOffscreenPass()||ee.isHidden(this.transform.zoom))continue;const re=O[ee.source];(ee.type==="custom"||re.length)&&this.renderLayer(this,C[ee.source],ee,re,G)}if((y=this.style.projection)===null||y===void 0||y.updateGPUdependent({context:this.context,useProgram:$=>this.useProgram($)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?c.bq.black:c.bq.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function($,ee){const re=$.context,me=re.gl,_e=((Ie,we,ke)=>{const Ke=Math.cos(we.rollInRadians),He=Math.sin(we.rollInRadians),Je=en(we),tt=we.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ie.properties.get("sky-color"),u_horizon_color:Ie.properties.get("horizon-color"),u_horizon:[(we.width/2-Je*He)*ke,(we.height/2+Je*Ke)*ke],u_horizon_normal:[-He,Ke],u_sky_horizon_blend:Ie.properties.get("sky-horizon-blend")*we.height/2*ke,u_sky_blend:tt}})(ee,$.style.map.transform,$.pixelRatio),ye=new vi(me.LEQUAL,vi.ReadWrite,[0,1]),ve=Di.disabled,Se=$.colorModeForRenderPass(),be=$.useProgram("sky"),Ce=xf(re,ee);be.draw(re,me.TRIANGLES,ye,ve,Se,Mi.disabled,_e,null,void 0,"sky",Ce.vertexBuffer,Ce.indexBuffer,Ce.segments)})(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=M.length-1;this.currentLayer>=0;this.currentLayer--){const $=this.style._layers[M[this.currentLayer]],ee=C[$.source],re=D[$.source];this._renderTileClippingMasks($,re,!1),this.renderLayer(this,ee,$,re,G)}this.renderPass="translucent";let X=!1;for(this.currentLayer=0;this.currentLayer<M.length;this.currentLayer++){const $=this.style._layers[M[this.currentLayer]],ee=C[$.source];if(this.renderToTexture&&this.renderToTexture.renderLayer($,G))continue;this.opaquePassEnabledForLayer()||X||(X=!0,G.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const re=($.type==="symbol"?U:O)[$.source];this._renderTileClippingMasks($,D[$.source],!!this.renderToTexture),this.renderLayer(this,ee,$,re,G)}if(G.isRenderingGlobe&&(function($,ee,re){const me=$.context,_e=me.gl,ye=$.useProgram("atmosphere"),ve=new vi(_e.LEQUAL,vi.ReadOnly,[0,1]),Se=$.transform,be=(function(tt,bt){const Ct=tt.properties.get("position"),_t=[-Ct.x,-Ct.y,-Ct.z],Yt=c.as(new Float64Array(16));return tt.properties.get("anchor")==="map"&&(c.bh(Yt,Yt,bt.rollInRadians),c.bi(Yt,Yt,-bt.pitchInRadians),c.bh(Yt,Yt,bt.bearingInRadians),c.bi(Yt,Yt,bt.center.lat*Math.PI/180),c.bK(Yt,Yt,-bt.center.lng*Math.PI/180)),c.ch(_t,_t,Yt),_t})(re,$.transform),Ce=Se.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ie=ee.properties.get("atmosphere-blend")*Ce.projectionTransition;if(Ie===0)return;const we=Es(Se.worldSize,Se.center.lat),ke=Se.inverseProjectionMatrix,Ke=new Float64Array(4);Ke[3]=1,c.aI(Ke,Ke,Se.modelViewProjectionMatrix),Ke[0]/=Ke[3],Ke[1]/=Ke[3],Ke[2]/=Ke[3],Ke[3]=1,c.aI(Ke,Ke,ke),Ke[0]/=Ke[3],Ke[1]/=Ke[3],Ke[2]/=Ke[3],Ke[3]=1;const He=((tt,bt,Ct,_t,Yt)=>({u_sun_pos:tt,u_atmosphere_blend:bt,u_globe_position:Ct,u_globe_radius:_t,u_inv_proj_matrix:Yt}))(be,Ie,[Ke[0],Ke[1],Ke[2]],we,ke),Je=xf(me,ee);ye.draw(me,_e.TRIANGLES,ve,Di.disabled,pn.alphaBlended,Mi.disabled,He,null,null,"atmosphere",Je.vertexBuffer,Je.indexBuffer,Je.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const $=(function(ee,re){let me=null;const _e=Object.values(ee._layers).flatMap((be=>be.source&&!be.isHidden(re)?[ee.tileManagers[be.source]]:[])),ye=_e.filter((be=>be.getSource().type==="vector")),ve=_e.filter((be=>be.getSource().type!=="vector")),Se=be=>{(!me||me.getSource().maxzoom<be.getSource().maxzoom)&&(me=be)};return ye.forEach((be=>Se(be))),me||ve.forEach((be=>Se(be))),me})(this.style,this.transform.zoom);$&&(function(ee,re,me){for(let _e=0;_e<me.length;_e++)kh(ee,re,me[_e])})(this,$,$.getVisibleCoordinates())}this.options.showPadding&&(function($){const ee=$.transform.padding;Yc($,$.transform.height-(ee.top||0),3,Ul),Yc($,ee.bottom||0,3,fl),Vl($,ee.left||0,3,xd),Vl($,$.transform.width-(ee.right||0),3,wd);const re=$.transform.centerPoint;(function(me,_e,ye,ve){Pr(me,_e-1,ye-10,2,20,ve),Pr(me,_e-10,ye-1,20,2,ve)})($,re.x,$.transform.height-re.y,ys)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let y=this.terrainFacilitator.dirty;y||(y=t?!c.ck(o,f):!c.cl(o,f)),y||(y=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),y&&(c.cm(o,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(M,C){const D=M.context,O=D.gl,U=M.transform,G=pn.unblended,X=new vi(O.LEQUAL,vi.ReadWrite,[0,1]),$=C.tileManager.getRenderableTiles(),ee=M.useProgram("terrainDepth");D.bindFramebuffer.set(C.getFramebuffer("depth").framebuffer),D.viewport.set([0,0,M.width/devicePixelRatio,M.height/devicePixelRatio]),D.clear({color:c.bq.transparent,depth:1});for(const re of $){const me=C.getTerrainMesh(re.tileID),_e=C.getTerrainData(re.tileID),ye=U.getProjectionData({overscaledTileID:re.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ve={u_ele_delta:C.getMeshFrameDelta(U.zoom)};ee.draw(D,O.TRIANGLES,X,Di.disabled,G,Mi.backCCW,ve,_e,ye,"terrain",me.vertexBuffer,me.indexBuffer,me.segments)}D.bindFramebuffer.set(null),D.viewport.set([0,0,M.width,M.height])})(this,this.style.map.terrain),(function(M,C){const D=M.context,O=D.gl,U=M.transform,G=pn.unblended,X=new vi(O.LEQUAL,vi.ReadWrite,[0,1]),$=C.getCoordsTexture(),ee=C.tileManager.getRenderableTiles(),re=M.useProgram("terrainCoords");D.bindFramebuffer.set(C.getFramebuffer("coords").framebuffer),D.viewport.set([0,0,M.width/devicePixelRatio,M.height/devicePixelRatio]),D.clear({color:c.bq.transparent,depth:1}),C.coordsIndex=[];for(const me of ee){const _e=C.getTerrainMesh(me.tileID),ye=C.getTerrainData(me.tileID);D.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,$.texture);const ve={u_terrain_coords_id:(255-C.coordsIndex.length)/255,u_texture:0,u_ele_delta:C.getMeshFrameDelta(U.zoom)},Se=U.getProjectionData({overscaledTileID:me.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});re.draw(D,O.TRIANGLES,X,Di.disabled,G,Mi.backCCW,ve,ye,Se,"terrain",_e.vertexBuffer,_e.indexBuffer,_e.segments),C.coordsIndex.push(me.tileID.key)}D.bindFramebuffer.set(null),D.viewport.set([0,0,M.width,M.height])})(this,this.style.map.terrain))}renderLayer(t,o,f,y,M){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(y||[]).length)&&(this.id=f.id,c.cn(f)?(function(C,D,O,U,G,X){if(C.renderPass!=="translucent")return;const{isRenderingToTexture:$}=X,ee=Di.disabled,re=C.colorModeForRenderPass();(O._unevaluatedLayout.hasValue("text-variable-anchor")||O._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(me,_e,ye,ve,Se,be,Ce,Ie,we){const ke=_e.transform,Ke=_e.style.map.terrain,He=Se==="map",Je=be==="map";for(const tt of me){const bt=ve.getTile(tt),Ct=bt.getBucket(ye);if(!Ct||!Ct.text||!Ct.text.segments.get().length)continue;const _t=c.az(Ct.textSizeData,ke.zoom),Yt=c.aO(bt,1,_e.transform.zoom),wi=Ra(He,_e.transform,Yt),hn=ye.layout.get("icon-text-fit")!=="none"&&Ct.hasIconData();if(_t){const In=Math.pow(2,ke.zoom-bt.tileID.overscaledZ),gn=Ke?(qn,xn)=>Ke.getElevation(tt,qn,xn):null;ui(Ct,He,Je,we,ke,wi,In,_t,hn,c.aP(ke,bt,Ce,Ie),tt.toUnwrapped(),gn)}}})(U,C,O,D,O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),G),O.paint.get("icon-opacity").constantOr(1)!==0&&mr(C,D,O,U,!1,O.paint.get("icon-translate"),O.paint.get("icon-translate-anchor"),O.layout.get("icon-rotation-alignment"),O.layout.get("icon-pitch-alignment"),O.layout.get("icon-keep-upright"),ee,re,$),O.paint.get("text-opacity").constantOr(1)!==0&&mr(C,D,O,U,!0,O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.layout.get("text-keep-upright"),ee,re,$),D.map.showCollisionBoxes&&(Ue(C,D,O,U,!0),Ue(C,D,O,U,!1))})(t,o,f,y,this.style.placement.variableOffsets,M):c.co(f)?(function(C,D,O,U,G){if(C.renderPass!=="translucent")return;const{isRenderingToTexture:X}=G,$=O.paint.get("circle-opacity"),ee=O.paint.get("circle-stroke-width"),re=O.paint.get("circle-stroke-opacity"),me=!O.layout.get("circle-sort-key").isConstant();if($.constantOr(1)===0&&(ee.constantOr(1)===0||re.constantOr(1)===0))return;const _e=C.context,ye=_e.gl,ve=C.transform,Se=C.getDepthModeForSublayer(0,vi.ReadOnly),be=Di.disabled,Ce=C.colorModeForRenderPass(),Ie=[],we=ve.getCircleRadiusCorrection();for(let ke=0;ke<U.length;ke++){const Ke=U[ke],He=D.getTile(Ke),Je=He.getBucket(O);if(!Je)continue;const tt=O.paint.get("circle-translate"),bt=O.paint.get("circle-translate-anchor"),Ct=c.aP(ve,He,tt,bt),_t=Je.programConfigurations.get(O.id),Yt=C.useProgram("circle",_t),wi=Je.layoutVertexBuffer,hn=Je.indexBuffer,In=C.style.map.terrain&&C.style.map.terrain.getTerrainData(Ke),gn={programConfiguration:_t,program:Yt,layoutVertexBuffer:wi,indexBuffer:hn,uniformValues:vu(C,He,O,Ct,we),terrainData:In,projectionData:ve.getProjectionData({overscaledTileID:Ke,applyGlobeMatrix:!X,applyTerrainMatrix:!0})};if(me){const qn=Je.segments.get();for(const xn of qn)Ie.push({segments:new c.aY([xn]),sortKey:xn.sortKey,state:gn})}else Ie.push({segments:Je.segments,sortKey:0,state:gn})}me&&Ie.sort(((ke,Ke)=>ke.sortKey-Ke.sortKey));for(const ke of Ie){const{programConfiguration:Ke,program:He,layoutVertexBuffer:Je,indexBuffer:tt,uniformValues:bt,terrainData:Ct,projectionData:_t}=ke.state;He.draw(_e,ye.TRIANGLES,Se,be,Ce,Mi.backCCW,bt,Ct,_t,O.id,Je,tt,ke.segments,O.paint,C.transform.zoom,Ke)}})(t,o,f,y,M):c.cp(f)?(function(C,D,O,U,G){if(O.paint.get("heatmap-opacity")===0)return;const X=C.context,{isRenderingToTexture:$,isRenderingGlobe:ee}=G;if(C.style.map.terrain){for(const re of U){const me=D.getTile(re);D.hasRenderableParent(re)||(C.renderPass==="offscreen"?$a(C,me,O,re,ee):C.renderPass==="translucent"&&cn(C,O,re,$,ee))}X.viewport.set([0,0,C.width,C.height])}else C.renderPass==="offscreen"?(function(re,me,_e,ye){const ve=re.context,Se=ve.gl,be=re.transform,Ce=Di.disabled,Ie=new pn([Se.ONE,Se.ONE],c.bq.transparent,[!0,!0,!0,!0]);(function(we,ke,Ke){const He=we.gl;we.activeTexture.set(He.TEXTURE1),we.viewport.set([0,0,ke.width/4,ke.height/4]);let Je=Ke.heatmapFbos.get(c.ce);Je?(He.bindTexture(He.TEXTURE_2D,Je.colorAttachment.get()),we.bindFramebuffer.set(Je.framebuffer)):(Je=Wi(we,ke.width/4,ke.height/4),Ke.heatmapFbos.set(c.ce,Je))})(ve,re,_e),ve.clear({color:c.bq.transparent});for(let we=0;we<ye.length;we++){const ke=ye[we];if(me.hasRenderableParent(ke))continue;const Ke=me.getTile(ke),He=Ke.getBucket(_e);if(!He)continue;const Je=He.programConfigurations.get(_e.id),tt=re.useProgram("heatmap",Je),bt=be.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Ct=be.getCircleRadiusCorrection();tt.draw(ve,Se.TRIANGLES,vi.disabled,Ce,Ie,Mi.backCCW,qo(Ke,be.zoom,_e.paint.get("heatmap-intensity"),Ct),null,bt,_e.id,He.layoutVertexBuffer,He.indexBuffer,He.segments,_e.paint,be.zoom,Je)}ve.viewport.set([0,0,re.width,re.height])})(C,D,O,U):C.renderPass==="translucent"&&(function(re,me){const _e=re.context,ye=_e.gl;_e.setColorMode(re.colorModeForRenderPass());const ve=me.heatmapFbos.get(c.ce);ve&&(_e.activeTexture.set(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_2D,ve.colorAttachment.get()),_e.activeTexture.set(ye.TEXTURE1),Ri(_e,me).bind(ye.LINEAR,ye.CLAMP_TO_EDGE),re.useProgram("heatmapTexture").draw(_e,ye.TRIANGLES,vi.disabled,Di.disabled,re.colorModeForRenderPass(),Mi.disabled,Lh(re,me,0,1),null,null,me.id,re.viewportBuffer,re.quadTriangleIndexBuffer,re.viewportSegments,me.paint,re.transform.zoom))})(C,O)})(t,o,f,y,M):c.cq(f)?(function(C,D,O,U,G){if(C.renderPass!=="translucent")return;const{isRenderingToTexture:X}=G,$=O.paint.get("line-opacity"),ee=O.paint.get("line-width");if($.constantOr(1)===0||ee.constantOr(1)===0)return;const re=C.getDepthModeForSublayer(0,vi.ReadOnly),me=C.colorModeForRenderPass(),_e=O.paint.get("line-dasharray"),ye=_e.constantOr(1),ve=O.paint.get("line-pattern"),Se=ve.constantOr(1),be=O.paint.get("line-gradient"),Ce=O.getCrossfadeParameters();let Ie;Ie=Se?"linePattern":ye&&be?"lineGradientSDF":ye?"lineSDF":be?"lineGradient":"line";const we=C.context,ke=we.gl,Ke=C.transform;let He=!0;for(const Je of U){const tt=D.getTile(Je);if(Se&&!tt.patternsLoaded())continue;const bt=tt.getBucket(O);if(!bt)continue;const Ct=bt.programConfigurations.get(O.id),_t=C.context.program.get(),Yt=C.useProgram(Ie,Ct),wi=He||Yt.program!==_t,hn=C.style.map.terrain&&C.style.map.terrain.getTerrainData(Je),In=ve.constantOr(null),gn=_e&&_e.constantOr(null);if(In&&tt.imageAtlas){const Br=tt.imageAtlas,lr=Br.patternPositions[In.to.toString()],gr=Br.patternPositions[In.from.toString()];lr&&gr&&Ct.setConstantPatternPositions(lr,gr)}else if(gn){const Br=O.layout.get("line-cap")==="round",lr=C.lineAtlas.getDash(gn.to,Br),gr=C.lineAtlas.getDash(gn.from,Br);Ct.setConstantDashPositions(lr,gr)}const qn=Ke.getProjectionData({overscaledTileID:Je,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),xn=Ke.getPixelScale();let Or;Se?(Or=$o(C,tt,O,xn,Ce),so(we,ke,tt,Ct,Ce)):ye&&be?(Or=zs(C,tt,O,xn,Ce,bt.lineClipsArray.length),Xa(C,D,we,ke,O,bt,Je,Ct,Ce)):ye?(Or=ra(C,tt,O,xn,Ce),Nn(C,we,ke,Ct,wi,Ce)):be?(Or=vd(C,tt,O,xn,bt.lineClipsArray.length),Ha(C,D,we,ke,O,bt,Je)):Or=ds(C,tt,O,xn);const jn=C.stencilModeForClipping(Je);Yt.draw(we,ke.TRIANGLES,re,jn,me,Mi.disabled,Or,hn,qn,O.id,bt.layoutVertexBuffer,bt.indexBuffer,bt.segments,O.paint,C.transform.zoom,Ct,bt.layoutVertexBuffer2),He=!1}})(t,o,f,y,M):c.cr(f)?(function(C,D,O,U,G){const X=O.paint.get("fill-color"),$=O.paint.get("fill-opacity");if($.constantOr(1)===0)return;const{isRenderingToTexture:ee}=G,re=C.colorModeForRenderPass(),me=O.paint.get("fill-pattern"),_e=C.opaquePassEnabledForLayer()&&!me.constantOr(1)&&X.constantOr(c.bq.transparent).a===1&&$.constantOr(0)===1?"opaque":"translucent";if(C.renderPass===_e){const ye=C.getDepthModeForSublayer(1,C.renderPass==="opaque"?vi.ReadWrite:vi.ReadOnly);lo(C,D,O,U,ye,re,!1,ee)}if(C.renderPass==="translucent"&&O.paint.get("fill-antialias")){const ye=C.getDepthModeForSublayer(O.getPaintProperty("fill-outline-color")?2:0,vi.ReadOnly);lo(C,D,O,U,ye,re,!0,ee)}})(t,o,f,y,M):c.cs(f)?(function(C,D,O,U,G){const X=O.paint.get("fill-extrusion-opacity");if(X===0)return;const{isRenderingToTexture:$}=G;if(C.renderPass==="translucent"){const ee=new vi(C.context.gl.LEQUAL,vi.ReadWrite,C.depthRangeFor3D);if(X!==1||O.paint.get("fill-extrusion-pattern").constantOr(1))ps(C,D,O,U,ee,Di.disabled,pn.disabled,$),ps(C,D,O,U,ee,C.stencilModeFor3D(),C.colorModeForRenderPass(),$);else{const re=C.colorModeForRenderPass();ps(C,D,O,U,ee,Di.disabled,re,$)}}})(t,o,f,y,M):c.ct(f)?(function(C,D,O,U,G){if(C.renderPass!=="offscreen"&&C.renderPass!=="translucent")return;const{isRenderingToTexture:X}=G,$=C.context,ee=C.style.projection.useSubdivision,re=C.getDepthModeForSublayer(0,vi.ReadOnly),me=C.colorModeForRenderPass();if(C.renderPass==="offscreen")(function(_e,ye,ve,Se,be,Ce,Ie){const we=_e.context,ke=we.gl;for(const Ke of ve){const He=ye.getTile(Ke),Je=He.dem;if(!Je||!Je.data||!He.needsHillshadePrepare)continue;const tt=Je.dim,bt=Je.stride,Ct=Je.getPixels();if(we.activeTexture.set(ke.TEXTURE1),we.pixelStoreUnpackPremultiplyAlpha.set(!1),He.demTexture=He.demTexture||_e.getTileTexture(bt),He.demTexture){const Yt=He.demTexture;Yt.update(Ct,{premultiply:!1}),Yt.bind(ke.NEAREST,ke.CLAMP_TO_EDGE)}else He.demTexture=new c.T(we,Ct,ke.RGBA,{premultiply:!1}),He.demTexture.bind(ke.NEAREST,ke.CLAMP_TO_EDGE);we.activeTexture.set(ke.TEXTURE0);let _t=He.fbo;if(!_t){const Yt=new c.T(we,{width:tt,height:tt,data:null},ke.RGBA);Yt.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),_t=He.fbo=we.createFramebuffer(tt,tt,!0,!1),_t.colorAttachment.set(Yt.texture)}we.bindFramebuffer.set(_t.framebuffer),we.viewport.set([0,0,tt,tt]),_e.useProgram("hillshadePrepare").draw(we,ke.TRIANGLES,be,Ce,Ie,Mi.disabled,yd(He.tileID,Je),null,null,Se.id,_e.rasterBoundsBuffer,_e.quadTriangleIndexBuffer,_e.rasterBoundsSegments),He.needsHillshadePrepare=!1}})(C,D,U,O,re,Di.disabled,me),$.viewport.set([0,0,C.width,C.height]);else if(C.renderPass==="translucent")if(ee){const[_e,ye,ve]=C.stencilConfigForOverlapTwoPass(U);ms(C,D,O,ve,_e,re,me,!1,X),ms(C,D,O,ve,ye,re,me,!0,X)}else{const[_e,ye]=C.getStencilConfigForOverlapAndUpdateStencilID(U);ms(C,D,O,ye,_e,re,me,!1,X)}})(t,o,f,y,M):c.cu(f)?(function(C,D,O,U,G){if(C.renderPass!=="translucent"||!U.length)return;const{isRenderingToTexture:X}=G,$=C.style.projection.useSubdivision,ee=C.getDepthModeForSublayer(0,vi.ReadOnly),re=C.colorModeForRenderPass();if($){const[me,_e,ye]=C.stencilConfigForOverlapTwoPass(U);Rs(C,D,O,ye,me,ee,re,!1,X),Rs(C,D,O,ye,_e,ee,re,!0,X)}else{const[me,_e]=C.getStencilConfigForOverlapAndUpdateStencilID(U);Rs(C,D,O,_e,me,ee,re,!1,X)}})(t,o,f,y,M):c.bV(f)?(function(C,D,O,U,G){if(C.renderPass!=="translucent"||O.paint.get("raster-opacity")===0||!U.length)return;const{isRenderingToTexture:X}=G,$=D.getSource(),ee=C.style.projection.useSubdivision;if($ instanceof Da)uo(C,D,O,U,null,!1,!1,$.tileCoords,$.flippedWindingOrder,X);else if(ee){const[re,me,_e]=C.stencilConfigForOverlapTwoPass(U);uo(C,D,O,_e,re,!1,!0,Xo,!1,X),uo(C,D,O,_e,me,!0,!0,Xo,!1,X)}else{const[re,me]=C.getStencilConfigForOverlapAndUpdateStencilID(U);uo(C,D,O,me,re,!1,!0,Xo,!1,X)}})(t,o,f,y,M):c.cv(f)?(function(C,D,O,U,G){const X=O.paint.get("background-color"),$=O.paint.get("background-opacity");if($===0)return;const{isRenderingToTexture:ee}=G,re=C.context,me=re.gl,_e=C.style.projection,ye=C.transform,ve=ye.tileSize,Se=O.paint.get("background-pattern");if(C.isPatternMissing(Se))return;const be=!Se&&X.a===1&&$===1&&C.opaquePassEnabledForLayer()?"opaque":"translucent";if(C.renderPass!==be)return;const Ce=Di.disabled,Ie=C.getDepthModeForSublayer(0,be==="opaque"?vi.ReadWrite:vi.ReadOnly),we=C.colorModeForRenderPass(),ke=C.useProgram(Se?"backgroundPattern":"background"),Ke=U||nr(ye,{tileSize:ve,terrain:C.style.map.terrain});Se&&(re.activeTexture.set(me.TEXTURE0),C.imageManager.bind(C.context));const He=O.getCrossfadeParameters();for(const Je of Ke){const tt=ye.getProjectionData({overscaledTileID:Je,applyGlobeMatrix:!ee,applyTerrainMatrix:!0}),bt=Se?Qu($,C,Se,{tileID:Je,tileSize:ve},He):xu($,X),Ct=C.style.map.terrain&&C.style.map.terrain.getTerrainData(Je),_t=_e.getMeshFromTileID(re,Je.canonical,!1,!0,"raster");ke.draw(re,me.TRIANGLES,Ie,Ce,we,Mi.backCCW,bt,Ct,tt,O.id,_t.vertexBuffer,_t.indexBuffer,_t.segments)}})(t,0,f,y,M):c.cw(f)&&(function(C,D,O,U){const{isRenderingGlobe:G}=U,X=C.context,$=O.implementation,ee=C.style.projection,re=C.transform,me=re.getProjectionDataForCustomLayer(G),_e={farZ:re.farZ,nearZ:re.nearZ,fov:re.fov*Math.PI/180,modelViewProjectionMatrix:re.modelViewProjectionMatrix,projectionMatrix:re.projectionMatrix,shaderData:{variantName:ee.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${ee.shaderPreludeCode.vertexSource}`,define:ee.shaderDefine},defaultProjectionData:me},ye=$.renderingMode?$.renderingMode:"2d";if(C.renderPass==="offscreen"){const ve=$.prerender;ve&&(C.setCustomLayerDefaults(),X.setColorMode(C.colorModeForRenderPass()),ve.call($,X.gl,_e),X.setDirty(),C.setBaseState())}else if(C.renderPass==="translucent"){C.setCustomLayerDefaults(),X.setColorMode(C.colorModeForRenderPass()),X.setStencilMode(Di.disabled);const ve=ye==="3d"?C.getDepthModeFor3D():C.getDepthModeForSublayer(0,vi.ReadOnly);X.setDepthMode(ve),$.render(X.gl,_e),X.setDirty(),C.setBaseState(),X.bindFramebuffer.set(null)}})(t,0,f,M))}saveTileTexture(t){const o=this._tileTextures[t.size[0]];o?o.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const o=this._tileTextures[t];return o&&o.length>0?o.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const o=this.imageManager.getPattern(t.from.toString()),f=this.imageManager.getPattern(t.to.toString());return!o||!f}useProgram(t,o,f=!1,y=[]){this.cache=this.cache||{};const M=!!this.style.map.terrain,C=this.style.projection,D=f?Xi.projectionMercator:C.shaderPreludeCode,O=f?Bn:C.shaderDefine,U=t+(o?o.cacheKey:"")+`/${f?ta:C.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(M?"/terrain":"")+(y?`/${y.join("/")}`:"");return this.cache[U]||(this.cache[U]=new Il(this.context,Xi[t],o,bd[t],this._showOverdrawInspector,M,D,O,y)),this.cache[U]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var t,o;if(this._tileTextures){for(const f in this._tileTextures){const y=this._tileTextures[f];if(y)for(const M of y)M.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((t=this.tileExtentMesh.vertexBuffer)===null||t===void 0||t.destroy()),this.tileExtentMesh&&((o=this.tileExtentMesh.indexBuffer)===null||o===void 0||o.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const f in this.cache){const y=this.cache[f];y&&y.program&&this.context.gl.deleteProgram(y.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:o}=this.context.gl;return this.width!==t||this.height!==o}}function wf(b,t){let o,f=!1,y=null,M=null;const C=()=>{y=null,f&&(b.apply(M,o),y=setTimeout(C,t),f=!1)};return(...D)=>(f=!0,M=this,o=D,y||C(),y)}class ar{constructor(t){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let f;return o.split("&").map((y=>y.split("="))).forEach((y=>{y[0]===this._hashName&&(f=y)})),(f&&f[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(!this._isValidHash(o))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:f,pitch:+(o[4]||0)}),!0},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const f=o.join("/");let y=f;y.split("&").length>0&&(y=y.split("&")[0]),this._hashName&&(y=`${this._hashName}=${f}`);let M=window.location.hash.replace(y,"");M.startsWith("#&")?M=M.slice(0,1)+M.slice(2):M==="#"&&(M="");let C=window.location.href.replace(/(#.+)?$/,M);C=C.replace("&&","&"),window.history.replaceState(window.history.state,null,C)},this._updateHash=wf(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const o=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,y=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),M=Math.pow(10,y),C=Math.round(o.lng*M)/M,D=Math.round(o.lat*M)/M,O=this._map.getBearing(),U=this._map.getPitch();let G="";if(G+=t?`/${C}/${D}/${f}`:`${f}/${D}/${C}`,(O||U)&&(G+="/"+Math.round(10*O)/10),U&&(G+=`/${Math.round(U)}`),this._hashName){const X=this._hashName;let $=!1;const ee=window.location.hash.slice(1).split("&").map((re=>{const me=re.split("=")[0];return me===X?($=!0,`${me}=${G}`):re})).filter((re=>re));return $||ee.push(`${X}=${G}`),`#${ee.join("&")}`}return`#${G}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new c.V(+t[2],+t[1])}catch{return!1}const o=+t[0],f=+(t[3]||0),y=+(t[4]||0);return o>=this._map.getMinZoom()&&o<=this._map.getMaxZoom()&&f>=-180&&f<=180&&y>=this._map.getMinPitch()&&y<=this._map.getMaxPitch()}}const Su={linearity:.3,easing:c.cx(0,0,.3,1)},Ya=c.e({deceleration:2500,maxSpeed:1400},Su),co=c.e({deceleration:20,maxSpeed:1400},Su),Sd=c.e({deceleration:1e3,maxSpeed:360},Su),Wa=c.e({deceleration:1e3,maxSpeed:90},Su),Wc=c.e({deceleration:1e3,maxSpeed:360},Su);class Kc{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:fe(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,o=fe();for(;t.length>0&&o-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:M}of this._inertiaBuffer)o.zoom+=M.zoomDelta||0,o.bearing+=M.bearingDelta||0,o.pitch+=M.pitchDelta||0,o.roll+=M.rollDelta||0,M.panDelta&&o.pan._add(M.panDelta),M.around&&(o.around=M.around),M.pinchAround&&(o.pinchAround=M.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(o.pan.mag()){const M=Oh(o.pan.mag(),f,c.e({},Ya,t||{})),C=o.pan.mult(M.amount/o.pan.mag()),D=this._map.cameraHelper.handlePanInertia(C,this._map.transform);y.center=D.easingCenter,y.offset=D.easingOffset,Jc(y,M)}if(o.zoom){const M=Oh(o.zoom,f,co);y.zoom=this._map.transform.zoom+M.amount,Jc(y,M)}if(o.bearing){const M=Oh(o.bearing,f,Sd);y.bearing=this._map.transform.bearing+c.ao(M.amount,-179,179),Jc(y,M)}if(o.pitch){const M=Oh(o.pitch,f,Wa);y.pitch=this._map.transform.pitch+M.amount,Jc(y,M)}if(o.roll){const M=Oh(o.roll,f,Wc);y.roll=this._map.transform.roll+c.ao(M.amount,-179,179),Jc(y,M)}if(y.zoom||y.bearing){const M=o.pinchAround===void 0?o.around:o.pinchAround;y.around=M?this._map.unproject(M):this._map.getCenter()}return this.clear(),c.e(y,{noMoveStart:!0})}}function Jc(b,t){(!b.duration||b.duration<t.duration)&&(b.duration=t.duration,b.easing=t.easing)}function Oh(b,t,o){const{maxSpeed:f,linearity:y,deceleration:M}=o,C=c.ao(b*y/(t/1e3),-f,f),D=Math.abs(C)/(M*y);return{easing:o.easing,duration:1e3*D,amount:C*(D/2)}}class Mo extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,f,y={}){f=f instanceof MouseEvent?f:new MouseEvent(t,f);const M=ce.mousePos(o.getCanvas(),f),C=o.unproject(M);super(t,c.e({point:M,lngLat:C,originalEvent:f},y)),this._defaultPrevented=!1,this.target=o}}class ks extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,f){const y=t==="touchend"?f.changedTouches:f.touches,M=ce.touchPos(o.getCanvasContainer(),y),C=M.map((O=>o.unproject(O))),D=M.reduce(((O,U,G,X)=>O.add(U.div(X.length))),new c.P(0,0));super(t,{points:M,point:D,lngLats:C,lngLat:o.unproject(D),originalEvent:f}),this._defaultPrevented=!1}}class Bh extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,f){super(t,{originalEvent:f}),this._defaultPrevented=!1}}class Mu{constructor(t,o){this._map=t,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Bh(t.type,this._map,t))}mousedown(t,o){return this._mousedownPos=o,this._firePreventable(new Mo(t.type,this._map,t))}mouseup(t){this._map.fire(new Mo(t.type,this._map,t))}click(t,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new Mo(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Mo(t.type,this._map,t))}mouseover(t){this._map.fire(new Mo(t.type,this._map,t))}mouseout(t){this._map.fire(new Mo(t.type,this._map,t))}touchstart(t){return this._firePreventable(new ks(t.type,this._map,t))}touchmove(t){this._map.fire(new ks(t.type,this._map,t))}touchend(t){this._map.fire(new ks(t.type,this._map,t))}touchcancel(t){this._map.fire(new ks(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class pl{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Mo(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Mo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Mo(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ot{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(c.P.convert(t),this._map.terrain)}}class Fh{constructor(t,o){this._map=t,this._tr=new Ot(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,o){this.isEnabled()&&t.shiftKey&&t.button===0&&(ce.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(t,o){if(!this._active)return;const f=o;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=f,this._box||(this._box=ce.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const M=Math.min(y.x,f.x),C=Math.max(y.x,f.x),D=Math.min(y.y,f.y),O=Math.max(y.y,f.y);ce.setTransform(this._box,`translate(${M}px,${D}px)`),this._box.style.width=C-M+"px",this._box.style.height=O-D+"px"}mouseupWindow(t,o){if(!this._active||t.button!==0)return;const f=this._startPos,y=o;if(this.reset(),ce.suppressClick(),f.x!==y.x||f.y!==y.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:t})),{cameraAnimation:M=>M.fitScreenCoordinates(f,y,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ce.remove(this._box),this._box=null),ce.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,o){return this._map.fire(new c.l(t,{originalEvent:o}))}}function Eu(b,t){if(b.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${t.length}`);const o={};for(let f=0;f<b.length;f++)o[b[f].identifier]=t[f];return o}class Nh{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,o,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),f.length===this.numTouches&&(this.centroid=(function(y){const M=new c.P(0,0);for(const C of y)M._add(C);return M.div(y.length)})(o),this.touches=Eu(f,o)))}touchmove(t,o,f){if(this.aborted||!this.centroid)return;const y=Eu(f,o);for(const M in this.touches){const C=y[M];(!C||C.dist(this.touches[M])>30)&&(this.aborted=!0)}}touchend(t,o,f){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class Au{constructor(t){this.singleTap=new Nh(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,o,f){this.singleTap.touchstart(t,o,f)}touchmove(t,o,f){this.singleTap.touchmove(t,o,f)}touchend(t,o,f){const y=this.singleTap.touchend(t,o,f);if(y){const M=t.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(y)<30;if(M&&C||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class Qc{constructor(t){this._tr=new Ot(t),this._zoomIn=new Au({numTouches:1,numTaps:2}),this._zoomOut=new Au({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,o,f){this._zoomIn.touchstart(t,o,f),this._zoomOut.touchstart(t,o,f)}touchmove(t,o,f){this._zoomIn.touchmove(t,o,f),this._zoomOut.touchmove(t,o,f)}touchend(t,o,f){const y=this._zoomIn.touchend(t,o,f),M=this._zoomOut.touchend(t,o,f),C=this._tr;return y?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:C.zoom+1,around:C.unproject(y)},{originalEvent:t})}):M?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:C.zoom-1,around:C.unproject(M)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yo{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const o=this._moveFunction(...t);if(o.bearingDelta||o.pitchDelta||o.rollDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(t,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(o)?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,o){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const y=Array.isArray(o)?o[0]:o;return!this._moved&&y.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=y,this._move(f,y))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&ce.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const rc=0,Md=2,Tf={[rc]:1,[Md]:2};class _s{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const o=ce.mouseButton(t);this._eventButton=o}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(o,f){const y=Tf[f];return o.buttons===void 0||(o.buttons&y)!==y})(t,this._eventButton)}isValidEndEvent(t){return ce.mouseButton(t)===this._eventButton}}class jh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class Uh{constructor(t=new _s({checkCorrectEvent:()=>!0}),o=new jh){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=o}_executeRelevantHandler(t,o,f){return t instanceof MouseEvent?o(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?f(t):void 0}startMove(t){this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.startMove(o)),(o=>this.oneFingerTouchMoveStateManager.startMove(o)))}endMove(t){this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.endMove(o)),(o=>this.oneFingerTouchMoveStateManager.endMove(o)))}isValidStartEvent(t){return this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.isValidStartEvent(o)),(o=>this.oneFingerTouchMoveStateManager.isValidStartEvent(o)))}isValidMoveEvent(t){return this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.isValidMoveEvent(o)),(o=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(o)))}isValidEndEvent(t){return this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.isValidEndEvent(o)),(o=>this.oneFingerTouchMoveStateManager.isValidEndEvent(o)))}}const Cu=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=t=>{t.preventDefault()}};class Ed{constructor(t,o){this._clickTolerance=t.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,o,f){return this._calculateTransform(t,o,f)}touchmove(t,o,f){if(this._active){if(!this._shouldBePrevented(f.length))return t.preventDefault(),this._calculateTransform(t,o,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,o,f){this._calculateTransform(t,o,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,o,f){f.length>0&&(this._active=!0);const y=Eu(f,o),M=new c.P(0,0),C=new c.P(0,0);let D=0;for(const U in y){const G=y[U],X=this._touches[U];X&&(M._add(G),C._add(G.sub(X)),D++,y[U]=G)}if(this._touches=y,this._shouldBePrevented(D)||!C.mag())return;const O=C.div(D);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:M.div(D),panDelta:O}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vh{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,o,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([o[0],o[1]]))}touchmove(t,o,f){if(!this._firstTwoTouches)return;t.preventDefault();const[y,M]=this._firstTwoTouches,C=ml(f,o,y),D=ml(f,o,M);if(!C||!D)return;const O=this._aroundCenter?null:C.add(D).div(2);return this._move([C,D],O,t)}touchend(t,o,f){if(!this._firstTwoTouches)return;const[y,M]=this._firstTwoTouches,C=ml(f,o,y),D=ml(f,o,M);C&&D||(this._active&&ce.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ml(b,t,o){for(let f=0;f<b.length;f++)if(b[f].identifier===o)return t[f]}function Ad(b,t){return Math.log(b/t)/Math.LN2}class Gl extends Vh{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,o){const f=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ad(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ad(this._distance,f),pinchAround:o}}}function Cd(b,t){return 180*b.angleWith(t)/Math.PI}class Os extends Vh{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,o,f){const y=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Cd(this._vector,y),pinchAround:o}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const o=25/(Math.PI*this._minDiameter)*360,f=Cd(t,this._startVector);return Math.abs(f)<o}}function $i(b){return Math.abs(b.y)>Math.abs(b.x)}class Zl extends Vh{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,o,f){super.touchstart(t,o,f),this._currentTouchCount=f.length}_start(t){this._lastPoints=t,$i(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,o,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const y=t[0].sub(this._lastPoints[0]),M=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,M,f.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(y.y+M.y)/2*-.5}):void 0}gestureBeginsVertically(t,o,f){if(this._valid!==void 0)return this._valid;const y=t.mag()>=2,M=o.mag()>=2;if(!y&&!M)return;if(!y||!M)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const C=t.y>0==o.y>0;return $i(t)&&$i(o)&&C}}const Pu={panStep:100,bearingStep:15,pitchStep:10};class ac{constructor(t){this._tr=new Ot(t);const o=Pu;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let o=0,f=0,y=0,M=0,C=0;switch(t.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:t.shiftKey?f=-1:(t.preventDefault(),M=-1);break;case 39:t.shiftKey?f=1:(t.preventDefault(),M=1);break;case 38:t.shiftKey?y=1:(t.preventDefault(),C=-1);break;case 40:t.shiftKey?y=-1:(t.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(f=0,y=0),{cameraAnimation:D=>{const O=this._tr;D.easeTo({duration:300,easeId:"keyboardHandler",easing:Gh,zoom:o?Math.round(O.zoom)+o*(t.shiftKey?2:1):O.zoom,bearing:O.bearing+f*this._bearingStep,pitch:O.pitch+y*this._pitchStep,offset:[-M*this._panStep,-C*this._panStep],center:O.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Gh(b){return b*(2-b)}const oc=4.000244140625,eh=1/450;class Pd{constructor(t,o){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=t,this._tr=new Ot(t),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=eh}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let o=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const f=fe(),y=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,o!==0&&o%oc==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(y*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),t.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=t,this._delta-=o,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=ce.mousePos(this._map.getCanvas(),t),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(c.V.convert(f.center)):o,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const D=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=D),typeof this._targetZoom=="number"&&(this._targetZoom+=D)}if(this._delta!==0){const D=this._type==="wheel"&&Math.abs(this._delta)>oc?this._wheelZoomRate:this._defaultZoomRate;let O=2/(1+Math.exp(-Math.abs(this._delta*D)));this._delta<0&&O!==0&&(O=1/O);const U=typeof this._targetZoom!="number"?t.scale:c.ar(this._targetZoom);this._targetZoom=t.applyConstrain(t.getCameraLngLat(),c.au(U*O)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,f=this._startZoom,y=this._easing;let M,C=!1;if(this._type==="wheel"&&f&&y){const D=fe()-this._lastWheelEventTime,O=Math.min((D+5)/200,1),U=y(O);M=c.G.number(f,o,U),O<1?this._frameId||(this._frameId=!0):C=!0}else M=o,C=!0;return this._active=!0,C&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=M,{noInertia:!0,needsRenderFrame:!C,zoomDelta:M-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let o=c.cz;if(this._prevEase){const f=this._prevEase,y=(fe()-f.start)/f.duration,M=f.easing(y+.01)-f.easing(y),C=.27/Math.sqrt(M*M+1e-4)*.01,D=Math.sqrt(.0729-C*C);o=c.cx(C,D,.25,1)}return this._prevEase={start:fe(),duration:t,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Sf{constructor(t,o){this._clickZoom=t,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ho{constructor(t){this._tr=new Ot(t),this.reset()}reset(){this._active=!1}dblclick(t,o){return t.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sc{constructor(){this._tap=new Au({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,o,f){if(!this._swipePoint)if(this._tapTime){const y=o[0],M=t.timeStamp-this._tapTime<500,C=this._tapPoint.dist(y)<30;M&&C?f.length>0&&(this._swipePoint=y,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(t,o,f)}touchmove(t,o,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const y=o[0],M=y.y-this._swipePoint.y;return this._swipePoint=y,t.preventDefault(),this._active=!0,{zoomDelta:M/128}}}else this._tap.touchmove(t,o,f)}touchend(t,o,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const y=this._tap.touchend(t,o,f);y&&(this._tapTime=t.timeStamp,this._tapPoint=y)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jt{constructor(t,o,f){this._el=t,this._mousePan=o,this._touchPan=f}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ai{constructor(t,o,f,y){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=o,this._mousePitch=f,this._mouseRoll=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class zu{constructor(t,o,f,y){this._el=t,this._touchZoom=o,this._touchRotate=f,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class fo{constructor(t,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=ce.create("div","maplibregl-cooperative-gesture-screen",t);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),y=document.createElement("div");y.className="maplibregl-desktop-message",y.textContent=o,this._container.appendChild(y);const M=document.createElement("div");M.className="maplibregl-mobile-message",M.textContent=f,this._container.appendChild(M),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(ce.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,o){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:t,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const fa=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class xr extends c.l{}function po(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class Mf{constructor(t,o){this.handleWindowEvent=y=>{this.handleEvent(y,`${y.type}Window`)},this.handleEvent=(y,M)=>{if(y.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const C=y.type==="renderFrame"?void 0:y,D={needsRenderFrame:!1},O={},U={};for(const{handlerName:$,handler:ee,allowed:re}of this._handlers){if(!ee.isEnabled())continue;let me;if(this._blockedByActive(U,re,$))ee.reset();else if(ee[M||y.type]){if(c.cA(y,M||y.type)){const _e=ce.mousePos(this._map.getCanvas(),y);me=ee[M||y.type](y,_e)}else if(c.cB(y,M||y.type)){const _e=this._getMapTouches(y.touches),ye=ce.touchPos(this._map.getCanvas(),_e);me=ee[M||y.type](y,ye,_e)}else c.cC(M||y.type)||(me=ee[M||y.type](y));this.mergeHandlerResult(D,O,me,$,C),me&&me.needsRenderFrame&&this._triggerRenderFrame()}(me||ee.isActive())&&(U[$]=ee)}const G={};for(const $ in this._previousActiveHandlers)U[$]||(G[$]=C);this._previousActiveHandlers=U,(Object.keys(G).length||po(D))&&(this._changes.push([D,O,G]),this._triggerRenderFrame()),(Object.keys(U).length||po(D))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=D;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Kc(t),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,M,C]of this._listeners)ce.addEventListener(y,M,y===document?this.handleWindowEvent:this.handleEvent,C)}destroy(){for(const[t,o,f]of this._listeners)ce.removeEventListener(t,o,t===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(t){const o=this._map,f=o.getCanvasContainer();this._add("mapEvent",new Mu(o,t));const y=o.boxZoom=new Fh(o,t);this._add("boxZoom",y),t.interactive&&t.boxZoom&&y.enable();const M=o.cooperativeGestures=new fo(o,t.cooperativeGestures);this._add("cooperativeGestures",M),t.cooperativeGestures&&M.enable();const C=new Qc(o),D=new ho(o);o.doubleClickZoom=new Sf(D,C),this._add("tapZoom",C),this._add("clickZoom",D),t.interactive&&t.doubleClickZoom&&o.doubleClickZoom.enable();const O=new sc;this._add("tapDragZoom",O);const U=o.touchPitch=new Zl(o);this._add("touchPitch",U),t.interactive&&t.touchPitch&&o.touchPitch.enable(t.touchPitch);const G=()=>o.project(o.getCenter()),X=(function({enable:be,clickTolerance:Ce,aroundCenter:Ie=!0,minPixelCenterThreshold:we=100,rotateDegreesPerPixelMoved:ke=.8},Ke){const He=new _s({checkCorrectEvent:Je=>ce.mouseButton(Je)===0&&Je.ctrlKey||ce.mouseButton(Je)===2&&!Je.ctrlKey});return new Yo({clickTolerance:Ce,move:(Je,tt)=>{const bt=Ke();if(Ie&&Math.abs(bt.y-Je.y)>we)return{bearingDelta:c.cy(new c.P(Je.x,tt.y),tt,bt)};let Ct=(tt.x-Je.x)*ke;return Ie&&tt.y<bt.y&&(Ct=-Ct),{bearingDelta:Ct}},moveStateManager:He,enable:be,assignEvents:Cu})})(t,G),$=(function({enable:be,clickTolerance:Ce,pitchDegreesPerPixelMoved:Ie=-.5}){const we=new _s({checkCorrectEvent:ke=>ce.mouseButton(ke)===0&&ke.ctrlKey||ce.mouseButton(ke)===2});return new Yo({clickTolerance:Ce,move:(ke,Ke)=>({pitchDelta:(Ke.y-ke.y)*Ie}),moveStateManager:we,enable:be,assignEvents:Cu})})(t),ee=(function({enable:be,clickTolerance:Ce,rollDegreesPerPixelMoved:Ie=.3},we){const ke=new _s({checkCorrectEvent:Ke=>ce.mouseButton(Ke)===2&&Ke.ctrlKey});return new Yo({clickTolerance:Ce,move:(Ke,He)=>{const Je=we();let tt=(He.x-Ke.x)*Ie;return He.y<Je.y&&(tt=-tt),{rollDelta:tt}},moveStateManager:ke,enable:be,assignEvents:Cu})})(t,G);o.dragRotate=new ai(t,X,$,ee),this._add("mouseRotate",X,["mousePitch"]),this._add("mousePitch",$,["mouseRotate","mouseRoll"]),this._add("mouseRoll",ee,["mousePitch"]),t.interactive&&t.dragRotate&&o.dragRotate.enable();const re=(function({enable:be,clickTolerance:Ce}){const Ie=new _s({checkCorrectEvent:we=>ce.mouseButton(we)===0&&!we.ctrlKey});return new Yo({clickTolerance:Ce,move:(we,ke)=>({around:ke,panDelta:ke.sub(we)}),activateOnStart:!0,moveStateManager:Ie,enable:be,assignEvents:Cu})})(t),me=new Ed(t,o);o.dragPan=new Jt(f,re,me),this._add("mousePan",re),this._add("touchPan",me,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&o.dragPan.enable(t.dragPan);const _e=new Os,ye=new Gl;o.touchZoomRotate=new zu(f,ye,_e,O),this._add("touchRotate",_e,["touchPan","touchZoom"]),this._add("touchZoom",ye,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&o.touchZoomRotate.enable(t.touchZoomRotate),this._add("blockableMapEvent",new pl(o));const ve=o.scrollZoom=new Pd(o,(()=>this._triggerRenderFrame()));this._add("scrollZoom",ve,["mousePan"]),t.interactive&&t.scrollZoom&&o.scrollZoom.enable(t.scrollZoom);const Se=o.keyboard=new ac(o);this._add("keyboard",Se),t.interactive&&t.keyboard&&o.keyboard.enable()}_add(t,o,f){this._handlers.push({handlerName:t,handler:o,allowed:f}),this._handlersById[t]=o}stop(t){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!fa(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,o,f){for(const y in t)if(y!==f&&(!o||o.indexOf(y)<0))return!0;return!1}_getMapTouches(t){const o=[];for(const f of t)this._el.contains(f.target)&&o.push(f);return o}mergeHandlerResult(t,o,f,y,M){if(!f)return;c.e(t,f);const C={handlerName:y,originalEvent:f.originalEvent||M};f.zoomDelta!==void 0&&(o.zoom=C),f.panDelta!==void 0&&(o.drag=C),f.rollDelta!==void 0&&(o.roll=C),f.pitchDelta!==void 0&&(o.pitch=C),f.bearingDelta!==void 0&&(o.rotate=C)}_applyChanges(){const t={},o={},f={};for(const[y,M,C]of this._changes)y.panDelta&&(t.panDelta=(t.panDelta||new c.P(0,0))._add(y.panDelta)),y.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+y.pitchDelta),y.rollDelta&&(t.rollDelta=(t.rollDelta||0)+y.rollDelta),y.around!==void 0&&(t.around=y.around),y.pinchAround!==void 0&&(t.pinchAround=y.pinchAround),y.noInertia&&(t.noInertia=y.noInertia),c.e(o,M),c.e(f,C);this._updateMapTransform(t,o,f),this._changes=[]}_updateMapTransform(t,o,f){const y=this._map,M=y._getTransformForUpdate(),C=y.terrain;if(!(po(t)||C&&this._terrainMovement))return this._fireEvents(o,f,!0);y._stop(!0);let{panDelta:D,zoomDelta:O,bearingDelta:U,pitchDelta:G,rollDelta:X,around:$,pinchAround:ee}=t;ee!==void 0&&($=ee),$=$||y.transform.centerPoint,C&&!M.isPointOnMapSurface($)&&($=M.centerPoint);const re={panDelta:D,zoomDelta:O,rollDelta:X,pitchDelta:G,bearingDelta:U,around:$};this._map.cameraHelper.useGlobeControls&&!M.isPointOnMapSurface($)&&($=M.centerPoint);const me=$.distSqr(M.centerPoint)<.01?M.center:M.screenPointToLocation(D?$.sub(D):$);this._handleMapControls({terrain:C,tr:M,deltasForHelper:re,preZoomAroundLoc:me,combinedEventsInProgress:o,panDelta:D}),y._applyUpdatedTransform(M),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(o,f,!0)}_handleMapControls({terrain:t,tr:o,deltasForHelper:f,preZoomAroundLoc:y,combinedEventsInProgress:M,panDelta:C}){const D=this._map.cameraHelper;if(D.handleMapControlsRollPitchBearingZoom(f,o),t)return D.useGlobeControls?(this._terrainMovement||!M.drag&&!M.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void D.handleMapControlsPan(f,o,y)):this._terrainMovement||!M.drag&&!M.zoom?void(M.drag&&this._terrainMovement&&C?o.setCenter(o.screenPointToLocation(o.centerPoint.sub(C))):D.handleMapControlsPan(f,o,y)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void D.handleMapControlsPan(f,o,y));D.handleMapControlsPan(f,o,y)}_fireEvents(t,o,f){const y=fa(this._eventsInProgress),M=fa(t),C={};for(const X in t){const{originalEvent:$}=t[X];this._eventsInProgress[X]||(C[`${X}start`]=$),this._eventsInProgress[X]=t[X]}!y&&M&&this._fireEvent("movestart",M.originalEvent);for(const X in C)this._fireEvent(X,C[X]);M&&this._fireEvent("move",M.originalEvent);for(const X in t){const{originalEvent:$}=t[X];this._fireEvent(X,$)}const D={};let O;for(const X in this._eventsInProgress){const{handlerName:$,originalEvent:ee}=this._eventsInProgress[X];this._handlersById[$].isActive()||(delete this._eventsInProgress[X],O=o[$]||ee,D[`${X}end`]=O)}for(const X in D)this._fireEvent(X,D[X]);const U=fa(this._eventsInProgress),G=(y||M)&&!U;if(G&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const X=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&X.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(X)}if(f&&G){this._updatingCamera=!0;const X=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=ee=>ee!==0&&-this._bearingSnap<ee&&ee<this._bearingSnap;!X||!X.essential&&ue.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:O})),$(this._map.getBearing())&&this._map.resetNorth()):($(X.bearing||this._map.getBearing())&&(X.bearing=0),X.freezeElevation=!0,this._map.easeTo(X,{originalEvent:O})),this._updatingCamera=!1}}_fireEvent(t,o){this._map.fire(new c.l(t,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new xr("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Iu extends c.E{constructor(t,o,f){super(),this._renderFrameCallback=()=>{const y=Math.min((fe()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(y)),y<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=f.bearingSnap,this.cameraHelper=o,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(t,o){t.apply(this.transform),this.transform=t,this.cameraHelper=o}getCenter(){return new c.V(this.transform.center.lng,this.transform.center.lat)}setCenter(t,o){return this.jumpTo({center:t},o)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,o){return this.jumpTo({elevation:t},o),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,o,f){return t=c.P.convert(t).mult(-1),this.panTo(this.transform.center,c.e({offset:t},o),f)}panTo(t,o,f){return this.easeTo(c.e({center:t},o),f)}getZoom(){return this.transform.zoom}setZoom(t,o){return this.jumpTo({zoom:t},o),this}zoomTo(t,o,f){return this.easeTo(c.e({zoom:t},o),f)}zoomIn(t,o){return this.zoomTo(this.getZoom()+1,t,o),this}zoomOut(t,o){return this.zoomTo(this.getZoom()-1,t,o),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,o){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new c.l("movestart",o)).fire(new c.l("move",o)).fire(new c.l("moveend",o))),this}getBearing(){return this.transform.bearing}setBearing(t,o){return this.jumpTo({bearing:t},o),this}getPadding(){return this.transform.padding}setPadding(t,o){return this.jumpTo({padding:t},o),this}rotateTo(t,o,f){return this.easeTo(c.e({bearing:t},o),f)}resetNorth(t,o){return this.rotateTo(0,c.e({duration:1e3},t),o),this}resetNorthPitch(t,o){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},t),o),this}snapToNorth(t,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,o):this}getPitch(){return this.transform.pitch}setPitch(t,o){return this.jumpTo({pitch:t},o),this}getRoll(){return this.transform.roll}setRoll(t,o){return this.jumpTo({roll:t},o),this}cameraForBounds(t,o){t=Cn.convert(t).adjustAntiMeridian();const f=o&&o.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),f,o)}_cameraForBoxAndBearing(t,o,f,y){const M={top:0,bottom:0,right:0,left:0};if(typeof(y=c.e({padding:M,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const U=y.padding;y.padding={top:U,bottom:U,right:U,left:U}}const C=c.e(M,y.padding);y.padding=C;const D=this.transform,O=new Cn(t,o);return this.cameraHelper.cameraForBoxAndBearing(y,C,O,f,D)}fitBounds(t,o,f){return this._fitInternal(this.cameraForBounds(t,o),o,f)}fitScreenCoordinates(t,o,f,y,M){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(t)),this.transform.screenPointToLocation(c.P.convert(o)),f,y),y,M)}_fitInternal(t,o,f){return t?(delete(o=c.e(t,o)).padding,o.linear?this.easeTo(o,f):this.flyTo(o,f)):this}jumpTo(t,o){this.stop();const f=this._getTransformForUpdate();let y=!1,M=!1,C=!1;const D=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,t);const O=f.zoom!==D;return"elevation"in t&&f.elevation!==+t.elevation&&f.setElevation(+t.elevation),"bearing"in t&&f.bearing!==+t.bearing&&(y=!0,f.setBearing(+t.bearing)),"pitch"in t&&f.pitch!==+t.pitch&&(M=!0,f.setPitch(+t.pitch)),"roll"in t&&f.roll!==+t.roll&&(C=!0,f.setRoll(+t.roll)),t.padding==null||f.isPaddingEqual(t.padding)||f.setPadding(t.padding),this._applyUpdatedTransform(f),this.fire(new c.l("movestart",o)).fire(new c.l("move",o)),O&&this.fire(new c.l("zoomstart",o)).fire(new c.l("zoom",o)).fire(new c.l("zoomend",o)),y&&this.fire(new c.l("rotatestart",o)).fire(new c.l("rotate",o)).fire(new c.l("rotateend",o)),M&&this.fire(new c.l("pitchstart",o)).fire(new c.l("pitch",o)).fire(new c.l("pitchend",o)),C&&this.fire(new c.l("rollstart",o)).fire(new c.l("roll",o)).fire(new c.l("rollend",o)),this.fire(new c.l("moveend",o))}calculateCameraOptionsFromTo(t,o,f,y=0){const M=c.ab.fromLngLat(t,o),C=c.ab.fromLngLat(f,y),D=C.x-M.x,O=C.y-M.y,U=C.z-M.z,G=Math.hypot(D,O,U);if(G===0)throw new Error("Can't calculate camera options with same From and To");const X=Math.hypot(D,O),$=c.au(this.transform.cameraToCenterDistance/G/this.transform.tileSize),ee=180*Math.atan2(D,-O)/Math.PI;let re=180*Math.acos(X/G)/Math.PI;return re=U<0?90-re:90+re,{center:C.toLngLat(),elevation:y,zoom:$,pitch:re,bearing:ee}}calculateCameraOptionsFromCameraLngLatAltRotation(t,o,f,y,M){const C=this.transform.calculateCenterFromCameraLngLatAlt(t,o,f,y);return{center:C.center,elevation:C.elevation,zoom:C.zoom,bearing:f,pitch:y,roll:M}}easeTo(t,o){this._stop(!1,t.easeId),((t=c.e({offset:[0,0],duration:500,easing:c.cz},t)).animate===!1||!t.essential&&ue.prefersReducedMotion)&&(t.duration=0);const f=this._getTransformForUpdate(),y=this.getBearing(),M=f.pitch,C=f.roll,D="bearing"in t?this._normalizeBearing(t.bearing,y):y,O="pitch"in t?+t.pitch:M,U="roll"in t?this._normalizeBearing(t.roll,C):C,G="padding"in t?t.padding:f.padding,X=c.P.convert(t.offset);let $,ee;t.around&&($=c.V.convert(t.around),ee=f.locationToScreenPoint($));const re={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},me=this.cameraHelper.handleEaseTo(f,{bearing:D,pitch:O,roll:U,padding:G,around:$,aroundPoint:ee,offsetAsPoint:X,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||y!==D,this._pitching=this._pitching||O!==M,this._rolling=this._rolling||U!==C,this._padding=!f.isPaddingEqual(G),this._zooming=this._zooming||me.isZooming,this._easeId=t.easeId,this._prepareEase(o,t.noMoveStart,re),this.terrain&&this._prepareElevation(me.elevationCenter),this._ease((_e=>{me.easeFunc(_e),this.terrain&&!t.freezeElevation&&this._updateElevation(_e),this._applyUpdatedTransform(f),this._fireMoveEvents(o)}),(_e=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(o,_e)}),t),this}_prepareEase(t,o,f={}){this._moving=!0,o||f.moving||this.fire(new c.l("movestart",t)),this._zooming&&!f.zooming&&this.fire(new c.l("zoomstart",t)),this._rotating&&!f.rotating&&this.fire(new c.l("rotatestart",t)),this._pitching&&!f.pitching&&this.fire(new c.l("pitchstart",t)),this._rolling&&!f.rolling&&this.fire(new c.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&o!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(f-(o-(f*t+this._elevationStart))/(1-t)),this._elevationTarget=o}this.transform.setElevation(c.G.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const o=t.getCameraLngLat(),f=t.getCameraAltitude(),y=this.terrain?this.terrain.getElevationForLngLatZoom(o,t.zoom):0;if(f<y){const M=this.calculateCameraOptionsFromTo(o,y,t.center,t.elevation);return{pitch:M.pitch,zoom:M.zoom}}return{}}_applyUpdatedTransform(t){const o=[];if(o.push((y=>this._elevateCameraIfInsideTerrain(y))),this.transformCameraUpdate&&o.push((y=>this.transformCameraUpdate(y))),!o.length)return;const f=t.clone();for(const y of o){const M=f.clone(),{center:C,zoom:D,roll:O,pitch:U,bearing:G,elevation:X}=y(M);C&&M.setCenter(C),X!==void 0&&M.setElevation(X),D!==void 0&&M.setZoom(D),O!==void 0&&M.setRoll(O),U!==void 0&&M.setPitch(U),G!==void 0&&M.setBearing(G),f.apply(M)}this.transform.apply(f)}_fireMoveEvents(t){this.fire(new c.l("move",t)),this._zooming&&this.fire(new c.l("zoom",t)),this._rotating&&this.fire(new c.l("rotate",t)),this._pitching&&this.fire(new c.l("pitch",t)),this._rolling&&this.fire(new c.l("roll",t))}_afterEase(t,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const f=this._zooming,y=this._rotating,M=this._pitching,C=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new c.l("zoomend",t)),y&&this.fire(new c.l("rotateend",t)),M&&this.fire(new c.l("pitchend",t)),C&&this.fire(new c.l("rollend",t)),this.fire(new c.l("moveend",t))}flyTo(t,o){if(!t.essential&&ue.prefersReducedMotion){const tt=c.U(t,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(tt,o)}this.stop(),t=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.cz},t);const f=this._getTransformForUpdate(),y=f.bearing,M=f.pitch,C=f.roll,D=f.padding,O="bearing"in t?this._normalizeBearing(t.bearing,y):y,U="pitch"in t?+t.pitch:M,G="roll"in t?this._normalizeBearing(t.roll,C):C,X="padding"in t?t.padding:f.padding,$=c.P.convert(t.offset);let ee=f.centerPoint.add($);const re=f.screenPointToLocation(ee),me=this.cameraHelper.handleFlyTo(f,{bearing:O,pitch:U,roll:G,padding:X,locationAtOffset:re,offsetAsPoint:$,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let _e=t.curve;const ye=Math.max(f.width,f.height),ve=ye/me.scaleOfZoom,Se=me.pixelPathLength;typeof me.scaleOfMinZoom=="number"&&(_e=Math.sqrt(ye/me.scaleOfMinZoom/Se*2));const be=_e*_e;function Ce(tt){const bt=(ve*ve-ye*ye+(tt?-1:1)*be*be*Se*Se)/(2*(tt?ve:ye)*be*Se);return Math.log(Math.sqrt(bt*bt+1)-bt)}function Ie(tt){return(Math.exp(tt)-Math.exp(-tt))/2}function we(tt){return(Math.exp(tt)+Math.exp(-tt))/2}const ke=Ce(!1);let Ke=function(tt){return we(ke)/we(ke+_e*tt)},He=function(tt){return ye*((we(ke)*(Ie(bt=ke+_e*tt)/we(bt))-Ie(ke))/be)/Se;var bt},Je=(Ce(!0)-ke)/_e;if(Math.abs(Se)<2e-6||!isFinite(Je)){if(Math.abs(ye-ve)<1e-6)return this.easeTo(t,o);const tt=ve<ye?-1:1;Je=Math.abs(Math.log(ve/ye))/_e,He=()=>0,Ke=bt=>Math.exp(tt*_e*bt)}return t.duration="duration"in t?+t.duration:1e3*Je/("screenSpeed"in t?+t.screenSpeed/_e:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=y!==O,this._pitching=U!==M,this._rolling=G!==C,this._padding=!f.isPaddingEqual(X),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(me.targetCenter),this._ease((tt=>{const bt=tt*Je,Ct=1/Ke(bt),_t=He(bt);this._rotating&&f.setBearing(c.G.number(y,O,tt)),this._pitching&&f.setPitch(c.G.number(M,U,tt)),this._rolling&&f.setRoll(c.G.number(C,G,tt)),this._padding&&(f.interpolatePadding(D,X,tt),ee=f.centerPoint.add($)),me.easeFunc(tt,Ct,_t,ee),this.terrain&&!t.freezeElevation&&this._updateElevation(tt),this._applyUpdatedTransform(f),this._fireMoveEvents(o)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(o)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,o){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,o)}return t||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(t,o,f){f.animate===!1||f.duration===0?(t(1),o()):(this._easeStart=fe(),this._easeOptions=f,this._onEaseFrame=t,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,o){t=c.W(t,-180,180);const f=Math.abs(t-o);return Math.abs(t-360-o)<f&&(t-=360),Math.abs(t+360-o)<f&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLat(c.V.convert(t)):null}}const Eo={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class wr{constructor(t=Eo){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=ce.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ce.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ce.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ce.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,o){const f=this._map._getUIString(`AttributionControl.${o}`);t.title=f,t.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((y=>typeof y!="string"?"":y))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const o=this._map.style.tileManagers;for(const y in o){const M=o[y];if(M.used||M.usedForTerrain){const C=M.getSource();C.attribution&&t.indexOf(C.attribution)<0&&t.push(C.attribution)}}t=t.filter((y=>String(y).trim())),t.sort(((y,M)=>y.length-M.length)),t=t.filter(((y,M)=>{for(let C=M+1;C<t.length;C++)if(t[C].indexOf(y)>=0)return!1;return!0}));const f=t.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,t.length?(this._innerContainer.innerHTML=ce.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ql{constructor(t={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const f=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=ce.create("div","maplibregl-ctrl");const o=ce.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ce.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class mn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const o=++this._id;return this._queue.push({callback:t,id:o,cancelled:!1}),o}remove(t){const o=this._currentlyRunning,f=o?this._queue.concat(o):this._queue;for(const y of f)if(y.id===t)return void(y.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const f of o)if(!f.cancelled&&(f.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ri=c.aV([{name:"a_pos3d",type:"Int16",components:3}]);class zn extends c.E{constructor(t){super(),this._lastTilesetChange=fe(),this.tileManager=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(t,o){this.tileManager.update(t,o),this._renderableTilesKeys=[];const f={};for(const y of nr(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o,calculateTileZoom:this.tileManager._source.calculateTileZoom}))f[y.key]=!0,this._renderableTilesKeys.push(y.key),this._tiles[y.key]||(y.terrainRttPosMatrix32f=new Float64Array(16),c.c8(y.terrainRttPosMatrix32f,0,c.a5,c.a5,0,0,1),this._tiles[y.key]=new mt(y,this.tileSize),this._lastTilesetChange=fe());for(const y in this._tiles)f[y]||delete this._tiles[y]}freeRtt(t){for(const o in this._tiles){const f=this._tiles[o];(!t||f.tileID.equals(t)||f.tileID.isChildOf(t)||t.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,o){return o?this._getTerrainCoordsForTileRanges(t,o):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const o={};for(const f of this._renderableTilesKeys){const y=this._tiles[f].tileID,M=t.clone(),C=c.bl();if(y.canonical.equals(t.canonical))c.c8(C,0,c.a5,c.a5,0,0,1);else if(y.canonical.isChildOf(t.canonical)){const D=y.canonical.z-t.canonical.z,O=y.canonical.x-(y.canonical.x>>D<<D),U=y.canonical.y-(y.canonical.y>>D<<D),G=c.a5>>D;c.c8(C,0,G,G,0,0,1),c.O(C,C,[-O*G,-U*G,0])}else{if(!t.canonical.isChildOf(y.canonical))continue;{const D=t.canonical.z-y.canonical.z,O=t.canonical.x-(t.canonical.x>>D<<D),U=t.canonical.y-(t.canonical.y>>D<<D),G=c.a5>>D;c.c8(C,0,c.a5,c.a5,0,0,1),c.O(C,C,[O*G,U*G,0]),c.Q(C,C,[1/2**D,1/2**D,0])}}M.terrainRttPosMatrix32f=new Float32Array(C),o[f]=M}return o}_getTerrainCoordsForTileRanges(t,o){const f={};for(const y of this._renderableTilesKeys){const M=this._tiles[y].tileID;if(!this._isWithinTileRanges(M,o))continue;const C=t.clone(),D=c.bl();if(M.canonical.z===t.canonical.z){const O=t.canonical.x-M.canonical.x,U=t.canonical.y-M.canonical.y;c.c8(D,0,c.a5,c.a5,0,0,1),c.O(D,D,[O*c.a5,U*c.a5,0])}else if(M.canonical.z>t.canonical.z){const O=M.canonical.z-t.canonical.z,U=M.canonical.x-(M.canonical.x>>O<<O),G=M.canonical.y-(M.canonical.y>>O<<O),X=t.canonical.x-(M.canonical.x>>O),$=t.canonical.y-(M.canonical.y>>O),ee=c.a5>>O;c.c8(D,0,ee,ee,0,0,1),c.O(D,D,[-U*ee+X*c.a5,-G*ee+$*c.a5,0])}else{const O=t.canonical.z-M.canonical.z,U=t.canonical.x-(t.canonical.x>>O<<O),G=t.canonical.y-(t.canonical.y>>O<<O),X=(t.canonical.x>>O)-M.canonical.x,$=(t.canonical.y>>O)-M.canonical.y,ee=c.a5<<O;c.c8(D,0,ee,ee,0,0,1),c.O(D,D,[U*c.a5+X*ee,G*c.a5+$*ee,0])}C.terrainRttPosMatrix32f=new Float32Array(D),f[y]=C}return f}getSourceTile(t,o){const f=this.tileManager._source;let y=t.overscaledZ-this.deltaZoom;if(y>f.maxzoom&&(y=f.maxzoom),y<f.minzoom)return;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(y).key);let M=this.findTileInCaches(this._sourceTileCache[t.key]);if(!M?.dem&&o)for(;y>=f.minzoom&&!M?.dem;)M=this.findTileInCaches(t.scaledTo(y--).key);return M}findTileInCaches(t){let o=this.tileManager.getTileByID(t);return o||(o=this.tileManager._outOfViewCache.getByKey(t),o)}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,o){return o[t.canonical.z]&&t.canonical.x>=o[t.canonical.z].minTileX&&t.canonical.x<=o[t.canonical.z].maxTileX&&t.canonical.y>=o[t.canonical.z].minTileY&&t.canonical.y<=o[t.canonical.z].maxTileY}}class or{constructor(t,o,f){this._meshCache={},this.painter=t,this.tileManager=new zn(o),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,o,f,y=c.a5){var M;if(!(o>=0&&o<y&&f>=0&&f<y))return 0;const C=this.getTerrainData(t),D=(M=C.tile)===null||M===void 0?void 0:M.dem;if(!D)return 0;const O=c.cD([],[o/y*c.a5,f/y*c.a5],C.u_terrain_matrix),U=[O[0]*D.dim,O[1]*D.dim],G=Math.floor(U[0]),X=Math.floor(U[1]),$=U[0]-G,ee=U[1]-X;return D.get(G,X)*(1-$)*(1-ee)+D.get(G+1,X)*$*(1-ee)+D.get(G,X+1)*(1-$)*ee+D.get(G+1,X+1)*$*ee}getElevationForLngLatZoom(t,o){if(!c.cE(o,t.wrap()))return 0;const{tileID:f,mercatorX:y,mercatorY:M}=this._getOverscaledTileIDFromLngLatZoom(t,o);return this.getElevation(f,y%c.a5,M%c.a5,c.a5)}getElevationForLngLat(t){return this.getElevationForLngLatZoom(t,this.tileManager.maxzoom)}getElevation(t,o,f,y=c.a5){return this.getDEMElevation(t,o,f,y)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const y=this.painter.context,M=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(y,M,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(y,new c.R({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.as([])}const o=this.tileManager.getSourceTile(t,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const y=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new c.T(y,o.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),o.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const f=o&&o+o.tileID.key+t.key;if(f&&!this._demMatrixCache[f]){const y=this.tileManager.getSource().maxzoom;let M=t.canonical.z-o.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=y?M=t.canonical.z-y:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const C=t.canonical.x-(t.canonical.x>>M<<M),D=t.canonical.y-(t.canonical.y>>M<<M),O=c.cF(new Float64Array(16),[1/(c.a5<<M),1/(c.a5<<M),0]);c.O(O,O,[C*c.a5,D*c.a5,0]),this._demMatrixCache[t.key]={matrix:O,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(t){const o=this.painter,f=o.width/devicePixelRatio,y=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(o.context,{width:f,height:y,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(o.context,{width:f,height:y,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(f,y,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,f,y))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let M=0,C=0;M<this._coordsTextureSize;M++)for(let D=0;D<this._coordsTextureSize;D++,C+=4)o[C+0]=255&D,o[C+1]=255&M,o[C+2]=D>>8<<4|M>>8,o[C+3]=0;const f=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),y=new c.T(t,f,t.gl.RGBA,{premultiply:!1});return y.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),f=this.painter.context,y=f.gl,M=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),C=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),D=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),y.readPixels(M,D-C-1,1,1,y.RGBA,y.UNSIGNED_BYTE,o),f.bindFramebuffer.set(null);const O=o[0]+(o[2]>>4<<8),U=o[1]+((15&o[2])<<8),G=this.coordsIndex[255-o[3]],X=G&&this.tileManager.getTileByID(G);if(!X)return null;const $=this._coordsTextureSize,ee=(1<<X.tileID.canonical.z)*$;return new c.ab((X.tileID.canonical.x*$+O)/ee+X.tileID.wrap,(X.tileID.canonical.y*$+U)/ee,this.getElevation(X.tileID,O,U,$))}depthAtPoint(t){const o=new Uint8Array(4),f=this.painter.context,y=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),y.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,y.RGBA,y.UNSIGNED_BYTE,o),f.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(t){var o;const f=((o=this.painter.style.projection)===null||o===void 0?void 0:o.transitionState)>0,y=f&&t.canonical.y===0,M=f&&t.canonical.y===(1<<t.canonical.z)-1,C=`m_${y?"n":""}_${M?"s":""}`;if(this._meshCache[C])return this._meshCache[C];const D=this.painter.context,O=new c.cG,U=new c.aZ,G=this.meshSize,X=c.a5/G,$=G*G;for(let we=0;we<=G;we++)for(let ke=0;ke<=G;ke++)O.emplaceBack(ke*X,we*X,0);for(let we=0;we<$;we+=G+1)for(let ke=0;ke<G;ke++)U.emplaceBack(ke+we,G+ke+we+1,G+ke+we+2),U.emplaceBack(ke+we,G+ke+we+2,ke+we+1);const ee=O.length,re=ee+(G+1),me=(G+1)*G,_e=y?c.bs:0,ye=y?0:1,ve=M?c.bt:c.a5,Se=M?0:1;for(let we=0;we<=G;we++)O.emplaceBack(we*X,_e,ye);for(let we=0;we<=G;we++)O.emplaceBack(we*X,ve,Se);for(let we=0;we<G;we++)U.emplaceBack(me+we,re+we,re+we+1),U.emplaceBack(me+we,re+we+1,me+we+1),U.emplaceBack(0+we,ee+we+1,ee+we),U.emplaceBack(0+we,0+we+1,ee+we+1);const be=O.length,Ce=be+2*(G+1);for(const we of[0,1])for(let ke=0;ke<=G;ke++)for(const Ke of[0,1])O.emplaceBack(we*c.a5,ke*X,Ke);for(let we=0;we<2*G;we+=2)U.emplaceBack(be+we,be+we+1,be+we+3),U.emplaceBack(be+we,be+we+3,be+we+2),U.emplaceBack(Ce+we,Ce+we+3,Ce+we+1),U.emplaceBack(Ce+we,Ce+we+2,Ce+we+3);const Ie=new fn(D.createVertexBuffer(O,ri.members),D.createIndexBuffer(U),c.aY.simpleSegment(0,0,O.length,U.length));return this._meshCache[C]=Ie,Ie}getMeshFrameDelta(t){return 2*Math.PI*c.bF/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,o){var f;if(!c.cE(o,t.wrap()))return 0;const{tileID:y}=this._getOverscaledTileIDFromLngLatZoom(t,o);return(f=this.getMinMaxElevation(y).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(t){const o=this.getTerrainData(t).tile,f={minElevation:null,maxElevation:null};return o&&o.dem&&(f.minElevation=o.dem.min*this.exaggeration,f.maxElevation=o.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(t,o){const f=c.ab.fromLngLat(t.wrap()),y=(1<<o)*c.a5,M=f.x*y,C=f.y*y,D=Math.floor(M/c.a5),O=Math.floor(C/c.a5);return{tileID:new c.a2(o,0,o,D,O),mercatorX:M,mercatorY:C}}}class lc{constructor(t,o,f){this._context=t,this._size=o,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(f.texture),{id:t,fbo:o,texture:f,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((o=>t.id!==o)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const Wo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class $l{constructor(t,o){this.painter=t,this.terrain=o,this.pool=new lc(t.context,30,o.tileManager.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=t._order.filter((f=>!t._layers[f].isHidden(o))),this._coordsAscending={};for(const f in t.tileManagers){this._coordsAscending[f]={};const y=t.tileManagers[f].getVisibleCoordinates(),M=t.tileManagers[f].getSource(),C=M instanceof Da?M.terrainTileRanges:null;for(const D of y){const O=this.terrain.tileManager.getTerrainCoords(D,C);for(const U in O)this._coordsAscending[f][U]||(this._coordsAscending[f][U]=[]),this._coordsAscending[f][U].push(O[U])}}this._coordsAscendingStr={};for(const f of t._order){const y=t._layers[f],M=y.source;if(Wo[y.type]&&!this._coordsAscendingStr[M]){this._coordsAscendingStr[M]={};for(const C in this._coordsAscending[M])this._coordsAscendingStr[M][C]=this._coordsAscending[M][C].map((D=>D.key)).sort().join()}}for(const f of this._renderableTiles)for(const y in this._coordsAscendingStr){const M=this._coordsAscendingStr[y][f.tileID.key];M&&M!==f.rttCoords[y]&&(f.rtt=[])}}renderLayer(t,o){if(t.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},o),{isRenderingToTexture:!0}),y=t.type,M=this.painter,C=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Wo[y]&&(this._prevType&&Wo[this._prevType]||this._stacks.push([]),this._prevType=y,this._stacks[this._stacks.length-1].push(t.id),!C))return!0;if(Wo[this._prevType]||Wo[y]&&C){this._prevType=y;const D=this._stacks.length-1,O=this._stacks[D]||[];for(const U of this._renderableTiles){if(this.pool.isFull()&&(Td(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(U),U.rtt[D]){const X=this.pool.getObjectForId(U.rtt[D].id);if(X.stamp===U.rtt[D].stamp){this.pool.useObject(X);continue}}const G=this.pool.getOrCreateFreeObject();this.pool.useObject(G),this.pool.stampObject(G),U.rtt[D]={id:G.id,stamp:G.stamp},M.context.bindFramebuffer.set(G.fbo.framebuffer),M.context.clear({color:c.bq.transparent,stencil:0}),M.currentStencilSource=void 0;for(let X=0;X<O.length;X++){const $=M.style._layers[O[X]],ee=$.source?this._coordsAscending[$.source][U.tileID.key]:[U.tileID];M.context.viewport.set([0,0,G.fbo.width,G.fbo.height]),M._renderTileClippingMasks($,ee,!0),M.renderLayer(M,M.style.tileManagers[$.source],$,ee,f),$.source&&(U.rttCoords[$.source]=this._coordsAscendingStr[$.source][U.tileID.key])}}return Td(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),Wo[y]}return!1}}const th={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Hl=k,Xl={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Eo,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},Ef={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class sr{constructor(t,o,f=!1){this.mousedown=M=>{this.startMove(M,ce.mousePos(this.element,M)),ce.addEventListener(window,"mousemove",this.mousemove),ce.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=M=>{this.move(M,ce.mousePos(this.element,M))},this.mouseup=M=>{this._rotatePitchHandler.dragEnd(M),this.offTemp()},this.touchstart=M=>{M.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ce.touchPos(this.element,M.targetTouches)[0],this.startMove(M,this._startPos),ce.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.addEventListener(window,"touchend",this.touchend))},this.touchmove=M=>{M.targetTouches.length!==1?this.reset():(this._lastPos=ce.touchPos(this.element,M.targetTouches)[0],this.move(M,this._lastPos))},this.touchend=M=>{M.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=o;const y=new Uh;this._rotatePitchHandler=new Yo({clickTolerance:3,move:(M,C)=>{const D=o.getBoundingClientRect(),O=new c.P((D.bottom-D.top)/2,(D.right-D.left)/2);return{bearingDelta:c.cy(new c.P(M.x,C.y),C,O),pitchDelta:f?-.5*(C.y-M.y):void 0}},moveStateManager:y,enable:!0,assignEvents:()=>{}}),this.map=t,ce.addEventListener(o,"mousedown",this.mousedown),ce.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),ce.addEventListener(o,"touchcancel",this.reset)}startMove(t,o){this._rotatePitchHandler.dragStart(t,o),ce.disableDrag()}move(t,o){const f=this.map,{bearingDelta:y,pitchDelta:M}=this._rotatePitchHandler.dragMove(t,o)||{};y&&f.setBearing(f.getBearing()+y),M&&f.setPitch(f.getPitch()+M)}off(){const t=this.element;ce.removeEventListener(t,"mousedown",this.mousedown),ce.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),ce.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.removeEventListener(window,"touchend",this.touchend),ce.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){ce.enableDrag(),ce.removeEventListener(window,"mousemove",this.mousemove),ce.removeEventListener(window,"mouseup",this.mouseup),ce.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.removeEventListener(window,"touchend",this.touchend)}}let Bs;function ih(b,t,o,f=!1){if(f||!o.getCoveringTilesDetailsProvider().allowWorldCopies())return b?.wrap();const y=new c.V(b.lng,b.lat);if(b=new c.V(b.lng,b.lat),t){const M=new c.V(b.lng-360,b.lat),C=new c.V(b.lng+360,b.lat),D=o.locationToScreenPoint(b).distSqr(t);o.locationToScreenPoint(M).distSqr(t)<D?b=M:o.locationToScreenPoint(C).distSqr(t)<D&&(b=C)}for(;Math.abs(b.lng-o.center.lng)>180;){const M=o.locationToScreenPoint(b);if(M.x>=0&&M.y>=0&&M.x<=o.width&&M.y<=o.height)break;b.lng>o.center.lng?b.lng-=360:b.lng+=360}return b.lng!==y.lng&&o.isPointOnMapSurface(o.locationToScreenPoint(b))?b:y}const nh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Zh(b,t,o){const f=b.classList;for(const y in nh)f.remove(`maplibregl-${o}-anchor-${y}`);f.add(`maplibregl-${o}-anchor-${t}`)}class qh extends c.E{constructor(t){if(super(),this._onKeyPress=o=>{const f=o.code,y=o.charCode||o.keyCode;f!=="Space"&&f!=="Enter"&&y!==32&&y!==13||this.togglePopup()},this._onMapClick=o=>{const f=o.originalEvent.target,y=this._element;this._popup&&(f===y||y.contains(f))&&this.togglePopup()},this._update=o=>{if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();(o?.type==="terrain"||o?.type==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=ih(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let M="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?M="rotateX(0deg)":this._pitchAlignment==="map"&&(M=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),ce.setTransform(this._element,`${nh[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${M} ${y}`),ue.frameAsync(new AbortController).then((()=>{this._updateOpacity(o&&o.type==="moveend")})).catch((()=>{}))},this._onMove=o=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=c.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=ce.create("div");const o=ce.createNS("http://www.w3.org/2000/svg","svg"),f=41,y=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${f}px`),o.setAttributeNS(null,"width",`${y}px`),o.setAttributeNS(null,"viewBox",`0 0 ${y} ${f}`);const M=ce.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"stroke","none"),M.setAttributeNS(null,"stroke-width","1"),M.setAttributeNS(null,"fill","none"),M.setAttributeNS(null,"fill-rule","evenodd");const C=ce.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill-rule","nonzero");const D=ce.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"transform","translate(3.0, 29.0)"),D.setAttributeNS(null,"fill","#000000");const O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ye of O){const ve=ce.createNS("http://www.w3.org/2000/svg","ellipse");ve.setAttributeNS(null,"opacity","0.04"),ve.setAttributeNS(null,"cx","10.5"),ve.setAttributeNS(null,"cy","5.80029008"),ve.setAttributeNS(null,"rx",ye.rx),ve.setAttributeNS(null,"ry",ye.ry),D.appendChild(ve)}const U=ce.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"fill",this._color);const G=ce.createNS("http://www.w3.org/2000/svg","path");G.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),U.appendChild(G);const X=ce.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"opacity","0.25"),X.setAttributeNS(null,"fill","#000000");const $=ce.createNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),X.appendChild($);const ee=ce.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ee.setAttributeNS(null,"fill","#FFFFFF");const re=ce.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"transform","translate(8.0, 8.0)");const me=ce.createNS("http://www.w3.org/2000/svg","circle");me.setAttributeNS(null,"fill","#000000"),me.setAttributeNS(null,"opacity","0.25"),me.setAttributeNS(null,"cx","5.5"),me.setAttributeNS(null,"cy","5.5"),me.setAttributeNS(null,"r","5.4999962");const _e=ce.createNS("http://www.w3.org/2000/svg","circle");_e.setAttributeNS(null,"fill","#FFFFFF"),_e.setAttributeNS(null,"cx","5.5"),_e.setAttributeNS(null,"cy","5.5"),_e.setAttributeNS(null,"r","5.4999962"),re.appendChild(me),re.appendChild(_e),C.appendChild(D),C.appendChild(U),C.appendChild(X),C.appendChild(ee),C.appendChild(re),o.appendChild(C),o.setAttributeNS(null,"height",f*this._scale+"px"),o.setAttributeNS(null,"width",y*this._scale+"px"),this._element.appendChild(o),this._offset=c.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(o=>{o.preventDefault()})),this._element.addEventListener("mousedown",(o=>{o.preventDefault()})),Zh(this._element,this._anchor,"marker"),t&&t.className)for(const o of t.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ce.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=c.V.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const y=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var o,f;const y=(o=this._map)===null||o===void 0?void 0:o.terrain,M=this._map.transform.isLocationOccluded(this._lngLat);if(!y||M){const ee=M?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==ee&&(this._element.style.opacity=ee))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const C=this._map,D=C.terrain.depthAtPoint(this._pos),O=C.terrain.getElevationForLngLat(this._lngLat);if(C.transform.lngLatToCameraDepth(this._lngLat,O)-D<.006)return void(this._element.style.opacity=this._opacity);const U=-this._offset.y/C.transform.pixelsPerMeter,G=Math.sin(C.getPitch()*Math.PI/180)*U,X=C.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),$=C.transform.lngLatToCameraDepth(this._lngLat,O+G)-X>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&$&&this._popup.remove(),this._element.style.opacity=$?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=c.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,o){return(this._opacity===void 0||t===void 0&&o===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const $h={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Yl=0,Wl=!1;const Pa={maxWidth:100,unit:"metric"};function Jn(b,t,o){const f=o&&o.maxWidth||100,y=b._container.clientHeight/2,M=b._container.clientWidth/2,C=b.unproject([M-f/2,y]),D=b.unproject([M+f/2,y]),O=Math.round(b.project(D).x-b.project(C).x),U=Math.min(f,O,b._container.clientWidth),G=C.distanceTo(D);if(o&&o.unit==="imperial"){const X=3.2808*G;X>5280?gl(t,U,X/5280,b._getUIString("ScaleControl.Miles")):gl(t,U,X,b._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?gl(t,U,G/1852,b._getUIString("ScaleControl.NauticalMiles")):G>=1e3?gl(t,U,G/1e3,b._getUIString("ScaleControl.Kilometers")):gl(t,U,G,b._getUIString("ScaleControl.Meters"))}function gl(b,t,o,f){const y=(function(M){const C=Math.pow(10,`${Math.floor(M)}`.length-1);let D=M/C;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:(function(O){const U=Math.pow(10,Math.ceil(-Math.log(O)/Math.LN10));return Math.round(O*U)/U})(D),C*D})(o);b.style.width=t*(y/o)+"px",b.innerHTML=`${y}&nbsp;${f}`}const uc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},rh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ah(b){if(b){if(typeof b=="number"){const t=Math.round(Math.abs(b)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,b),"top-left":new c.P(t,t),"top-right":new c.P(-t,t),bottom:new c.P(0,-b),"bottom-left":new c.P(t,-t),"bottom-right":new c.P(-t,-t),left:new c.P(b,0),right:new c.P(-b,0)}}if(b instanceof c.P||Array.isArray(b)){const t=c.P.convert(b);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:c.P.convert(b.center||[0,0]),top:c.P.convert(b.top||[0,0]),"top-left":c.P.convert(b["top-left"]||[0,0]),"top-right":c.P.convert(b["top-right"]||[0,0]),bottom:c.P.convert(b.bottom||[0,0]),"bottom-left":c.P.convert(b["bottom-left"]||[0,0]),"bottom-right":c.P.convert(b["bottom-right"]||[0,0]),left:c.P.convert(b.left||[0,0]),right:c.P.convert(b.right||[0,0])}}return ah(new c.P(0,0))}const Fs=k;w.AJAXError=c.cJ,w.Event=c.l,w.Evented=c.E,w.LngLat=c.V,w.MercatorCoordinate=c.ab,w.Point=c.P,w.addProtocol=c.cK,w.config=c.c,w.removeProtocol=c.cL,w.AttributionControl=wr,w.BoxZoomHandler=Fh,w.CanvasSource=ne,w.CooperativeGesturesHandler=fo,w.DoubleClickZoomHandler=Sf,w.DragPanHandler=Jt,w.DragRotateHandler=ai,w.EdgeInsets=Ma,w.FullscreenControl=class extends c.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var t;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=o?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ce.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=ce.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ce.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},w.GeoJSONSource=Rr,w.GeolocateControl=class extends c.E{constructor(b){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const o=new c.V(t.coords.longitude,t.coords.latitude),f=t.coords.accuracy,y=this._map.getBearing(),M=c.e({bearing:y},this.options.fitBoundsOptions),C=Cn.fromLngLat(o,f);this._map.fitBounds(C,M,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const o=new c.V(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Wl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=ce.create("button","maplibregl-ctrl-geolocate",this._container),ce.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ce.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new qh({element:this._dotElement}),this._circleElement=ce.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new qh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(o=>{const f=o?.[0]instanceof ResizeObserverEntry;o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))}))}},this.options=c.e({},$h,b)}onAdd(b){return this._map=b,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return c._(this,arguments,void 0,(function*(t=!1){if(Bs!==void 0&&!t)return Bs;if(window.navigator.permissions===void 0)return Bs=!!window.navigator.geolocation,Bs;try{Bs=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Bs=!!window.navigator.geolocation}return Bs}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ce.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Yl=0,Wl=!1}_isOutOfMapMaxBounds(b){const t=this._map.getMaxBounds(),o=b.coords;return t&&(o.longitude<t.getWest()||o.longitude>t.getEast()||o.latitude<t.getSouth()||o.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const b=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&b))return;const t=this._map.project(b),o=this._map.unproject([t.x+100,t.y]),f=b.distanceTo(o)/100,y=2*this._accuracy/f;this._circleElement.style.width=`${y.toFixed(2)}px`,this._circleElement.style.height=`${y.toFixed(2)}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Yl--,Wl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Yl++,Yl>1?(b={maximumAge:6e5,timeout:0},Wl=!0):(b=this.options.positionOptions,Wl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},w.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const t=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=ce.create("button","maplibregl-ctrl-globe",this._container),ce.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){ce.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},w.Hash=ar,w.ImageSource=Da,w.KeyboardHandler=ac,w.LngLatBounds=Cn,w.LogoControl=ql,w.Map=class extends Iu{constructor(b){var t,o;c.cH.mark(c.cI.create);const f=Object.assign(Object.assign(Object.assign({},Xl),b),{canvasContextAttributes:Object.assign(Object.assign({},Xl.canvasContextAttributes),b.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const y=new pr,M=new Pi;if(f.minZoom!==void 0&&y.setMinZoom(f.minZoom),f.maxZoom!==void 0&&y.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&y.setMinPitch(f.minPitch),f.maxPitch!==void 0&&y.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&y.setRenderWorldCopies(f.renderWorldCopies),f.transformConstrain!==null&&y.setConstrainOverride(f.transformConstrain),super(y,M,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new mn,this._controls=[],this._mapId=c.ah(),this._lostContextStyle={style:null,images:null},this._contextLost=D=>{D.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const O of Object.values(this.style._layers))if(O.type==="custom"&&console.warn(`Custom layer with id '${O.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),O._listeners)for(const[U]of Object.entries(O._listeners))console.warn(`Custom layer with id '${O.id}' had event listeners for event '${U}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new c.l("webglcontextlost",{originalEvent:D}))},this._contextRestored=D=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:D}))},this._onMapScroll=D=>{if(D.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},th),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this._zoomLevelsToOverscale=f.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=f.transformCameraUpdate,this.transformConstrain=f.transformConstrain,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,f.reduceMotion!==void 0&&(ue.prefersReducedMotion=f.reduceMotion),this._imageQueueHandle=Qe.addThrottleControl((()=>this.isMoving())),this._requestManager=new Et(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let D=!1;const O=wf((U=>{this._trackResize&&!this._removed&&(this.resize(U),this.redraw())}),50);this._resizeObserver=new ResizeObserver((U=>{D?O(U):D=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Mf(this,f),this._hash=f.hash&&new ar(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,c.e({},f.fitBoundsOptions,{duration:0}))));const C=typeof f.style=="string"||((o=(t=f.style)===null||t===void 0?void 0:t.projection)===null||o===void 0?void 0:o.type)!=="globe";this.resize(null,C),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new wr(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new ql,f.logoPosition),this.on("style.load",(()=>{if(C||this._resizeTransform(),this.transform.unmodified){const D=c.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(D)}})),this.on("data",(D=>{this._update(D.dataType==="style"),this.fire(new c.l(`${D.dataType}data`,D))})),this.on("dataloading",(D=>{this.fire(new c.l(`${D.dataType}dataloading`,D))})),this.on("dataabort",(D=>{this.fire(new c.l("sourcedataabort",D))}))}_getMapId(){return this._mapId}setGlobalStateProperty(b,t){return this.style.setGlobalStateProperty(b,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,t){if(t===void 0&&(t=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=b.onAdd(this);this._controls.push(b);const f=this._controlPositions[t];return t.indexOf("bottom")!==-1?f.insertBefore(o,f.firstChild):f.appendChild(o),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(b);return t>-1&&this._controls.splice(t,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}coveringTiles(b){return nr(this.transform,b)}calculateCameraOptionsFromTo(b,t,o,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLat(o)),super.calculateCameraOptionsFromTo(b,t,o,f)}resize(b,t=!0){const[o,f]=this._containerDimensions(),y=this._getClampedPixelRatio(o,f);if(this._resizeCanvas(o,f,y),this.painter.resize(o,f,y),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const D=this._getClampedPixelRatio(o,f);this._resizeCanvas(o,f,D),this.painter.resize(o,f,D)}this._resizeTransform(t);const M=!this._moving;return M&&(this.stop(),this.fire(new c.l("movestart",b)).fire(new c.l("move",b))),this.fire(new c.l("resize",b)),M&&this.fire(new c.l("moveend",b)),this}_resizeTransform(b=!0){var t;const[o,f]=this._containerDimensions();this.transform.resize(o,f,b),(t=this._requestedCameraState)===null||t===void 0||t.resize(o,f,b)}_getClampedPixelRatio(b,t){const{0:o,1:f}=this._maxCanvasSize,y=this.getPixelRatio(),M=b*y,C=t*y;return Math.min(M>o?o/M:1,C>f?f/C:1)*y}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(Cn.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}setTransformConstrain(b){return this.transform.setConstrainOverride(b),this._update()}project(b){return this.transform.locationToScreenPoint(c.V.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(c.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,t,o){if(b==="mouseenter"||b==="mouseover"){let f=!1;return{layers:t,listener:o,delegates:{mousemove:M=>{const C=t.filter((O=>this.getLayer(O))),D=C.length!==0?this.queryRenderedFeatures(M.point,{layers:C}):[];D.length?f||(f=!0,o.call(this,new Mo(b,this,M.originalEvent,{features:D}))):f=!1},mouseout:()=>{f=!1}}}}if(b==="mouseleave"||b==="mouseout"){let f=!1;return{layers:t,listener:o,delegates:{mousemove:C=>{const D=t.filter((O=>this.getLayer(O)));(D.length!==0?this.queryRenderedFeatures(C.point,{layers:D}):[]).length?f=!0:f&&(f=!1,o.call(this,new Mo(b,this,C.originalEvent)))},mouseout:C=>{f&&(f=!1,o.call(this,new Mo(b,this,C.originalEvent)))}}}}{const f=y=>{const M=t.filter((D=>this.getLayer(D))),C=M.length!==0?this.queryRenderedFeatures(y.point,{layers:M}):[];C.length&&(y.features=C,o.call(this,y),delete y.features)};return{layers:t,listener:o,delegates:{[b]:f}}}}_saveDelegatedListener(b,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(t)}_removeDelegatedListener(b,t,o){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const f=this._delegatedListeners[b];for(let y=0;y<f.length;y++){const M=f[y];if(M.listener===o&&M.layers.length===t.length&&M.layers.every((C=>t.includes(C)))){for(const C in M.delegates)this.off(C,M.delegates[C]);return void f.splice(y,1)}}}on(b,t,o){if(o===void 0)return super.on(b,t);const f=typeof t=="string"?[t]:t,y=this._createDelegatedListener(b,f,o);this._saveDelegatedListener(b,y);for(const M in y.delegates)this.on(M,y.delegates[M]);return{unsubscribe:()=>{this._removeDelegatedListener(b,f,o)}}}once(b,t,o){if(o===void 0)return super.once(b,t);const f=typeof t=="string"?[t]:t,y=this._createDelegatedListener(b,f,o);for(const M in y.delegates){const C=y.delegates[M];y.delegates[M]=(...D)=>{this._removeDelegatedListener(b,f,o),C(...D)}}this._saveDelegatedListener(b,y);for(const M in y.delegates)this.once(M,y.delegates[M]);return this}off(b,t,o){return o===void 0?super.off(b,t):(this._removeDelegatedListener(b,typeof t=="string"?[t]:t,o),this)}queryRenderedFeatures(b,t){if(!this.style)return[];let o;const f=b instanceof c.P||Array.isArray(b),y=f?b:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(f?{}:b)||{},y instanceof c.P||typeof y[0]=="number")o=[c.P.convert(y)];else{const M=c.P.convert(y[0]),C=c.P.convert(y[1]);o=[M,new c.P(C.x,M.y),C,new c.P(M.x,C.y),M]}return this.style.queryRenderedFeatures(o,t,this.transform)}querySourceFeatures(b,t){return this.style.querySourceFeatures(b,t)}setStyle(b,t){return(t=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(b,t))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const t=this._locale[b];if(t==null)throw new Error(`Missing UI string '${b}'`);return t}_updateStyle(b,t){var o,f;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(b,t)));const y=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new hs(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,t,y):this.style.loadJSON(b,t,y),this):((f=(o=this.style)===null||o===void 0?void 0:o.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new hs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,t){if(typeof b=="string"){const o=this._requestManager.transformRequest(b,"Style");c.j(o,new AbortController).then((f=>{this._updateDiff(f.data,t)})).catch((f=>{f&&this.fire(new c.k(f))}))}else typeof b=="object"&&this._updateDiff(b,t)}_updateDiff(b,t){try{this.style.setState(b,t)&&this._update(!0)}catch(o){c.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(b,t)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(b,t){return this._lazyInitEmptyStyle(),this.style.addSource(b,t),this._update(!0)}isSourceLoaded(b){const t=this.style&&this.style.tileManagers[b];if(t!==void 0)return t.loaded();this.fire(new c.k(new Error(`There is no tile manager with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const t=this.style.tileManagers[b.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&t.reload();for(const o in this.style._layers){const f=this.style._layers[o];f.type==="hillshade"&&f.source===b.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),f.type==="color-relief"&&f.source===b.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new or(this.painter,t,b),this.painter.renderToTexture=new $l(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=o=>{var f;o.dataType==="style"?this.terrain.tileManager.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((f=o.source)===null||f===void 0?void 0:f.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:b})),this}getTerrain(){var b,t;return(t=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const b=this.style&&this.style.tileManagers;for(const t of Object.values(b))if(!t.areTilesLoaded())return!1;return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,t,o){if(o){const f=this.getSource(o);if(!f)throw new Error(`There is no source with ID "${o}", cannot set LOD parameters`);f.calculateTileZoom=un(Math.max(1,b),Math.max(1,t))}else for(const f in this.style.tileManagers)this.style.tileManagers[f].getSource().calculateTileZoom=un(Math.max(1,b),Math.max(1,t));return this._update(!0),this}refreshTiles(b,t){const o=this.style.tileManagers[b];if(!o)throw new Error(`There is no tile manager with ID "${b}", cannot refresh tile`);t===void 0?o.reload(!0):o.refreshTiles(t.map((f=>new c.ae(f.z,f.x,f.y))))}addImage(b,t,o={}){const{pixelRatio:f=1,sdf:y=!1,stretchX:M,stretchY:C,content:D,textFitWidth:O,textFitHeight:U}=o;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||c.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:G,height:X,data:$}=t,ee=t;return this.style.addImage(b,{data:new c.R({width:G,height:X},new Uint8Array($)),pixelRatio:f,stretchX:M,stretchY:C,content:D,textFitWidth:O,textFitHeight:U,sdf:y,version:0,userImage:ee}),ee.onAdd&&ee.onAdd(this,b),this}}{const{width:G,height:X,data:$}=ue.getImageData(t);this.style.addImage(b,{data:new c.R({width:G,height:X},$),pixelRatio:f,stretchX:M,stretchY:C,content:D,textFitWidth:O,textFitHeight:U,sdf:y,version:0})}}updateImage(b,t){const o=this.style.getImage(b);if(!o)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=t instanceof HTMLImageElement||c.b(t)?ue.getImageData(t):t,{width:y,height:M,data:C}=f;if(y===void 0||M===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==o.data.width||M!==o.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const D=!(t instanceof HTMLImageElement||c.b(t));return o.data.replace(C,D),this.style.updateImage(b,o),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return Qe.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,t){return this._lazyInitEmptyStyle(),this.style.addLayer(b,t),this._update(!0)}moveLayer(b,t){return this.style.moveLayer(b,t),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,t,o){return this.style.setLayerZoomRange(b,t,o),this._update(!0)}setFilter(b,t,o={}){return this.style.setFilter(b,t,o),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,t,o,f={}){return this.style.setPaintProperty(b,t,o,f),this._update(!0)}getPaintProperty(b,t){return this.style.getPaintProperty(b,t)}setLayoutProperty(b,t,o,f={}){return this.style.setLayoutProperty(b,t,o,f),this._update(!0)}getLayoutProperty(b,t){return this.style.getLayoutProperty(b,t)}setGlyphs(b,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,t,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,t,o,(f=>{f||this._update(!0)})),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,t,(o=>{o||this._update(!0)})),this}setLight(b,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,t){return this.style.setFeatureState(b,t),this._update()}removeFeatureState(b,t){return this.style.removeFeatureState(b,t),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,t=0;return this._container&&(b=this._container.clientWidth||400,t=this._container.clientHeight||300),[b,t]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const t=this._canvasContainer=ce.create("div","maplibregl-canvas-container",b);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=ce.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),f=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],f);const y=this._controlContainer=ce.create("div","maplibregl-control-container",b),M=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((C=>{M[C]=ce.create("div",`maplibregl-ctrl-${C} `,y)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,t,o){this._canvas.width=Math.floor(o*b),this._canvas.height=Math.floor(o*t),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(f=>{t={requestedAttributes:b},f&&(t.statusMessage=f.statusMessage,t.type=f.type)}),{once:!0});let o=null;if(o=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!o){const f="Failed to initialize WebGL";throw t?(t.message=f,new Error(JSON.stringify(t))):new Error(f)}this.painter=new Op(o,this.transform),qe.testSupport(o)}migrateProjection(b,t){super.migrateProjection(b,t),this.painter.transform=b,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var t,o,f,y,M;const C=this._idleTriggered?this._fadeDuration:0,D=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let O=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const X=this.transform.zoom,$=fe();this.style.zoomHistory.update(X,$);const ee=new c.H(X,{now:$,fadeDuration:C,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),re=ee.crossFadingFactor();re===1&&re===this._crossFadingFactor||(O=!0,this._crossFadingFactor=re),this.style.update(ee)}const U=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0!==D;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((y=this.style.projection)===null||y===void 0?void 0:y.transitionState,(M=this.style.projection)===null||M===void 0?void 0:M.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||U)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,C,this._crossSourceCollisions,U),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:C,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cH.mark(c.cI.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||O)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const G=this._sourcesDirty||this._styleDirty||this._placementDirty;return G||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||G||(this._fullyLoaded=!0,c.cH.mark(c.cI.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Qe.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ce.remove(this._canvasContainer),ce.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cH.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ue.frame(this._frameRequest,(b=>{c.cH.frame(b),this._frameRequest=null;try{this._render(b)}catch(t){if(!c.Z(t)&&!(function(o){return o.message===j})(t))throw t}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return Hl}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},w.MapMouseEvent=Mo,w.MapTouchEvent=ks,w.MapWheelEvent=Bh,w.Marker=qh,w.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const t=this._map.getZoom(),o=t===this._map.getMaxZoom(),f=t===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,o)=>{const f=this._map._getUIString(`NavigationControl.${o}`);t.title=f,t.setAttribute("aria-label",f)},this.options=c.e({},Ef,b),this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),ce.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),ce.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=ce.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new sr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ce.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,t){const o=ce.create("button",b,this._container);return o.type="button",o.addEventListener("click",t),o}},w.Popup=class extends c.E{constructor(b){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&ce.remove(this._content),this._container&&(ce.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ce.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ce.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const C of this.options.className.split(" "))this._container.classList.add(C);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=ih(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const o=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const y=ah(this.options.offset);if(!f){const C=this._container.offsetWidth,D=this._container.offsetHeight;let O;O=o.y+y.bottom.y<D?["top"]:o.y>this._map.transform.height-D?["bottom"]:[],o.x<C/2?O.push("left"):o.x>this._map.transform.width-C/2&&O.push("right"),f=O.length===0?"bottom":O.join("-")}let M=o.add(y[f]);this.options.subpixelPositioning||(M=M.round()),ce.setTransform(this._container,`${nh[f]} translate(${M.x}px,${M.y}px)`),Zh(this._container,f,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(uc),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=c.V.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const t=document.createDocumentFragment(),o=document.createElement("body");let f;for(o.innerHTML=b;f=o.firstChild,f;)t.appendChild(f);return this.setDOMContent(t)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ce.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=ce.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(rh);b&&b.focus()}},w.RasterDEMTileSource=no,w.RasterTileSource=Oo,w.ScaleControl=class{constructor(b){this._onMove=()=>{Jn(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Jn(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Pa),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ce.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},w.ScrollZoomHandler=Pd,w.Style=hs,w.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ce.create("button","maplibregl-ctrl-terrain",this._container),ce.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ce.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},w.TwoFingersTouchPitchHandler=Zl,w.TwoFingersTouchRotateHandler=Os,w.TwoFingersTouchZoomHandler=Gl,w.TwoFingersTouchZoomRotateHandler=zu,w.VectorTileSource=ko,w.VideoSource=Ve,w.addSourceType=(b,t)=>c._(void 0,void 0,void 0,(function*(){if(de(b))throw new Error(`A source type called "${b}" already exists.`);((o,f)=>{ie[o]=f})(b,t)})),w.clearPrewarmedResources=function(){const b=fi;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(zt),fi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},w.createTileMesh=Uc,w.getMaxParallelImageRequests=function(){return c.c.MAX_PARALLEL_IMAGE_REQUESTS},w.getRTLTextPluginStatus=function(){return je().getRTLTextPluginStatus()},w.getVersion=function(){return Fs},w.getWorkerCount=function(){return Dt.workerCount},w.getWorkerUrl=function(){return c.c.WORKER_URL},w.importScriptInWorkers=function(b){return _o().broadcast("IS",b)},w.isTimeFrozen=function(){return ge.isFrozen()},w.now=fe,w.prewarm=function(){rn().acquire(zt)},w.restoreNow=function(){ge.restoreNow()},w.setMaxParallelImageRequests=function(b){c.c.MAX_PARALLEL_IMAGE_REQUESTS=b},w.setNow=function(b){ge.setNow(b)},w.setRTLTextPlugin=function(b,t){return je().setRTLTextPlugin(b,t)},w.setWorkerCount=function(b){Dt.workerCount=b},w.setWorkerUrl=function(b){c.c.WORKER_URL=b}}));var A=h;return A}))})(iv)),iv.exports}var FC=BC();const si=Ry(FC),B2="3.7.8",NC=B2,Wm=typeof Buffer=="function",R1=typeof TextDecoder=="function"?new TextDecoder:void 0,k1=typeof TextEncoder=="function"?new TextEncoder:void 0,jC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",hy=Array.prototype.slice.call(jC),H_=(s=>{let a={};return s.forEach((h,g)=>a[h]=g),a})(hy),UC=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,rs=String.fromCharCode.bind(String),O1=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):s=>new Uint8Array(Array.prototype.slice.call(s,0)),F2=s=>s.replace(/=/g,"").replace(/[+\/]/g,a=>a=="+"?"-":"_"),N2=s=>s.replace(/[^A-Za-z0-9\+\/]/g,""),j2=s=>{let a,h,g,S,A="";const w=s.length%3;for(let c=0;c<s.length;){if((h=s.charCodeAt(c++))>255||(g=s.charCodeAt(c++))>255||(S=s.charCodeAt(c++))>255)throw new TypeError("invalid character found");a=h<<16|g<<8|S,A+=hy[a>>18&63]+hy[a>>12&63]+hy[a>>6&63]+hy[a&63]}return w?A.slice(0,w-3)+"===".substring(w):A},lx=typeof btoa=="function"?s=>btoa(s):Wm?s=>Buffer.from(s,"binary").toString("base64"):j2,lb=Wm?s=>Buffer.from(s).toString("base64"):s=>{let h=[];for(let g=0,S=s.length;g<S;g+=4096)h.push(rs.apply(null,s.subarray(g,g+4096)));return lx(h.join(""))},nv=(s,a=!1)=>a?F2(lb(s)):lb(s),VC=s=>{if(s.length<2){var a=s.charCodeAt(0);return a<128?s:a<2048?rs(192|a>>>6)+rs(128|a&63):rs(224|a>>>12&15)+rs(128|a>>>6&63)+rs(128|a&63)}else{var a=65536+(s.charCodeAt(0)-55296)*1024+(s.charCodeAt(1)-56320);return rs(240|a>>>18&7)+rs(128|a>>>12&63)+rs(128|a>>>6&63)+rs(128|a&63)}},GC=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,U2=s=>s.replace(GC,VC),B1=Wm?s=>Buffer.from(s,"utf8").toString("base64"):k1?s=>lb(k1.encode(s)):s=>lx(U2(s)),Nm=(s,a=!1)=>a?F2(B1(s)):B1(s),F1=s=>Nm(s,!0),ZC=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,qC=s=>{switch(s.length){case 4:var a=(7&s.charCodeAt(0))<<18|(63&s.charCodeAt(1))<<12|(63&s.charCodeAt(2))<<6|63&s.charCodeAt(3),h=a-65536;return rs((h>>>10)+55296)+rs((h&1023)+56320);case 3:return rs((15&s.charCodeAt(0))<<12|(63&s.charCodeAt(1))<<6|63&s.charCodeAt(2));default:return rs((31&s.charCodeAt(0))<<6|63&s.charCodeAt(1))}},V2=s=>s.replace(ZC,qC),G2=s=>{if(s=s.replace(/\s+/g,""),!UC.test(s))throw new TypeError("malformed base64.");s+="==".slice(2-(s.length&3));let a,h,g,S=[];for(let A=0;A<s.length;)a=H_[s.charAt(A++)]<<18|H_[s.charAt(A++)]<<12|(h=H_[s.charAt(A++)])<<6|(g=H_[s.charAt(A++)]),h===64?S.push(rs(a>>16&255)):g===64?S.push(rs(a>>16&255,a>>8&255)):S.push(rs(a>>16&255,a>>8&255,a&255));return S.join("")},ux=typeof atob=="function"?s=>atob(N2(s)):Wm?s=>Buffer.from(s,"base64").toString("binary"):G2,Z2=Wm?s=>O1(Buffer.from(s,"base64")):s=>O1(ux(s).split("").map(a=>a.charCodeAt(0))),q2=s=>Z2($2(s)),$C=Wm?s=>Buffer.from(s,"base64").toString("utf8"):R1?s=>R1.decode(Z2(s)):s=>V2(ux(s)),$2=s=>N2(s.replace(/[-_]/g,a=>a=="-"?"+":"/")),ub=s=>$C($2(s)),HC=s=>{if(typeof s!="string")return!1;const a=s.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(a)||!/[^\s0-9a-zA-Z\-_]/.test(a)},H2=s=>({value:s,enumerable:!1,writable:!0,configurable:!0}),X2=function(){const s=(a,h)=>Object.defineProperty(String.prototype,a,H2(h));s("fromBase64",function(){return ub(this)}),s("toBase64",function(a){return Nm(this,a)}),s("toBase64URI",function(){return Nm(this,!0)}),s("toBase64URL",function(){return Nm(this,!0)}),s("toUint8Array",function(){return q2(this)})},Y2=function(){const s=(a,h)=>Object.defineProperty(Uint8Array.prototype,a,H2(h));s("toBase64",function(a){return nv(this,a)}),s("toBase64URI",function(){return nv(this,!0)}),s("toBase64URL",function(){return nv(this,!0)})},XC=()=>{X2(),Y2()},YC={version:B2,VERSION:NC,atob:ux,atobPolyfill:G2,btoa:lx,btoaPolyfill:j2,fromBase64:ub,toBase64:Nm,encode:Nm,encodeURI:F1,encodeURL:F1,utob:U2,btou:V2,decode:ub,isValid:HC,fromUint8Array:nv,toUint8Array:q2,extendString:X2,extendUint8Array:Y2,extendBuiltins:XC};var X_={exports:{}},N1;function WC(){if(N1)return X_.exports;N1=1;var s=typeof Reflect=="object"?Reflect:null,a=s&&typeof s.apply=="function"?s.apply:function(Pe,$e,Qe){return Function.prototype.apply.call(Pe,$e,Qe)},h;s&&typeof s.ownKeys=="function"?h=s.ownKeys:Object.getOwnPropertySymbols?h=function(Pe){return Object.getOwnPropertyNames(Pe).concat(Object.getOwnPropertySymbols(Pe))}:h=function(Pe){return Object.getOwnPropertyNames(Pe)};function g(Be){console&&console.warn&&console.warn(Be)}var S=Number.isNaN||function(Pe){return Pe!==Pe};function A(){A.init.call(this)}X_.exports=A,X_.exports.once=qe,A.EventEmitter=A,A.prototype._events=void 0,A.prototype._eventsCount=0,A.prototype._maxListeners=void 0;var w=10;function c(Be){if(typeof Be!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Be)}Object.defineProperty(A,"defaultMaxListeners",{enumerable:!0,get:function(){return w},set:function(Be){if(typeof Be!="number"||Be<0||S(Be))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Be+".");w=Be}}),A.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},A.prototype.setMaxListeners=function(Pe){if(typeof Pe!="number"||Pe<0||S(Pe))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Pe+".");return this._maxListeners=Pe,this};function k(Be){return Be._maxListeners===void 0?A.defaultMaxListeners:Be._maxListeners}A.prototype.getMaxListeners=function(){return k(this)},A.prototype.emit=function(Pe){for(var $e=[],Qe=1;Qe<arguments.length;Qe++)$e.push(arguments[Qe]);var Et=Pe==="error",Ut=this._events;if(Ut!==void 0)Et=Et&&Ut.error===void 0;else if(!Et)return!1;if(Et){var $t;if($e.length>0&&($t=$e[0]),$t instanceof Error)throw $t;var hi=new Error("Unhandled error."+($t?" ("+$t.message+")":""));throw hi.context=$t,hi}var li=Ut[Pe];if(li===void 0)return!1;if(typeof li=="function")a(li,this,$e);else for(var nn=li.length,Ci=ge(li,nn),Qe=0;Qe<nn;++Qe)a(Ci[Qe],this,$e);return!0};function N(Be,Pe,$e,Qe){var Et,Ut,$t;if(c($e),Ut=Be._events,Ut===void 0?(Ut=Be._events=Object.create(null),Be._eventsCount=0):(Ut.newListener!==void 0&&(Be.emit("newListener",Pe,$e.listener?$e.listener:$e),Ut=Be._events),$t=Ut[Pe]),$t===void 0)$t=Ut[Pe]=$e,++Be._eventsCount;else if(typeof $t=="function"?$t=Ut[Pe]=Qe?[$e,$t]:[$t,$e]:Qe?$t.unshift($e):$t.push($e),Et=k(Be),Et>0&&$t.length>Et&&!$t.warned){$t.warned=!0;var hi=new Error("Possible EventEmitter memory leak detected. "+$t.length+" "+String(Pe)+" listeners added. Use emitter.setMaxListeners() to increase limit");hi.name="MaxListenersExceededWarning",hi.emitter=Be,hi.type=Pe,hi.count=$t.length,g(hi)}return Be}A.prototype.addListener=function(Pe,$e){return N(this,Pe,$e,!1)},A.prototype.on=A.prototype.addListener,A.prototype.prependListener=function(Pe,$e){return N(this,Pe,$e,!0)};function H(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function K(Be,Pe,$e){var Qe={fired:!1,wrapFn:void 0,target:Be,type:Pe,listener:$e},Et=H.bind(Qe);return Et.listener=$e,Qe.wrapFn=Et,Et}A.prototype.once=function(Pe,$e){return c($e),this.on(Pe,K(this,Pe,$e)),this},A.prototype.prependOnceListener=function(Pe,$e){return c($e),this.prependListener(Pe,K(this,Pe,$e)),this},A.prototype.removeListener=function(Pe,$e){var Qe,Et,Ut,$t,hi;if(c($e),Et=this._events,Et===void 0)return this;if(Qe=Et[Pe],Qe===void 0)return this;if(Qe===$e||Qe.listener===$e)--this._eventsCount===0?this._events=Object.create(null):(delete Et[Pe],Et.removeListener&&this.emit("removeListener",Pe,Qe.listener||$e));else if(typeof Qe!="function"){for(Ut=-1,$t=Qe.length-1;$t>=0;$t--)if(Qe[$t]===$e||Qe[$t].listener===$e){hi=Qe[$t].listener,Ut=$t;break}if(Ut<0)return this;Ut===0?Qe.shift():fe(Qe,Ut),Qe.length===1&&(Et[Pe]=Qe[0]),Et.removeListener!==void 0&&this.emit("removeListener",Pe,hi||$e)}return this},A.prototype.off=A.prototype.removeListener,A.prototype.removeAllListeners=function(Pe){var $e,Qe,Et;if(Qe=this._events,Qe===void 0)return this;if(Qe.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Qe[Pe]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete Qe[Pe]),this;if(arguments.length===0){var Ut=Object.keys(Qe),$t;for(Et=0;Et<Ut.length;++Et)$t=Ut[Et],$t!=="removeListener"&&this.removeAllListeners($t);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if($e=Qe[Pe],typeof $e=="function")this.removeListener(Pe,$e);else if($e!==void 0)for(Et=$e.length-1;Et>=0;Et--)this.removeListener(Pe,$e[Et]);return this};function ae(Be,Pe,$e){var Qe=Be._events;if(Qe===void 0)return[];var Et=Qe[Pe];return Et===void 0?[]:typeof Et=="function"?$e?[Et.listener||Et]:[Et]:$e?ce(Et):ge(Et,Et.length)}A.prototype.listeners=function(Pe){return ae(this,Pe,!0)},A.prototype.rawListeners=function(Pe){return ae(this,Pe,!1)},A.listenerCount=function(Be,Pe){return typeof Be.listenerCount=="function"?Be.listenerCount(Pe):ue.call(Be,Pe)},A.prototype.listenerCount=ue;function ue(Be){var Pe=this._events;if(Pe!==void 0){var $e=Pe[Be];if(typeof $e=="function")return 1;if($e!==void 0)return $e.length}return 0}A.prototype.eventNames=function(){return this._eventsCount>0?h(this._events):[]};function ge(Be,Pe){for(var $e=new Array(Pe),Qe=0;Qe<Pe;++Qe)$e[Qe]=Be[Qe];return $e}function fe(Be,Pe){for(;Pe+1<Be.length;Pe++)Be[Pe]=Be[Pe+1];Be.pop()}function ce(Be){for(var Pe=new Array(Be.length),$e=0;$e<Pe.length;++$e)Pe[$e]=Be[$e].listener||Be[$e];return Pe}function qe(Be,Pe){return new Promise(function($e,Qe){function Et($t){Be.removeListener(Pe,Ut),Qe($t)}function Ut(){typeof Be.removeListener=="function"&&Be.removeListener("error",Et),$e([].slice.call(arguments))}Ne(Be,Pe,Ut,{once:!0}),Pe!=="error"&&Fe(Be,Et,{once:!0})})}function Fe(Be,Pe,$e){typeof Be.on=="function"&&Ne(Be,"error",Pe,$e)}function Ne(Be,Pe,$e,Qe){if(typeof Be.on=="function")Qe.once?Be.once(Pe,$e):Be.on(Pe,$e);else if(typeof Be.addEventListener=="function")Be.addEventListener(Pe,function Et(Ut){Qe.once&&Be.removeEventListener(Pe,Et),$e(Ut)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Be)}return X_.exports}var KC=WC();const JC=Ry(KC);function QC(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class eP{constructor(){this._apiKey="",this._fetch=QC(),this.tileCacheSize=200}set apiKey(a){this._apiKey=a}get apiKey(){return this._apiKey}set fetch(a){this._fetch=a}get fetch(){return this._fetch}}const jm=new eP,tP={AUTO:{code:null,flag:"auto",name:"Auto",latin:!1,isMode:!0,geocoding:!0},LATIN:{code:"latin",flag:"name:latin",name:"Latin",latin:!0,isMode:!1,geocoding:!1},NON_LATIN:{code:"nonlatin",flag:"name:nonlatin",name:"Non Latin",latin:!1,isMode:!1,geocoding:!1},LOCAL:{code:null,flag:"name",name:"Local",latin:!0,isMode:!1,geocoding:!1}},iP={ALBANIAN:{code:"sq",flag:"name:sq",name:"Albanian",latin:!0,isMode:!1,geocoding:!0},AMHARIC:{code:"am",flag:"name:am",name:"Amharic",latin:!1,isMode:!1,geocoding:!0},ARABIC:{code:"ar",flag:"name:ar",name:"Arabic",latin:!1,isMode:!1,geocoding:!0},ARMENIAN:{code:"hy",flag:"name:hy",name:"Armenian",latin:!1,isMode:!1,geocoding:!0},AZERBAIJANI:{code:"az",flag:"name:az",name:"Azerbaijani",latin:!0,isMode:!1,geocoding:!0},BASQUE:{code:"eu",flag:"name:eu",name:"Basque",latin:!0,isMode:!1,geocoding:!0},BELARUSIAN:{code:"be",flag:"name:be",name:"Belarusian",latin:!1,isMode:!1,geocoding:!0},BENGALI:{code:"bn",flag:"name:bn",name:"Bengali",latin:!0,isMode:!1,geocoding:!0},BOSNIAN:{code:"bs",flag:"name:bs",name:"Bosnian",latin:!0,isMode:!1,geocoding:!0},BRETON:{code:"br",flag:"name:br",name:"Breton",latin:!0,isMode:!1,geocoding:!0},BULGARIAN:{code:"bg",flag:"bg",name:"Bulgarian",latin:!1,isMode:!1,geocoding:!0},CATALAN:{code:"ca",flag:"name:ca",name:"Catalan",latin:!0,isMode:!1,geocoding:!0},CHINESE:{code:"zh",flag:"name:zh",name:"Chinese",latin:!1,isMode:!1,geocoding:!0},TRADITIONAL_CHINESE:{code:"zh-Hant",flag:"name:zh-Hant",name:"Chinese (traditional)",latin:!1,isMode:!1,geocoding:!1},SIMPLIFIED_CHINESE:{code:"zh-Hans",flag:"name:zh-Hans",name:"Chinese (simplified)",latin:!1,isMode:!1,geocoding:!1},CORSICAN:{code:"co",flag:"name:co",name:"Corsican",latin:!0,isMode:!1,geocoding:!0},CROATIAN:{code:"hr",flag:"name:hr",name:"Croatian",latin:!0,isMode:!1,geocoding:!0},CZECH:{code:"cs",flag:"name:cs",name:"Czech",latin:!0,isMode:!1,geocoding:!0},DANISH:{code:"da",flag:"name:da",name:"Danish",latin:!0,isMode:!1,geocoding:!0},DUTCH:{code:"nl",flag:"name:nl",name:"Dutch",latin:!0,isMode:!1,geocoding:!0},GERMAN:{code:"de",flag:"name:de",name:"German",latin:!0,isMode:!1,geocoding:!0},GREEK:{code:"el",flag:"name:el",name:"Greek",latin:!1,isMode:!1,geocoding:!0},ENGLISH:{code:"en",flag:"name:en",name:"English",latin:!0,isMode:!1,geocoding:!0},ESPERANTO:{code:"eo",flag:"name:eo",name:"Esperanto",latin:!0,isMode:!1,geocoding:!0},ESTONIAN:{code:"et",flag:"name:et",name:"Estonian",latin:!0,isMode:!1,geocoding:!0},FINNISH:{code:"fi",flag:"name:fi",name:"Finnish",latin:!0,isMode:!1,geocoding:!0},FRENCH:{code:"fr",flag:"name:fr",name:"French",latin:!0,isMode:!1,geocoding:!0},FRISIAN:{code:"fy",flag:"name:fy",name:"Frisian (West)",latin:!0,isMode:!1,geocoding:!0},GEORGIAN:{code:"ka",flag:"name:ka",name:"Georgian",latin:!1,isMode:!1,geocoding:!0},HEBREW:{code:"he",flag:"name:he",name:"Hebrew",latin:!1,isMode:!1,geocoding:!0},HINDI:{code:"hi",flag:"name:hi",name:"Hindi",latin:!1,isMode:!1,geocoding:!0},HUNGARIAN:{code:"hu",flag:"name:hu",name:"Hungarian",latin:!0,isMode:!1,geocoding:!0},ICELANDIC:{code:"is",flag:"name:is",name:"Icelandic",latin:!0,isMode:!1,geocoding:!0},INDONESIAN:{code:"id",flag:"name:id",name:"Indonesian",latin:!0,isMode:!1,geocoding:!0},IRISH:{code:"ga",flag:"name:ga",name:"Irish",latin:!0,isMode:!1,geocoding:!0},ITALIAN:{code:"it",flag:"name:it",name:"Italian",latin:!0,isMode:!1,geocoding:!0},JAPANESE:{code:"ja",flag:"name:ja",name:"Japanese",latin:!1,isMode:!1,geocoding:!0},JAPANESE_HIRAGANA:{code:"ja-Hira",flag:"name:ja-Hira",name:"Japanese Hiragana form",latin:!1,isMode:!1,geocoding:!1},JAPANESE_2018:{code:"ja-Latn",flag:"name:ja-Latn",name:"Japanese (Latin 2018)",latin:!0,isMode:!1,geocoding:!1},JAPANESE_KANA:{code:"ja_kana",flag:"name:ja_kana",name:"Japanese (Kana)",latin:!1,isMode:!1,geocoding:!1},JAPANESE_LATIN:{code:"ja_rm",flag:"name:ja_rm",name:"Japanese (Latin script)",latin:!0,isMode:!1,geocoding:!1},KANNADA:{code:"kn",flag:"name:kn",name:"Kannada",latin:!0,isMode:!1,geocoding:!0},KAZAKH:{code:"kk",flag:"name:kk",name:"Kazakh",latin:!1,isMode:!1,geocoding:!0},KOREAN:{code:"ko",flag:"name:ko",name:"Korean",latin:!1,isMode:!1,geocoding:!0},KOREAN_LATIN:{code:"ko-Latn",flag:"name:ko-Latn",name:"Korean (Latin script)",latin:!0,isMode:!1,geocoding:!1},KURDISH:{code:"ku",flag:"name:ku",name:"Kurdish",latin:!0,isMode:!1,geocoding:!0},CLASSICAL_LATIN:{code:"la",flag:"name:la",name:"Latin",latin:!0,isMode:!1,geocoding:!0},LATVIAN:{code:"lv",flag:"name:lv",name:"Latvian",latin:!0,isMode:!1,geocoding:!0},LITHUANIAN:{code:"lt",flag:"name:lt",name:"Lithuanian",latin:!0,isMode:!1,geocoding:!0},LUXEMBOURGISH:{code:"lb",flag:"name:lb",name:"Luxembourgish",latin:!0,isMode:!1,geocoding:!0},MACEDONIAN:{code:"mk",flag:"name:mk",name:"Macedonian",latin:!1,isMode:!1,geocoding:!0},MALAYALAM:{code:"ml",flag:"name:ml",name:"Malayalam",latin:!1,isMode:!1,geocoding:!0},MALTESE:{code:"mt",flag:"name:mt",name:"Maltese",latin:!0,isMode:!1,geocoding:!0},NORWEGIAN:{code:"no",flag:"name:no",name:"Norwegian",latin:!0,isMode:!1,geocoding:!0},OCCITAN:{code:"oc",flag:"name:oc",name:"Occitan",latin:!0,isMode:!1,geocoding:!0},PERSIAN:{code:"fa",flag:"name:fa",name:"Persian",latin:!1,isMode:!1,geocoding:!0},POLISH:{code:"pl",flag:"name:pl",name:"Polish",latin:!0,isMode:!1,geocoding:!0},PORTUGUESE:{code:"pt",flag:"name:pt",name:"Portuguese",latin:!0,isMode:!1,geocoding:!0},PUNJABI:{code:"pa",flag:"name:pa",name:"Punjabi",latin:!1,isMode:!1,geocoding:!0},WESTERN_PUNJABI:{code:"pnb",flag:"name:pnb",name:"Western Punjabi",latin:!1,isMode:!1,geocoding:!1},ROMANIAN:{code:"ro",flag:"name:ro",name:"Romanian",latin:!0,isMode:!1,geocoding:!0},ROMANSH:{code:"rm",flag:"name:rm",name:"Romansh",latin:!0,isMode:!1,geocoding:!0},RUSSIAN:{code:"ru",flag:"name:ru",name:"Russian",latin:!1,isMode:!1,geocoding:!0},SERBIAN_CYRILLIC:{code:"sr",flag:"name:sr",name:"Serbian (Cyrillic script)",latin:!1,isMode:!1,geocoding:!0},SERBIAN_LATIN:{code:"sr-Latn",flag:"name:sr-Latn",name:"Serbian (Latin script)",latin:!0,isMode:!1,geocoding:!1},SCOTTISH_GAELIC:{code:"gd",flag:"name:gd",name:"Scottish Gaelic",latin:!0,isMode:!1,geocoding:!0},SLOVAK:{code:"sk",flag:"name:sk",name:"Slovak",latin:!0,isMode:!1,geocoding:!0},SLOVENE:{code:"sl",flag:"name:sl",name:"Slovene",latin:!0,isMode:!1,geocoding:!0},SPANISH:{code:"es",flag:"name:es",name:"Spanish",latin:!0,isMode:!1,geocoding:!0},SWEDISH:{code:"sv",flag:"name:sv",name:"Swedish",latin:!0,isMode:!1,geocoding:!0},TAMIL:{code:"ta",flag:"name:ta",name:"Tamil",latin:!1,isMode:!1,geocoding:!0},TELUGU:{code:"te",flag:"name:te",name:"Telugu",latin:!1,isMode:!1,geocoding:!0},THAI:{code:"th",flag:"name:th",name:"Thai",latin:!1,isMode:!1,geocoding:!0},TURKISH:{code:"tr",flag:"name:tr",name:"Turkish",latin:!0,isMode:!1,geocoding:!0},UKRAINIAN:{code:"uk",flag:"name:uk",name:"Ukrainian",latin:!1,isMode:!1,geocoding:!0},VIETNAMESE:{code:"vi",flag:"name:vi",name:"Vietnamese (Latin script)",latin:!0,isMode:!1,geocoding:!0},WELSH:{code:"cy",flag:"name:cy",name:"Welsh",latin:!0,isMode:!1,geocoding:!0}},jy={...tP,...iP};function nP(s,a=jy){return s in a?s[s]:null}function cb(s,a=jy){for(const h of Object.values(a))if(h.code===s)return h;return null}function hb(s,a=jy){for(const h of Object.values(a))if(h.flag===s)return h;return null}function rP(s){return s!==null&&typeof s=="object"&&"code"in s&&"flag"in s&&"name"in s&&"latin"in s&&"isMode"in s&&"geocoding"in s&&(typeof s.code=="string"||s.code===null)&&typeof s.flag=="string"&&typeof s.name=="string"&&typeof s.latin=="boolean"&&typeof s.isMode=="boolean"&&typeof s.geocoding=="boolean"}function j1(s,a=jy){return rP(s)?hb(s.flag,a):typeof s!="string"?null:nP(s,a)||cb(s,a)||hb(s,a)||null}async function aP(s,a={}){if(jm.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(s).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return jm.fetch(s,a)}const W2={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(W2);class oP extends Error{constructor(a,h=""){super(`Call to enpoint ${a.url} failed with the status code ${a.status}. ${h}`),this.res=a}}const U1={403:"Key is missing, invalid or restricted"};async function sP(s={}){const a=new URL("geolocation/ip.json",W2.maptilerApiURL);a.searchParams.set("key",s.apiKey??jm.apiKey),"elevation"in s&&a.searchParams.set("elevation",s.elevation?"true":"false");const h=a.toString(),g=await aP(h);if(!g.ok)throw new oP(g,g.status in U1?U1[g.status]:"");return await g.json()}const V1={info:sP};function K2(s){const a=/^maptiler:\/\/(.*)/;let h;const g=s.trim();let S;return g.startsWith("http://")||g.startsWith("https://")?S=g:(h=a.exec(g))!==null?S=`https://api.maptiler.com/maps/${h[1]}/style.json`:S=`https://api.maptiler.com/maps/${g}/style.json`,S}class J2{constructor(a,h,g,S,A,w,c=!1,k){this.name=a,this.variantType=h,this.id=g,this.referenceStyle=S,this.description=A,this.imageURL=w,this.deprecated=c,this.deprecationMessage=k}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(a){return this.referenceStyle.hasVariant(a)}getVariant(a){const h=this.referenceStyle.getVariant(a);return this.warnIfDeprecated(h),h}getVariants(){return this.referenceStyle.getVariants().filter(a=>a!==this).map(a=>(this.warnIfDeprecated(a),a))}getImageURL(){return this.imageURL}getExpandedStyleURL(){return K2(this.getId())}warnIfDeprecated(a=this){if(!a.deprecated)return a;if(a.deprecationMessage)console.warn(a.deprecationMessage);else{const h=a.getFullName();console.warn(`Style "${h}" is deprecated and will be removed in a future version.`)}return a}}class Q2{constructor(a,h){this.name=a,this.id=h,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(a){this.variants[a.getType()]=a,this.orderedVariants.push(a)}hasVariant(a){return a in this.variants}getVariant(a){return a in this.variants?this.variants[a]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0].warnIfDeprecated()}}const mf=[{referenceStyleID:"STREETS_V2",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default v2",variantType:"DEFAULT",description:"",imageURL:"",deprecated:!0,deprecationMessage:'"streets-v2" is deprecated, use "streets-v4" instead'},{id:"streets-v2-dark",name:"Dark v2",variantType:"DARK",description:"",imageURL:"",deprecated:!0,deprecationMessage:'"streets-v2-dark" is deprecated, use "streets-v4-dark" instead'},{id:"streets-v2-light",name:"Light v2",variantType:"LIGHT",description:"",imageURL:"",deprecated:!0,deprecationMessage:'"streets-v2-light" is deprecated, use "streets-v4-light" instead'},{id:"streets-v2-night",name:"Night v2",variantType:"NIGHT",description:"",imageURL:"",deprecated:!0,deprecationMessage:'"streets-v2-night" is deprecated, use "streets-v4-night" instead'},{id:"streets-v2-pastel",name:"Pastel v2",variantType:"PASTEL",description:"",imageURL:"",deprecated:!0,deprecationMessage:'"streets-v2-pastel" is deprecated, use "streets-v4-pastel" instead'}]},{referenceStyleID:"STREETS_V4",name:"Streets",description:"",variants:[{id:"streets-v4",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v4-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v4-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"BASE_V4",name:"Base",description:"",variants:[{id:"base-v4",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"base-v4-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"base-v4-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"base-v4-ai",name:"Base AI",variantType:"NIGHT",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC_V2",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:"",deprecated:!0,deprecationMessage:'"basic-v2" is deprecated, use "basic-v4" instead'},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",deprecated:!0,variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",deprecated:!0,variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",deprecated:!0,variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",deprecated:!0,variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",deprecated:!0,variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",deprecated:!0,description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",deprecated:!0,description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"AQUARELLE",name:"Aquarelle",description:"Watercolor map for creative use",variants:[{id:"aquarelle",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"aquarelle-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"aquarelle-vivid",name:"Vivid",variantType:"VIVID",description:"",imageURL:""}]},{referenceStyleID:"LANDSCAPE_V2",name:"Landscape",description:"Terrain map for data overlays and visualisations",variants:[{id:"landscape",name:"Default",variantType:"DEFAULT",description:"",imageURL:"",deprecated:!0,deprecationMessage:'"landscape" is deprecated, use "landscape-v4" instead'},{id:"landscape-dark",name:"Dark",variantType:"DARK",description:"",imageURL:"",deprecated:!0,deprecationMessage:'"landscape-dark" is deprecated, use "landscape-v4-dark" instead'},{id:"landscape-vivid",name:"Vivid",variantType:"VIVID",description:"",imageURL:"",deprecated:!0,deprecationMessage:'"landscape-vivid" is deprecated, use "landscape-v4-vivid" instead'}]},{referenceStyleID:"LANDSCAPE_V4",name:"Landscape",description:"Terrain map for data overlays and visualisations",variants:[{id:"landscape-v4",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"landscape-v4-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"landscape-v4-vivid",name:"Vivid",variantType:"VIVID",description:"",imageURL:""}]}],lP={STREETS:"STREETS_V2",BASIC:"BASIC_V2",LANDSCAPE:"LANDSCAPE_V2"};function uP(s,a){mf.find(S=>S.referenceStyleID===s)&&console.warn(`Default reference style ${s} already exists, it will be overwritten...`);const h=mf.find(S=>S.referenceStyleID===a);if(!h)throw new Error(`Versioned map style not found for reference style: ${a}`);const g={...h,referenceStyleID:s};mf.push(g)}Object.entries(lP).forEach(([s,a])=>{uP(s,a)});function cP(s){return new Proxy(s,{get(a,h,g){return a.hasVariant(h)?a.getVariant(h):h.toString().toUpperCase()===h?s.getDefaultVariant():Reflect.get(a,h,g)}})}function hP(){const s={};for(let a=0;a<mf.length;a+=1){const h=mf[a],g=cP(new Q2(h.name,h.referenceStyleID));for(let S=0;S<h.variants.length;S+=1){const A=h.variants[S],w=new J2(A.name,A.variantType,A.id,g,A.description,A.imageURL,A.deprecated);g.addVariant(w)}s[h.referenceStyleID]=g}return s}const gy=hP(),ns=[];for(let s=0;s<256;++s)ns.push((s+256).toString(16).slice(1));function dP(s,a=0){return(ns[s[a+0]]+ns[s[a+1]]+ns[s[a+2]]+ns[s[a+3]]+"-"+ns[s[a+4]]+ns[s[a+5]]+"-"+ns[s[a+6]]+ns[s[a+7]]+"-"+ns[s[a+8]]+ns[s[a+9]]+"-"+ns[s[a+10]]+ns[s[a+11]]+ns[s[a+12]]+ns[s[a+13]]+ns[s[a+14]]+ns[s[a+15]]).toLowerCase()}let N0;const fP=new Uint8Array(16);function pP(){if(!N0){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");N0=crypto.getRandomValues.bind(crypto)}return N0(fP)}const mP=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),G1={randomUUID:mP};function gP(s,a,h){if(G1.randomUUID&&!s)return G1.randomUUID();s=s||{};const g=s.random??s.rng?.()??pP();if(g.length<16)throw new Error("Random bytes length must be >= 16");return g[6]=g[6]&15|64,g[8]=g[8]&63|128,dP(g)}var yP=Object.defineProperty,eT=s=>{throw TypeError(s)},_P=(s,a,h)=>a in s?yP(s,a,{enumerable:!0,configurable:!0,writable:!0,value:h}):s[a]=h,Wt=(s,a,h)=>_P(s,typeof a!="symbol"?a+"":a,h),cx=(s,a,h)=>a.has(s)||eT("Cannot "+h),ci=(s,a,h)=>(cx(s,a,"read from private field"),h?h.call(s):a.get(s)),xl=(s,a,h)=>a.has(s)?eT("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(s):a.set(s,h),lu=(s,a,h,g)=>(cx(s,a,"write to private field"),a.set(s,h),h),ou=(s,a,h)=>(cx(s,a,"access private method"),h);(class extends si.Marker{addTo(s){return super.addTo(s)}});class xL extends si.Popup{addTo(a){return super.addTo(a)}}class wL extends si.Style{constructor(a,h={}){super(a,h)}}class TL extends si.CanvasSource{onAdd(a){super.onAdd(a)}}class SL extends si.GeoJSONSource{onAdd(a){super.onAdd(a)}}class ML extends si.ImageSource{onAdd(a){super.onAdd(a)}}class EL extends si.RasterTileSource{onAdd(a){super.onAdd(a)}}class AL extends si.RasterDEMTileSource{onAdd(a){super.onAdd(a)}}class CL extends si.VectorTileSource{onAdd(a){super.onAdd(a)}}class PL extends si.VideoSource{onAdd(a){super.onAdd(a)}}class vP extends si.NavigationControl{onAdd(a){return super.onAdd(a)}}class bP extends si.GeolocateControl{onAdd(a){return super.onAdd(a)}}class zL extends si.AttributionControl{onAdd(a){return super.onAdd(a)}}class xP extends si.LogoControl{onAdd(a){return super.onAdd(a)}}class wP extends si.ScaleControl{onAdd(a){return super.onAdd(a)}}class TP extends si.FullscreenControl{onAdd(a){return super.onAdd(a)}}class IL extends si.TerrainControl{onAdd(a){return super.onAdd(a)}}class LL extends si.BoxZoomHandler{constructor(a,h){super(a,h)}}class DL extends si.ScrollZoomHandler{constructor(a,h){super(a,h)}}class RL extends si.CooperativeGesturesHandler{constructor(a,h){super(a,h)}}class kL extends si.KeyboardHandler{constructor(a){super(a)}}class OL extends si.TwoFingersTouchPitchHandler{constructor(a){super(a)}}class BL extends si.MapWheelEvent{constructor(a,h,g){super(a,h,g)}}class FL extends si.MapTouchEvent{constructor(a,h,g){super(a,h,g)}}class NL extends si.MapMouseEvent{constructor(a,h,g,S={}){super(a,h,g,S)}}const An={VISITOR:{code:null,flag:"visitor",name:"Visitor",latin:!0,isMode:!0,geocoding:!1},VISITOR_ENGLISH:{code:null,flag:"visitor_en",name:"Visitor English",latin:!0,isMode:!0,geocoding:!1},STYLE:{code:null,flag:"style",name:"Style",latin:!1,isMode:!0,geocoding:!1},STYLE_LOCK:{code:null,flag:"style_lock",name:"Style Lock",latin:!1,isMode:!0,geocoding:!1},...jy};function Z1(){if(typeof navigator>"u"){const s=Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];return cb(s)||An.ENGLISH}return Array.from(new Set(navigator.languages.map(s=>s.split("-")[0]))).map(s=>cb(s)).filter(s=>s)[0]??An.LOCAL}const Ys={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",telemetryURL:"https://api.maptiler.com/metrics",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:An.STYLE,secondaryLanguage:An.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(Ys);const hx=gP();class SP extends JC{constructor(){super(...arguments),Wt(this,"primaryLanguage",Ys.primaryLanguage),Wt(this,"secondaryLanguage"),Wt(this,"session",!0),Wt(this,"caching",!0),Wt(this,"telemetry",!0),Wt(this,"_unit","metric"),Wt(this,"_apiKey","")}set unit(a){this._unit=a,this.emit("unit",a)}get unit(){return this._unit}set apiKey(a){this._apiKey=a,jm.apiKey=a,this.emit("apiKey",a)}get apiKey(){return this._apiKey}set fetch(a){jm.fetch=a}get fetch(){return jm.fetch}}const ba=new SP;class q1 extends xP{constructor(a={}){super(a),Wt(this,"logoURL",""),Wt(this,"linkURL",""),this.logoURL=a.logoURL??Ys.maptilerLogoURL,this.linkURL=a.linkURL??Ys.maptilerURL}onAdd(a){this._map=a,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const h=window.document.createElement("a");return h.style.backgroundRepeat="no-repeat",h.style.cursor="pointer",h.style.display="block",h.style.height="23px",h.style.margin="0 0 -4px -4px",h.style.overflow="hidden",h.style.width="88px",h.style.backgroundImage=`url(${this.logoURL})`,h.style.backgroundSize="100px 30px",h.style.width="100px",h.style.height="30px",h.target="_blank",h.rel="noopener",h.href=this.linkURL,h.setAttribute("aria-label","MapTiler logo"),h.setAttribute("rel","noopener"),this._container.appendChild(h),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}const db="localcache_source",fb="localcache",MP="maptiler_sdk",EP=1e3,AP=100,pb=typeof caches<"u",{addProtocol:$1}=si;function CP(s,a){if(pb&&ba.caching&&ba.session&&s.host===Ys.maptilerApiHost){if(a==="Source"&&s.href.includes("tiles.json"))return s.href.replace("https://",`${db}://`);if(a==="Tile"||a==="Glyphs")return s.href.replace("https://",`${fb}://`)}return s.href}let j0;async function tT(){return j0||(j0=await caches.open(MP)),j0}let H1=0;async function PP(){const s=await tT(),a=await s.keys(),h=a.slice(0,Math.max(a.length-EP,0));for(const g of h)s.delete(g)}function zP(){$1(db,async(s,a)=>{if(!s.url)throw new Error("");s.url=s.url.replace(`${db}://`,"https://");const h=s;h.signal=a.signal;const g=await fetch(s.url,h),S=await g.json();return S.tiles&&S.tiles.length>0&&(S.tiles[0]+=`&last-modified=${g.headers.get("Last-Modified")}`),{data:S,cacheControl:g.headers.get("Cache-Control"),expires:g.headers.get("Expires")}}),$1(fb,async(s,a)=>{if(!s.url)throw new Error("");s.url=s.url.replace(`${fb}://`,"https://");const h=new URL(s.url),g=new URL(h);g.searchParams.delete("mtsid"),g.searchParams.delete("key");const S=g.toString(),A=new URL(h);A.searchParams.delete("last-modified");const w=A.toString(),c=async ae=>({data:await ae.arrayBuffer(),cacheControl:ae.headers.get("Cache-Control"),expires:ae.headers.get("Expires")}),k=await tT(),N=await k.match(S);if(N)return c(N);const H=s;H.signal=a.signal;const K=await fetch(w,H);return K.status>=200&&K.status<300&&(k.put(S,K.clone()).catch(()=>{}),++H1>AP&&(PP(),H1=0)),c(K)})}async function IP(s){if(typeof window>"u")return;const a=si.getRTLTextPluginStatus();if(a==="unavailable"||a==="requested")try{await si.setRTLTextPlugin(s??Ys.rtlPluginURL,!0)}catch(h){console.error("Error enabling RTL plugin. It is enabled by default and cannot be unset after. Are you attempting to enable it twice?",h)}}function LP(s,a){for(const h of s)typeof a[h]=="function"&&(a[h]=a[h].bind(a))}function X1(s,a){let h=null;try{h=new URL(s)}catch{return{url:s}}return h.host===Ys.maptilerApiHost&&(h.searchParams.has("key")||h.searchParams.append("key",ba.apiKey),ba.session&&h.searchParams.append("mtsid",hx)),{url:CP(h,a)}}function Y1(s){return(a,h)=>{if(s!=null){const g=s(a,h),S=X1(g?.url??"",h);return{...g,...S}}return X1(a,h)}}function iT(){return Math.random().toString(36).substring(2)}function Lv(s){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(s)}function DP(s){try{return JSON.parse(s)}catch{}return null}function RP(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function kP(s){const a=RP();if(!a)return;let h=null;if(typeof s=="string"?h=document.getElementById(s):s instanceof HTMLElement&&(h=s),!h)throw new Error("The Map container must be provided.");const g=document.createElement("div");throw g.innerHTML=a,g.classList.add("webgl-warning-div"),h.appendChild(g),new Error(a)}function W1(s,a){return!(!Array.isArray(s)||s.length!==2||s[0]!=="get"||typeof s[1]!="string"||a&&!s[1].startsWith("name:")||!a&&s[1]!=="name")}function OP(s,a,h){const g=structuredClone(s),S=A=>{if(typeof A!="string")for(let w=0;w<A.length;w+=1)W1(A[w],h)?A[w]=structuredClone(a):S(A[w])};return W1(g,h)?a:(S(g),g)}function BP(s,a){const h=a?/\{name:\S+\}/:/\{name\}/;return{contains:h.test(s),exactMatch:new RegExp(`^${h.source}$`).test(s)}}function FP(s,a,h){const g=h?/\{name:\S+\}/:/\{name\}/,S=s.split(g);return["concat",...S.flatMap((A,w)=>w===S.length-1?[A]:[A,a])]}function NP(s){var a;const h=/\{name(?::(?<language>\S+))?\}/g,g=[];for(;;){const S=h.exec(s);if(!S)break;const A=((a=S.groups)==null?void 0:a.language)??null;g.push(A)}return g}function jP(s){return!Array.isArray(s)||s.length!==2||s[0]!=="get"||typeof s[1]!="string"?null:s[1].trim()==="name"?{isLanguage:!0,localization:null}:s[1].trim().startsWith("name:")?{isLanguage:!0,localization:s[1].trim().split(":").pop()}:null}function UP(s){const a=[],h=structuredClone(s),g=S=>{if(typeof S!="string")for(let A=0;A<S.length;A+=1){const w=jP(S[A]);w?a.push(w.localization):g(S[A])}};return g([h]),a}function VP(s,a){const h=[];for(const A of s){if(A.type!=="symbol")continue;const w=A,{id:c,layout:k}=w;if(!k||!("text-field"in k))continue;const N=a.getLayoutProperty(c,"text-field");if(N)if(typeof N=="string"){const H=NP(N);h.push(H)}else{const H=UP(N);h.push(H)}}const g=h.flat(),S={unlocalized:0,localized:{}};for(const A of g)A===null?S.unlocalized+=1:(A in S.localized||(S.localized[A]=0),S.localized[A]+=1);return S}var GP=8,ZP={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},qP={"*":{type:"source"}},$P=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],HP={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},XP={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},YP={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},WP={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},KP={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},JP={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},QP={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},e5=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],t5={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},i5={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},n5={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},r5={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},a5={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},o5={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},s5={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},l5={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},u5={type:"array",value:"*"},c5={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},h5={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},d5={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},f5={type:"array",value:"*",minimum:1},p5={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},m5={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},g5={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},y5={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},_5=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],v5={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},b5={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},x5={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},w5={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},T5={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},S5={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},M5={"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},E5={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},A5={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},C5={"*":{type:"string"}},P5={$version:GP,$root:ZP,sources:qP,source:$P,source_vector:HP,source_raster:XP,source_raster_dem:YP,source_geojson:WP,source_video:KP,source_image:JP,layer:QP,layout:e5,layout_background:t5,layout_fill:i5,layout_circle:n5,layout_heatmap:r5,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:a5,layout_symbol:o5,layout_raster:s5,layout_hillshade:l5,"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:u5,filter_operator:c5,geometry_type:h5,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:d5,expression:f5,light:p5,sky:m5,terrain:g5,projection:y5,paint:_5,paint_fill:v5,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:b5,paint_circle:x5,paint_heatmap:w5,paint_symbol:T5,paint_raster:S5,paint_hillshade:M5,"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:E5,transition:A5,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:C5};class Bt{constructor(a,h,g,S){this.message=(a?`${a}: `:"")+g,S&&(this.identifier=S),h!=null&&h.__line__&&(this.line=h.__line__)}}function dv(s,...a){for(const h of a)for(const g in h)s[g]=h[g];return s}class Th extends Error{constructor(a,h){super(h),this.message=h,this.key=a}}class dx{constructor(a,h=[]){this.parent=a,this.bindings={};for(const[g,S]of h)this.bindings[g]=S}concat(a){return new dx(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return this.bindings[a]?!0:this.parent?this.parent.has(a):!1}}const Dv={kind:"null"},qt={kind:"number"},Ji={kind:"string"},qi={kind:"boolean"},Mh={kind:"color"},Rv={kind:"projectionDefinition"},wp={kind:"object"},ji={kind:"value"},z5={kind:"error"},kv={kind:"collator"},Ov={kind:"formatted"},Bv={kind:"padding"},Sy={kind:"colorArray"},Fv={kind:"numberArray"},Uy={kind:"resolvedImage"},Nv={kind:"variableAnchorOffsetCollection"};function uu(s,a){return{kind:"array",itemType:s,N:a}}function Hr(s){if(s.kind==="array"){const a=Hr(s.itemType);return typeof s.N=="number"?`array<${a}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${a}>`}else return s.kind}const I5=[Dv,qt,Ji,qi,Mh,Rv,Ov,wp,uu(ji),Bv,Fv,Sy,Uy,Nv];function My(s,a){if(a.kind==="error")return null;if(s.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!My(s.itemType,a.itemType))&&(typeof s.N!="number"||s.N===a.N))return null}else{if(s.kind===a.kind)return null;if(s.kind==="value"){for(const h of I5)if(!My(h,a))return null}}return`Expected ${Hr(s)} but found ${Hr(a)} instead.`}function fx(s,a){return a.some(h=>h.kind===s.kind)}function Tp(s,a){return a.some(h=>h==="null"?s===null:h==="array"?Array.isArray(s):h==="object"?s&&!Array.isArray(s)&&typeof s=="object":h===typeof s)}function uf(s,a){return s.kind==="array"&&a.kind==="array"?s.itemType.kind===a.itemType.kind&&typeof s.N=="number":s.kind===a.kind}const nT=.96422,rT=1,aT=.82521,oT=4/29,Um=6/29,sT=3*Um*Um,L5=Um*Um*Um,D5=Math.PI/180,R5=180/Math.PI;function lT(s){return s=s%360,s<0&&(s+=360),s}function uT([s,a,h,g]){s=U0(s),a=U0(a),h=U0(h);let S,A;const w=V0((.2225045*s+.7168786*a+.0606169*h)/rT);s===a&&a===h?S=A=w:(S=V0((.4360747*s+.3850649*a+.1430804*h)/nT),A=V0((.0139322*s+.0971045*a+.7141733*h)/aT));const c=116*w-16;return[c<0?0:c,500*(S-w),200*(w-A),g]}function U0(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function V0(s){return s>L5?Math.pow(s,1/3):s/sT+oT}function cT([s,a,h,g]){let S=(s+16)/116,A=isNaN(a)?S:S+a/500,w=isNaN(h)?S:S-h/200;return S=rT*Z0(S),A=nT*Z0(A),w=aT*Z0(w),[G0(3.1338561*A-1.6168667*S-.4906146*w),G0(-.9787684*A+1.9161415*S+.033454*w),G0(.0719453*A-.2289914*S+1.4052427*w),g]}function G0(s){return s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055,s<0?0:s>1?1:s}function Z0(s){return s>Um?s*s*s:sT*(s-oT)}function k5(s){const[a,h,g,S]=uT(s),A=Math.sqrt(h*h+g*g);return[Math.round(A*1e4)?lT(Math.atan2(g,h)*R5):NaN,A,a,S]}function O5([s,a,h,g]){return s=isNaN(s)?0:s*D5,cT([h,Math.cos(s)*a,Math.sin(s)*a,g])}function B5([s,a,h,g]){s=lT(s),a/=100,h/=100;function S(A){const w=(A+s/30)%12,c=a*Math.min(h,1-h);return h-c*Math.max(-1,Math.min(w-3,9-w,1))}return[S(0),S(8),S(4),g]}const F5=Object.hasOwn||function(s,a){return Object.prototype.hasOwnProperty.call(s,a)};function yy(s,a){return F5(s,a)?s[a]:void 0}function N5(s){if(s=s.toLowerCase().trim(),s==="transparent")return[0,0,0,0];const a=yy(j5,s);if(a){const[S,A,w]=a;return[S/255,A/255,w/255,1]}if(s.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(s)){const S=s.length<6?1:2;let A=1;return[Y_(s.slice(A,A+=S)),Y_(s.slice(A,A+=S)),Y_(s.slice(A,A+=S)),Y_(s.slice(A,A+S)||"ff")]}if(s.startsWith("rgb")){const S=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,A=s.match(S);if(A){const[w,c,k,N,H,K,ae,ue,ge,fe,ce,qe]=A,Fe=[N||" ",ae||" ",fe].join("");if(Fe==="  "||Fe==="  /"||Fe===",,"||Fe===",,,"){const Ne=[k,K,ge].join(""),Be=Ne==="%%%"?100:Ne===""?255:0;if(Be){const Pe=[Rm(+c/Be,0,1),Rm(+H/Be,0,1),Rm(+ue/Be,0,1),ce?K1(+ce,qe):1];if(J1(Pe))return Pe}}return}}const h=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,g=s.match(h);if(g){const[S,A,w,c,k,N,H,K,ae]=g,ue=[w||" ",k||" ",H].join("");if(ue==="  "||ue==="  /"||ue===",,"||ue===",,,"){const ge=[+A,Rm(+c,0,100),Rm(+N,0,100),K?K1(+K,ae):1];if(J1(ge))return B5(ge)}}}function Y_(s){return parseInt(s.padEnd(2,s),16)/255}function K1(s,a){return Rm(a?s/100:s,0,1)}function Rm(s,a,h){return Math.min(Math.max(a,s),h)}function J1(s){return!s.some(Number.isNaN)}const j5={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Sp(s,a,h){return s+h*(a-s)}function Ey(s,a,h){return s.map((g,S)=>Sp(g,a[S],h))}class Hn{constructor(a,h,g,S=1,A=!0){this.r=a,this.g=h,this.b=g,this.a=S,A||(this.r*=S,this.g*=S,this.b*=S,S||this.overwriteGetter("rgb",[a,h,g,S]))}static parse(a){if(a instanceof Hn)return a;if(typeof a!="string")return;const h=N5(a);if(h)return new Hn(...h,!1)}get rgb(){const{r:a,g:h,b:g,a:S}=this,A=S||1/0;return this.overwriteGetter("rgb",[a/A,h/A,g/A,S])}get hcl(){return this.overwriteGetter("hcl",k5(this.rgb))}get lab(){return this.overwriteGetter("lab",uT(this.rgb))}overwriteGetter(a,h){return Object.defineProperty(this,a,{value:h}),h}toString(){const[a,h,g,S]=this.rgb;return`rgba(${[a,h,g].map(A=>Math.round(A*255)).join(",")},${S})`}static interpolate(a,h,g,S="rgb"){switch(S){case"rgb":{const[A,w,c,k]=Ey(a.rgb,h.rgb,g);return new Hn(A,w,c,k,!1)}case"hcl":{const[A,w,c,k]=a.hcl,[N,H,K,ae]=h.hcl;let ue,ge;if(!isNaN(A)&&!isNaN(N)){let Ne=N-A;N>A&&Ne>180?Ne-=360:N<A&&A-N>180&&(Ne+=360),ue=A+g*Ne}else isNaN(A)?isNaN(N)?ue=NaN:(ue=N,(c===1||c===0)&&(ge=H)):(ue=A,(K===1||K===0)&&(ge=w));const[fe,ce,qe,Fe]=O5([ue,ge??Sp(w,H,g),Sp(c,K,g),Sp(k,ae,g)]);return new Hn(fe,ce,qe,Fe,!1)}case"lab":{const[A,w,c,k]=cT(Ey(a.lab,h.lab,g));return new Hn(A,w,c,k,!1)}}}}Hn.black=new Hn(0,0,0,1);Hn.white=new Hn(1,1,1,1);Hn.transparent=new Hn(0,0,0,0);Hn.red=new Hn(1,0,0,1);class px{constructor(a,h,g){a?this.sensitivity=h?"variant":"case":this.sensitivity=h?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,h){return this.collator.compare(a,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const U5=["bottom","center","top"];class mb{constructor(a,h,g,S,A,w){this.text=a,this.image=h,this.scale=g,this.fontStack=S,this.textColor=A,this.verticalAlign=w}}class cd{constructor(a){this.sections=a}static fromString(a){return new cd([new mb(a,null,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof cd?a:cd.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}}class Lc{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Lc)return a;if(typeof a=="number")return new Lc([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(const h of a)if(typeof h!="number")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]];break}return new Lc(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,h,g){return new Lc(Ey(a.values,h.values,g))}}class Dc{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Dc)return a;if(typeof a=="number")return new Dc([a]);if(Array.isArray(a)){for(const h of a)if(typeof h!="number")return;return new Dc(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,h,g){return new Dc(Ey(a.values,h.values,g))}}class cu{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof cu)return a;if(typeof a=="string"){const g=Hn.parse(a);return g?new cu([g]):void 0}if(!Array.isArray(a))return;const h=[];for(const g of a){if(typeof g!="string")return;const S=Hn.parse(g);if(!S)return;h.push(S)}return new cu(h)}toString(){return JSON.stringify(this.values)}static interpolate(a,h,g,S="rgb"){const A=[];if(a.values.length!=h.values.length)throw new Error(`colorArray: Arrays have mismatched length (${a.values.length} vs. ${h.values.length}), cannot interpolate.`);for(let w=0;w<a.values.length;w++)A.push(Hn.interpolate(a.values[w],h.values[w],g,S));return new cu(A)}}class ua extends Error{constructor(a){super(a),this.name="RuntimeError"}toJSON(){return this.message}}const V5=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Eh{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Eh)return a;if(!(!Array.isArray(a)||a.length<1||a.length%2!==0)){for(let h=0;h<a.length;h+=2){const g=a[h],S=a[h+1];if(typeof g!="string"||!V5.has(g)||!Array.isArray(S)||S.length!==2||typeof S[0]!="number"||typeof S[1]!="number")return}return new Eh(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,h,g){const S=a.values,A=h.values;if(S.length!==A.length)throw new ua(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${h.toString()}`);const w=[];for(let c=0;c<S.length;c+=2){if(S[c]!==A[c])throw new ua(`Cannot interpolate values containing mismatched anchors. from[${c}]: ${S[c]}, to[${c}]: ${A[c]}`);w.push(S[c]);const[k,N]=S[c+1],[H,K]=A[c+1];w.push([Sp(k,H,g),Sp(N,K,g)])}return new Eh(w)}}class _f{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new _f({name:a,available:!1}):null}}class Pc{constructor(a,h,g){this.from=a,this.to=h,this.transition=g}static interpolate(a,h,g){return new Pc(a,h,g)}static parse(a){if(a instanceof Pc)return a;if(Array.isArray(a)&&a.length===3&&typeof a[0]=="string"&&typeof a[1]=="string"&&typeof a[2]=="number")return new Pc(a[0],a[1],a[2]);if(typeof a=="object"&&typeof a.from=="string"&&typeof a.to=="string"&&typeof a.transition=="number")return new Pc(a.from,a.to,a.transition);if(typeof a=="string")return new Pc(a,a,1)}}function hT(s,a,h,g){return typeof s=="number"&&s>=0&&s<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof h=="number"&&h>=0&&h<=255?typeof g>"u"||typeof g=="number"&&g>=0&&g<=1?null:`Invalid rgba value [${[s,a,h,g].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof g=="number"?[s,a,h,g]:[s,a,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ay(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Pc||s instanceof Hn||s instanceof px||s instanceof cd||s instanceof Lc||s instanceof Dc||s instanceof cu||s instanceof Eh||s instanceof _f)return!0;if(Array.isArray(s)){for(const a of s)if(!Ay(a))return!1;return!0}else if(typeof s=="object"){for(const a in s)if(!Ay(s[a]))return!1;return!0}else return!1}function to(s){if(s===null)return Dv;if(typeof s=="string")return Ji;if(typeof s=="boolean")return qi;if(typeof s=="number")return qt;if(s instanceof Hn)return Mh;if(s instanceof Pc)return Rv;if(s instanceof px)return kv;if(s instanceof cd)return Ov;if(s instanceof Lc)return Bv;if(s instanceof Dc)return Fv;if(s instanceof cu)return Sy;if(s instanceof Eh)return Nv;if(s instanceof _f)return Uy;if(Array.isArray(s)){const a=s.length;let h;for(const g of s){const S=to(g);if(!h)h=S;else{if(h===S)continue;h=ji;break}}return uu(h||ji,a)}else return wp}function _y(s){const a=typeof s;return s===null?"":a==="string"||a==="number"||a==="boolean"?String(s):s instanceof Hn||s instanceof Pc||s instanceof cd||s instanceof Lc||s instanceof Dc||s instanceof cu||s instanceof Eh||s instanceof _f?s.toString():JSON.stringify(s)}class Vm{constructor(a,h){this.type=a,this.value=h}static parse(a,h){if(a.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Ay(a[1]))return h.error("invalid value");const g=a[1];let S=to(g);const A=h.expectedType;return S.kind==="array"&&S.N===0&&A&&A.kind==="array"&&(typeof A.N!="number"||A.N===0)&&(S=A),new Vm(S,g)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const W_={string:Ji,number:qt,boolean:qi,object:wp};class zc{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let g=1,S;const A=a[0];if(A==="array"){let c;if(a.length>2){const N=a[1];if(typeof N!="string"||!(N in W_)||N==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);c=W_[N],g++}else c=ji;let k;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return h.error('The length argument to "array" must be a positive integer literal',2);k=a[2],g++}S=uu(c,k)}else{if(!W_[A])throw new Error(`Types doesn't contain name = ${A}`);S=W_[A]}const w=[];for(;g<a.length;g++){const c=h.parse(a[g],g,ji);if(!c)return null;w.push(c)}return new zc(S,w)}evaluate(a){for(let h=0;h<this.args.length;h++){const g=this.args[h].evaluate(a);if(My(this.type,to(g))){if(h===this.args.length-1)throw new ua(`Expected value to be of type ${Hr(this.type)}, but found ${Hr(to(g))} instead.`)}else return g}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const Q1={"to-boolean":qi,"to-color":Mh,"to-number":qt,"to-string":Ji};class df{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const g=a[0];if(!Q1[g])throw new Error(`Can't parse ${g} as it is not part of the known types`);if((g==="to-boolean"||g==="to-string")&&a.length!==2)return h.error("Expected one argument.");const S=Q1[g],A=[];for(let w=1;w<a.length;w++){const c=h.parse(a[w],w,ji);if(!c)return null;A.push(c)}return new df(S,A)}evaluate(a){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(a);case"color":{let h,g;for(const S of this.args){if(h=S.evaluate(a),g=null,h instanceof Hn)return h;if(typeof h=="string"){const A=a.parseColor(h);if(A)return A}else if(Array.isArray(h)&&(h.length<3||h.length>4?g=`Invalid rgba value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:g=hT(h[0],h[1],h[2],h[3]),!g))return new Hn(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new ua(g||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const g of this.args){h=g.evaluate(a);const S=Lc.parse(h);if(S)return S}throw new ua(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"numberArray":{let h;for(const g of this.args){h=g.evaluate(a);const S=Dc.parse(h);if(S)return S}throw new ua(`Could not parse numberArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"colorArray":{let h;for(const g of this.args){h=g.evaluate(a);const S=cu.parse(h);if(S)return S}throw new ua(`Could not parse colorArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const g of this.args){h=g.evaluate(a);const S=Eh.parse(h);if(S)return S}throw new ua(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const g of this.args){if(h=g.evaluate(a),h===null)return 0;const S=Number(h);if(!isNaN(S))return S}throw new ua(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return cd.fromString(_y(this.args[0].evaluate(a)));case"resolvedImage":return _f.fromString(_y(this.args[0].evaluate(a)));case"projectionDefinition":return this.args[0].evaluate(a);default:return _y(this.args[0].evaluate(a))}}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const G5=["Unknown","Point","LineString","Polygon"];class dT{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?G5[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let h=this._parseColorCache.get(a);return h||(h=Hn.parse(a),this._parseColorCache.set(a,h)),h}}class jv{constructor(a,h,g=[],S,A=new dx,w=[]){this.registry=a,this.path=g,this.key=g.map(c=>`[${c}]`).join(""),this.scope=A,this.errors=w,this.expectedType=S,this._isConstant=h}parse(a,h,g,S,A={}){return h?this.concat(h,g,S)._parse(a,A):this._parse(a,A)}_parse(a,h){(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number")&&(a=["literal",a]);function g(S,A,w){return w==="assert"?new zc(A,[S]):w==="coerce"?new df(A,[S]):S}if(Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const S=a[0];if(typeof S!="string")return this.error(`Expression name must be a string, but found ${typeof S} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const A=this.registry[S];if(A){let w=A.parse(a,this);if(!w)return null;if(this.expectedType){const c=this.expectedType,k=w.type;if((c.kind==="string"||c.kind==="number"||c.kind==="boolean"||c.kind==="object"||c.kind==="array")&&k.kind==="value")w=g(w,c,h.typeAnnotation||"assert");else if(c.kind==="projectionDefinition"&&["string","array"].includes(k.kind)||["color","formatted","resolvedImage"].includes(c.kind)&&["value","string"].includes(k.kind)||["padding","numberArray"].includes(c.kind)&&["value","number","array"].includes(k.kind)||c.kind==="colorArray"&&["value","string","array"].includes(k.kind)||c.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(k.kind))w=g(w,c,h.typeAnnotation||"coerce");else if(this.checkSubtype(c,k))return null}if(!(w instanceof Vm)&&w.type.kind!=="resolvedImage"&&this._isConstant(w)){const c=new dT;try{w=new Vm(w.type,w.evaluate(c))}catch(k){return this.error(k.message),null}}return w}return this.error(`Unknown expression "${S}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof a>"u"?this.error("'undefined' value invalid. Use null instead."):typeof a=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof a} instead.`)}concat(a,h,g){const S=typeof a=="number"?this.path.concat(a):this.path,A=g?this.scope.concat(g):this.scope;return new jv(this.registry,this._isConstant,S,h||null,A,this.errors)}error(a,...h){const g=`${this.key}${h.map(S=>`[${S}]`).join("")}`;this.errors.push(new Th(g,a))}checkSubtype(a,h){const g=My(a,h);return g&&this.error(g),g}}class Uv{constructor(a,h){this.type=h.type,this.bindings=[].concat(a),this.result=h}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const h of this.bindings)a(h[1]);a(this.result)}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const g=[];for(let A=1;A<a.length-1;A+=2){const w=a[A];if(typeof w!="string")return h.error(`Expected string, but found ${typeof w} instead.`,A);if(/[^a-zA-Z0-9_]/.test(w))return h.error("Variable names must contain only alphanumeric characters or '_'.",A);const c=h.parse(a[A+1],A+1);if(!c)return null;g.push([w,c])}const S=h.parse(a[a.length-1],a.length-1,h.expectedType,g);return S?new Uv(g,S):null}outputDefined(){return this.result.outputDefined()}}class Vv{constructor(a,h){this.type=h.type,this.name=a,this.boundExpression=h}static parse(a,h){if(a.length!==2||typeof a[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const g=a[1];return h.scope.has(g)?new Vv(g,h.scope.get(g)):h.error(`Unknown variable "${g}". Make sure "${g}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class mx{constructor(a,h,g){this.type=a,this.index=h,this.input=g}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const g=h.parse(a[1],1,qt),S=h.parse(a[2],2,uu(h.expectedType||ji));if(!g||!S)return null;const A=S.type;return new mx(A.itemType,g,S)}evaluate(a){const h=this.index.evaluate(a),g=this.input.evaluate(a);if(h<0)throw new ua(`Array index out of bounds: ${h} < 0.`);if(h>=g.length)throw new ua(`Array index out of bounds: ${h} > ${g.length-1}.`);if(h!==Math.floor(h))throw new ua(`Array index must be an integer, but found ${h} instead.`);return g[h]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class gx{constructor(a,h){this.type=qi,this.needle=a,this.haystack=h}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const g=h.parse(a[1],1,ji),S=h.parse(a[2],2,ji);return!g||!S?null:fx(g.type,[qi,Ji,qt,Dv,ji])?new gx(g,S):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hr(g.type)} instead`)}evaluate(a){const h=this.needle.evaluate(a),g=this.haystack.evaluate(a);if(!g)return!1;if(!Tp(h,["boolean","string","number","null"]))throw new ua(`Expected first argument to be of type boolean, string, number or null, but found ${Hr(to(h))} instead.`);if(!Tp(g,["string","array"]))throw new ua(`Expected second argument to be of type array or string, but found ${Hr(to(g))} instead.`);return g.indexOf(h)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class fv{constructor(a,h,g){this.type=qt,this.needle=a,this.haystack=h,this.fromIndex=g}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 2 or 3 arguments, but found ${a.length-1} instead.`);const g=h.parse(a[1],1,ji),S=h.parse(a[2],2,ji);if(!g||!S)return null;if(!fx(g.type,[qi,Ji,qt,Dv,ji]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hr(g.type)} instead`);if(a.length===4){const A=h.parse(a[3],3,qt);return A?new fv(g,S,A):null}else return new fv(g,S)}evaluate(a){const h=this.needle.evaluate(a),g=this.haystack.evaluate(a);if(!Tp(h,["boolean","string","number","null"]))throw new ua(`Expected first argument to be of type boolean, string, number or null, but found ${Hr(to(h))} instead.`);let S;if(this.fromIndex&&(S=this.fromIndex.evaluate(a)),Tp(g,["string"])){const A=g.indexOf(h,S);return A===-1?-1:[...g.slice(0,A)].length}else{if(Tp(g,["array"]))return g.indexOf(h,S);throw new ua(`Expected second argument to be of type array or string, but found ${Hr(to(g))} instead.`)}}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class yx{constructor(a,h,g,S,A,w){this.inputType=a,this.type=h,this.input=g,this.cases=S,this.outputs=A,this.otherwise=w}static parse(a,h){if(a.length<5)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!==1)return h.error("Expected an even number of arguments.");let g,S;h.expectedType&&h.expectedType.kind!=="value"&&(S=h.expectedType);const A={},w=[];for(let N=2;N<a.length-1;N+=2){let H=a[N];const K=a[N+1];Array.isArray(H)||(H=[H]);const ae=h.concat(N);if(H.length===0)return ae.error("Expected at least one branch label.");for(const ge of H){if(typeof ge!="number"&&typeof ge!="string")return ae.error("Branch labels must be numbers or strings.");if(typeof ge=="number"&&Math.abs(ge)>Number.MAX_SAFE_INTEGER)return ae.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ge=="number"&&Math.floor(ge)!==ge)return ae.error("Numeric branch labels must be integer values.");if(!g)g=to(ge);else if(ae.checkSubtype(g,to(ge)))return null;if(typeof A[String(ge)]<"u")return ae.error("Branch labels must be unique.");A[String(ge)]=w.length}const ue=h.parse(K,N,S);if(!ue)return null;S=S||ue.type,w.push(ue)}const c=h.parse(a[1],1,ji);if(!c)return null;const k=h.parse(a[a.length-1],a.length-1,S);return!k||c.type.kind!=="value"&&h.concat(1).checkSubtype(g,c.type)?null:new yx(g,S,c,A,w,k)}evaluate(a){const h=this.input.evaluate(a);return(to(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}}class _x{constructor(a,h,g){this.type=a,this.branches=h,this.otherwise=g}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!==0)return h.error("Expected an odd number of arguments.");let g;h.expectedType&&h.expectedType.kind!=="value"&&(g=h.expectedType);const S=[];for(let w=1;w<a.length-1;w+=2){const c=h.parse(a[w],w,qi);if(!c)return null;const k=h.parse(a[w+1],w+1,g);if(!k)return null;S.push([c,k]),g=g||k.type}const A=h.parse(a[a.length-1],a.length-1,g);if(!A)return null;if(!g)throw new Error("Can't infer output type");return new _x(g,S,A)}evaluate(a){for(const[h,g]of this.branches)if(h.evaluate(a))return g.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[h,g]of this.branches)a(h),a(g);a(this.otherwise)}outputDefined(){return this.branches.every(([a,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class pv{constructor(a,h,g,S){this.type=a,this.input=h,this.beginIndex=g,this.endIndex=S}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 2 or 3 arguments, but found ${a.length-1} instead.`);const g=h.parse(a[1],1,ji),S=h.parse(a[2],2,qt);if(!g||!S)return null;if(!fx(g.type,[uu(ji),Ji,ji]))return h.error(`Expected first argument to be of type array or string, but found ${Hr(g.type)} instead`);if(a.length===4){const A=h.parse(a[3],3,qt);return A?new pv(g.type,g,S,A):null}else return new pv(g.type,g,S)}evaluate(a){const h=this.input.evaluate(a),g=this.beginIndex.evaluate(a);let S;if(this.endIndex&&(S=this.endIndex.evaluate(a)),Tp(h,["string"]))return[...h].slice(g,S).join("");if(Tp(h,["array"]))return h.slice(g,S);throw new ua(`Expected first argument to be of type array or string, but found ${Hr(to(h))} instead.`)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function fT(s,a){const h=s.length-1;let g=0,S=h,A=0,w,c;for(;g<=S;)if(A=Math.floor((g+S)/2),w=s[A],c=s[A+1],w<=a){if(A===h||a<c)return A;g=A+1}else if(w>a)S=A-1;else throw new ua("Input is not a number.");return 0}class Gv{constructor(a,h,g){this.type=a,this.input=h,this.labels=[],this.outputs=[];for(const[S,A]of g)this.labels.push(S),this.outputs.push(A)}static parse(a,h){if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!==0)return h.error("Expected an even number of arguments.");const g=h.parse(a[1],1,qt);if(!g)return null;const S=[];let A=null;h.expectedType&&h.expectedType.kind!=="value"&&(A=h.expectedType);for(let w=1;w<a.length;w+=2){const c=w===1?-1/0:a[w],k=a[w+1],N=w,H=w+1;if(typeof c!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(S.length&&S[S.length-1][0]>=c)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',N);const K=h.parse(k,H,A);if(!K)return null;A=A||K.type,S.push([c,K])}return new Gv(A,g,S)}evaluate(a){const h=this.labels,g=this.outputs;if(h.length===1)return g[0].evaluate(a);const S=this.input.evaluate(a);if(S<=h[0])return g[0].evaluate(a);const A=h.length;if(S>=h[A-1])return g[A-1].evaluate(a);const w=fT(h,S);return g[w].evaluate(a)}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function Z5(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var q0,ew;function q5(){if(ew)return q0;ew=1,q0=s;function s(a,h,g,S){this.cx=3*a,this.bx=3*(g-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(S-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=h,this.p2x=g,this.p2y=S}return s.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,h){if(h===void 0&&(h=1e-6),a<0)return 0;if(a>1)return 1;for(var g=a,S=0;S<8;S++){var A=this.sampleCurveX(g)-a;if(Math.abs(A)<h)return g;var w=this.sampleCurveDerivativeX(g);if(Math.abs(w)<1e-6)break;g=g-A/w}var c=0,k=1;for(g=a,S=0;S<20&&(A=this.sampleCurveX(g),!(Math.abs(A-a)<h));S++)a>A?c=g:k=g,g=(k-c)*.5+c;return g},solve:function(a,h){return this.sampleCurveY(this.solveCurveX(a,h))}},q0}var $5=q5(),H5=Z5($5);class Ah{constructor(a,h,g,S,A){this.type=a,this.operator=h,this.interpolation=g,this.input=S,this.labels=[],this.outputs=[];for(const[w,c]of A)this.labels.push(w),this.outputs.push(c)}static interpolationFactor(a,h,g,S){let A=0;if(a.name==="exponential")A=$0(h,a.base,g,S);else if(a.name==="linear")A=$0(h,1,g,S);else if(a.name==="cubic-bezier"){const w=a.controlPoints;A=new H5(w[0],w[1],w[2],w[3]).solve($0(h,1,g,S))}return A}static parse(a,h){let[g,S,A,...w]=a;if(!Array.isArray(S)||S.length===0)return h.error("Expected an interpolation type expression.",1);if(S[0]==="linear")S={name:"linear"};else if(S[0]==="exponential"){const N=S[1];if(typeof N!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);S={name:"exponential",base:N}}else if(S[0]==="cubic-bezier"){const N=S.slice(1);if(N.length!==4||N.some(H=>typeof H!="number"||H<0||H>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);S={name:"cubic-bezier",controlPoints:N}}else return h.error(`Unknown interpolation type ${String(S[0])}`,1,0);if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!==0)return h.error("Expected an even number of arguments.");if(A=h.parse(A,2,qt),!A)return null;const c=[];let k=null;(g==="interpolate-hcl"||g==="interpolate-lab")&&h.expectedType!=Sy?k=Mh:h.expectedType&&h.expectedType.kind!=="value"&&(k=h.expectedType);for(let N=0;N<w.length;N+=2){const H=w[N],K=w[N+1],ae=N+3,ue=N+4;if(typeof H!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ae);if(c.length&&c[c.length-1][0]>=H)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ae);const ge=h.parse(K,ue,k);if(!ge)return null;k=k||ge.type,c.push([H,ge])}return!uf(k,qt)&&!uf(k,Rv)&&!uf(k,Mh)&&!uf(k,Bv)&&!uf(k,Fv)&&!uf(k,Sy)&&!uf(k,Nv)&&!uf(k,uu(qt))?h.error(`Type ${Hr(k)} is not interpolatable.`):new Ah(k,g,S,A,c)}evaluate(a){const h=this.labels,g=this.outputs;if(h.length===1)return g[0].evaluate(a);const S=this.input.evaluate(a);if(S<=h[0])return g[0].evaluate(a);const A=h.length;if(S>=h[A-1])return g[A-1].evaluate(a);const w=fT(h,S),c=h[w],k=h[w+1],N=Ah.interpolationFactor(this.interpolation,S,c,k),H=g[w].evaluate(a),K=g[w+1].evaluate(a);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Sp(H,K,N);case"color":return Hn.interpolate(H,K,N);case"padding":return Lc.interpolate(H,K,N);case"colorArray":return cu.interpolate(H,K,N);case"numberArray":return Dc.interpolate(H,K,N);case"variableAnchorOffsetCollection":return Eh.interpolate(H,K,N);case"array":return Ey(H,K,N);case"projectionDefinition":return Pc.interpolate(H,K,N)}case"interpolate-hcl":switch(this.type.kind){case"color":return Hn.interpolate(H,K,N,"hcl");case"colorArray":return cu.interpolate(H,K,N,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Hn.interpolate(H,K,N,"lab");case"colorArray":return cu.interpolate(H,K,N,"lab")}}}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function $0(s,a,h,g){const S=g-h,A=s-h;return S===0?0:a===1?A/S:(Math.pow(a,A)-1)/(Math.pow(a,S)-1)}class Cy{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let g=null;const S=h.expectedType;S&&S.kind!=="value"&&(g=S);const A=[];for(const w of a.slice(1)){const c=h.parse(w,1+A.length,g,void 0,{typeAnnotation:"omit"});if(!c)return null;g=g||c.type,A.push(c)}if(!g)throw new Error("No output type");return S&&A.some(w=>My(S,w.type))?new Cy(ji,A):new Cy(g,A)}evaluate(a){let h=null,g=0,S;for(const A of this.args)if(g++,h=A.evaluate(a),h&&h instanceof _f&&!h.available&&(S||(S=h.name),h=null,g===this.args.length&&(h=S)),h!==null)break;return h}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}function tw(s,a){return s==="=="||s==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function X5(s,a,h){return a===h}function Y5(s,a,h){return a!==h}function W5(s,a,h){return a<h}function K5(s,a,h){return a>h}function J5(s,a,h){return a<=h}function Q5(s,a,h){return a>=h}function pT(s,a,h,g){return g.compare(a,h)===0}function ez(s,a,h,g){return!pT(s,a,h,g)}function tz(s,a,h,g){return g.compare(a,h)<0}function iz(s,a,h,g){return g.compare(a,h)>0}function nz(s,a,h,g){return g.compare(a,h)<=0}function rz(s,a,h,g){return g.compare(a,h)>=0}function Km(s,a,h){const g=s!=="=="&&s!=="!=";return class mT{constructor(A,w,c){this.type=qi,this.lhs=A,this.rhs=w,this.collator=c,this.hasUntypedArgument=A.type.kind==="value"||w.type.kind==="value"}static parse(A,w){if(A.length!==3&&A.length!==4)return w.error("Expected two or three arguments.");const c=A[0];let k=w.parse(A[1],1,ji);if(!k)return null;if(!tw(c,k.type))return w.concat(1).error(`"${c}" comparisons are not supported for type '${Hr(k.type)}'.`);let N=w.parse(A[2],2,ji);if(!N)return null;if(!tw(c,N.type))return w.concat(2).error(`"${c}" comparisons are not supported for type '${Hr(N.type)}'.`);if(k.type.kind!==N.type.kind&&k.type.kind!=="value"&&N.type.kind!=="value")return w.error(`Cannot compare types '${Hr(k.type)}' and '${Hr(N.type)}'.`);g&&(k.type.kind==="value"&&N.type.kind!=="value"?k=new zc(N.type,[k]):k.type.kind!=="value"&&N.type.kind==="value"&&(N=new zc(k.type,[N])));let H=null;if(A.length===4){if(k.type.kind!=="string"&&N.type.kind!=="string"&&k.type.kind!=="value"&&N.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(H=w.parse(A[3],3,kv),!H)return null}return new mT(k,N,H)}evaluate(A){const w=this.lhs.evaluate(A),c=this.rhs.evaluate(A);if(g&&this.hasUntypedArgument){const k=to(w),N=to(c);if(k.kind!==N.kind||!(k.kind==="string"||k.kind==="number"))throw new ua(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${k.kind}, ${N.kind}) instead.`)}if(this.collator&&!g&&this.hasUntypedArgument){const k=to(w),N=to(c);if(k.kind!=="string"||N.kind!=="string")return a(A,w,c)}return this.collator?h(A,w,c,this.collator.evaluate(A)):a(A,w,c)}eachChild(A){A(this.lhs),A(this.rhs),this.collator&&A(this.collator)}outputDefined(){return!0}}}const az=Km("==",X5,pT),oz=Km("!=",Y5,ez),sz=Km("<",W5,tz),lz=Km(">",K5,iz),uz=Km("<=",J5,nz),cz=Km(">=",Q5,rz);class Zv{constructor(a,h,g){this.type=kv,this.locale=g,this.caseSensitive=a,this.diacriticSensitive=h}static parse(a,h){if(a.length!==2)return h.error("Expected one argument.");const g=a[1];if(typeof g!="object"||Array.isArray(g))return h.error("Collator options argument must be an object.");const S=h.parse(g["case-sensitive"]===void 0?!1:g["case-sensitive"],1,qi);if(!S)return null;const A=h.parse(g["diacritic-sensitive"]===void 0?!1:g["diacritic-sensitive"],1,qi);if(!A)return null;let w=null;return g.locale&&(w=h.parse(g.locale,1,Ji),!w)?null:new Zv(S,A,w)}evaluate(a){return new px(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}class vx{constructor(a,h,g,S,A){this.type=Ji,this.number=a,this.locale=h,this.currency=g,this.minFractionDigits=S,this.maxFractionDigits=A}static parse(a,h){if(a.length!==3)return h.error("Expected two arguments.");const g=h.parse(a[1],1,qt);if(!g)return null;const S=a[2];if(typeof S!="object"||Array.isArray(S))return h.error("NumberFormat options argument must be an object.");let A=null;if(S.locale&&(A=h.parse(S.locale,1,Ji),!A))return null;let w=null;if(S.currency&&(w=h.parse(S.currency,1,Ji),!w))return null;let c=null;if(S["min-fraction-digits"]&&(c=h.parse(S["min-fraction-digits"],1,qt),!c))return null;let k=null;return S["max-fraction-digits"]&&(k=h.parse(S["max-fraction-digits"],1,qt),!k)?null:new vx(g,A,w,c,k)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class bx{constructor(a){this.type=Ov,this.sections=a}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const g=a[1];if(!Array.isArray(g)&&typeof g=="object")return h.error("First argument must be an image or text section.");const S=[];let A=!1;for(let w=1;w<=a.length-1;++w){const c=a[w];if(A&&typeof c=="object"&&!Array.isArray(c)){A=!1;let k=null;if(c["font-scale"]&&(k=h.parse(c["font-scale"],1,qt),!k))return null;let N=null;if(c["text-font"]&&(N=h.parse(c["text-font"],1,uu(Ji)),!N))return null;let H=null;if(c["text-color"]&&(H=h.parse(c["text-color"],1,Mh),!H))return null;let K=null;if(c["vertical-align"]){if(typeof c["vertical-align"]=="string"&&!U5.includes(c["vertical-align"]))return h.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${c["vertical-align"]}' instead.`);if(K=h.parse(c["vertical-align"],1,Ji),!K)return null}const ae=S[S.length-1];ae.scale=k,ae.font=N,ae.textColor=H,ae.verticalAlign=K}else{const k=h.parse(a[w],1,ji);if(!k)return null;const N=k.type.kind;if(N!=="string"&&N!=="value"&&N!=="null"&&N!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");A=!0,S.push({content:k,scale:null,font:null,textColor:null,verticalAlign:null})}}return new bx(S)}evaluate(a){const h=g=>{const S=g.content.evaluate(a);return to(S)===Uy?new mb("",S,null,null,null,g.verticalAlign?g.verticalAlign.evaluate(a):null):new mb(_y(S),null,g.scale?g.scale.evaluate(a):null,g.font?g.font.evaluate(a).join(","):null,g.textColor?g.textColor.evaluate(a):null,g.verticalAlign?g.verticalAlign.evaluate(a):null)};return new cd(this.sections.map(h))}eachChild(a){for(const h of this.sections)a(h.content),h.scale&&a(h.scale),h.font&&a(h.font),h.textColor&&a(h.textColor),h.verticalAlign&&a(h.verticalAlign)}outputDefined(){return!1}}class xx{constructor(a){this.type=Uy,this.input=a}static parse(a,h){if(a.length!==2)return h.error("Expected two arguments.");const g=h.parse(a[1],1,Ji);return g?new xx(g):h.error("No image name provided.")}evaluate(a){const h=this.input.evaluate(a),g=_f.fromString(h);return g&&a.availableImages&&(g.available=a.availableImages.indexOf(h)>-1),g}eachChild(a){a(this.input)}outputDefined(){return!1}}class wx{constructor(a){this.type=qt,this.input=a}static parse(a,h){if(a.length!==2)return h.error(`Expected 1 argument, but found ${a.length-1} instead.`);const g=h.parse(a[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Hr(g.type)} instead.`):new wx(g):null}evaluate(a){const h=this.input.evaluate(a);if(typeof h=="string")return[...h].length;if(Array.isArray(h))return h.length;throw new ua(`Expected value to be of type string or array, but found ${Hr(to(h))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}const Ch=8192;function hz(s,a){const h=dz(s[0]),g=pz(s[1]),S=Math.pow(2,a.z);return[Math.round(h*S*Ch),Math.round(g*S*Ch)]}function Tx(s,a){const h=Math.pow(2,a.z),g=(s[0]/Ch+a.x)/h,S=(s[1]/Ch+a.y)/h;return[fz(g),mz(S)]}function dz(s){return(180+s)/360}function fz(s){return s*360-180}function pz(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function mz(s){return 360/Math.PI*Math.atan(Math.exp((180-s*360)*Math.PI/180))-90}function Vy(s,a){s[0]=Math.min(s[0],a[0]),s[1]=Math.min(s[1],a[1]),s[2]=Math.max(s[2],a[0]),s[3]=Math.max(s[3],a[1])}function Py(s,a){return!(s[0]<=a[0]||s[2]>=a[2]||s[1]<=a[1]||s[3]>=a[3])}function gz(s,a,h){return a[1]>s[1]!=h[1]>s[1]&&s[0]<(h[0]-a[0])*(s[1]-a[1])/(h[1]-a[1])+a[0]}function yz(s,a,h){const g=s[0]-a[0],S=s[1]-a[1],A=s[0]-h[0],w=s[1]-h[1];return g*w-A*S===0&&g*A<=0&&S*w<=0}function qv(s,a,h,g){const S=[a[0]-s[0],a[1]-s[1]],A=[g[0]-h[0],g[1]-h[1]];return xz(A,S)===0?!1:!!(iw(s,a,h,g)&&iw(h,g,s,a))}function _z(s,a,h){for(const g of h)for(let S=0;S<g.length-1;++S)if(qv(s,a,g[S],g[S+1]))return!0;return!1}function Jm(s,a,h=!1){let g=!1;for(const S of a)for(let A=0;A<S.length-1;A++){if(yz(s,S[A],S[A+1]))return h;gz(s,S[A],S[A+1])&&(g=!g)}return g}function vz(s,a){for(const h of a)if(Jm(s,h))return!0;return!1}function gT(s,a){for(const h of s)if(!Jm(h,a))return!1;for(let h=0;h<s.length-1;++h)if(_z(s[h],s[h+1],a))return!1;return!0}function bz(s,a){for(const h of a)if(gT(s,h))return!0;return!1}function xz(s,a){return s[0]*a[1]-s[1]*a[0]}function iw(s,a,h,g){const S=s[0]-h[0],A=s[1]-h[1],w=a[0]-h[0],c=a[1]-h[1],k=g[0]-h[0],N=g[1]-h[1],H=S*N-k*A,K=w*N-k*c;return H>0&&K<0||H<0&&K>0}function Sx(s,a,h){const g=[];for(let S=0;S<s.length;S++){const A=[];for(let w=0;w<s[S].length;w++){const c=hz(s[S][w],h);Vy(a,c),A.push(c)}g.push(A)}return g}function yT(s,a,h){const g=[];for(let S=0;S<s.length;S++){const A=Sx(s[S],a,h);g.push(A)}return g}function _T(s,a,h,g){if(s[0]<h[0]||s[0]>h[2]){const S=g*.5;let A=s[0]-h[0]>S?-g:h[0]-s[0]>S?g:0;A===0&&(A=s[0]-h[2]>S?-g:h[2]-s[0]>S?g:0),s[0]+=A}Vy(a,s)}function wz(s){s[0]=s[1]=1/0,s[2]=s[3]=-1/0}function nw(s,a,h,g){const S=Math.pow(2,g.z)*Ch,A=[g.x*Ch,g.y*Ch],w=[];for(const c of s)for(const k of c){const N=[k.x+A[0],k.y+A[1]];_T(N,a,h,S),w.push(N)}return w}function rw(s,a,h,g){const S=Math.pow(2,g.z)*Ch,A=[g.x*Ch,g.y*Ch],w=[];for(const c of s){const k=[];for(const N of c){const H=[N.x+A[0],N.y+A[1]];Vy(a,H),k.push(H)}w.push(k)}if(a[2]-a[0]<=S/2){wz(a);for(const c of w)for(const k of c)_T(k,a,h,S)}return w}function Tz(s,a){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],S=s.canonicalID();if(a.type==="Polygon"){const A=Sx(a.coordinates,g,S),w=nw(s.geometry(),h,g,S);if(!Py(h,g))return!1;for(const c of w)if(!Jm(c,A))return!1}if(a.type==="MultiPolygon"){const A=yT(a.coordinates,g,S),w=nw(s.geometry(),h,g,S);if(!Py(h,g))return!1;for(const c of w)if(!vz(c,A))return!1}return!0}function Sz(s,a){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],S=s.canonicalID();if(a.type==="Polygon"){const A=Sx(a.coordinates,g,S),w=rw(s.geometry(),h,g,S);if(!Py(h,g))return!1;for(const c of w)if(!gT(c,A))return!1}if(a.type==="MultiPolygon"){const A=yT(a.coordinates,g,S),w=rw(s.geometry(),h,g,S);if(!Py(h,g))return!1;for(const c of w)if(!bz(c,A))return!1}return!0}class Mp{constructor(a,h){this.type=qi,this.geojson=a,this.geometries=h}static parse(a,h){if(a.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Ay(a[1])){const g=a[1];if(g.type==="FeatureCollection"){const S=[];for(const A of g.features){const{type:w,coordinates:c}=A.geometry;w==="Polygon"&&S.push(c),w==="MultiPolygon"&&S.push(...c)}if(S.length){const A={type:"MultiPolygon",coordinates:S};return new Mp(g,A)}}else if(g.type==="Feature"){const S=g.geometry.type;if(S==="Polygon"||S==="MultiPolygon")return new Mp(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new Mp(g,g)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return Tz(a,this.geometries);if(a.geometryType()==="LineString")return Sz(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class vT{constructor(a=[],h=(g,S)=>g<S?-1:g>S?1:0){if(this.data=a,this.length=this.data.length,this.compare=h,this.length>0)for(let g=(this.length>>1)-1;g>=0;g--)this._down(g)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:h,compare:g}=this,S=h[a];for(;a>0;){const A=a-1>>1,w=h[A];if(g(S,w)>=0)break;h[a]=w,a=A}h[a]=S}_down(a){const{data:h,compare:g}=this,S=this.length>>1,A=h[a];for(;a<S;){let w=(a<<1)+1;const c=w+1;if(c<this.length&&g(h[c],h[w])<0&&(w=c),g(h[w],A)>=0)break;h[a]=h[w],a=w}h[a]=A}}function Mz(s,a){if(s.length<=1)return[s];const h=[];let g,S;for(const A of s){const w=Ez(A);w!==0&&(A.area=Math.abs(w),S===void 0&&(S=w<0),S===w<0?(g&&h.push(g),g=[A]):g.push(A))}return g&&h.push(g),h}function Ez(s){let a=0;for(let h=0,g=s.length,S=g-1,A,w;h<g;S=h++)A=s[h],w=s[S],a+=(w.x-A.x)*(A.y+w.y);return a}const Az=6378.137,aw=1/298.257223563,ow=aw*(2-aw),sw=Math.PI/180;class Mx{constructor(a){const h=sw*Az*1e3,g=Math.cos(a*sw),S=1/(1-ow*(1-g*g)),A=Math.sqrt(S);this.kx=h*A*g,this.ky=h*A*S*(1-ow)}distance(a,h){const g=this.wrap(a[0]-h[0])*this.kx,S=(a[1]-h[1])*this.ky;return Math.sqrt(g*g+S*S)}pointOnLine(a,h){let g=1/0,S,A,w,c;for(let k=0;k<a.length-1;k++){let N=a[k][0],H=a[k][1],K=this.wrap(a[k+1][0]-N)*this.kx,ae=(a[k+1][1]-H)*this.ky,ue=0;(K!==0||ae!==0)&&(ue=(this.wrap(h[0]-N)*this.kx*K+(h[1]-H)*this.ky*ae)/(K*K+ae*ae),ue>1?(N=a[k+1][0],H=a[k+1][1]):ue>0&&(N+=K/this.kx*ue,H+=ae/this.ky*ue)),K=this.wrap(h[0]-N)*this.kx,ae=(h[1]-H)*this.ky;const ge=K*K+ae*ae;ge<g&&(g=ge,S=N,A=H,w=k,c=ue)}return{point:[S,A],index:w,t:Math.max(0,Math.min(1,c))}}wrap(a){for(;a<-180;)a+=360;for(;a>180;)a-=360;return a}}const gb=100,yb=50;function bT(s,a){return a[0]-s[0]}function mv(s){return s[1]-s[0]+1}function dd(s,a){return s[1]>=s[0]&&s[1]<a}function _b(s,a){if(s[0]>s[1])return[null,null];const h=mv(s);if(a){if(h===2)return[s,null];const S=Math.floor(h/2);return[[s[0],s[0]+S],[s[0]+S,s[1]]]}if(h===1)return[s,null];const g=Math.floor(h/2)-1;return[[s[0],s[0]+g],[s[0]+g+1,s[1]]]}function vb(s,a){if(!dd(a,s.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let g=a[0];g<=a[1];++g)Vy(h,s[g]);return h}function bb(s){const a=[1/0,1/0,-1/0,-1/0];for(const h of s)for(const g of h)Vy(a,g);return a}function lw(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function Ex(s,a,h){if(!lw(s)||!lw(a))return NaN;let g=0,S=0;return s[2]<a[0]&&(g=a[0]-s[2]),s[0]>a[2]&&(g=s[0]-a[2]),s[1]>a[3]&&(S=s[1]-a[3]),s[3]<a[1]&&(S=a[1]-s[3]),h.distance([0,0],[g,S])}function xp(s,a,h){const g=h.pointOnLine(a,s);return h.distance(s,g.point)}function Ax(s,a,h,g,S){const A=Math.min(xp(s,[h,g],S),xp(a,[h,g],S)),w=Math.min(xp(h,[s,a],S),xp(g,[s,a],S));return Math.min(A,w)}function Cz(s,a,h,g,S){if(!(dd(a,s.length)&&dd(g,h.length)))return 1/0;let A=1/0;for(let w=a[0];w<a[1];++w){const c=s[w],k=s[w+1];for(let N=g[0];N<g[1];++N){const H=h[N],K=h[N+1];if(qv(c,k,H,K))return 0;A=Math.min(A,Ax(c,k,H,K,S))}}return A}function Pz(s,a,h,g,S){if(!(dd(a,s.length)&&dd(g,h.length)))return NaN;let A=1/0;for(let w=a[0];w<=a[1];++w)for(let c=g[0];c<=g[1];++c)if(A=Math.min(A,S.distance(s[w],h[c])),A===0)return A;return A}function zz(s,a,h){if(Jm(s,a,!0))return 0;let g=1/0;for(const S of a){const A=S[0],w=S[S.length-1];if(A!==w&&(g=Math.min(g,xp(s,[w,A],h)),g===0))return g;const c=h.pointOnLine(S,s);if(g=Math.min(g,h.distance(s,c.point)),g===0)return g}return g}function Iz(s,a,h,g){if(!dd(a,s.length))return NaN;for(let A=a[0];A<=a[1];++A)if(Jm(s[A],h,!0))return 0;let S=1/0;for(let A=a[0];A<a[1];++A){const w=s[A],c=s[A+1];for(const k of h)for(let N=0,H=k.length,K=H-1;N<H;K=N++){const ae=k[K],ue=k[N];if(qv(w,c,ae,ue))return 0;S=Math.min(S,Ax(w,c,ae,ue,g))}}return S}function uw(s,a){for(const h of s)for(const g of h)if(Jm(g,a,!0))return!0;return!1}function Lz(s,a,h,g=1/0){const S=bb(s),A=bb(a);if(g!==1/0&&Ex(S,A,h)>=g)return g;if(Py(S,A)){if(uw(s,a))return 0}else if(uw(a,s))return 0;let w=1/0;for(const c of s)for(let k=0,N=c.length,H=N-1;k<N;H=k++){const K=c[H],ae=c[k];for(const ue of a)for(let ge=0,fe=ue.length,ce=fe-1;ge<fe;ce=ge++){const qe=ue[ce],Fe=ue[ge];if(qv(K,ae,qe,Fe))return 0;w=Math.min(w,Ax(K,ae,qe,Fe,h))}}return w}function cw(s,a,h,g,S,A){if(!A)return;const w=Ex(vb(g,A),S,h);w<a&&s.push([w,A,[0,0]])}function K_(s,a,h,g,S,A,w){if(!A||!w)return;const c=Ex(vb(g,A),vb(S,w),h);c<a&&s.push([c,A,w])}function gv(s,a,h,g,S=1/0){let A=Math.min(g.distance(s[0],h[0][0]),S);if(A===0)return A;const w=new vT([[0,[0,s.length-1],[0,0]]],bT),c=bb(h);for(;w.length>0;){const k=w.pop();if(k[0]>=A)continue;const N=k[1],H=a?yb:gb;if(mv(N)<=H){if(!dd(N,s.length))return NaN;if(a){const K=Iz(s,N,h,g);if(isNaN(K)||K===0)return K;A=Math.min(A,K)}else for(let K=N[0];K<=N[1];++K){const ae=zz(s[K],h,g);if(A=Math.min(A,ae),A===0)return 0}}else{const K=_b(N,a);cw(w,A,g,s,c,K[0]),cw(w,A,g,s,c,K[1])}}return A}function yv(s,a,h,g,S,A=1/0){let w=Math.min(A,S.distance(s[0],h[0]));if(w===0)return w;const c=new vT([[0,[0,s.length-1],[0,h.length-1]]],bT);for(;c.length>0;){const k=c.pop();if(k[0]>=w)continue;const N=k[1],H=k[2],K=a?yb:gb,ae=g?yb:gb;if(mv(N)<=K&&mv(H)<=ae){if(!dd(N,s.length)&&dd(H,h.length))return NaN;let ue;if(a&&g)ue=Cz(s,N,h,H,S),w=Math.min(w,ue);else if(a&&!g){const ge=s.slice(N[0],N[1]+1);for(let fe=H[0];fe<=H[1];++fe)if(ue=xp(h[fe],ge,S),w=Math.min(w,ue),w===0)return w}else if(!a&&g){const ge=h.slice(H[0],H[1]+1);for(let fe=N[0];fe<=N[1];++fe)if(ue=xp(s[fe],ge,S),w=Math.min(w,ue),w===0)return w}else ue=Pz(s,N,h,H,S),w=Math.min(w,ue)}else{const ue=_b(N,a),ge=_b(H,g);K_(c,w,S,s,h,ue[0],ge[0]),K_(c,w,S,s,h,ue[0],ge[1]),K_(c,w,S,s,h,ue[1],ge[0]),K_(c,w,S,s,h,ue[1],ge[1])}}return w}function Dz(s,a){const h=s.geometry(),g=h.flat().map(w=>Tx([w.x,w.y],s.canonical));if(h.length===0)return NaN;const S=new Mx(g[0][1]);let A=1/0;for(const w of a){switch(w.type){case"Point":A=Math.min(A,yv(g,!1,[w.coordinates],!1,S,A));break;case"LineString":A=Math.min(A,yv(g,!1,w.coordinates,!0,S,A));break;case"Polygon":A=Math.min(A,gv(g,!1,w.coordinates,S,A));break}if(A===0)return A}return A}function Rz(s,a){const h=s.geometry(),g=h.flat().map(w=>Tx([w.x,w.y],s.canonical));if(h.length===0)return NaN;const S=new Mx(g[0][1]);let A=1/0;for(const w of a){switch(w.type){case"Point":A=Math.min(A,yv(g,!0,[w.coordinates],!1,S,A));break;case"LineString":A=Math.min(A,yv(g,!0,w.coordinates,!0,S,A));break;case"Polygon":A=Math.min(A,gv(g,!0,w.coordinates,S,A));break}if(A===0)return A}return A}function kz(s,a){const h=s.geometry();if(h.length===0||h[0].length===0)return NaN;const g=Mz(h).map(w=>w.map(c=>c.map(k=>Tx([k.x,k.y],s.canonical)))),S=new Mx(g[0][0][0][1]);let A=1/0;for(const w of a)for(const c of g){switch(w.type){case"Point":A=Math.min(A,gv([w.coordinates],!1,c,S,A));break;case"LineString":A=Math.min(A,gv(w.coordinates,!0,c,S,A));break;case"Polygon":A=Math.min(A,Lz(c,w.coordinates,S,A));break}if(A===0)return A}return A}function H0(s){return s.type==="MultiPolygon"?s.coordinates.map(a=>({type:"Polygon",coordinates:a})):s.type==="MultiLineString"?s.coordinates.map(a=>({type:"LineString",coordinates:a})):s.type==="MultiPoint"?s.coordinates.map(a=>({type:"Point",coordinates:a})):[s]}class Ep{constructor(a,h){this.type=qt,this.geojson=a,this.geometries=h}static parse(a,h){if(a.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Ay(a[1])){const g=a[1];if(g.type==="FeatureCollection")return new Ep(g,g.features.map(S=>H0(S.geometry)).flat());if(g.type==="Feature")return new Ep(g,H0(g.geometry));if("type"in g&&"coordinates"in g)return new Ep(g,H0(g))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return Dz(a,this.geometries);if(a.geometryType()==="LineString")return Rz(a,this.geometries);if(a.geometryType()==="Polygon")return kz(a,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Gy{constructor(a){this.type=ji,this.key=a}static parse(a,h){if(a.length!==2)return h.error(`Expected 1 argument, but found ${a.length-1} instead.`);const g=a[1];return g==null?h.error("Global state property must be defined."):typeof g!="string"?h.error(`Global state property must be string, but found ${typeof a[1]} instead.`):new Gy(g)}evaluate(a){var h;const g=(h=a.globals)===null||h===void 0?void 0:h.globalState;return!g||Object.keys(g).length===0?null:yy(g,this.key)}eachChild(){}outputDefined(){return!1}}const Cx={"==":az,"!=":oz,">":lz,"<":sz,">=":cz,"<=":uz,array:zc,at:mx,boolean:zc,case:_x,coalesce:Cy,collator:Zv,format:bx,image:xx,in:gx,"index-of":fv,interpolate:Ah,"interpolate-hcl":Ah,"interpolate-lab":Ah,length:wx,let:Uv,literal:Vm,match:yx,number:zc,"number-format":vx,object:zc,slice:pv,step:Gv,string:zc,"to-boolean":df,"to-color":df,"to-number":df,"to-string":df,var:Vv,within:Mp,distance:Ep,"global-state":Gy};class Rc{constructor(a,h,g,S){this.name=a,this.type=h,this._evaluate=g,this.args=S}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,h){const g=a[0],S=Rc.definitions[g];if(!S)return h.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0);const A=Array.isArray(S)?S[0]:S.type,w=Array.isArray(S)?[[S[1],S[2]]]:S.overloads,c=w.filter(([N])=>!Array.isArray(N)||N.length===a.length-1);let k=null;for(const[N,H]of c){k=new jv(h.registry,_v,h.path,null,h.scope);const K=[];let ae=!1;for(let ue=1;ue<a.length;ue++){const ge=a[ue],fe=Array.isArray(N)?N[ue-1]:N.type,ce=k.parse(ge,1+K.length,fe);if(!ce){ae=!0;break}K.push(ce)}if(!ae){if(Array.isArray(N)&&N.length!==K.length){k.error(`Expected ${N.length} arguments, but found ${K.length} instead.`);continue}for(let ue=0;ue<K.length;ue++){const ge=Array.isArray(N)?N[ue]:N.type,fe=K[ue];k.concat(ue+1).checkSubtype(ge,fe.type)}if(k.errors.length===0)return new Rc(g,A,H,K)}}if(c.length===1)h.errors.push(...k.errors);else{const N=(c.length?c:w).map(([K])=>Bz(K)).join(" | "),H=[];for(let K=1;K<a.length;K++){const ae=h.parse(a[K],1+H.length);if(!ae)return null;H.push(Hr(ae.type))}h.error(`Expected arguments of type ${N}, but found (${H.join(", ")}) instead.`)}return null}static register(a,h){Rc.definitions=h;for(const g in h)a[g]=Rc}}function hw(s,[a,h,g,S]){a=a.evaluate(s),h=h.evaluate(s),g=g.evaluate(s);const A=S?S.evaluate(s):1,w=hT(a,h,g,A);if(w)throw new ua(w);return new Hn(a/255,h/255,g/255,A,!1)}function dw(s,a){return s in a}function X0(s,a){const h=a[s];return typeof h>"u"?null:h}function Oz(s,a,h,g){for(;h<=g;){const S=h+g>>1;if(a[S]===s)return!0;a[S]>s?g=S-1:h=S+1}return!1}function pp(s){return{type:s}}Rc.register(Cx,{error:[z5,[Ji],(s,[a])=>{throw new ua(a.evaluate(s))}],typeof:[Ji,[ji],(s,[a])=>Hr(to(a.evaluate(s)))],"to-rgba":[uu(qt,4),[Mh],(s,[a])=>{const[h,g,S,A]=a.evaluate(s).rgb;return[h*255,g*255,S*255,A]}],rgb:[Mh,[qt,qt,qt],hw],rgba:[Mh,[qt,qt,qt,qt],hw],has:{type:qi,overloads:[[[Ji],(s,[a])=>dw(a.evaluate(s),s.properties())],[[Ji,wp],(s,[a,h])=>dw(a.evaluate(s),h.evaluate(s))]]},get:{type:ji,overloads:[[[Ji],(s,[a])=>X0(a.evaluate(s),s.properties())],[[Ji,wp],(s,[a,h])=>X0(a.evaluate(s),h.evaluate(s))]]},"feature-state":[ji,[Ji],(s,[a])=>X0(a.evaluate(s),s.featureState||{})],properties:[wp,[],s=>s.properties()],"geometry-type":[Ji,[],s=>s.geometryType()],id:[ji,[],s=>s.id()],zoom:[qt,[],s=>s.globals.zoom],"heatmap-density":[qt,[],s=>s.globals.heatmapDensity||0],elevation:[qt,[],s=>s.globals.elevation||0],"line-progress":[qt,[],s=>s.globals.lineProgress||0],accumulated:[ji,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[qt,pp(qt),(s,a)=>{let h=0;for(const g of a)h+=g.evaluate(s);return h}],"*":[qt,pp(qt),(s,a)=>{let h=1;for(const g of a)h*=g.evaluate(s);return h}],"-":{type:qt,overloads:[[[qt,qt],(s,[a,h])=>a.evaluate(s)-h.evaluate(s)],[[qt],(s,[a])=>-a.evaluate(s)]]},"/":[qt,[qt,qt],(s,[a,h])=>a.evaluate(s)/h.evaluate(s)],"%":[qt,[qt,qt],(s,[a,h])=>a.evaluate(s)%h.evaluate(s)],ln2:[qt,[],()=>Math.LN2],pi:[qt,[],()=>Math.PI],e:[qt,[],()=>Math.E],"^":[qt,[qt,qt],(s,[a,h])=>Math.pow(a.evaluate(s),h.evaluate(s))],sqrt:[qt,[qt],(s,[a])=>Math.sqrt(a.evaluate(s))],log10:[qt,[qt],(s,[a])=>Math.log(a.evaluate(s))/Math.LN10],ln:[qt,[qt],(s,[a])=>Math.log(a.evaluate(s))],log2:[qt,[qt],(s,[a])=>Math.log(a.evaluate(s))/Math.LN2],sin:[qt,[qt],(s,[a])=>Math.sin(a.evaluate(s))],cos:[qt,[qt],(s,[a])=>Math.cos(a.evaluate(s))],tan:[qt,[qt],(s,[a])=>Math.tan(a.evaluate(s))],asin:[qt,[qt],(s,[a])=>Math.asin(a.evaluate(s))],acos:[qt,[qt],(s,[a])=>Math.acos(a.evaluate(s))],atan:[qt,[qt],(s,[a])=>Math.atan(a.evaluate(s))],min:[qt,pp(qt),(s,a)=>Math.min(...a.map(h=>h.evaluate(s)))],max:[qt,pp(qt),(s,a)=>Math.max(...a.map(h=>h.evaluate(s)))],abs:[qt,[qt],(s,[a])=>Math.abs(a.evaluate(s))],round:[qt,[qt],(s,[a])=>{const h=a.evaluate(s);return h<0?-Math.round(-h):Math.round(h)}],floor:[qt,[qt],(s,[a])=>Math.floor(a.evaluate(s))],ceil:[qt,[qt],(s,[a])=>Math.ceil(a.evaluate(s))],"filter-==":[qi,[Ji,ji],(s,[a,h])=>s.properties()[a.value]===h.value],"filter-id-==":[qi,[ji],(s,[a])=>s.id()===a.value],"filter-type-==":[qi,[Ji],(s,[a])=>s.geometryType()===a.value],"filter-<":[qi,[Ji,ji],(s,[a,h])=>{const g=s.properties()[a.value],S=h.value;return typeof g==typeof S&&g<S}],"filter-id-<":[qi,[ji],(s,[a])=>{const h=s.id(),g=a.value;return typeof h==typeof g&&h<g}],"filter->":[qi,[Ji,ji],(s,[a,h])=>{const g=s.properties()[a.value],S=h.value;return typeof g==typeof S&&g>S}],"filter-id->":[qi,[ji],(s,[a])=>{const h=s.id(),g=a.value;return typeof h==typeof g&&h>g}],"filter-<=":[qi,[Ji,ji],(s,[a,h])=>{const g=s.properties()[a.value],S=h.value;return typeof g==typeof S&&g<=S}],"filter-id-<=":[qi,[ji],(s,[a])=>{const h=s.id(),g=a.value;return typeof h==typeof g&&h<=g}],"filter->=":[qi,[Ji,ji],(s,[a,h])=>{const g=s.properties()[a.value],S=h.value;return typeof g==typeof S&&g>=S}],"filter-id->=":[qi,[ji],(s,[a])=>{const h=s.id(),g=a.value;return typeof h==typeof g&&h>=g}],"filter-has":[qi,[ji],(s,[a])=>a.value in s.properties()],"filter-has-id":[qi,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[qi,[uu(Ji)],(s,[a])=>a.value.indexOf(s.geometryType())>=0],"filter-id-in":[qi,[uu(ji)],(s,[a])=>a.value.indexOf(s.id())>=0],"filter-in-small":[qi,[Ji,uu(ji)],(s,[a,h])=>h.value.indexOf(s.properties()[a.value])>=0],"filter-in-large":[qi,[Ji,uu(ji)],(s,[a,h])=>Oz(s.properties()[a.value],h.value,0,h.value.length-1)],all:{type:qi,overloads:[[[qi,qi],(s,[a,h])=>a.evaluate(s)&&h.evaluate(s)],[pp(qi),(s,a)=>{for(const h of a)if(!h.evaluate(s))return!1;return!0}]]},any:{type:qi,overloads:[[[qi,qi],(s,[a,h])=>a.evaluate(s)||h.evaluate(s)],[pp(qi),(s,a)=>{for(const h of a)if(h.evaluate(s))return!0;return!1}]]},"!":[qi,[qi],(s,[a])=>!a.evaluate(s)],"is-supported-script":[qi,[Ji],(s,[a])=>{const h=s.globals&&s.globals.isSupportedScript;return h?h(a.evaluate(s)):!0}],upcase:[Ji,[Ji],(s,[a])=>a.evaluate(s).toUpperCase()],downcase:[Ji,[Ji],(s,[a])=>a.evaluate(s).toLowerCase()],concat:[Ji,pp(ji),(s,a)=>a.map(h=>_y(h.evaluate(s))).join("")],"resolved-locale":[Ji,[kv],(s,[a])=>a.evaluate(s).resolvedLocale()]});function Bz(s){return Array.isArray(s)?`(${s.map(Hr).join(", ")})`:`(${Hr(s.type)}...)`}function _v(s){if(s instanceof Vv)return _v(s.boundExpression);if(s instanceof Rc&&s.name==="error"||s instanceof Zv||s instanceof Mp||s instanceof Ep||s instanceof Gy)return!1;const a=s instanceof df||s instanceof zc;let h=!0;return s.eachChild(g=>{a?h=h&&_v(g):h=h&&g instanceof Vm}),h?$v(s)&&Hv(s,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]):!1}function $v(s){if(s instanceof Rc&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Mp||s instanceof Ep)return!1;let a=!0;return s.eachChild(h=>{a&&!$v(h)&&(a=!1)}),a}function zy(s){if(s instanceof Rc&&s.name==="feature-state")return!1;let a=!0;return s.eachChild(h=>{a&&!zy(h)&&(a=!1)}),a}function Hv(s,a){if(s instanceof Rc&&a.indexOf(s.name)>=0)return!1;let h=!0;return s.eachChild(g=>{h&&!Hv(g,a)&&(h=!1)}),h}function xb(s){return{result:"success",value:s}}function km(s){return{result:"error",value:s}}function vv(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function xT(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function wT(s){return!!s.expression&&s.expression.interpolated}function dn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function Px(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&to(s)===wp}class Fz{constructor(a,h,g){this.expression=a,this._warningHistory={},this._evaluator=new dT,this._defaultValue=h?Uz(h):null,this._enumValues=h&&h.type==="enum"?h.values:null,this._globalState=g}evaluateWithoutErrorHandling(a,h,g,S,A,w){return this._globalState&&(a=Gm(a,this._globalState)),this._evaluator.globals=a,this._evaluator.feature=h,this._evaluator.featureState=g,this._evaluator.canonical=S,this._evaluator.availableImages=A||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(a,h,g,S,A,w){this._globalState&&(a=Gm(a,this._globalState)),this._evaluator.globals=a,this._evaluator.feature=h||null,this._evaluator.featureState=g||null,this._evaluator.canonical=S,this._evaluator.availableImages=A||null,this._evaluator.formattedSection=w||null;try{const c=this.expression.evaluate(this._evaluator);if(c==null||typeof c=="number"&&c!==c)return this._defaultValue;if(this._enumValues&&!(c in this._enumValues))throw new ua(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(c)} instead.`);return c}catch(c){return this._warningHistory[c.message]||(this._warningHistory[c.message]=!0,typeof console<"u"&&console.warn(c.message)),this._defaultValue}}}function TT(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in Cx}function ST(s,a,h){const g=new jv(Cx,_v,[],a?jz(a):void 0),S=g.parse(s,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return S?xb(new Fz(S,a,h)):km(g.errors)}class fw{constructor(a,h,g){this.kind=a,this._styleExpression=h,this.isStateDependent=a!=="constant"&&!zy(h.expression),this.globalStateRefs=zx(h.expression),this._globalState=g}evaluateWithoutErrorHandling(a,h,g,S,A,w){return this._globalState&&(a=Gm(a,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(a,h,g,S,A,w)}evaluate(a,h,g,S,A,w){return this._globalState&&(a=Gm(a,this._globalState)),this._styleExpression.evaluate(a,h,g,S,A,w)}}class pw{constructor(a,h,g,S,A){this.kind=a,this.zoomStops=g,this._styleExpression=h,this.isStateDependent=a!=="camera"&&!zy(h.expression),this.globalStateRefs=zx(h.expression),this.interpolationType=S,this._globalState=A}evaluateWithoutErrorHandling(a,h,g,S,A,w){return this._globalState&&(a=Gm(a,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(a,h,g,S,A,w)}evaluate(a,h,g,S,A,w){return this._globalState&&(a=Gm(a,this._globalState)),this._styleExpression.evaluate(a,h,g,S,A,w)}interpolationFactor(a,h,g){return this.interpolationType?Ah.interpolationFactor(this.interpolationType,a,h,g):0}}function Nz(s,a,h){const g=ST(s,a,h);if(g.result==="error")return g;const S=g.value.expression,A=$v(S);if(!A&&!vv(a))return km([new Th("","data expressions not supported")]);const w=Hv(S,["zoom"]);if(!w&&!xT(a))return km([new Th("","zoom expressions not supported")]);const c=rv(S);if(!c&&!w)return km([new Th("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(c instanceof Th)return km([c]);if(c instanceof Ah&&!wT(a))return km([new Th("",'"interpolate" expressions cannot be used with this property')]);if(!c)return xb(A?new fw("constant",g.value,h):new fw("source",g.value,h));const k=c instanceof Ah?c.interpolation:void 0;return xb(A?new pw("camera",g.value,c.labels,k,h):new pw("composite",g.value,c.labels,k,h))}function rv(s){let a=null;if(s instanceof Uv)a=rv(s.result);else if(s instanceof Cy){for(const h of s.args)if(a=rv(h),a)break}else(s instanceof Gv||s instanceof Ah)&&s.input instanceof Rc&&s.input.name==="zoom"&&(a=s);return a instanceof Th||s.eachChild(h=>{const g=rv(h);g instanceof Th?a=g:!a&&g?a=new Th("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&g&&a!==g&&(a=new Th("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function zx(s,a=new Set){return s instanceof Gy&&a.add(s.key),s.eachChild(h=>{zx(h,a)}),a}function jz(s){const a={color:Mh,string:Ji,number:qt,enum:Ji,boolean:qi,formatted:Ov,padding:Bv,numberArray:Fv,colorArray:Sy,projectionDefinition:Rv,resolvedImage:Uy,variableAnchorOffsetCollection:Nv};return s.type==="array"?uu(a[s.value]||ji,s.length):a[s.type]}function Uz(s){if(s.type==="color"&&Px(s.default))return new Hn(0,0,0,0);switch(s.type){case"color":return Hn.parse(s.default)||null;case"padding":return Lc.parse(s.default)||null;case"numberArray":return Dc.parse(s.default)||null;case"colorArray":return cu.parse(s.default)||null;case"variableAnchorOffsetCollection":return Eh.parse(s.default)||null;case"projectionDefinition":return Pc.parse(s.default)||null;default:return s.default===void 0?null:s.default}}function Gm(s,a){const{zoom:h,heatmapDensity:g,elevation:S,lineProgress:A,isSupportedScript:w,accumulated:c}=s??{};return{zoom:h,heatmapDensity:g,elevation:S,lineProgress:A,isSupportedScript:w,accumulated:c,globalState:a}}function MT(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const a of s.slice(1))if(!MT(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}function ET(s){const a=s.key,h=s.value;return h?[new Bt(a,h,"constants have been deprecated as of v8")]:[]}function xa(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Pp(s){if(Array.isArray(s))return s.map(Pp);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const a={};for(const h in s)a[h]=Pp(s[h]);return a}return xa(s)}function ju(s){const a=s.key,h=s.value,g=s.valueSpec||{},S=s.objectElementValidators||{},A=s.style,w=s.styleSpec,c=s.validateSpec;let k=[];const N=dn(h);if(N!=="object")return[new Bt(a,h,`object expected, ${N} found`)];for(const H in h){const K=H.split(".")[0],ae=yy(g,K)||g["*"];let ue;if(yy(S,K))ue=S[K];else if(yy(g,K))ue=c;else if(S["*"])ue=S["*"];else if(g["*"])ue=c;else{k.push(new Bt(a,h[H],`unknown property "${H}"`));continue}k=k.concat(ue({key:(a&&`${a}.`)+H,value:h[H],valueSpec:ae,style:A,styleSpec:w,object:h,objectKey:H,validateSpec:c},h))}for(const H in g)S[H]||g[H].required&&g[H].default===void 0&&h[H]===void 0&&k.push(new Bt(a,h,`missing required property "${H}"`));return k}function Ix(s){const a=s.value,h=s.valueSpec,g=s.validateSpec,S=s.style,A=s.styleSpec,w=s.key,c=s.arrayElementValidator||g;if(dn(a)!=="array")return[new Bt(w,a,`array expected, ${dn(a)} found`)];if(h.length&&a.length!==h.length)return[new Bt(w,a,`array length ${h.length} expected, length ${a.length} found`)];if(h["min-length"]&&a.length<h["min-length"])return[new Bt(w,a,`array length at least ${h["min-length"]} expected, length ${a.length} found`)];let k={type:h.value,values:h.values};A.$version<7&&(k.function=h.function),dn(h.value)==="object"&&(k=h.value);let N=[];for(let H=0;H<a.length;H++)N=N.concat(c({array:a,arrayIndex:H,value:a[H],valueSpec:k,validateSpec:s.validateSpec,style:S,styleSpec:A,key:`${w}[${H}]`}));return N}function Xv(s){const a=s.key,h=s.value,g=s.valueSpec;let S=dn(h);return S==="number"&&h!==h&&(S="NaN"),S!=="number"?[new Bt(a,h,`number expected, ${S} found`)]:"minimum"in g&&h<g.minimum?[new Bt(a,h,`${h} is less than the minimum value ${g.minimum}`)]:"maximum"in g&&h>g.maximum?[new Bt(a,h,`${h} is greater than the maximum value ${g.maximum}`)]:[]}function AT(s){const a=s.valueSpec,h=xa(s.value.type);let g,S={},A,w;const c=h!=="categorical"&&s.value.property===void 0,k=!c,N=dn(s.value.stops)==="array"&&dn(s.value.stops[0])==="array"&&dn(s.value.stops[0][0])==="object",H=ju({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:K,default:ge}});return h==="identity"&&c&&H.push(new Bt(s.key,s.value,'missing required property "property"')),h!=="identity"&&!s.value.stops&&H.push(new Bt(s.key,s.value,'missing required property "stops"')),h==="exponential"&&s.valueSpec.expression&&!wT(s.valueSpec)&&H.push(new Bt(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(k&&!vv(s.valueSpec)?H.push(new Bt(s.key,s.value,"property functions not supported")):c&&!xT(s.valueSpec)&&H.push(new Bt(s.key,s.value,"zoom functions not supported"))),(h==="categorical"||N)&&s.value.property===void 0&&H.push(new Bt(s.key,s.value,'"property" property is required')),H;function K(fe){if(h==="identity")return[new Bt(fe.key,fe.value,'identity function may not have a "stops" property')];let ce=[];const qe=fe.value;return ce=ce.concat(Ix({key:fe.key,value:qe,valueSpec:fe.valueSpec,validateSpec:fe.validateSpec,style:fe.style,styleSpec:fe.styleSpec,arrayElementValidator:ae})),dn(qe)==="array"&&qe.length===0&&ce.push(new Bt(fe.key,qe,"array must have at least one stop")),ce}function ae(fe){let ce=[];const qe=fe.value,Fe=fe.key;if(dn(qe)!=="array")return[new Bt(Fe,qe,`array expected, ${dn(qe)} found`)];if(qe.length!==2)return[new Bt(Fe,qe,`array length 2 expected, length ${qe.length} found`)];if(N){if(dn(qe[0])!=="object")return[new Bt(Fe,qe,`object expected, ${dn(qe[0])} found`)];if(qe[0].zoom===void 0)return[new Bt(Fe,qe,"object stop key must have zoom")];if(qe[0].value===void 0)return[new Bt(Fe,qe,"object stop key must have value")];if(w&&w>xa(qe[0].zoom))return[new Bt(Fe,qe[0].zoom,"stop zoom values must appear in ascending order")];xa(qe[0].zoom)!==w&&(w=xa(qe[0].zoom),A=void 0,S={}),ce=ce.concat(ju({key:`${Fe}[0]`,value:qe[0],valueSpec:{zoom:{}},validateSpec:fe.validateSpec,style:fe.style,styleSpec:fe.styleSpec,objectElementValidators:{zoom:Xv,value:ue}}))}else ce=ce.concat(ue({key:`${Fe}[0]`,value:qe[0],validateSpec:fe.validateSpec,style:fe.style,styleSpec:fe.styleSpec},qe));return TT(Pp(qe[1]))?ce.concat([new Bt(`${Fe}[1]`,qe[1],"expressions are not allowed in function stops.")]):ce.concat(fe.validateSpec({key:`${Fe}[1]`,value:qe[1],valueSpec:a,validateSpec:fe.validateSpec,style:fe.style,styleSpec:fe.styleSpec}))}function ue(fe,ce){const qe=dn(fe.value),Fe=xa(fe.value),Ne=fe.value!==null?fe.value:ce;if(!g)g=qe;else if(qe!==g)return[new Bt(fe.key,Ne,`${qe} stop domain type must match previous stop domain type ${g}`)];if(qe!=="number"&&qe!=="string"&&qe!=="boolean")return[new Bt(fe.key,Ne,"stop domain value must be a number, string, or boolean")];if(qe!=="number"&&h!=="categorical"){let Be=`number expected, ${qe} found`;return vv(a)&&h===void 0&&(Be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Bt(fe.key,Ne,Be)]}return h==="categorical"&&qe==="number"&&(!isFinite(Fe)||Math.floor(Fe)!==Fe)?[new Bt(fe.key,Ne,`integer expected, found ${Fe}`)]:h!=="categorical"&&qe==="number"&&A!==void 0&&Fe<A?[new Bt(fe.key,Ne,"stop domain values must appear in ascending order")]:(A=Fe,h==="categorical"&&Fe in S?[new Bt(fe.key,Ne,"stop domain values must be unique")]:(S[Fe]=!0,[]))}function ge(fe){return fe.validateSpec({key:fe.key,value:fe.value,valueSpec:a,validateSpec:fe.validateSpec,style:fe.style,styleSpec:fe.styleSpec})}}function Zm(s){const a=(s.expressionContext==="property"?Nz:ST)(Pp(s.value),s.valueSpec);if(a.result==="error")return a.value.map(g=>new Bt(`${s.key}${g.key}`,s.value,g.message));const h=a.value.expression||a.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!h.outputDefined())return[new Bt(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!zy(h))return[new Bt(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!zy(h))return[new Bt(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!Hv(h,["zoom","feature-state"]))return[new Bt(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!$v(h))return[new Bt(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Vz(s){const a=s.value,h=s.key,g=dn(a);return g!=="boolean"?[new Bt(h,a,`boolean expected, ${g} found`)]:[]}function wb(s){const a=s.key,h=s.value,g=dn(h);return g!=="string"?[new Bt(a,h,`color expected, ${g} found`)]:Hn.parse(String(h))?[]:[new Bt(a,h,`color expected, "${h}" found`)]}function Iy(s){const a=s.key,h=s.value,g=s.valueSpec,S=[];return Array.isArray(g.values)?g.values.indexOf(xa(h))===-1&&S.push(new Bt(a,h,`expected one of [${g.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(g.values).indexOf(xa(h))===-1&&S.push(new Bt(a,h,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(h)} found`)),S}function Lx(s){return MT(Pp(s.value))?Zm(dv({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):CT(s)}function CT(s){const a=s.value,h=s.key;if(dn(a)!=="array")return[new Bt(h,a,`array expected, ${dn(a)} found`)];const g=s.styleSpec;let S,A=[];if(a.length<1)return[new Bt(h,a,"filter array must have at least 1 element")];switch(A=A.concat(Iy({key:`${h}[0]`,value:a[0],valueSpec:g.filter_operator,style:s.style,styleSpec:s.styleSpec})),xa(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&xa(a[1])==="$type"&&A.push(new Bt(h,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&A.push(new Bt(h,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(S=dn(a[1]),S!=="string"&&A.push(new Bt(`${h}[1]`,a[1],`string expected, ${S} found`)));for(let w=2;w<a.length;w++)S=dn(a[w]),xa(a[1])==="$type"?A=A.concat(Iy({key:`${h}[${w}]`,value:a[w],valueSpec:g.geometry_type,style:s.style,styleSpec:s.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&A.push(new Bt(`${h}[${w}]`,a[w],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let w=1;w<a.length;w++)A=A.concat(CT({key:`${h}[${w}]`,value:a[w],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":S=dn(a[1]),a.length!==2?A.push(new Bt(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):S!=="string"&&A.push(new Bt(`${h}[1]`,a[1],`string expected, ${S} found`));break}return A}function PT(s,a){const h=s.key,g=s.validateSpec,S=s.style,A=s.styleSpec,w=s.value,c=s.objectKey,k=A[`${a}_${s.layerType}`];if(!k)return[];const N=c.match(/^(.*)-transition$/);if(a==="paint"&&N&&k[N[1]]&&k[N[1]].transition)return g({key:h,value:w,valueSpec:A.transition,style:S,styleSpec:A});const H=s.valueSpec||k[c];if(!H)return[new Bt(h,w,`unknown property "${c}"`)];let K;if(dn(w)==="string"&&vv(H)&&!H.tokens&&(K=/^{([^}]+)}$/.exec(w)))return[new Bt(h,w,`"${c}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(K[1])} }\`.`)];const ae=[];return s.layerType==="symbol"&&c==="text-font"&&Px(Pp(w))&&xa(w.type)==="identity"&&ae.push(new Bt(h,w,'"text-font" does not support identity functions')),ae.concat(g({key:s.key,value:w,valueSpec:H,style:S,styleSpec:A,expressionContext:"property",propertyType:a,propertyKey:c}))}function zT(s){return PT(s,"paint")}function IT(s){return PT(s,"layout")}function LT(s){let a=[];const h=s.value,g=s.key,S=s.style,A=s.styleSpec;if(dn(h)!=="object")return[new Bt(g,h,`object expected, ${dn(h)} found`)];!h.type&&!h.ref&&a.push(new Bt(g,h,'either "type" or "ref" is required'));let w=xa(h.type);const c=xa(h.ref);if(h.id){const k=xa(h.id);for(let N=0;N<s.arrayIndex;N++){const H=S.layers[N];xa(H.id)===k&&a.push(new Bt(g,h.id,`duplicate layer id "${h.id}", previously used at line ${H.id.__line__}`))}}if("ref"in h){["type","source","source-layer","filter","layout"].forEach(N=>{N in h&&a.push(new Bt(g,h[N],`"${N}" is prohibited for ref layers`))});let k;S.layers.forEach(N=>{xa(N.id)===c&&(k=N)}),k?k.ref?a.push(new Bt(g,h.ref,"ref cannot reference another ref layer")):w=xa(k.type):a.push(new Bt(g,h.ref,`ref layer "${c}" not found`))}else if(w!=="background")if(!h.source)a.push(new Bt(g,h,'missing required property "source"'));else{const k=S.sources&&S.sources[h.source],N=k&&xa(k.type);k?N==="vector"&&w==="raster"?a.push(new Bt(g,h.source,`layer "${h.id}" requires a raster source`)):N!=="raster-dem"&&w==="hillshade"?a.push(new Bt(g,h.source,`layer "${h.id}" requires a raster-dem source`)):N!=="raster-dem"&&w==="color-relief"?a.push(new Bt(g,h.source,`layer "${h.id}" requires a raster-dem source`)):N==="raster"&&w!=="raster"?a.push(new Bt(g,h.source,`layer "${h.id}" requires a vector source`)):N==="vector"&&!h["source-layer"]?a.push(new Bt(g,h,`layer "${h.id}" must specify a "source-layer"`)):N==="raster-dem"&&w!=="hillshade"&&w!=="color-relief"?a.push(new Bt(g,h.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):w==="line"&&h.paint&&h.paint["line-gradient"]&&(N!=="geojson"||!k.lineMetrics)&&a.push(new Bt(g,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new Bt(g,h.source,`source "${h.source}" not found`))}return a=a.concat(ju({key:g,value:h,valueSpec:A.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*"(){return[]},type(){return s.validateSpec({key:`${g}.type`,value:h.type,valueSpec:A.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:h,objectKey:"type"})},filter:Lx,layout(k){return ju({layer:h,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*"(N){return IT(dv({layerType:w},N))}}})},paint(k){return ju({layer:h,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*"(N){return zT(dv({layerType:w},N))}}})}}})),a}function zp(s){const a=s.value,h=s.key,g=dn(a);return g!=="string"?[new Bt(h,a,`string expected, ${g} found`)]:[]}function Gz(s){var a;const h=(a=s.sourceName)!==null&&a!==void 0?a:"",g=s.value,S=s.styleSpec,A=S.source_raster_dem,w=s.style;let c=[];const k=dn(g);if(g===void 0)return c;if(k!=="object")return c.push(new Bt("source_raster_dem",g,`object expected, ${k} found`)),c;const N=xa(g.encoding)==="custom",H=["redFactor","greenFactor","blueFactor","baseShift"],K=s.value.encoding?`"${s.value.encoding}"`:"Default";for(const ae in g)!N&&H.includes(ae)?c.push(new Bt(ae,g[ae],`In "${h}": "${ae}" is only valid when "encoding" is set to "custom". ${K} encoding found`)):A[ae]?c=c.concat(s.validateSpec({key:ae,value:g[ae],valueSpec:A[ae],validateSpec:s.validateSpec,style:w,styleSpec:S})):c.push(new Bt(ae,g[ae],`unknown property "${ae}"`));return c}const mw={promoteId:Zz};function DT(s){const a=s.value,h=s.key,g=s.styleSpec,S=s.style,A=s.validateSpec;if(!a.type)return[new Bt(h,a,'"type" is required')];const w=xa(a.type);let c;switch(w){case"vector":case"raster":return c=ju({key:h,value:a,valueSpec:g[`source_${w.replace("-","_")}`],style:s.style,styleSpec:g,objectElementValidators:mw,validateSpec:A}),c;case"raster-dem":return c=Gz({sourceName:h,value:a,style:s.style,styleSpec:g,validateSpec:A}),c;case"geojson":if(c=ju({key:h,value:a,valueSpec:g.source_geojson,style:S,styleSpec:g,validateSpec:A,objectElementValidators:mw}),a.cluster)for(const k in a.clusterProperties){const[N,H]=a.clusterProperties[k],K=typeof N=="string"?[N,["accumulated"],["get",k]]:N;c.push(...Zm({key:`${h}.${k}.map`,value:H,expressionContext:"cluster-map"})),c.push(...Zm({key:`${h}.${k}.reduce`,value:K,expressionContext:"cluster-reduce"}))}return c;case"video":return ju({key:h,value:a,valueSpec:g.source_video,style:S,validateSpec:A,styleSpec:g});case"image":return ju({key:h,value:a,valueSpec:g.source_image,style:S,validateSpec:A,styleSpec:g});case"canvas":return[new Bt(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Iy({key:`${h}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Zz({key:s,value:a}){if(dn(a)==="string")return zp({key:s,value:a});{const h=[];for(const g in a)h.push(...zp({key:`${s}.${g}`,value:a[g]}));return h}}function RT(s){const a=s.value,h=s.styleSpec,g=h.light,S=s.style;let A=[];const w=dn(a);if(a===void 0)return A;if(w!=="object")return A=A.concat([new Bt("light",a,`object expected, ${w} found`)]),A;for(const c in a){const k=c.match(/^(.*)-transition$/);k&&g[k[1]]&&g[k[1]].transition?A=A.concat(s.validateSpec({key:c,value:a[c],valueSpec:h.transition,validateSpec:s.validateSpec,style:S,styleSpec:h})):g[c]?A=A.concat(s.validateSpec({key:c,value:a[c],valueSpec:g[c],validateSpec:s.validateSpec,style:S,styleSpec:h})):A=A.concat([new Bt(c,a[c],`unknown property "${c}"`)])}return A}function kT(s){const a=s.value,h=s.styleSpec,g=h.sky,S=s.style,A=dn(a);if(a===void 0)return[];if(A!=="object")return[new Bt("sky",a,`object expected, ${A} found`)];let w=[];for(const c in a)g[c]?w=w.concat(s.validateSpec({key:c,value:a[c],valueSpec:g[c],style:S,styleSpec:h})):w=w.concat([new Bt(c,a[c],`unknown property "${c}"`)]);return w}function OT(s){const a=s.value,h=s.styleSpec,g=h.terrain,S=s.style;let A=[];const w=dn(a);if(a===void 0)return A;if(w!=="object")return A=A.concat([new Bt("terrain",a,`object expected, ${w} found`)]),A;for(const c in a)g[c]?A=A.concat(s.validateSpec({key:c,value:a[c],valueSpec:g[c],validateSpec:s.validateSpec,style:S,styleSpec:h})):A=A.concat([new Bt(c,a[c],`unknown property "${c}"`)]);return A}function qz(s){return zp(s).length===0?[]:Zm(s)}function $z(s){return zp(s).length===0?[]:Zm(s)}function Hz(s){const a=s.key,h=s.value;if(dn(h)==="array"){if(h.length<1||h.length>4)return[new Bt(a,h,`padding requires 1 to 4 values; ${h.length} values found`)];const g={type:"number"};let S=[];for(let A=0;A<h.length;A++)S=S.concat(s.validateSpec({key:`${a}[${A}]`,value:h[A],validateSpec:s.validateSpec,valueSpec:g}));return S}else return Xv({key:a,value:h,valueSpec:{}})}function Xz(s){const a=s.key,h=s.value;if(dn(h)==="array"){const g={type:"number"};if(h.length<1)return[new Bt(a,h,"array length at least 1 expected, length 0 found")];let S=[];for(let A=0;A<h.length;A++)S=S.concat(s.validateSpec({key:`${a}[${A}]`,value:h[A],validateSpec:s.validateSpec,valueSpec:g}));return S}else return Xv({key:a,value:h,valueSpec:{}})}function Yz(s){const a=s.key,h=s.value;if(dn(h)==="array"){if(h.length<1)return[new Bt(a,h,"array length at least 1 expected, length 0 found")];let g=[];for(let S=0;S<h.length;S++)g=g.concat(wb({key:`${a}[${S}]`,value:h[S]}));return g}else return wb({key:a,value:h})}function Wz(s){const a=s.key,h=s.value,g=dn(h),S=s.styleSpec;if(g!=="array"||h.length<1||h.length%2!==0)return[new Bt(a,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let A=[];for(let w=0;w<h.length;w+=2)A=A.concat(Iy({key:`${a}[${w}]`,value:h[w],valueSpec:S.layout_symbol["text-anchor"]})),A=A.concat(Ix({key:`${a}[${w+1}]`,value:h[w+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:S}));return A}function BT(s){let a=[];const h=s.value,g=s.key;if(Array.isArray(h)){const S=[],A=[];for(const w in h){h[w].id&&S.includes(h[w].id)&&a.push(new Bt(g,h,`all the sprites' ids must be unique, but ${h[w].id} is duplicated`)),S.push(h[w].id),h[w].url&&A.includes(h[w].url)&&a.push(new Bt(g,h,`all the sprites' URLs must be unique, but ${h[w].url} is duplicated`)),A.push(h[w].url);const c={id:{type:"string",required:!0},url:{type:"string",required:!0}};a=a.concat(ju({key:`${g}[${w}]`,value:h[w],valueSpec:c,validateSpec:s.validateSpec}))}return a}else return zp({key:g,value:h})}function Kz(s){const a=s.value,h=s.styleSpec,g=h.projection,S=s.style,A=dn(a);if(a===void 0)return[];if(A!=="object")return[new Bt("projection",a,`object expected, ${A} found`)];let w=[];for(const c in a)g[c]?w=w.concat(s.validateSpec({key:c,value:a[c],valueSpec:g[c],style:S,styleSpec:h})):w=w.concat([new Bt(c,a[c],`unknown property "${c}"`)]);return w}function Jz(s){const a=s.key;let h=s.value;h=h instanceof String?h.valueOf():h;const g=dn(h);return g==="array"&&!eI(h)&&!Qz(h)?[new Bt(a,h,`projection expected, invalid array ${JSON.stringify(h)} found`)]:["array","string"].includes(g)?[]:[new Bt(a,h,`projection expected, invalid type "${g}" found`)]}function Qz(s){return!!["interpolate","step","literal"].includes(s[0])}function eI(s){return Array.isArray(s)&&s.length===3&&typeof s[0]=="string"&&typeof s[1]=="string"&&typeof s[2]=="number"}function tI(s){return!!s&&s.constructor===Object}function FT(s){return tI(s.value)?[]:[new Bt(s.key,s.value,`object expected, ${dn(s.value)} found`)]}const gw={"*"(){return[]},array:Ix,boolean:Vz,number:Xv,color:wb,constants:ET,enum:Iy,filter:Lx,function:AT,layer:LT,object:ju,source:DT,light:RT,sky:kT,terrain:OT,projection:Kz,projectionDefinition:Jz,string:zp,formatted:qz,resolvedImage:$z,padding:Hz,numberArray:Xz,colorArray:Yz,variableAnchorOffsetCollection:Wz,sprite:BT,state:FT};function bv(s){const a=s.value,h=s.valueSpec,g=s.styleSpec;return s.validateSpec=bv,h.expression&&Px(xa(a))?AT(s):h.expression&&TT(Pp(a))?Zm(s):h.type&&gw[h.type]?gw[h.type](s):ju(dv({},s,{valueSpec:h.type?g[h.type]:h}))}function NT(s){const a=s.value,h=s.key,g=zp(s);return g.length||(a.indexOf("{fontstack}")===-1&&g.push(new Bt(h,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&g.push(new Bt(h,a,'"glyphs" url must include a "{range}" token'))),g}function hu(s,a=P5){let h=[];return h=h.concat(bv({key:"",value:s,valueSpec:a.$root,styleSpec:a,style:s,validateSpec:bv,objectElementValidators:{glyphs:NT,"*"(){return[]}}})),s.constants&&(h=h.concat(ET({key:"constants",value:s.constants}))),jT(h)}hu.source=Oc(kc(DT));hu.sprite=Oc(kc(BT));hu.glyphs=Oc(kc(NT));hu.light=Oc(kc(RT));hu.sky=Oc(kc(kT));hu.terrain=Oc(kc(OT));hu.state=Oc(kc(FT));hu.layer=Oc(kc(LT));hu.filter=Oc(kc(Lx));hu.paintProperty=Oc(kc(zT));hu.layoutProperty=Oc(kc(IT));function kc(s){return function(a){return s(Object.assign({},a,{validateSpec:bv}))}}function jT(s){return[].concat(s).sort((a,h)=>a.line-h.line)}function Oc(s){return function(...a){return jT(s.apply(this,a))}}function yw(s){if(!s)return{style:gy[mf[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0};if(typeof s=="string"){const a=nI(s);return a.isValidStyle?{style:a.styleObject,requiresUrlMonitoring:!1,isFallback:!1}:a.isValidJSON?{style:gy[mf[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}:s.startsWith("http")?{style:s,requiresUrlMonitoring:!0,isFallback:!1}:s.toLowerCase().includes(".json")?{style:iI(s),requiresUrlMonitoring:!0,isFallback:!1}:{style:K2(s),requiresUrlMonitoring:!0,isFallback:!1}}return s instanceof J2?{style:s.getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:s instanceof Q2?{style:s.getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:hu(s).length===0?{style:s,requiresUrlMonitoring:!1,isFallback:!1,isJSON:!0}:{style:gy[mf[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}}function iI(s){try{return new URL(s).href}catch{}return new URL(s,location.origin).href}function nI(s){try{const a=JSON.parse(s),h=hu(a);return{isValidJSON:!0,isValidStyle:h.length===0,styleObject:h.length===0?a:null}}catch{return{isValidJSON:!1,isValidStyle:!1,styleObject:null}}}function hd(s,a,h){const g=window.document.createElement(s);return a!==void 0&&(g.className=a),h&&h.appendChild(g),g}function Ly(s){s.parentNode&&s.parentNode.removeChild(s)}class rI{constructor(){Wt(this,"_map"),Wt(this,"_container"),Wt(this,"_terrainButton"),LP(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(a){return this._map=a,this._container=hd("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=hd("button","maplibregl-ctrl-terrain",this._container),hd("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){Ly(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){UT(this._map),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}function UT(s){s.hasTerrain()?s.disableTerrain():s.enableTerrain()}class aI extends vP{constructor(a={}){super({showCompass:a.showCompass??!0,showZoom:a.showZoom??!0,visualizePitch:a.visualizePitch??!0}),Wt(this,"_rotateCompassArrow",()=>{const h=this._map.getBearing(),g=this._map.getPitch(),S=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(g*(Math.PI/180))**.5)}) rotateX(${Math.min(70,g)}deg) rotateZ(${-h}deg)`:`rotate(${-h}deg)`;this._compassIcon.style.transform=S}),this._compass&&(this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",h=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:h}):this._map.resetNorth({},{originalEvent:h})}))}_createButton(a,h){const g=super._createButton(a,h);return g.clickFunction=h,g}}const _w=si.Marker,vw=si.LngLat,oI=si.LngLatBounds;class sI extends bP{constructor(){super(...arguments),Wt(this,"lastUpdatedCenter",new vw(0,0)),Wt(this,"_updateCamera",a=>{var h;const g=new vw(a.coords.longitude,a.coords.latitude),S=a.coords.accuracy,A={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},w=this._map.getZoom();w>(((h=this.options.fitBoundsOptions)==null?void 0:h.maxZoom)??30)&&(A.zoom=w),this._map.fitBounds(oI.fromLngLat(g,S),A,{geolocateSource:!0});let c=!1;const k=()=>{c=!0};this._map.once("click",k),this._map.once("dblclick",k),this._map.once("dragstart",k),this._map.once("mousedown",k),this._map.once("touchstart",k),this._map.once("wheel",k),this._map.once("moveend",()=>{this._map.off("click",k),this._map.off("dblclick",k),this._map.off("dragstart",k),this._map.off("mousedown",k),this._map.off("touchstart",k),this._map.off("wheel",k),!c&&(this.lastUpdatedCenter=this._map.getCenter())})}),Wt(this,"_finishSetupUI",a=>{if(this._map){if(a===!1){const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=hd("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new _w({element:this._dotElement}),this._circleElement=hd("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _w({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",h=>{const g=h.originalEvent&&h.originalEvent.type==="resize",S=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!h.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!g&&S>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}}),Wt(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const a=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],h=this._map.project(a),g=this._map.unproject([h.x,h.y]),S=this._map.unproject([h.x+20,h.y]),A=g.distanceTo(S)/20,w=Math.ceil(2*this._accuracy/A);this._circleElement.style.width=`${w}px`,this._circleElement.style.height=`${w}px`}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;case"BACKGROUND_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}}var mp,au,gp,yp,dy;class lI{constructor(a,h,g){if(xl(this,mp),xl(this,au),xl(this,gp),xl(this,yp),xl(this,dy),typeof a=="string"){const S=document.querySelector(a);if(!S)throw new Error(`No element has been found with selector "${a}" when creating an external control.`);lu(this,au,S)}else lu(this,au,a);h&&lu(this,gp,S=>{h(ci(this,mp),ci(this,au),S)}),g&&lu(this,yp,S=>{g(ci(this,mp),ci(this,au),S)}),lu(this,dy,ci(this,au).parentElement)}onAdd(a){return lu(this,mp,a),ci(this,gp)&&ci(this,au).addEventListener("click",ci(this,gp)),ci(this,yp)&&ci(this,mp).on("render",ci(this,yp)),Ly(ci(this,au)),ci(this,au)}onRemove(){ci(this,gp)&&ci(this,au).removeEventListener("click",ci(this,gp)),ci(this,yp)&&ci(this,mp).off("render",ci(this,yp)),ci(this,dy)?ci(this,dy).appendChild(ci(this,au)):Ly(ci(this,au))}}mp=new WeakMap,au=new WeakMap,gp=new WeakMap,yp=new WeakMap,dy=new WeakMap;class uI{constructor(){Wt(this,"map"),Wt(this,"container"),Wt(this,"projectionButton")}onAdd(a){return this.map=a,this.container=hd("div","maplibregl-ctrl maplibregl-ctrl-group"),this.projectionButton=hd("button","maplibregl-ctrl-projection",this.container),hd("span","maplibregl-ctrl-icon",this.projectionButton).setAttribute("aria-hidden","true"),this.projectionButton.type="button",this.projectionButton.addEventListener("click",this.toggleProjection.bind(this)),a.on("projectiontransition",this.updateProjectionIcon.bind(this)),this.updateProjectionIcon(),this.container}onRemove(){Ly(this.container),this.map.off("projectiontransition",this.updateProjectionIcon),this.map=void 0}toggleProjection(){VT(this.map),this.updateProjectionIcon()}updateProjectionIcon(){this.projectionButton.classList.remove("maplibregl-ctrl-projection-globe"),this.projectionButton.classList.remove("maplibregl-ctrl-projection-mercator"),this.map.isGlobeProjection()?(this.projectionButton.classList.add("maplibregl-ctrl-projection-mercator"),this.projectionButton.title="Enable Mercator projection"):(this.projectionButton.classList.add("maplibregl-ctrl-projection-globe"),this.projectionButton.title="Enable Globe projection")}}function VT(s){s.getProjection()===void 0&&s.setProjection({type:"mercator"}),s.isGlobeProjection()?s.enableMercatorProjection():s.enableGlobeProjection()}const fy={"zoom-in":s=>s.zoomIn(),"zoom-out":s=>s.zoomOut(),"toggle-projection":VT,"toggle-terrain":UT,"reset-view":s=>{s.getPitch()===0?s.easeTo({pitch:Math.min(s.getMaxPitch(),80)}):s.resetNorthPitch()},"reset-bearing":s=>{s.rotateTo(0)},"reset-pitch":s=>{s.setPitch(0)},"reset-roll":s=>{s.setRoll(0)}};var av,py;class Tb extends lI{constructor(a,h){if(h&&!(h in fy))throw new Error(`data-maptiler-control value "${h}" is invalid.`);super(a,h&&fy[h]),xl(this,av),xl(this,py,new Map)}onAdd(a){return lu(this,av,a),super.onAdd(a)}onRemove(){for(const[a,h]of ci(this,py)){const g=a.deref();g&&g.removeEventListener("click",h)}ci(this,py).clear(),super.onRemove()}configureGroupItem(a,h){if(!h)return;if(!(h in fy))throw new Error(`data-maptiler-control value "${h}" is invalid.`);const g=S=>{fy[h](ci(this,av),a,S)};a.addEventListener("click",g),ci(this,py).set(new WeakRef(a),g)}}av=new WeakMap,py=new WeakMap,Wt(Tb,"controlCallbacks",fy);var su,wh,_p,vp,Fu,ov,Hs,GT,Nu,ZT;class Y0{constructor(a,h){xl(this,Hs),xl(this,su),Wt(this,"map"),xl(this,wh),xl(this,_p),xl(this,vp),xl(this,Fu,!1),xl(this,ov),a.style!==void 0&&lu(this,Fu,!0),lu(this,su,{zoomAdjust:-4,position:"top-right",...h,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...a,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...a.containerStyle??{}}}),a.lockZoom!==void 0&&(ci(this,su).minZoom=a.lockZoom,ci(this,su).maxZoom=a.lockZoom)}setStyle(a,h){ci(this,Fu)||this.map.setStyle(a,h),ou(this,Hs,Nu).call(this)}addLayer(a,h){return ci(this,Fu)||this.map.addLayer(a,h),ou(this,Hs,Nu).call(this),this.map}moveLayer(a,h){return ci(this,Fu)||this.map.moveLayer(a,h),ou(this,Hs,Nu).call(this),this.map}removeLayer(a){return ci(this,Fu)||this.map.removeLayer(a),ou(this,Hs,Nu).call(this),this}setLayerZoomRange(a,h,g){return ci(this,Fu)||this.map.setLayerZoomRange(a,h,g),ou(this,Hs,Nu).call(this),this}setFilter(a,h,g){return ci(this,Fu)||this.map.setFilter(a,h,g),ou(this,Hs,Nu).call(this),this}setPaintProperty(a,h,g,S){return ci(this,Fu)||this.map.setPaintProperty(a,h,g,S),ou(this,Hs,Nu).call(this),this}setLayoutProperty(a,h,g,S){return ci(this,Fu)||this.map.setLayoutProperty(a,h,g,S),ou(this,Hs,Nu).call(this),this}setGlyphs(a,h){return ci(this,Fu)||this.map.setGlyphs(a,h),ou(this,Hs,Nu).call(this),this}onAdd(a){lu(this,wh,a),lu(this,_p,hd("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[h,g]of Object.entries(ci(this,su).containerStyle))ci(this,_p).style.setProperty(h,g);return ci(this,su).container=ci(this,_p),ci(this,su).zoom=a.getZoom()+ci(this,su).zoomAdjust,this.map=new HT(ci(this,su)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{ou(this,Hs,GT).call(this,ci(this,su).parentRect),lu(this,ov,ou(this,Hs,ZT).call(this))}),ci(this,_p)}onRemove(){var a;(a=ci(this,ov))==null||a.call(this),Ly(ci(this,_p))}}su=new WeakMap,wh=new WeakMap,_p=new WeakMap,vp=new WeakMap,Fu=new WeakMap,ov=new WeakMap,Hs=new WeakSet,GT=function(s){s===void 0||s.linePaint===void 0&&s.fillPaint===void 0||(lu(this,vp,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:ci(this,vp)}),(s.lineLayout!==void 0||s.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...s.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...s.linePaint}}),s.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...s.fillPaint}}),ou(this,Hs,Nu).call(this))},Nu=function(){if(ci(this,vp)===void 0)return;const{devicePixelRatio:s}=window,a=ci(this,wh).getCanvas(),h=a.width/s,g=a.height/s,S=ci(this,wh).unproject.bind(ci(this,wh)),A=S([0,0]),w=S([h,0]),c=S([0,g]),k=S([h,g]);ci(this,vp).geometry.coordinates=[[c.toArray(),k.toArray(),w.toArray(),A.toArray(),c.toArray()]];const N=this.map.getSource("parentRect");N!==void 0&&N.setData(ci(this,vp))},ZT=function(){const{pitchAdjust:s}=ci(this,su),a=()=>{A("parent")},h=()=>{A("minimap")},g=()=>{ci(this,wh).on("move",a),this.map.on("move",h)},S=()=>{ci(this,wh).off("move",a),this.map.off("move",h)},A=w=>{S();const c=w==="parent"?ci(this,wh):this.map,k=w==="parent"?this.map:ci(this,wh),N=c.getCenter(),H=c.getZoom()+ci(this,su).zoomAdjust*(w==="parent"?1:-1),K=c.getBearing(),ae=c.getPitch();k.jumpTo({center:N,zoom:H,bearing:K,pitch:s?ae:0}),ou(this,Hs,Nu).call(this),g()};return g(),()=>{S()}};class cI{constructor(a,h=2e3){Wt(this,"map"),Wt(this,"registeredModules",new Set),Wt(this,"viewerType"),this.map=a,this.viewerType="Map",setTimeout(async()=>{if(!ba.telemetry)return;const g=this.preparePayload();try{(await fetch(g,{method:"POST"})).ok||console.warn("The metrics could not be sent to MapTiler Cloud")}catch(S){console.warn("The metrics could not be sent to MapTiler Cloud",S)}},Math.max(1e3,h))}registerModule(a,h){this.registeredModules.add(`${a}:${h}`)}registerViewerType(a="Map"){this.viewerType=a}preparePayload(){const a=new URL(Ys.telemetryURL);return a.searchParams.append("sdk",lS()),a.searchParams.append("key",ba.apiKey),a.searchParams.append("mtsid",hx),a.searchParams.append("session",ba.session?"1":"0"),a.searchParams.append("caching",ba.caching?"1":"0"),a.searchParams.append("lang-updated",this.map.isLanguageUpdated()?"1":"0"),a.searchParams.append("terrain",this.map.getTerrain()?"1":"0"),a.searchParams.append("globe",this.map.isGlobeProjection()?"1":"0"),a.searchParams.append("viewerType",this.viewerType),this.registeredModules.size>0&&a.searchParams.append("modules",Array.from(this.registeredModules).join("|")),a.href}}var Dy=typeof Float32Array<"u"?Float32Array:Array;function vy(){var s=new Dy(16);return Dy!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s}function hI(s,a,h,g,S,A,w,c,k,N,H,K,ae,ue,ge,fe,ce){return s[0]=a,s[1]=h,s[2]=g,s[3]=S,s[4]=A,s[5]=w,s[6]=c,s[7]=k,s[8]=N,s[9]=H,s[10]=K,s[11]=ae,s[12]=ue,s[13]=ge,s[14]=fe,s[15]=ce,s}function dI(s,a,h){var g=a[0],S=a[1],A=a[2],w=a[3],c=a[4],k=a[5],N=a[6],H=a[7],K=a[8],ae=a[9],ue=a[10],ge=a[11],fe=a[12],ce=a[13],qe=a[14],Fe=a[15],Ne=h[0],Be=h[1],Pe=h[2],$e=h[3];return s[0]=Ne*g+Be*c+Pe*K+$e*fe,s[1]=Ne*S+Be*k+Pe*ae+$e*ce,s[2]=Ne*A+Be*N+Pe*ue+$e*qe,s[3]=Ne*w+Be*H+Pe*ge+$e*Fe,Ne=h[4],Be=h[5],Pe=h[6],$e=h[7],s[4]=Ne*g+Be*c+Pe*K+$e*fe,s[5]=Ne*S+Be*k+Pe*ae+$e*ce,s[6]=Ne*A+Be*N+Pe*ue+$e*qe,s[7]=Ne*w+Be*H+Pe*ge+$e*Fe,Ne=h[8],Be=h[9],Pe=h[10],$e=h[11],s[8]=Ne*g+Be*c+Pe*K+$e*fe,s[9]=Ne*S+Be*k+Pe*ae+$e*ce,s[10]=Ne*A+Be*N+Pe*ue+$e*qe,s[11]=Ne*w+Be*H+Pe*ge+$e*Fe,Ne=h[12],Be=h[13],Pe=h[14],$e=h[15],s[12]=Ne*g+Be*c+Pe*K+$e*fe,s[13]=Ne*S+Be*k+Pe*ae+$e*ce,s[14]=Ne*A+Be*N+Pe*ue+$e*qe,s[15]=Ne*w+Be*H+Pe*ge+$e*Fe,s}function fI(s,a,h){var g=h[0],S=h[1],A=h[2];return s[0]=a[0]*g,s[1]=a[1]*g,s[2]=a[2]*g,s[3]=a[3]*g,s[4]=a[4]*S,s[5]=a[5]*S,s[6]=a[6]*S,s[7]=a[7]*S,s[8]=a[8]*A,s[9]=a[9]*A,s[10]=a[10]*A,s[11]=a[11]*A,s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15],s}function bw(s,a,h){var g=Math.sin(h),S=Math.cos(h),A=a[4],w=a[5],c=a[6],k=a[7],N=a[8],H=a[9],K=a[10],ae=a[11];return a!==s&&(s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15]),s[4]=A*S+N*g,s[5]=w*S+H*g,s[6]=c*S+K*g,s[7]=k*S+ae*g,s[8]=N*S-A*g,s[9]=H*S-w*g,s[10]=K*S-c*g,s[11]=ae*S-k*g,s}function pI(s,a,h){var g=Math.sin(h),S=Math.cos(h),A=a[0],w=a[1],c=a[2],k=a[3],N=a[8],H=a[9],K=a[10],ae=a[11];return a!==s&&(s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15]),s[0]=A*S-N*g,s[1]=w*S-H*g,s[2]=c*S-K*g,s[3]=k*S-ae*g,s[8]=A*g+N*S,s[9]=w*g+H*S,s[10]=c*g+K*S,s[11]=k*g+ae*S,s}function xw(s,a,h){var g=Math.sin(h),S=Math.cos(h),A=a[0],w=a[1],c=a[2],k=a[3],N=a[4],H=a[5],K=a[6],ae=a[7];return a!==s&&(s[8]=a[8],s[9]=a[9],s[10]=a[10],s[11]=a[11],s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15]),s[0]=A*S+N*g,s[1]=w*S+H*g,s[2]=c*S+K*g,s[3]=k*S+ae*g,s[4]=N*S-A*g,s[5]=H*S-w*g,s[6]=K*S-c*g,s[7]=ae*S-k*g,s}function mI(s,a,h,g,S){var A=1/Math.tan(a/2);if(s[0]=A/h,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=A,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,S!=null&&S!==1/0){var w=1/(g-S);s[10]=(S+g)*w,s[14]=2*S*g*w}else s[10]=-1,s[14]=-2*g;return s}var gI=mI;function sv(){var s=new Dy(3);return Dy!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function yI(s,a,h){var g=new Dy(3);return g[0]=s,g[1]=a,g[2]=h,g}function W0(s,a){var h=a[0],g=a[1],S=a[2],A=h*h+g*g+S*S;return A>0&&(A=1/Math.sqrt(A)),s[0]=a[0]*A,s[1]=a[1]*A,s[2]=a[2]*A,s}function ww(s,a,h){var g=a[0],S=a[1],A=a[2],w=h[0],c=h[1],k=h[2];return s[0]=S*k-A*c,s[1]=A*w-g*k,s[2]=g*c-S*w,s}(function(){var s=sv();return function(a,h,g,S,A,w){var c,k;for(h||(h=3),g||(g=0),S?k=Math.min(S*h+g,a.length):k=a.length,c=g;c<k;c+=h)s[0]=a[c],s[1]=a[c+1],s[2]=a[c+2],A(s,s,w),a[c]=s[0],a[c+1]=s[1],a[c+2]=s[2];return a}})();function _I(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Tw,Sw;function vI(){return Sw||(Sw=1,Tw={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),Tw}var K0,Mw;function qT(){if(Mw)return K0;Mw=1;const s=vI(),a={};for(const S of Object.keys(s))a[s[S]]=S;const h={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};K0=h;for(const S of Object.keys(h)){if(!("channels"in h[S]))throw new Error("missing channels property: "+S);if(!("labels"in h[S]))throw new Error("missing channel labels property: "+S);if(h[S].labels.length!==h[S].channels)throw new Error("channel and label counts mismatch: "+S);const{channels:A,labels:w}=h[S];delete h[S].channels,delete h[S].labels,Object.defineProperty(h[S],"channels",{value:A}),Object.defineProperty(h[S],"labels",{value:w})}h.rgb.hsl=function(S){const A=S[0]/255,w=S[1]/255,c=S[2]/255,k=Math.min(A,w,c),N=Math.max(A,w,c),H=N-k;let K,ae;N===k?K=0:A===N?K=(w-c)/H:w===N?K=2+(c-A)/H:c===N&&(K=4+(A-w)/H),K=Math.min(K*60,360),K<0&&(K+=360);const ue=(k+N)/2;return N===k?ae=0:ue<=.5?ae=H/(N+k):ae=H/(2-N-k),[K,ae*100,ue*100]},h.rgb.hsv=function(S){let A,w,c,k,N;const H=S[0]/255,K=S[1]/255,ae=S[2]/255,ue=Math.max(H,K,ae),ge=ue-Math.min(H,K,ae),fe=function(ce){return(ue-ce)/6/ge+1/2};return ge===0?(k=0,N=0):(N=ge/ue,A=fe(H),w=fe(K),c=fe(ae),H===ue?k=c-w:K===ue?k=1/3+A-c:ae===ue&&(k=2/3+w-A),k<0?k+=1:k>1&&(k-=1)),[k*360,N*100,ue*100]},h.rgb.hwb=function(S){const A=S[0],w=S[1];let c=S[2];const k=h.rgb.hsl(S)[0],N=1/255*Math.min(A,Math.min(w,c));return c=1-1/255*Math.max(A,Math.max(w,c)),[k,N*100,c*100]},h.rgb.cmyk=function(S){const A=S[0]/255,w=S[1]/255,c=S[2]/255,k=Math.min(1-A,1-w,1-c),N=(1-A-k)/(1-k)||0,H=(1-w-k)/(1-k)||0,K=(1-c-k)/(1-k)||0;return[N*100,H*100,K*100,k*100]};function g(S,A){return(S[0]-A[0])**2+(S[1]-A[1])**2+(S[2]-A[2])**2}return h.rgb.keyword=function(S){const A=a[S];if(A)return A;let w=1/0,c;for(const k of Object.keys(s)){const N=s[k],H=g(S,N);H<w&&(w=H,c=k)}return c},h.keyword.rgb=function(S){return s[S]},h.rgb.xyz=function(S){let A=S[0]/255,w=S[1]/255,c=S[2]/255;A=A>.04045?((A+.055)/1.055)**2.4:A/12.92,w=w>.04045?((w+.055)/1.055)**2.4:w/12.92,c=c>.04045?((c+.055)/1.055)**2.4:c/12.92;const k=A*.4124+w*.3576+c*.1805,N=A*.2126+w*.7152+c*.0722,H=A*.0193+w*.1192+c*.9505;return[k*100,N*100,H*100]},h.rgb.lab=function(S){const A=h.rgb.xyz(S);let w=A[0],c=A[1],k=A[2];w/=95.047,c/=100,k/=108.883,w=w>.008856?w**(1/3):7.787*w+16/116,c=c>.008856?c**(1/3):7.787*c+16/116,k=k>.008856?k**(1/3):7.787*k+16/116;const N=116*c-16,H=500*(w-c),K=200*(c-k);return[N,H,K]},h.hsl.rgb=function(S){const A=S[0]/360,w=S[1]/100,c=S[2]/100;let k,N,H;if(w===0)return H=c*255,[H,H,H];c<.5?k=c*(1+w):k=c+w-c*w;const K=2*c-k,ae=[0,0,0];for(let ue=0;ue<3;ue++)N=A+1/3*-(ue-1),N<0&&N++,N>1&&N--,6*N<1?H=K+(k-K)*6*N:2*N<1?H=k:3*N<2?H=K+(k-K)*(2/3-N)*6:H=K,ae[ue]=H*255;return ae},h.hsl.hsv=function(S){const A=S[0];let w=S[1]/100,c=S[2]/100,k=w;const N=Math.max(c,.01);c*=2,w*=c<=1?c:2-c,k*=N<=1?N:2-N;const H=(c+w)/2,K=c===0?2*k/(N+k):2*w/(c+w);return[A,K*100,H*100]},h.hsv.rgb=function(S){const A=S[0]/60,w=S[1]/100;let c=S[2]/100;const k=Math.floor(A)%6,N=A-Math.floor(A),H=255*c*(1-w),K=255*c*(1-w*N),ae=255*c*(1-w*(1-N));switch(c*=255,k){case 0:return[c,ae,H];case 1:return[K,c,H];case 2:return[H,c,ae];case 3:return[H,K,c];case 4:return[ae,H,c];case 5:return[c,H,K]}},h.hsv.hsl=function(S){const A=S[0],w=S[1]/100,c=S[2]/100,k=Math.max(c,.01);let N,H;H=(2-w)*c;const K=(2-w)*k;return N=w*k,N/=K<=1?K:2-K,N=N||0,H/=2,[A,N*100,H*100]},h.hwb.rgb=function(S){const A=S[0]/360;let w=S[1]/100,c=S[2]/100;const k=w+c;let N;k>1&&(w/=k,c/=k);const H=Math.floor(6*A),K=1-c;N=6*A-H,(H&1)!==0&&(N=1-N);const ae=w+N*(K-w);let ue,ge,fe;switch(H){default:case 6:case 0:ue=K,ge=ae,fe=w;break;case 1:ue=ae,ge=K,fe=w;break;case 2:ue=w,ge=K,fe=ae;break;case 3:ue=w,ge=ae,fe=K;break;case 4:ue=ae,ge=w,fe=K;break;case 5:ue=K,ge=w,fe=ae;break}return[ue*255,ge*255,fe*255]},h.cmyk.rgb=function(S){const A=S[0]/100,w=S[1]/100,c=S[2]/100,k=S[3]/100,N=1-Math.min(1,A*(1-k)+k),H=1-Math.min(1,w*(1-k)+k),K=1-Math.min(1,c*(1-k)+k);return[N*255,H*255,K*255]},h.xyz.rgb=function(S){const A=S[0]/100,w=S[1]/100,c=S[2]/100;let k,N,H;return k=A*3.2406+w*-1.5372+c*-.4986,N=A*-.9689+w*1.8758+c*.0415,H=A*.0557+w*-.204+c*1.057,k=k>.0031308?1.055*k**(1/2.4)-.055:k*12.92,N=N>.0031308?1.055*N**(1/2.4)-.055:N*12.92,H=H>.0031308?1.055*H**(1/2.4)-.055:H*12.92,k=Math.min(Math.max(0,k),1),N=Math.min(Math.max(0,N),1),H=Math.min(Math.max(0,H),1),[k*255,N*255,H*255]},h.xyz.lab=function(S){let A=S[0],w=S[1],c=S[2];A/=95.047,w/=100,c/=108.883,A=A>.008856?A**(1/3):7.787*A+16/116,w=w>.008856?w**(1/3):7.787*w+16/116,c=c>.008856?c**(1/3):7.787*c+16/116;const k=116*w-16,N=500*(A-w),H=200*(w-c);return[k,N,H]},h.lab.xyz=function(S){const A=S[0],w=S[1],c=S[2];let k,N,H;N=(A+16)/116,k=w/500+N,H=N-c/200;const K=N**3,ae=k**3,ue=H**3;return N=K>.008856?K:(N-16/116)/7.787,k=ae>.008856?ae:(k-16/116)/7.787,H=ue>.008856?ue:(H-16/116)/7.787,k*=95.047,N*=100,H*=108.883,[k,N,H]},h.lab.lch=function(S){const A=S[0],w=S[1],c=S[2];let k;k=Math.atan2(c,w)*360/2/Math.PI,k<0&&(k+=360);const N=Math.sqrt(w*w+c*c);return[A,N,k]},h.lch.lab=function(S){const A=S[0],w=S[1],c=S[2]/360*2*Math.PI,k=w*Math.cos(c),N=w*Math.sin(c);return[A,k,N]},h.rgb.ansi16=function(S,A=null){const[w,c,k]=S;let N=A===null?h.rgb.hsv(S)[2]:A;if(N=Math.round(N/50),N===0)return 30;let H=30+(Math.round(k/255)<<2|Math.round(c/255)<<1|Math.round(w/255));return N===2&&(H+=60),H},h.hsv.ansi16=function(S){return h.rgb.ansi16(h.hsv.rgb(S),S[2])},h.rgb.ansi256=function(S){const A=S[0],w=S[1],c=S[2];return A===w&&w===c?A<8?16:A>248?231:Math.round((A-8)/247*24)+232:16+36*Math.round(A/255*5)+6*Math.round(w/255*5)+Math.round(c/255*5)},h.ansi16.rgb=function(S){let A=S%10;if(A===0||A===7)return S>50&&(A+=3.5),A=A/10.5*255,[A,A,A];const w=(~~(S>50)+1)*.5,c=(A&1)*w*255,k=(A>>1&1)*w*255,N=(A>>2&1)*w*255;return[c,k,N]},h.ansi256.rgb=function(S){if(S>=232){const N=(S-232)*10+8;return[N,N,N]}S-=16;let A;const w=Math.floor(S/36)/5*255,c=Math.floor((A=S%36)/6)/5*255,k=A%6/5*255;return[w,c,k]},h.rgb.hex=function(S){const A=(((Math.round(S[0])&255)<<16)+((Math.round(S[1])&255)<<8)+(Math.round(S[2])&255)).toString(16).toUpperCase();return"000000".substring(A.length)+A},h.hex.rgb=function(S){const A=S.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!A)return[0,0,0];let w=A[0];A[0].length===3&&(w=w.split("").map(K=>K+K).join(""));const c=parseInt(w,16),k=c>>16&255,N=c>>8&255,H=c&255;return[k,N,H]},h.rgb.hcg=function(S){const A=S[0]/255,w=S[1]/255,c=S[2]/255,k=Math.max(Math.max(A,w),c),N=Math.min(Math.min(A,w),c),H=k-N;let K,ae;return H<1?K=N/(1-H):K=0,H<=0?ae=0:k===A?ae=(w-c)/H%6:k===w?ae=2+(c-A)/H:ae=4+(A-w)/H,ae/=6,ae%=1,[ae*360,H*100,K*100]},h.hsl.hcg=function(S){const A=S[1]/100,w=S[2]/100,c=w<.5?2*A*w:2*A*(1-w);let k=0;return c<1&&(k=(w-.5*c)/(1-c)),[S[0],c*100,k*100]},h.hsv.hcg=function(S){const A=S[1]/100,w=S[2]/100,c=A*w;let k=0;return c<1&&(k=(w-c)/(1-c)),[S[0],c*100,k*100]},h.hcg.rgb=function(S){const A=S[0]/360,w=S[1]/100,c=S[2]/100;if(w===0)return[c*255,c*255,c*255];const k=[0,0,0],N=A%1*6,H=N%1,K=1-H;let ae=0;switch(Math.floor(N)){case 0:k[0]=1,k[1]=H,k[2]=0;break;case 1:k[0]=K,k[1]=1,k[2]=0;break;case 2:k[0]=0,k[1]=1,k[2]=H;break;case 3:k[0]=0,k[1]=K,k[2]=1;break;case 4:k[0]=H,k[1]=0,k[2]=1;break;default:k[0]=1,k[1]=0,k[2]=K}return ae=(1-w)*c,[(w*k[0]+ae)*255,(w*k[1]+ae)*255,(w*k[2]+ae)*255]},h.hcg.hsv=function(S){const A=S[1]/100,w=S[2]/100,c=A+w*(1-A);let k=0;return c>0&&(k=A/c),[S[0],k*100,c*100]},h.hcg.hsl=function(S){const A=S[1]/100,w=S[2]/100*(1-A)+.5*A;let c=0;return w>0&&w<.5?c=A/(2*w):w>=.5&&w<1&&(c=A/(2*(1-w))),[S[0],c*100,w*100]},h.hcg.hwb=function(S){const A=S[1]/100,w=S[2]/100,c=A+w*(1-A);return[S[0],(c-A)*100,(1-c)*100]},h.hwb.hcg=function(S){const A=S[1]/100,w=1-S[2]/100,c=w-A;let k=0;return c<1&&(k=(w-c)/(1-c)),[S[0],c*100,k*100]},h.apple.rgb=function(S){return[S[0]/65535*255,S[1]/65535*255,S[2]/65535*255]},h.rgb.apple=function(S){return[S[0]/255*65535,S[1]/255*65535,S[2]/255*65535]},h.gray.rgb=function(S){return[S[0]/100*255,S[0]/100*255,S[0]/100*255]},h.gray.hsl=function(S){return[0,0,S[0]]},h.gray.hsv=h.gray.hsl,h.gray.hwb=function(S){return[0,100,S[0]]},h.gray.cmyk=function(S){return[0,0,0,S[0]]},h.gray.lab=function(S){return[S[0],0,0]},h.gray.hex=function(S){const A=Math.round(S[0]/100*255)&255,w=((A<<16)+(A<<8)+A).toString(16).toUpperCase();return"000000".substring(w.length)+w},h.rgb.gray=function(S){return[(S[0]+S[1]+S[2])/3/255*100]},K0}var J0,Ew;function bI(){if(Ew)return J0;Ew=1;const s=qT();function a(){const A={},w=Object.keys(s);for(let c=w.length,k=0;k<c;k++)A[w[k]]={distance:-1,parent:null};return A}function h(A){const w=a(),c=[A];for(w[A].distance=0;c.length;){const k=c.pop(),N=Object.keys(s[k]);for(let H=N.length,K=0;K<H;K++){const ae=N[K],ue=w[ae];ue.distance===-1&&(ue.distance=w[k].distance+1,ue.parent=k,c.unshift(ae))}}return w}function g(A,w){return function(c){return w(A(c))}}function S(A,w){const c=[w[A].parent,A];let k=s[w[A].parent][A],N=w[A].parent;for(;w[N].parent;)c.unshift(w[N].parent),k=g(s[w[N].parent][N],k),N=w[N].parent;return k.conversion=c,k}return J0=function(A){const w=h(A),c={},k=Object.keys(w);for(let N=k.length,H=0;H<N;H++){const K=k[H];w[K].parent!==null&&(c[K]=S(K,w))}return c},J0}var Q0,Aw;function xI(){if(Aw)return Q0;Aw=1;const s=qT(),a=bI(),h={},g=Object.keys(s);function S(w){const c=function(...k){const N=k[0];return N==null?N:(N.length>1&&(k=N),w(k))};return"conversion"in w&&(c.conversion=w.conversion),c}function A(w){const c=function(...k){const N=k[0];if(N==null)return N;N.length>1&&(k=N);const H=w(k);if(typeof H=="object")for(let K=H.length,ae=0;ae<K;ae++)H[ae]=Math.round(H[ae]);return H};return"conversion"in w&&(c.conversion=w.conversion),c}return g.forEach(w=>{h[w]={},Object.defineProperty(h[w],"channels",{value:s[w].channels}),Object.defineProperty(h[w],"labels",{value:s[w].labels});const c=a(w);Object.keys(c).forEach(k=>{const N=c[k];h[w][k]=A(N),h[w][k].raw=S(N)})}),Q0=h,Q0}var wI=xI();const TI=_I(wI);function Cw({gl:s,type:a,source:h}){const g=s.createShader(a);if(g===null)throw new Error("Cannot create shader");if(s.shaderSource(g,h),s.compileShader(g),!s.getShaderParameter(g,s.COMPILE_STATUS))throw console.error("Shader compilation error:",s.getShaderInfoLog(g)),s.deleteShader(g),new Error("Cannot compile shader");return g}function SI({gl:s,vertexShaderSource:a,fragmentShaderSource:h}){const g=Cw({gl:s,type:s.VERTEX_SHADER,source:a}),S=Cw({gl:s,type:s.FRAGMENT_SHADER,source:h}),A=s.createProgram();if(s.attachShader(A,g),s.attachShader(A,S),s.linkProgram(A),!s.getProgramParameter(A,s.LINK_STATUS))throw console.error("Error: ",s.getProgramInfoLog(A)),new Error("Cannot link shader program");return A}function MI(s,a,h){const g=s.getUniformLocation(a,h);if(g===null)throw new Error(`Cannot get uniform location for ${h}`);return g}function $T({gl:s,vertexShaderSource:a,fragmentShaderSource:h,attributesKeys:g,uniformsKeys:S,vertices:A,indices:w}){const c=SI({gl:s,vertexShaderSource:a,fragmentShaderSource:h}),k=g.reduce((ue,ge)=>(ue[ge]=s.getAttribLocation(c,`a_${ge}`),ue),{}),N=S.reduce((ue,ge)=>(ue[ge]=MI(s,c,`u_${ge}`),ue),{}),H=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,H),s.bufferData(s.ARRAY_BUFFER,new Float32Array(A),s.STATIC_DRAW);let K,ae;return w!==void 0&&(K=s.createBuffer(),ae=w.length,s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,K),s.bufferData(s.ELEMENT_ARRAY_BUFFER,new Uint16Array(w),s.STATIC_DRAW)),{shaderProgram:c,programInfo:{attributesLocations:k,uniformsLocations:N},positionBuffer:H,indexBuffer:K,indexBufferLength:ae}}function lv(s){if(!s)return[1,1,1,0];if(s==="transparent")return[1,1,1,0];try{const a=EI(s),h=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(a);if(h!=null&&h.length){const S=!!h[4];return[...TI.hex.rgb(a).map(A=>A/255),S?parseInt(h[4],16)/255:1]}const g=a.match(/(\d\.\d(\d+)?|\d{3}|\d{2}|\d{1})/gi)??["0","0","0"];if(a.includes("rgb")){const S=a.includes("rgba"),A=[...g.map(w=>parseFloat(w)).map((w,c)=>c<3?w/255:w)];return S||A.push(1),A}}catch{}return console.warn([`[parseColorStringToVec4]: Color ${s} is either not a valid color or its type is not supported, defaulting to black`]),[0,0,0,1]}let ly;function EI(s){return ly=ly??document.createElement("canvas").getContext("2d"),ly?(ly.fillStyle=s,ly.fillStyle):"#000000"}const Dx=1,Xr=Dx/2,Yr=Dx/2,Wr=Dx/2,AI=[-Xr,-Yr,Wr,Xr,-Yr,Wr,Xr,Yr,Wr,-Xr,Yr,Wr],CI=[-Xr,-Yr,-Wr,-Xr,Yr,-Wr,Xr,Yr,-Wr,Xr,-Yr,-Wr],PI=[-Xr,Yr,-Wr,-Xr,Yr,Wr,Xr,Yr,Wr,Xr,Yr,-Wr],zI=[-Xr,-Yr,-Wr,Xr,-Yr,-Wr,Xr,-Yr,Wr,-Xr,-Yr,Wr],II=[Xr,-Yr,-Wr,Xr,Yr,-Wr,Xr,Yr,Wr,Xr,-Yr,Wr],LI=[-Xr,-Yr,-Wr,-Xr,-Yr,Wr,-Xr,Yr,Wr,-Xr,Yr,-Wr],DI=[...AI,...CI,...PI,...zI,...II,...LI],RI=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],kI=`attribute vec3 a_vertexPosition;
varying vec3 vTextureCoord;

uniform mat4 u_projectionMatrix;
uniform mat4 u_modelViewMatrix;
  
void main(void) {
  vTextureCoord = vec3(-a_vertexPosition.x, a_vertexPosition.y, a_vertexPosition.z);
  gl_Position = u_projectionMatrix * u_modelViewMatrix * vec4(a_vertexPosition, 1.0);
}
`,Pw=`precision mediump float;

varying vec3 vTextureCoord;

%USE_TEXTURE_MACRO_MARKER%

# ifdef USE_TEXTURE
uniform samplerCube u_cubeSampler;
uniform float u_fadeOpacity;
# endif

uniform vec4 u_bgColor;

void main(void) {
  #ifdef USE_TEXTURE
  vec4 texColor = textureCube(u_cubeSampler, vTextureCoord);

    gl_FragColor = mix(
      u_bgColor,
      texColor,
      min(texColor.a, u_fadeOpacity)
    );

    gl_FragColor.a = max(gl_FragColor.a, u_fadeOpacity);

  #else
  gl_FragColor = u_bgColor;
  #endif
}
`,Ap={stars:{color:"hsl(233,100%,92%)",preset:"stars"},space:{color:"hsl(210, 100%, 4%)",preset:"space"},milkyway:{color:"hsl(233,100%,92%)",preset:"milkyway"},"milkyway-subtle":{color:"hsl(233,100%,92%)",preset:"milkyway-subtle"},"milkyway-bright":{color:"hsl(233,100%,92%)",preset:"milkyway-bright"},"milkyway-colored":{color:"black",preset:"milkyway-colored"}};var bp=(s=>(s.POSITIVE_X="pX",s.NEGATIVE_X="nX",s.POSITIVE_Y="pY",s.NEGATIVE_Y="nY",s.POSITIVE_Z="pZ",s.NEGATIVE_Z="nZ",s))(bp||{});const Bm=new Map;function OI(s){const a=Bm.get(s);a&&(Bm.delete(s),s.deleteTexture(a))}const zw=new Map;let Iw;function BI({gl:s,faces:a,onReady:h,forceRefresh:g}){if(Bm.get(s)&&!g&&Iw===JSON.stringify(a)){h(Bm.get(s),zw.get(s));return}Iw=JSON.stringify(a);const S=Bm.get(s)??s.createTexture();if(s.bindTexture(s.TEXTURE_CUBE_MAP,S),!a){console.warn("[CubemapLayer][loadCubemapTexture]: Faces are null");return}const A=Object.keys(a).length;if(A!==6){console.warn(`[CubemapLayer][loadCubemapTexture]: Faces should contain exactly 6 images, but found ${A}`);return}const w=Object.entries(a).map(([c,k])=>new Promise((N,H)=>{const K=c;if(k===void 0){H(new Error(`[CubemapLayer][loadCubemapTexture]: Face ${c} is undefined`));return}const ae=new Image;ae.crossOrigin="anonymous";const ue=()=>{N({image:ae,key:K})};ae.src=k,ae.complete&&ae.naturalWidth>0?ue():ae.onload=ue,ae.onerror=()=>{H(new Error(`[CubemapLayer][loadCubemapTexture]: Error loading image ${k}`))}}));Promise.all(w).then(c=>{for(let N=0;N<c.length;N++){const H=s.RGBA,K=s.RGBA,ae=s.UNSIGNED_BYTE,{image:ue,key:ge}=c[N]??{};if(!ue||!ge){console.warn("[CubemapLayer][loadCubemapTexture]: Image or key is null");continue}const fe=FI(s,ge);s.bindTexture(s.TEXTURE_CUBE_MAP,S),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texImage2D(fe,0,H,K,ae,ue)}s.bindTexture(s.TEXTURE_CUBE_MAP,S),s.generateMipmap(s.TEXTURE_CUBE_MAP),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,s.LINEAR_MIPMAP_LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,s.LINEAR);const k=c.map(N=>N.image);h(S,k),zw.set(s,k),Bm.set(s,S)}).catch(c=>{console.error("[CubemapLayer][loadCubemapTexture]: Error loading cubemap texture",c)})}function FI(s,a){if(a===bp.POSITIVE_X)return s.TEXTURE_CUBE_MAP_POSITIVE_X;if(a===bp.NEGATIVE_X)return s.TEXTURE_CUBE_MAP_NEGATIVE_X;if(a===bp.POSITIVE_Y)return s.TEXTURE_CUBE_MAP_POSITIVE_Y;if(a===bp.NEGATIVE_Y)return s.TEXTURE_CUBE_MAP_NEGATIVE_Y;if(a===bp.POSITIVE_Z)return s.TEXTURE_CUBE_MAP_POSITIVE_Z;if(a===bp.NEGATIVE_Z)return s.TEXTURE_CUBE_MAP_NEGATIVE_Z;throw new Error(`[CubemapLayer][loadCubemapTexture]: Invalid key ${a}`)}function NI(s,a,h){return[ff(s[0],a[0],h),ff(s[1],a[1],h),ff(s[2],a[2],h),ff(s[3],a[3],h)]}function ff(s,a,h){return s+(a-s)*h}function xv(s){if(!s)return{};const a=Object.keys(s).sort().map(h=>[h,s[h]]);return Object.fromEntries(a)}const Dm="https://api.maptiler.com/resources/space",jI=["vertexPosition"],UI=["projectionMatrix","modelViewMatrix","cubeSampler","bgColor","fadeOpacity"],Lw="%USE_TEXTURE_MACRO_MARKER%",VI="#define USE_TEXTURE",Dw=Ap.stars;function GI(s,a){if(!Sb(s))return{color:"transparent"};if(s===!0)return a;const h={...s};if(s.faces||s.path)return delete h.preset,h;const g=s.preset;if(g!==void 0&&!(g in Ap))throw new Error(`[CubemapLayer]: Invalid preset "${g}". Available presets: ${Object.keys(Ap).join(", ")}`);return{...h,color:h.color??Ap[g].color??"hsl(233,100%,92%)"}}class eb{constructor(a){Wt(this,"id","Cubemap Layer"),Wt(this,"type","custom"),Wt(this,"renderingMode","3d"),Wt(this,"map"),Wt(this,"faces"),Wt(this,"useCubemapTexture",!0),Wt(this,"currentFadeOpacity",0),Wt(this,"cubeMapNeedsUpdate",!1),Wt(this,"bgColor"),Wt(this,"previousBgColor",[0,0,0,0]),Wt(this,"targetBgColor",[0,0,0,0]),Wt(this,"transitionDelta",0),Wt(this,"gl"),Wt(this,"cubemap"),Wt(this,"texture"),Wt(this,"currentFacesDefinitionKey",""),Wt(this,"options"),Wt(this,"animationActive",!0),Wt(this,"imageIsAnimating",!1),Wt(this,"imageFadeInDelta",0);const h=GI(a,Dw);this.options=h,this.currentFacesDefinitionKey=JSON.stringify(h.faces??h.preset??h.path),this.bgColor=[0,0,0,0],this.targetBgColor=lv(h.color),this.faces=Rw(h),this.useCubemapTexture=this.faces!==null}updateCubemap({facesNeedUpdate:a}={facesNeedUpdate:!0}){this.useCubemapTexture=this.faces!==null;const h=UI.filter(g=>g==="cubeSampler"||g==="fadeOpacity"?this.useCubemapTexture:!0);this.cubemap=$T({gl:this.gl,vertexShaderSource:kI,fragmentShaderSource:this.useCubemapTexture?Pw.replace(Lw,VI):Pw.replace(Lw,""),attributesKeys:jI,uniformsKeys:h,vertices:DI,indices:RI}),this.cubeMapNeedsUpdate=a,this.useCubemapTexture&&this.updateTexture(this.gl,this.faces),this.animateColorChange()}onAdd(a,h){this.map=a,this.gl=h,this.updateCubemap()}onRemove(a,h){this.cubemap&&(this.texture&&(OI(h),this.texture=void 0),h.deleteProgram(this.cubemap.shaderProgram),h.deleteBuffer(this.cubemap.positionBuffer))}updateTexture(a,h){if(this.cubeMapNeedsUpdate===!0&&!this.imageIsAnimating){if(this.cubeMapNeedsUpdate=!1,!this.useCubemapTexture)return;BI({gl:a,faces:h,onReady:g=>{this.texture=g,this.animateIn()}})}}prerender(a,h){this.faces&&this.updateTexture(this.gl,this.faces)}animateColorChange(){const a=()=>{this.transitionDelta<1&&(requestAnimationFrame(a),this.bgColor=NI(this.previousBgColor,this.targetBgColor,this.transitionDelta),this.transitionDelta+=.075,this.map.triggerRepaint())};requestAnimationFrame(a)}async animateIn(){if(!this.imageIsAnimating){if(!this.animationActive){this.currentFadeOpacity=1,this.imageFadeInDelta=1,this.map.triggerRepaint();return}return new Promise(a=>{this.imageIsAnimating=!0;const h=()=>{if(this.imageFadeInDelta=Math.min(this.imageFadeInDelta+.05,1),this.currentFadeOpacity=ff(0,1,this.imageFadeInDelta),this.map.triggerRepaint(),this.imageFadeInDelta<1){requestAnimationFrame(h);return}this.imageIsAnimating=!1,this.imageFadeInDelta=0,a()};requestAnimationFrame(h)})}}async animateOut(){if(!(this.imageIsAnimating||!this.animationActive))return new Promise(a=>{const h=()=>{if(this.imageFadeInDelta=Math.min(this.imageFadeInDelta+.05,1),this.currentFadeOpacity=ff(1,0,this.imageFadeInDelta),this.map.triggerRepaint(),this.imageFadeInDelta>=1){this.imageIsAnimating=!1,this.imageFadeInDelta=0,a();return}requestAnimationFrame(h)};requestAnimationFrame(h)})}setAnimationActive(a){this.animationActive=a}render(a,h){if(!this.map.isGlobeProjection())return;if(this.map===void 0)throw new Error("[CubemapLayer]: Map is undefined");if(this.cubemap===void 0)throw new Error("[CubemapLayer]: Cubemap is undefined");this.texture,a.disable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.DST_ALPHA),a.useProgram(this.cubemap.shaderProgram),a.bindBuffer(a.ARRAY_BUFFER,this.cubemap.positionBuffer),a.vertexAttribPointer(this.cubemap.programInfo.attributesLocations.vertexPosition,3,a.FLOAT,!1,0,0),a.enableVertexAttribArray(this.cubemap.programInfo.attributesLocations.vertexPosition);const g=.1,S=1e4,A=a.canvas,w=A.clientWidth/A.clientHeight,c=this.map.transform,k=c.fov*(Math.PI/180),N=vy();gI(N,k,w,g,S),xw(N,N,c.rollInRadians),bw(N,N,-c.pitchInRadians),xw(N,N,c.bearingInRadians);const H=c.center.lat*Math.PI/180,K=c.center.lng*Math.PI/180;bw(N,N,H),pI(N,N,-K),a.uniformMatrix4fv(this.cubemap.programInfo.uniformsLocations.projectionMatrix,!1,N);const ae=vy();if(a.uniformMatrix4fv(this.cubemap.programInfo.uniformsLocations.modelViewMatrix,!1,ae),a.uniform4fv(this.cubemap.programInfo.uniformsLocations.bgColor,new Float32Array(this.bgColor)),a.uniform1f(this.cubemap.programInfo.uniformsLocations.fadeOpacity,this.currentFadeOpacity),this.useCubemapTexture&&this.texture&&(a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,this.texture),a.uniform1i(this.cubemap.programInfo.uniformsLocations.cubeSampler,0)),this.cubemap.indexBuffer===void 0)throw new Error("Index buffer is undefined");if(this.cubemap.indexBufferLength===void 0)throw new Error("Index buffer length is undefined");a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.cubemap.indexBuffer),a.drawElements(a.TRIANGLES,this.cubemap.indexBufferLength,a.UNSIGNED_SHORT,0)}setBgColor(a){this.targetBgColor=a,this.previousBgColor=this.bgColor,this.transitionDelta=0}getConfig(){return this.options}shouldUpdate(a){const h=this.getConfig();if(a===void 0&&h)return!0;const g=typeof a=="boolean"?a:xv(a),S=xv(h);return JSON.stringify(g)!==JSON.stringify(S)}async setCubemapFaces(a){if(await this.animateOut(),!a.faces&&!a.preset&&!a.path){this.faces=null,this.useCubemapTexture=!1,this.currentFacesDefinitionKey="empty",await this.animateIn();return}this.faces=Rw(a),this.currentFacesDefinitionKey=JSON.stringify(a.faces??a.preset??a.path)}async setCubemap(a){const h=typeof a=="boolean"?Dw:a;this.options=h;const g=JSON.stringify(h.faces??h.preset??h.path),S=this.currentFacesDefinitionKey!==g;S&&(await this.setCubemapFaces(h),this.cubeMapNeedsUpdate=!0);const A=lv(h.color);if(h.color&&this.targetBgColor.toString()!==A.toString())this.setBgColor(A);else if(!h.color&&h.preset&&h.preset in Ap){const w=Ap[h.preset];this.setBgColor(lv(w.color))}this.updateCubemap({facesNeedUpdate:S})}show(){this.map.setLayoutProperty(this.id,"visibility","visible")}hide(){this.map.setLayoutProperty(this.id,"visibility","none")}}function Sb(s){return s?typeof s=="boolean"?!0:!(!s.path&&!s.preset&&!s.faces&&!s.color||s.preset&&!(s.preset in Ap)||s.faces&&(!s.faces.pX||!s.faces.nX||!s.faces.pY||!s.faces.nY||!s.faces.pZ||!s.faces.nZ)):!1}function Rw(s){if(s.faces)return s.faces;if(s.preset)return{pX:`${Dm}/${s.preset}/px.webp`,nX:`${Dm}/${s.preset}/nx.webp`,pY:`${Dm}/${s.preset}/py.webp`,nY:`${Dm}/${s.preset}/ny.webp`,pZ:`${Dm}/${s.preset}/pz.webp`,nZ:`${Dm}/${s.preset}/nz.webp`};if(s.path){const a=s.path.baseUrl,h=s.path.format??"png";return{pX:`${a}/px.${h}`,nX:`${a}/nx.${h}`,pY:`${a}/py.${h}`,nY:`${a}/ny.${h}`,pZ:`${a}/pz.${h}`,nZ:`${a}/nz.${h}`}}return null}const ZI=`attribute vec3 a_position;

uniform mat4 u_matrix;
uniform mat4 u_rotationMatrix;

uniform float u_scale;

varying vec2 v_pos;
varying float v_scale;

void main() {
  v_scale = u_scale;
  v_pos = a_position.xy * u_scale;
  gl_Position = u_matrix * u_rotationMatrix * vec4(a_position, 1.0);
}
`,qI=`precision mediump float;
varying vec2 v_pos;
      
uniform int u_stopsNumber;
uniform float u_stops[100];
uniform vec4 u_colors[100];
uniform float u_maxDistance;

varying float v_scale;

const float EPSILON = 0.000001;

vec2 center = vec2(0.0, 0.0);
void main() {
  float rawDistance = distance(center, v_pos);
  float distanceFromGlobeEdge = rawDistance - 1.0;

    vec4 color = u_colors[0];

  // if we're further than the max distance, we should not render anything.
  // This is to always render a circle, otherwise we end up rendering
  // to the corners of the plane.
  if (distance(center, v_pos) > u_maxDistance * v_scale) {
    discard;
  }

  for (int i = 1; i < 100; i++) {
    // if we're past the last stop
    // we should fill to the end with the last stop color
    if (i >= u_stopsNumber) {
      color = u_colors[i - 1];
      break;
    }

    float scaledStopPosition = u_stops[i] * pow(v_scale, 1.6);
    float lastStopValue = u_stops[i - 1];
    float thisStopValue = u_stops[i];

    // this is to avoid blending errors when the stops are the same
    // eg when you would want a sharp edge between two stops.
    // \`numbersAreEqual\` will be 1.0 if the numbers are equal, 0.0 if they are not.
    // We then subtract EPSILON from the last stop making the stop value _almost_ equal
    // to the next stop but not enough to cause blending issues.
    // It's more efficient to do this than an if / else statement.
    float numbersAreEqual = 1.0 - step(EPSILON, abs(lastStopValue - thisStopValue));
    lastStopValue = lastStopValue - numbersAreEqual * EPSILON;

    float lastScaledStopPosition = lastStopValue * pow(v_scale, 1.6);

    if (distanceFromGlobeEdge <= scaledStopPosition) {
      float stopBlendFactor = (distanceFromGlobeEdge - lastScaledStopPosition) / (scaledStopPosition - lastScaledStopPosition);
      color = mix(u_colors[i - 1], u_colors[i], stopBlendFactor);
      break;
    }
  }
  
  // gl_FragColor = color;
  gl_FragColor = vec4(color.rgb * color.a, color.a);
}
`,ud=2,$I=["position"],HI=["matrix","rotationMatrix","stopsNumber","stops","colors","maxDistance","scale"],XI=[-ud,-ud,0,ud,-ud,0,-ud,ud,0,ud,ud,0],J_=[[0,"rgba(176, 208, 240, 1)"],[.1,"rgba(98, 168, 229, 0.3)"],[.2,"rgba(98, 168, 229, 0.0)"]],Q_=.9,kw=.06;class tb{constructor(a){if(Wt(this,"id","Halo Layer"),Wt(this,"type","custom"),Wt(this,"renderingMode","3d"),Wt(this,"gradient"),Wt(this,"scale",0),Wt(this,"animationDelta",0),Wt(this,"map"),Wt(this,"plane"),Wt(this,"animationActive",!0),typeof a=="boolean"){this.gradient={scale:Q_,stops:J_};return}const h=Ow(a);if(h.length>0)throw new Error(`[RadialGradientLayer]: Invalid Halo specification:
 - ${h.join(`
 - `)}
    `);this.gradient={scale:a.scale??Q_,stops:a.stops??J_}}onAdd(a,h){this.map=a,this.plane=$T({gl:h,vertexShaderSource:ZI,fragmentShaderSource:qI,attributesKeys:$I,uniformsKeys:HI,vertices:XI}),this.animateIn()}getConfig(){return this.gradient}shouldUpdate(a){const h=this.getConfig();if(a===void 0&&h)return!0;const g=typeof a=="boolean"?a:xv(a),S=xv(h);return JSON.stringify(g)!==JSON.stringify(S)}async animateIn(){if(!this.animationActive){this.scale=this.gradient.scale,this.animationDelta=1,this.map.triggerRepaint();return}return new Promise(a=>{this.animationDelta=0;const h=()=>{if(this.animationDelta<=1){this.scale=ff(0,this.gradient.scale,this.animationDelta),this.animationDelta+=kw,this.map.triggerRepaint(),requestAnimationFrame(h);return}a()};requestAnimationFrame(h)})}async animateOut(){if(this.animationActive)return this.animationDelta=0,new Promise(a=>{const h=()=>{if(this.animationDelta<1){this.scale=ff(this.gradient.scale,0,this.animationDelta),this.animationDelta+=kw,this.map.triggerRepaint(),requestAnimationFrame(h);return}a()};h()})}onRemove(a,h){this.plane!==void 0&&(h.deleteProgram(this.plane.shaderProgram),h.deleteBuffer(this.plane.positionBuffer))}prerender(a,h){}render(a,h){if(this.map===void 0)throw new Error("[RadialGradientLayer]: Map is undefined");if(!this.map.isGlobeProjection())return;if(this.plane===void 0)throw new Error("[RadialGradientLayer]: Plane is undefined");a.disable(a.DEPTH_TEST),a.enable(a.BLEND),a.useProgram(this.plane.shaderProgram),a.bindBuffer(a.ARRAY_BUFFER,this.plane.positionBuffer);const g=this.plane.programInfo.attributesLocations.position;a.enableVertexAttribArray(g),a.vertexAttribPointer(g,3,a.FLOAT,!1,0,0);const S=vy(),A=this.scale;fI(S,S,[A,A,A]);const w=vy();dI(w,h.defaultProjectionData.mainMatrix,S);const c=this.plane.programInfo.uniformsLocations.matrix;a.uniformMatrix4fv(c,!1,w);const k=vy(),N=this.map.transform.cameraPosition,H=W0(sv(),N),K=yI(0,1,0),ae=sv();ww(ae,K,H),W0(ae,ae);const ue=sv();ww(ue,H,ae),W0(ue,ue),hI(k,ae[0],ae[1],ae[2],0,ue[0],ue[1],ue[2],0,H[0],H[1],H[2],0,0,0,0,1);const ge=this.plane.programInfo.uniformsLocations.rotationMatrix;a.uniformMatrix4fv(ge,!1,k);const fe=this.gradient.stops.length,ce=[],qe=[];for(let Fe=0;Fe<=fe;Fe++)if(Fe<fe){ce[Fe]=this.gradient.stops[Fe][0];const Ne=lv(this.gradient.stops[Fe][1]);qe.push(...Ne)}a.uniform1i(this.plane.programInfo.uniformsLocations.stopsNumber,fe),a.uniform1fv(this.plane.programInfo.uniformsLocations.stops,new Float32Array(ce)),a.uniform4fv(this.plane.programInfo.uniformsLocations.colors,new Float32Array(qe)),a.uniform1f(this.plane.programInfo.uniformsLocations.maxDistance,ud),a.uniform1f(this.plane.programInfo.uniformsLocations.scale,A),a.drawArrays(a.TRIANGLE_STRIP,0,4)}async setGradient(a){if(a===!1){await this.animateOut();return}await this.animateOut();const h=Ow(a);if(h.length>0)throw new Error(`[RadialGradientLayer]: Invalid Halo specification:
 - ${h.join(`
 - `)}
    `);a===!0?(this.gradient.scale=Q_,this.gradient.stops=J_):(this.gradient.scale=a.scale??Q_,this.gradient.stops=a.stops??J_),await this.animateIn()}setAnimationActive(a){this.animationActive=a}show(){this.map.setLayoutProperty(this.id,"visibility","visible")}hide(){this.map.setLayoutProperty(this.id,"visibility","none")}}const YI=["scale","stops"];function Ow(s){var a;const h=[];if(typeof s=="boolean")return[];try{const g=Object.keys(s).filter(S=>!YI.includes(S));g.length>0&&h.push(`Properties ${g.map(S=>`\`${S}\``).join(", ")} are not supported.`)}catch{h.push("Halo specification is not an object.")}return typeof s.scale!="number"&&h.push("Halo `scale` property is not a number."),(!s.stops||s.stops.length===0)&&h.push("Halo `stops` property is not an array."),(a=s.stops)!=null&&a.some(g=>typeof g[0]!="number"||typeof g[1]!="string")&&h.push("Halo `stops` property is not an array of [number, string]"),h}function WI(){const s="color: #3A1888; background: white; padding: 5px 0; font-weight: bold;",a="color: #FBC935; background: white; padding: 5px; font-weight: bold;",h="color: #F1175D; background: white; padding: 5px 0; font-weight: bold;";console.info(`%c%c%c %cMapTiler SDK JS v${lS()} %c%c%c`,a+"padding-right: 0;",s,h,"color: #333; background: white; padding: 5px 0; font-weight: bold;",h,s,a+"padding-left: 0;")}const KI={POINT:"POINT",COUNTRY:"COUNTRY"};let HT=class XT extends si.Map{constructor(a){a.logSDKVersion!==!1&&WI(),kP(a.container),a.apiKey&&(ba.apiKey=a.apiKey);const{style:h,requiresUrlMonitoring:g,isFallback:S}=yw(a.style);S&&console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style."),ba.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");const A=location.hash;let w={compact:!1};a.customAttribution?w.customAttribution=a.customAttribution:a.attributionControl&&typeof a.attributionControl=="object"&&(w={...w,...a.attributionControl});const c={...a,style:h,maplibreLogo:!1,transformRequest:Y1(a.transformRequest),attributionControl:a.forceNoAttributionControl===!0?!1:w};delete c.style,super(c),Wt(this,"telemetry"),Wt(this,"space"),Wt(this,"halo"),Wt(this,"options"),Wt(this,"isTerrainEnabled",!1),Wt(this,"terrainExaggeration",1),Wt(this,"primaryLanguage"),Wt(this,"terrainGrowing",!1),Wt(this,"terrainFlattening",!1),Wt(this,"minimap"),Wt(this,"forceLanguageUpdate"),Wt(this,"languageAlwaysBeenStyle"),Wt(this,"isReady",!1),Wt(this,"terrainAnimationDuration",1e3),Wt(this,"monitoredStyleUrls"),Wt(this,"styleInProcess",!1),Wt(this,"curentProjection"),Wt(this,"originalLabelStyle",new window.Map),Wt(this,"isStyleLocalized",!1),Wt(this,"languageIsUpdated",!1),Wt(this,"spaceboxLoadingState",{styleLoadCallbackSet:!1,styleLoadedCallbackFired:!1}),this.options=a,this.setStyle(h),g&&this.monitorStyleUrl(h);const k=()=>{let ue="The distant style could not be loaded.";this.getStyle()?ue+=" Leaving the style as is.":(this.setStyle(gy.STREETS),ue+=`Loading default MapTiler Cloud style "${gy.STREETS.getDefaultVariant().getId()}" as a fallback.`),console.warn(ue)};if(this.on("style.load",()=>{this.styleInProcess=!1,(typeof a.rtlTextPlugin=="string"||typeof a.rtlTextPlugin>"u")&&IP(a.rtlTextPlugin)}),this.on("error",ue=>{if(ue.error instanceof si.AJAXError){const ge=ue.error.url,fe=new URL(ge);fe.search="";const ce=fe.href;this.monitoredStyleUrls&&this.monitoredStyleUrls.has(ce)&&(this.monitoredStyleUrls.delete(ce),k());return}if(this.styleInProcess){k();return}}),ba.caching&&!pb&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),ba.caching&&pb&&zP(),typeof a.language>"u")this.primaryLanguage=ba.primaryLanguage;else{const ue=j1(a.language,An);this.primaryLanguage=ue??ba.primaryLanguage}this.forceLanguageUpdate=!(this.primaryLanguage===An.STYLE||this.primaryLanguage===An.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===An.STYLE,this.terrainExaggeration=a.terrainExaggeration??this.terrainExaggeration,this.curentProjection=a.projection,this.on("style.load",ue=>{this.curentProjection==="mercator"?this.setProjection({type:"mercator"}):this.curentProjection==="globe"&&this.setProjection({type:"globe"})}),this.once("styledata",async()=>{if(!a.geolocate||a.center||a.hash&&A)return;try{if(a.geolocate===KI.COUNTRY){await this.fitToIpBounds();return}}catch(ge){console.warn(ge.message)}let ue;try{await this.centerOnIpPoint(a.zoom),ue=this.getCameraHash()}catch(ge){console.warn(ge.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(ge=>{ue===this.getCameraHash()&&(this.terrain?this.easeTo({center:[ge.coords.longitude,ge.coords.latitude],zoom:a.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[ge.coords.longitude,ge.coords.latitude],zoom:a.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let ue={logo:null};try{const ge=Object.keys(this.style.tileManagers).map(ce=>this.getSource(ce)).filter(ce=>ce&&"url"in ce&&typeof ce.url=="string"&&ce.url.includes("tiles.json")),fe=new URL(ge[0].url);fe.searchParams.has("key")||fe.searchParams.append("key",ba.apiKey),ue=await(await fetch(fe.href)).json()}catch{}if(a.customControls){const ge="[data-maptiler-control-group]",fe="[data-maptiler-control]",ce=Pe=>{let $e=Pe.dataset.maptilerControl;return($e==="true"||$e==="")&&($e=void 0),$e},qe=Pe=>Pe.dataset.maptilerPosition;let Fe=[...this._container.ownerDocument.querySelectorAll(ge)],Ne=[...this._container.ownerDocument.querySelectorAll(fe)].filter(Pe=>Pe.closest(ge)===null);if(typeof a.customControls=="string"){const Pe=a.customControls;Fe=Fe.filter($e=>$e.matches(Pe)||$e.closest(Pe)!==null),Ne=Ne.filter($e=>$e.matches(Pe)||$e.closest(Pe)!==null)}for(const Pe of Fe){const $e=new Tb(Pe);this.addControl($e,qe(Pe));for(const Qe of Pe.querySelectorAll(fe))$e.configureGroupItem(Qe,ce(Qe))}for(const Pe of Ne)this.addControl(new Tb(Pe,ce(Pe)),qe(Pe));const Be=()=>{const{lng:Pe,lat:$e}=this.getCenter();this._container.style.setProperty("--maptiler-center-lng",String(Pe)),this._container.style.setProperty("--maptiler-center-lat",String($e)),this._container.style.setProperty("--maptiler-zoom",String(this.getZoom())),this._container.style.setProperty("--maptiler-bearing",String(this.getBearing())),this._container.style.setProperty("--maptiler-pitch",String(this.getPitch())),this._container.style.setProperty("--maptiler-roll",String(this.getRoll())),this._container.style.setProperty("--maptiler-is-globe-projection",String(this.isGlobeProjection())),this._container.style.setProperty("--maptiler-has-terrain",String(this.hasTerrain()))};Be(),this.on("render",Be)}if(a.forceNoAttributionControl!==!0)if("logo"in ue&&ue.logo){const ge=ue.logo;this.addControl(new q1({logoURL:ge}),a.logoPosition)}else a.maptilerLogo&&this.addControl(new q1,a.logoPosition);if(a.scaleControl){const ge=a.scaleControl===!0||a.scaleControl===void 0?"bottom-right":a.scaleControl,fe=new wP({unit:ba.unit});this.addControl(fe,ge),ba.on("unit",ce=>{fe.setUnit(ce)})}if(a.navigationControl!==!1){const ge=a.navigationControl===!0||a.navigationControl===void 0?"top-right":a.navigationControl;this.addControl(new aI,ge)}if(a.geolocateControl!==!1){const ge=a.geolocateControl===!0||a.geolocateControl===void 0?"top-right":a.geolocateControl;this.addControl(new sI({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),ge)}if(a.terrainControl){const ge=a.terrainControl===!0||a.terrainControl===void 0?"top-right":a.terrainControl;this.addControl(new rI,ge)}if(a.projectionControl){const ge=a.projectionControl===!0||a.projectionControl===void 0?"top-right":a.projectionControl;this.addControl(new uI,ge)}if(a.fullscreenControl){const ge=a.fullscreenControl===!0||a.fullscreenControl===void 0?"top-right":a.fullscreenControl;this.addControl(new TP({}),ge)}this.isReady=!0,this.fire("ready",{target:this})});let N=!1,H=!1,K;this.once("ready",()=>{N=!0,H&&this.fire("loadWithTerrain",K)}),this.once("style.load",()=>{const{minimap:ue}=a;if(typeof ue=="object"){const{zoom:ge,center:fe,style:ce,language:qe,apiKey:Fe,maptilerLogo:Ne,canvasContextAttributes:Be,refreshExpiredTiles:Pe,maxBounds:$e,scrollZoom:Qe,minZoom:Et,maxZoom:Ut,boxZoom:$t,locale:hi,fadeDuration:li,crossSourceCollisions:nn,clickTolerance:Ci,bounds:Qi,fitBoundsOptions:lt,pixelRatio:Pt,validateStyle:Mt}=a;this.minimap=new Y0(ue,{zoom:ge,center:fe,style:ce,language:qe,apiKey:Fe,container:"null",maptilerLogo:Ne,canvasContextAttributes:Be,refreshExpiredTiles:Pe,maxBounds:$e,scrollZoom:Qe,minZoom:Et,maxZoom:Ut,boxZoom:$t,locale:hi,fadeDuration:li,crossSourceCollisions:nn,clickTolerance:Ci,bounds:Qi,fitBoundsOptions:lt,pixelRatio:Pt,validateStyle:Mt}),this.addControl(this.minimap,ue.position??"bottom-left")}else ue===!0?(this.minimap=new Y0({},a),this.addControl(this.minimap,"bottom-left")):ue!==void 0&&ue!==!1&&(this.minimap=new Y0({},a),this.addControl(this.minimap,ue))});const ae=ue=>{ue.terrain&&(H=!0,K={type:"loadWithTerrain",target:this,terrain:ue.terrain},this.off("terrain",ae),N&&this.fire("loadWithTerrain",K))};this.on("terrain",ae),a.terrain&&this.enableTerrain(a.terrainExaggeration??this.terrainExaggeration),this.once("load",()=>{this.getCanvas().addEventListener("webglcontextlost",ge=>{if(this._removed===!0){console.warn("[webglcontextlost]","WebGL context lost after map removal. This is harmless.");return}console.warn("[webglcontextlost]","Unexpected loss of WebGL context!"),this.fire("webglContextLost",ge)});const ue=this.getLayersOrder()[0];a.space&&this.initSpace({options:a,before:ue}),a.halo&&this.initHalo({options:a,before:ue})}),this.telemetry=new cI(this)}getSpace(){return this.space}setSpace(a,h=!0){if(h&&(this.options.space=a),a===!1){this.space=void 0;return}if(this.space){this.space.setCubemap(a),this.getLayer(this.space.id)||this.addLayer(this.space,this.getLayersOrder()[0]);return}this.space=new eb(a),this.once("load",()=>{const g=this.getLayersOrder()[0];this.space&&this.addLayer(this.space,g)})}enableSpaceAnimations(){this.setSpaceAnimationActive(!0)}disableSpaceAnimations(){this.setSpaceAnimationActive(!1)}enableHaloAnimations(){this.setHaloAnimationActive(!0)}disableHaloAnimations(){this.setHaloAnimationActive(!1)}setHaloAnimationActive(a){this.halo?this.halo.setAnimationActive(a):this.once("load",()=>{var h;(h=this.halo)==null||h.setAnimationActive(a)})}setSpaceAnimationActive(a){this.space?this.space.setAnimationActive(a):this.once("load",()=>{var h;(h=this.space)==null||h.setAnimationActive(a)})}setSpaceFromStyle({style:a}){var h,g,S,A,w;if(this.options.space===!1)return;if(this.options.space!==!0&&Sb(this.options.space)){this.setSpace(this.options.space);return}const c=(g=(h=a.metadata)==null?void 0:h.maptiler)==null?void 0:g.space,k=Sb(c);if(JSON.stringify((S=this.space)==null?void 0:S.getConfig())===JSON.stringify(c)){if(this.space&&!this.getLayer(this.space.id)){const N=this.getLayersOrder()[0];this.addLayer(this.space,N)}return}if(k){this.setSpace(c,!1);return}if(this.options.space===!0){this.setSpace(!0);return}if((A=this.space)!=null&&A.getConfig()&&c===void 0){this.setSpace({color:"transparent"},!1),this.removeLayer(((w=this.space)==null?void 0:w.id)??"");return}if(this.space&&this.isGlobeProjection()){if(!this.getLayer(this.space.id)){const N=this.getLayersOrder()[0];this.addLayer(this.space,N)}this.space.setCubemap(c)}}setHaloFromStyle({style:a}){var h,g,S;if(this.options.halo===!1)return;const A=(h=a.metadata)==null?void 0:h.maptiler;if(JSON.stringify((g=this.halo)==null?void 0:g.getConfig())===JSON.stringify(A?.halo)){if(this.halo&&!this.getLayer(this.halo.id)){const w=this.getLayersOrder().indexOf(((S=this.space)==null?void 0:S.id)??"")+1,c=this.getLayersOrder()[w];this.addLayer(this.halo,c)}return}if(!(A!=null&&A.halo)&&!this.options.halo){this.setHalo({stops:[[0,"transparent"],[.01,"transparent"]],scale:1});return}(()=>{var w;if(this.halo){if(!this.getLayer(this.halo.id)){const k=this.getLayersOrder().indexOf(((w=this.space)==null?void 0:w.id)??"")+1,N=this.getLayersOrder()[k];this.addLayer(this.halo,N)}const c=A?.halo??this.options.halo;c&&this.halo.setGradient(c)}})()}initSpace({options:a=this.options,before:h,spec:g}){if(this.space){this.getLayer(this.space.id)||this.addLayer(this.space,h);return}if(a.space===!1)return;if(a.space){this.space=new eb(a.space),this.addLayer(this.space,h);return}const S=g;S&&(this.space=new eb(S),this.addLayer(this.space,h))}initHalo({options:a=this.options,before:h,spec:g}){if(this.halo&&this.getLayer(this.halo.id)||a.halo===!1)return;const S=g;if(a.halo){this.halo=new tb(a.halo),this.addLayer(this.halo,h);return}S&&(this.halo=new tb(S),this.addLayer(this.halo,h))}getHalo(){return this.halo}setHalo(a){if(this.options.halo=a,!!this.isGlobeProjection()){if(this.halo){this.halo.setGradient(a);return}this.halo=new tb(a),this.once("load",()=>{var h;const g=this.getLayersOrder(),S=g[0],A=g.indexOf(((h=this.space)==null?void 0:h.id)??"")+2,w=g[A];this.halo&&this.addLayer(this.halo,this.space?w:S)})}}recreate(){const a={center:this.getCenter(),zoom:this.getZoom(),bearing:this.getBearing(),pitch:this.getPitch()};this.remove(),Object.assign(this,new XT({...this.options})),this.once("load",()=>{this.jumpTo(a)})}setTerrainAnimationDuration(a){this.terrainAnimationDuration=Math.max(a,0)}async onLoadAsync(){return new Promise(a=>{if(this.loaded()){a(this);return}this.once("load",()=>{a(this)})})}async onReadyAsync(){return new Promise(a=>{if(this.isReady){a(this);return}this.once("ready",()=>{a(this)})})}async onLoadWithTerrainAsync(){return new Promise(a=>{if(this.isReady&&this.terrain){a(this);return}this.once("loadWithTerrain",()=>{a(this)})})}monitorStyleUrl(a){typeof this.monitoredStyleUrls>"u"&&(this.monitoredStyleUrls=new Set);const h=new URL(a);h.search="",this.monitoredStyleUrls.add(h.href)}setStyle(a,h){var g,S,A,w,c;this.originalLabelStyle.clear(),(g=this.minimap)==null||g.setStyle(a),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1});const k=yw(a);if(k.requiresUrlMonitoring&&this.monitorStyleUrl(k.style),k.isFallback){if(this.getStyle())return console.warn("[Map.setStyle]: Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Keeping the curent style instead."),this;console.warn("[Map.setStyle]: Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style.")}this.spaceboxLoadingState.styleLoadedCallbackFired=!1,this.spaceboxLoadingState.styleLoadCallbackSet=!1;const N=this.getStyle(),H=k.style;try{super.setStyle(k.style,{...h,diff:typeof k.style!="string"}),this.styleInProcess=!0}catch(ue){this.styleInProcess=!1,console.error("[Map.setStyle]: Error while setting style:",ue)}const K=()=>{const ue=k.style;if(!ue.projection||ue.projection.type==="mercator"){console.warn("[Map.setStyle]: Neither space nor halo is supported for mercator projection. Ignoring...");return}this.setSpaceFromStyle({style:k.style}),this.setHaloFromStyle({style:k.style})},ae=ue=>{var ge,fe,ce,qe;const Fe=ue?.target.getStyle()??k.style;if(!this.spaceboxLoadingState.styleLoadedCallbackFired&&(this.spaceboxLoadingState.styleLoadedCallbackFired=!0,this.spaceboxLoadingState.styleLoadCallbackSet=!1,typeof Fe!="string"))try{const Ne=this.getLayersOrder()[0];this.space?this.setSpaceFromStyle({style:Fe}):this.initSpace({before:Ne,spec:(fe=(ge=Fe.metadata)==null?void 0:ge.maptiler)==null?void 0:fe.space}),this.halo?this.setHaloFromStyle({style:Fe}):this.initHalo({before:Ne,spec:(qe=(ce=Fe.metadata)==null?void 0:ce.maptiler)==null?void 0:qe.halo})}catch(Ne){console.error(Ne)}};return typeof k.style=="string"||k.requiresUrlMonitoring?(this.once("style.load",ae),this):(requestIdleCallback(()=>{try{ae()}catch(ue){console.error(ue)}}),this.spaceboxLoadingState.styleLoadCallbackSet?((S=N?.terrain)==null?void 0:S.source)!==((A=H?.terrain)==null?void 0:A.source)||((w=N?.terrain)==null?void 0:w.exaggeration)!==((c=H?.terrain)==null?void 0:c.exaggeration)?(this.once("terrain",K),this):this:(this.once("style.load",ae),this.once("projection.change",ae),this.spaceboxLoadingState.styleLoadCallbackSet=!0,this))}addLayer(a,h){var g;return(g=this.minimap)==null||g.addLayer(a,h),super.addLayer(a,h)}moveLayer(a,h){var g;return(g=this.minimap)==null||g.moveLayer(a,h),super.moveLayer(a,h)}removeLayer(a){var h;return(h=this.minimap)==null||h.removeLayer(a),super.removeLayer(a)}setLayerZoomRange(a,h,g){var S;return(S=this.minimap)==null||S.setLayerZoomRange(a,h,g),super.setLayerZoomRange(a,h,g)}setFilter(a,h,g){var S;return(S=this.minimap)==null||S.setFilter(a,h,g),super.setFilter(a,h,g)}setPaintProperty(a,h,g,S){var A;return(A=this.minimap)==null||A.setPaintProperty(a,h,g,S),super.setPaintProperty(a,h,g,S)}setLayoutProperty(a,h,g,S){var A;return(A=this.minimap)==null||A.setLayoutProperty(a,h,g,S),super.setLayoutProperty(a,h,g,S)}setGlyphs(a,h){var g;return(g=this.minimap)==null||g.setGlyphs(a,h),super.setGlyphs(a,h)}getStyleLanguage(){return!this.style||!this.style.stylesheet||!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?hb(this.style.stylesheet.metadata["maptiler:language"]):null}setLanguage(a){var h;(h=this.minimap)==null||h.map.setLanguage(a),this.onStyleReady(()=>{this.setPrimaryLanguage(a)})}setPrimaryLanguage(a){const h=this.getStyleLanguage(),g=j1(a,An);if(!g){console.warn(`The language "${g}" is not supported.`);return}if(!(g.flag===An.STYLE.flag&&h&&(h.flag===An.AUTO.flag||h.flag===An.VISITOR.flag))&&(g.flag!==An.STYLE.flag&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===g&&!this.forceLanguageUpdate))return;if(this.primaryLanguage.flag===An.STYLE_LOCK.flag){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=g;let S=g;if(g.flag===An.STYLE.flag){if(!h){console.warn("The style has no default languages or has an invalid one.");return}S=h}let A=An.LOCAL.flag,w=["get",A];S.flag===An.VISITOR.flag?(A=Z1().flag,w=["case",["all",["has",A],["has",An.LOCAL.flag]],["case",["==",["get",A],["get",An.LOCAL.flag]],["get",An.LOCAL.flag],["format",["get",A],{"font-scale":.8},`
`,["get",An.LOCAL.flag],{"font-scale":1.1}]],["get",An.LOCAL.flag]]):S.flag===An.VISITOR_ENGLISH.flag?(A=An.ENGLISH.flag,w=["case",["all",["has",A],["has",An.LOCAL.flag]],["case",["==",["get",A],["get",An.LOCAL.flag]],["get",An.LOCAL.flag],["format",["get",A],{"font-scale":.8},`
`,["get",An.LOCAL.flag],{"font-scale":1.1}]],["get",An.LOCAL.flag]]):S.flag===An.AUTO.flag?(A=Z1().flag,w=["coalesce",["get",A],["get",An.LOCAL.flag]]):S===An.LOCAL?(A=An.LOCAL.flag,w=["get",A]):(A=S.flag,w=["coalesce",["get",A],["get",An.LOCAL.flag]]);const{layers:c}=this.getStyle(),k=this.originalLabelStyle.size===0;if(k){const N=VP(c,this);this.isStyleLocalized=Object.keys(N.localized).length>0}for(const N of c){if(N.type!=="symbol")continue;const H=N,K=this.getSource(H.source);if(!K||!("url"in K&&typeof K.url=="string")||new URL(K.url).host!==Ys.maptilerApiHost)continue;const{id:ae,layout:ue}=H;if(!ue||!("text-field"in ue))continue;let ge;if(k?(ge=this.getLayoutProperty(ae,"text-field"),this.originalLabelStyle.set(ae,ge)):ge=this.originalLabelStyle.get(ae),typeof ge=="string"){const{contains:fe,exactMatch:ce}=BP(ge,this.isStyleLocalized);if(!fe)continue;if(ce)this.setLayoutProperty(ae,"text-field",w);else{const qe=FP(ge,w,this.isStyleLocalized);this.setLayoutProperty(ae,"text-field",qe)}}else{const fe=OP(ge,w,this.isStyleLocalized);this.setLayoutProperty(ae,"text-field",fe)}}this.languageIsUpdated=!0}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(a){if(!this.terrain)return;const h=performance.now(),g=this.terrain.exaggeration,S=a-g,A=()=>{if(!this.terrain||this.terrainFlattening)return;const w=(performance.now()-h)/this.terrainAnimationDuration;if(w<.99){const c=1-(1-w)**4,k=g+c*S;this.terrain.exaggeration=k,requestAnimationFrame(A)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=a,this.fire("terrainAnimationStop",{terrain:this.terrain});this._elevationFreeze=!1,this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(A)}enableTerrain(a=this.terrainExaggeration){if(a<0){console.warn("Terrain exaggeration cannot be negative.");return}const h=S=>{!this.terrain||S.type!=="data"||S.dataType!=="source"||!("source"in S)||S.sourceId!=="maptiler-terrain"||S.source.type!=="raster-dem"||S.isSourceLoaded&&(this.off("data",h),this.growTerrain(a))},g=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=a,this.on("data",h),this.addSource(Ys.terrainSourceId,{type:"raster-dem",url:Ys.terrainSourceURL}),this.setTerrain({source:Ys.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(a);return}if(this.loaded()||this.isTerrainEnabled)g();else{const S=()=>{this.getTerrain()&&this.getSource(Ys.terrainSourceId)||g()};this.once("load",()=>{S()}),this.once("moveend",()=>{S()})}}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const a=performance.now(),h=this.terrain.exaggeration,g=()=>{if(!this.terrain||this.terrainGrowing)return;const S=(performance.now()-a)/this.terrainAnimationDuration;if(this._elevationFreeze=!1,S<.99){const A=(1-S)**4,w=h*A;this.terrain.exaggeration=w,requestAnimationFrame(g)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(Ys.terrainSourceId)&&this.removeSource(Ys.terrainSourceId),this.fire("terrainAnimationStop",{terrain:null});this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(g)}setTerrainExaggeration(a,h=!0){!h&&this.terrain?(this.terrainExaggeration=a,this.terrain.exaggeration=a,this.triggerRepaint()):this.enableTerrain(a)}onStyleReady(a){this.isStyleLoaded()?a():this.once("styledata",()=>{a()})}async fitToIpBounds(){const a=await V1.info();this.fitBounds(a.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(a){const h=await V1.info();this.jumpTo({center:[h.longitude??0,h.latitude??0],zoom:a||11})}getCameraHash(){const a=new Float32Array(5),h=this.getCenter();return a[0]=h.lng,a[1]=h.lat,a[2]=this.getZoom(),a[3]=this.getPitch(),a[4]=this.getBearing(),YC.fromUint8Array(new Uint8Array(a.buffer))}getSdkConfig(){return ba}getMaptilerSessionId(){return hx}setTransformRequest(a){return super.setTransformRequest(Y1(a)),this}getProjection(){const a=this.style.getProjection();return!a===void 0&&this.style.projection?{type:this.style.projection.name}:a}isGlobeProjection(){const a=this.getProjection();return a?a.type==="globe":!1}enableGlobeProjection(){this.isGlobeProjection()!==!0&&(this.setProjection({type:"globe"}),this.curentProjection="globe")}enableMercatorProjection(){this.isGlobeProjection()!==!1&&(this.setProjection({type:"mercator"}),this.curentProjection="mercator")}setProjection(a){return this.fire("projection.change",{target:this,projection:a}),super.setProjection(a)}isLanguageUpdated(){return this.languageIsUpdated}};const{Evented:jL}=si,{Evented:UL}=si;function Rx(s){if(typeof DOMParser<"u"){const a=new DOMParser().parseFromString(s,"application/xml");if(a.querySelector("parsererror"))throw new Error("The provided string is not valid XML");return a}throw new Error("No XML parser found")}function YT(s,a){if(!s.hasChildNodes())return!1;for(const h of Array.from(s.childNodes)){const g=h.nodeName;if(typeof g=="string"&&g.trim().toLowerCase()===a.toLowerCase())return!0}return!1}function Bw(s){if(typeof XMLSerializer<"u")return new XMLSerializer().serializeToString(s);throw new Error("No XML serializer found")}function WT(s){const a=typeof s=="string"?Rx(s):s;if(!YT(a,"gpx"))throw new Error("The XML document is not valid GPX");const h=Ro(a,"trk"),g=Ro(a,"rte"),S=Ro(a,"wpt"),A={type:"FeatureCollection",features:[]};for(const w of Array.from(h)){const c=tL(w);c&&A.features.push(c)}for(const w of Array.from(g)){const c=iL(w);c&&A.features.push(c)}for(const w of Array.from(S))A.features.push(nL(w));return A}function KT(s,a){let h=s;if(typeof h=="string"&&(h=Rx(h)),!YT(h,"kml"))throw new Error("The XML document is not valid KML");const g={type:"FeatureCollection",features:[]},S={},A={},w={},c=Ro(h,"Placemark"),k=Ro(h,"Style"),N=Ro(h,"StyleMap");for(const H of Array.from(k)){const K=Nw(Bw(H)).toString(16);S[`#${Cp(H,"id")}`]=K,A[K]=H}for(const H of Array.from(N)){S[`#${Cp(H,"id")}`]=Nw(Bw(H)).toString(16);const K=Ro(H,"Pair"),ae={};for(const ue of Array.from(K))ae[$n(Ii(ue,"key"))??""]=$n(Ii(ue,"styleUrl"));w[`#${Cp(H,"id")}`]=ae}for(const H of Array.from(c))g.features=g.features.concat(eL(H,S,A,w));return g}function Fw(s){if(s===null)return["#000000",1];let a="",h=1,g=s;return g.startsWith("#")&&(g=g.substring(1)),(g.length===6||g.length===3)&&(a=g),g.length===8&&(h=Number.parseInt(g.substring(0,2),16)/255,a=`#${g.substring(6,8)}${g.substring(4,6)}${g.substring(2,4)}`),[a??"#000000",h??1]}function JI(s){return eS(s.split(" "))}function QI(s){let a=Ro(s,"coord");const h=[],g=[];a.length===0&&(a=Ro(s,"gx:coord"));for(const A of Array.from(a))h.push(JI($n(A)??""));const S=Ro(s,"when");for(const A of Array.from(S))g.push($n(A));return{coords:h,times:g}}function uv(s){const a=["Polygon","LineString","Point","Track","gx:Track"];let h,g,S,A,w;const c=[],k=[];if(Ii(s,"MultiGeometry")!==null)return uv(Ii(s,"MultiGeometry"));if(Ii(s,"MultiTrack")!==null)return uv(Ii(s,"MultiTrack"));if(Ii(s,"gx:MultiTrack")!==null)return uv(Ii(s,"gx:MultiTrack"));for(S=0;S<a.length;S++)if(g=Ro(s,a[S]),g){for(A=0;A<g.length;A++)if(h=g[A],a[S]==="Point")c.push({type:"Point",coordinates:tS($n(Ii(h,"coordinates"))??"")});else if(a[S]==="LineString")c.push({type:"LineString",coordinates:Uw($n(Ii(h,"coordinates"))??"")});else if(a[S]==="Polygon"){const N=Ro(h,"LinearRing"),H=[];for(w=0;w<N.length;w++)H.push(Uw($n(Ii(N[w],"coordinates"))??""));c.push({type:"Polygon",coordinates:H})}else if(a[S]==="Track"||a[S]==="gx:Track"){const N=QI(h);c.push({type:"LineString",coordinates:N.coords}),N.times.length&&k.push(N.times)}}return{geoms:c,coordTimes:k}}function eL(s,a,h,g){const S=uv(s),A={},w=$n(Ii(s,"name")),c=$n(Ii(s,"address")),k=$n(Ii(s,"description")),N=Ii(s,"TimeSpan"),H=Ii(s,"TimeStamp"),K=Ii(s,"ExtendedData"),ae=Ii(s,"visibility");let ue,ge=$n(Ii(s,"styleUrl")),fe=Ii(s,"LineStyle"),ce=Ii(s,"PolyStyle");if(!S.geoms.length)return[];if(w&&(A.name=w),c&&(A.address=c),ge){ge.startsWith("#")||(ge=`#${ge}`),A.styleUrl=ge,a[ge]&&(A.styleHash=a[ge]),g[ge]&&(A.styleMapHash=g[ge],A.styleHash=a[g[ge].normal??""]);const Fe=h[A.styleHash??""];if(Fe){fe||(fe=Ii(Fe,"LineStyle")),ce||(ce=Ii(Fe,"PolyStyle"));const Ne=Ii(Fe,"IconStyle");if(Ne){const Be=Ii(Ne,"Icon");if(Be){const Pe=$n(Ii(Be,"href"));Pe&&(A.icon=Pe)}}}}if(k&&(A.description=k),N){const Fe=$n(Ii(N,"begin")),Ne=$n(Ii(N,"end"));Fe&&Ne&&(A.timespan={begin:Fe,end:Ne})}if(H!==null&&(A.timestamp=$n(Ii(H,"when"))??new Date().toISOString()),fe!==null){const Fe=Fw($n(Ii(fe,"color"))),Ne=Fe[0],Be=Fe[1],Pe=Number.parseFloat($n(Ii(fe,"width"))??"");Ne&&(A.stroke=Ne),Number.isNaN(Be)||(A["stroke-opacity"]=Be),Number.isNaN(Pe)||(A["stroke-width"]=Pe)}if(ce){const Fe=Fw($n(Ii(ce,"color"))),Ne=Fe[0],Be=Fe[1],Pe=$n(Ii(ce,"fill")),$e=$n(Ii(ce,"outline"));Ne&&(A.fill=Ne),Number.isNaN(Be)||(A["fill-opacity"]=Be),Pe&&(A["fill-opacity"]=Pe==="1"?A["fill-opacity"]||1:0),$e&&(A["stroke-opacity"]=$e==="1"?A["stroke-opacity"]||1:0)}if(K){const Fe=Ro(K,"Data"),Ne=Ro(K,"SimpleData");for(ue=0;ue<Fe.length;ue++)A[Fe[ue].getAttribute("name")??""]=$n(Ii(Fe[ue],"value"))??"";for(ue=0;ue<Ne.length;ue++)A[Ne[ue].getAttribute("name")??""]=$n(Ne[ue])??""}ae!==null&&(A.visibility=$n(ae)??""),S.coordTimes.length!==0&&(A.coordTimes=S.coordTimes.length===1?S.coordTimes[0]:S.coordTimes);const qe={type:"Feature",geometry:S.geoms.length===1?S.geoms[0]:{type:"GeometryCollection",geometries:S.geoms},properties:A};return Cp(s,"id")&&(qe.id=Cp(s,"id")??void 0),[qe]}function JT(s,a){const h=Ro(s,a),g=[],S=[];let A=[];const w=h.length;if(!(w<2)){for(let c=0;c<w;c++){const k=iS(h[c]);g.push(k.coordinates),k.time&&S.push(k.time),(k.heartRate||A.length)&&(A.length===0&&(A=new Array(c).fill(null)),A.push(k.heartRate))}return{line:g,times:S,heartRates:A}}}function tL(s){const a=Ro(s,"trkseg"),h=[],g=[],S=[];let A;for(let c=0;c<a.length;c++)if(A=JT(a[c],"trkpt"),A!==void 0&&(A.line&&h.push(A.line),A.times&&A.times.length&&g.push(A.times),S.length||A.heartRates&&A.heartRates.length)){if(!S.length)for(let k=0;k<c;k++)S.push(new Array(h[k].length).fill(null));A.heartRates&&A.heartRates.length?S.push(A.heartRates):S.push(new Array(A.line.length).fill(null))}if(h.length===0)return;const w={...kx(s),...QT(Ii(s,"extensions"))};return g.length!==0&&(w.coordTimes=h.length===1?g[0]:g),S.length!==0&&(w.heartRates=h.length===1?S[0]:S),h.length===1?{type:"Feature",properties:w,geometry:{type:"LineString",coordinates:h[0]}}:{type:"Feature",properties:w,geometry:{type:"MultiLineString",coordinates:h}}}function iL(s){const a=JT(s,"rtept");return a===void 0?void 0:{type:"Feature",properties:{...kx(s),...QT(Ii(s,"extensions"))},geometry:{type:"LineString",coordinates:a.line}}}function nL(s){return{type:"Feature",properties:{...kx(s),...Mb(s,["sym"])},geometry:{type:"Point",coordinates:iS(s).coordinates}}}function QT(s){const a={};if(s){const h=Ii(s,"line");if(h){const g=$n(Ii(h,"color")),S=Number.parseFloat($n(Ii(h,"opacity"))??"0"),A=Number.parseFloat($n(Ii(h,"width"))??"0");g&&(a.stroke=g),Number.isNaN(S)||(a["stroke-opacity"]=S),Number.isNaN(A)||(a["stroke-width"]=A*96/25.4)}}return a}function kx(s){const a=Mb(s,["name","cmt","desc","type","time","keywords"]),h=Ro(s,"link");if(h.length!==0){a.links=[];for(const g of Array.from(h)){const S={href:Cp(g,"href"),...Mb(g,["text","type"])};a.links.push(S)}}return a}function Nw(s){let a=0;if(!s||!s.length)return a;for(let h=0;h<s.length;h++)a=(a<<5)-a+s.charCodeAt(h)|0;return a}function Ro(s,a){return s.getElementsByTagName(a)}function Cp(s,a){return s.getAttribute(a)}function jw(s,a){return Number.parseFloat(Cp(s,a)??"0")}function Ii(s,a){const h=Ro(s,a);return h.length?h[0]:null}function rL(s){return s.normalize&&s.normalize(),s}function eS(s){return s.map(Number.parseFloat).map(a=>Number.isNaN(a)?null:a)}function $n(s){return s&&rL(s),s&&s.textContent}function Mb(s,a){const h={};let g,S;for(S=0;S<a.length;S++)g=Ii(s,a[S]),g&&(h[a[S]]=$n(g)??"");return h}function tS(s){return eS(s.replace(/\s*/g,"").split(","))}function Uw(s){const a=s.replace(/^\s*|\s*$/g,"").split(/\s+/),h=[];for(const g of a)h.push(tS(g));return h}function iS(s){const a=[jw(s,"lon"),jw(s,"lat")],h=Ii(s,"ele"),g=Ii(s,"gpxtpx:hr")||Ii(s,"hr"),S=Ii(s,"time");let A;return h&&(A=Number.parseFloat($n(h)??"0"),Number.isNaN(A)||a.push(A)),{coordinates:a,time:S?$n(S):null,heartRate:g!==null?Number.parseFloat($n(g)??"0"):null}}function aL(s){let a=s;try{typeof a=="string"&&(a=Rx(a))}catch{return null}try{return WT(a)}catch{}try{return KT(a)}catch{}return null}async function oL(s,a={}){const h=a.download??!1,g=await sL(s);if(h){const S=a.filename??"maptiler_screenshot.png",A=document.createElement("a");A.style.display="none",document.body.appendChild(A),A.href=URL.createObjectURL(g),A.download=S,A.click(),setTimeout(()=>{document.body.removeChild(A),URL.revokeObjectURL(A.href)},0)}return g}function sL(s){return new Promise((a,h)=>{s.redraw(),s.once("idle",()=>{s.getCanvas().toBlob(g=>{if(!g){h(Error("Screenshot could not be created."));return}a(g)},"image/png")})})}const Eb=[["#1D5B79","#468B97","#EF6262","#F3AA60"],["#614BC3","#33BBC5","#85E6C5","#C8FFE0"],["#461959","#7A316F","#CD6688","#AED8CC"],["#0079FF","#00DFA2","#F6FA70","#FF0060"],["#39B5E0","#A31ACB","#FF78F0","#F5EA5A"],["#37E2D5","#590696","#C70A80","#FBCB0A"],["#FFD36E","#FFF56D","#99FFCD","#9FB4FF"],["#00EAD3","#FFF5B7","#FF449F","#005F99"],["#10A19D","#540375","#FF7000","#FFBF00"]];function Yv(){return Eb[~~(Math.random()*Eb.length)][~~(Math.random()*4)]}function Zy(){return`maptiler_source_${iT()}`}function qy(){return`maptiler_layer_${iT()}`}function Ab(s,a){if(a<=s[0].zoom)return s[0].value;if(a>=s[s.length-1].zoom)return s[s.length-1].value;for(let h=0;h<s.length-1;h+=1)if(a>=s[h].zoom&&a<s[h+1].zoom){const g=s[h+1].zoom-s[h].zoom,S=(a-s[h].zoom)/g;return S*s[h+1].value+(1-S)*s[h].value}return 0}function gf(s){return["interpolate",["linear"],["zoom"],...s.flatMap(a=>[a.zoom,a.value])]}function Vn(s){return["interpolate",["linear"],["zoom"],...s.flatMap(a=>[a.zoom,a.value])]}function nS(s,a){if(typeof a=="number"&&typeof s=="number")return 2*a+s;if(typeof a=="number"&&Array.isArray(s))return["interpolate",["linear"],["zoom"],...s.flatMap(h=>[h.zoom,2*a+h.value])];if(typeof s=="number"&&Array.isArray(a))return["interpolate",["linear"],["zoom"],...a.flatMap(h=>[h.zoom,2*h.value+s])];if(Array.isArray(s)&&Array.isArray(a)){const h=Array.from(new Set([...s.map(g=>g.zoom),...a.map(g=>g.zoom)])).sort((g,S)=>g<S?-1:1);return["interpolate",["linear"],["zoom"],...h.flatMap(g=>[g,2*Ab(a,g)+Ab(s,g)])]}return 0}function rS(s,a){return["interpolate",["linear"],["get",a],...s.flatMap(h=>[h.propertyValue,h.value])]}function Ox(s){const a=s.trimStart(),h=`${a}${" ".repeat(s.length-a.length)}`,g=Array.from(h);if(!g.every(A=>A===" "||A==="_"))throw new Error("A dash pattern must be composed only of whitespace and underscore characters.");if(!(g.some(A=>A==="_")&&g.some(A=>A===" ")))throw new Error("A dash pattern must contain at least one underscore and one whitespace character");const S=[1];for(let A=1;A<g.length;A+=1){const w=g[A-1],c=g[A];w===c?S[S.length-1]+=1:S.push(1)}return S}function Cb(s,a){return["interpolate",["linear"],["get",a],...s.flatMap(h=>[h.value,h.color])]}function Pb(s,a,h=!0){return h?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.value,g.pointRadius*.025])],2,["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.value,g.pointRadius*.05])],4,["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.value,g.pointRadius*.1])],8,["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.value,g.pointRadius*.25])],16,["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.value,g.pointRadius])]]:["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.value,g.pointRadius])]}function aS(s,a,h=!0){return h?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.propertyValue,g.value*.025])],2,["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.propertyValue,g.value*.05])],4,["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.propertyValue,g.value*.1])],8,["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.propertyValue,g.value*.25])],16,["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.propertyValue,g.value])]]:["interpolate",["linear"],["get",a],...s.flatMap(g=>[g.propertyValue,g.value])]}function zb(s,a){return s.every(h=>h.color[3]===s[0].color[3])?s[0].color[3]?s[0].color[3]/255:1:["interpolate",["linear"],["get",a],...s.getRawColorStops().flatMap(h=>{const g=h.value,S=h.color;return[g,S.length===4?S[3]/255:1]})]}function oS(s,a=10){return["interpolate",["linear"],["heatmap-density"],...Array.from({length:a+1},(h,g)=>{const S=g/a;return[S,s.getColorHex(S)]}).flat()]}function ev(s){const a=s.toString(16);return a.length===1?`0${a}`:a}function lL(s){return`#${ev(s[0])}${ev(s[1])}${ev(s[2])}${s.length===4?ev(s[3]):""}`}class bi extends Array{constructor(a={}){super(),Wt(this,"min",0),Wt(this,"max",1),"min"in a&&(this.min=a.min),"max"in a&&(this.max=a.max),"stops"in a&&this.setStops(a.stops,{clone:!1})}static fromArrayDefinition(a){return new bi({stops:a.map(h=>({value:h[0],color:h[1]}))})}setStops(a,h={clone:!0}){const g=h.clone?this.clone():this;g.length=0;let S=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY;for(let w=0;w<a.length;w+=1)S=Math.min(S,a[w].value),A=Math.max(A,a[w].value),g.push({value:a[w].value,color:a[w].color.slice()});return g.sort((w,c)=>w.value<c.value?-1:1),this.min=S,this.max=A,g}scale(a,h,g={clone:!0}){const S=g.clone,A=this[0].value,w=this.at(-1).value-A,c=h-a,k=[];for(let N=0;N<this.length;N+=1){const H=(this[N].value-A)/w*c+a;S?k.push({value:H,color:this[N].color.slice()}):this[N].value=H}return S?new bi({stops:k}):this}at(a){return a<0?this[this.length+a]:this[a]}clone(){return new bi({stops:this.getRawColorStops()})}getRawColorStops(){const a=[];for(let h=0;h<this.length;h+=1)a.push({value:this[h].value,color:this[h].color});return a}reverse(a={clone:!0}){const h=a.clone?this.clone():this;for(let g=0;g<~~(h.length/2);g+=1){const S=h[g].color;h[g].color=h.at(-(g+1)).color,h.at(-(g+1)).color=S}return h}getBounds(){return{min:this.min,max:this.max}}getColor(a,h={smooth:!0}){if(a<=this[0].value)return this[0].color;if(a>=this.at(-1).value)return this.at(-1).color;for(let g=0;g<this.length-1;g+=1){if(a>this[g+1].value)continue;const S=this[g].color;if(!h.smooth)return S.slice();const A=this[g].value,w=this[g+1].value,c=this[g+1].color,k=(w-a)/(w-A);return S.map((N,H)=>Math.round(N*k+c[H]*(1-k)))}return[0,0,0]}getColorHex(a,h={smooth:!0,withAlpha:!1}){return lL(this.getColor(a,h))}getColorRelative(a,h={smooth:!0}){const g=this.getBounds();return this.getColor(g.min+a*(g.max-g.min),h)}getCanvasStrip(a={horizontal:!0,size:512,smooth:!0}){const h=document.createElement("canvas");h.width=a.horizontal?a.size:1,h.height=a.horizontal?1:a.size;const g=h.getContext("2d");if(!g)throw new Error("Canvs context is missing");const S=g.getImageData(0,0,h.width,h.height),A=S.data,w=a.size,c=this[0].value,k=(this.at(-1).value-c)/w;for(let N=0;N<w;N+=1){const H=this.getColor(c+N*k,{smooth:a.smooth});A[N*4]=H[0],A[N*4+1]=H[1],A[N*4+2]=H[2],A[N*4+3]=H.length>3?H[3]:255}return g.putImageData(S,0,0),h}resample(a,h=15){const g=this.getBounds(),S=this.scale(0,1),A=1/(h-1);let w;if(a==="ease-in-square")w=Array.from({length:h},(c,k)=>{const N=k*A,H=N**2,K=S.getColor(H);return{value:N,color:K}});else if(a==="ease-out-square")w=Array.from({length:h},(c,k)=>{const N=k*A,H=1-(1-N)**2,K=S.getColor(H);return{value:N,color:K}});else if(a==="ease-out-sqrt")w=Array.from({length:h},(c,k)=>{const N=k*A,H=N**.5,K=S.getColor(H);return{value:N,color:K}});else if(a==="ease-in-sqrt")w=Array.from({length:h},(c,k)=>{const N=k*A,H=1-(1-N)**.5,K=S.getColor(H);return{value:N,color:K}});else if(a==="ease-out-exp")w=Array.from({length:h},(c,k)=>{const N=k*A,H=1-2**(-10*N),K=S.getColor(H);return{value:N,color:K}});else if(a==="ease-in-exp")w=Array.from({length:h},(c,k)=>{const N=k*A,H=2**(10*N-10),K=S.getColor(H);return{value:N,color:K}});else throw new Error("Invalid ressampling method.");return new bi({stops:w}).scale(g.min,g.max)}transparentStart(){const a=this.getRawColorStops();a.unshift({value:a[0].value,color:a[0].color.slice()}),a[1].value+=.001;for(const h of a)h.color.length===3&&h.color.push(255);return a[0].color[3]=0,new bi({stops:a})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}}const sS={NULL:new bi({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),GRAY:new bi({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),JET:new bi({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new bi({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new bi({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new bi({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new bi({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new bi({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new bi({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new bi({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new bi({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new bi({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new bi({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new bi({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new bi({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new bi({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new bi({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new bi({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new bi({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new bi({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new bi({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new bi({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new bi({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new bi({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new bi({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new bi({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new bi({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new bi({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new bi({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new bi({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new bi({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new bi({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new bi({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new bi({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new bi({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new bi({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new bi({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new bi({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new bi({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new bi({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new bi({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new bi({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new bi({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new bi({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new bi({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new bi({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new bi({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new bi({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new bi({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]})};async function uL(s,a,h={}){var g,S;if(!a.sourceId&&!a.data)throw new Error("Creating a polyline layer requires an existing .sourceId or a valid .data property");let A=a.data;if(typeof A=="string"){if(Lv(A))A=`https://api.maptiler.com/data/${a.data}/features.json?key=${ba.apiKey}`;else if(((g=A.split(".").pop())==null?void 0:g.toLowerCase().trim())==="gpx"){const w=await(await fetch(A,h)).text();A=WT(w)}else if(((S=A.split(".").pop())==null?void 0:S.toLowerCase().trim())==="kml"){const w=await(await fetch(A,h)).text();A=KT(w)}else{const w=DP(A)??aL(A);w&&(A=w)}if(!A)throw new Error("Polyline data was provided as string but is incompatible with valid formats.")}return cL(s,{...a,data:A})}function cL(s,a){if(a.layerId&&s.getLayer(a.layerId))throw new Error(`A layer already exists with the layer id: ${a.layerId}`);const h=a.sourceId??Zy(),g=a.layerId??qy(),S={polylineLayerId:g,polylineOutlineLayerId:"",polylineSourceId:h};a.data&&!s.getSource(h)&&s.addSource(h,{type:"geojson",data:a.data});const A=a.lineWidth??3,w=a.lineColor??Yv(),c=a.lineOpacity??1,k=a.lineBlur??0,N=a.lineGapWidth??0;let H=a.lineDashArray??null;const K=a.outlineWidth??1,ae=a.outlineColor??"#FFFFFF",ue=a.outlineOpacity??1,ge=a.outlineBlur??0;if(typeof H=="string"&&(H=Ox(H)),a.outline===!0){const fe=`${g}_outline`;S.polylineOutlineLayerId=fe,s.addLayer({id:fe,type:"line",source:h,layout:{"line-join":a.lineJoin??"round","line-cap":a.lineCap??"round"},minzoom:a.minzoom??0,maxzoom:a.maxzoom??23,paint:{"line-opacity":typeof ue=="number"?ue:Vn(ue),"line-color":typeof ae=="string"?ae:gf(ae),"line-width":nS(A,K),"line-blur":typeof ge=="number"?ge:Vn(ge)}},a.beforeId)}return s.addLayer({id:g,type:"line",source:h,layout:{"line-join":a.lineJoin??"round","line-cap":a.lineCap??"round"},minzoom:a.minzoom??0,maxzoom:a.maxzoom??23,paint:{"line-opacity":typeof c=="number"?c:Vn(c),"line-color":typeof w=="string"?w:gf(w),"line-width":typeof A=="number"?A:Vn(A),"line-blur":typeof k=="number"?k:Vn(k),"line-gap-width":typeof N=="number"?N:Vn(N),...H&&{"line-dasharray":H}}},a.beforeId),S}function hL(s,a){if(a.layerId&&s.getLayer(a.layerId))throw new Error(`A layer already exists with the layer id: ${a.layerId}`);const h=a.sourceId??Zy(),g=a.layerId??qy(),S={polygonLayerId:g,polygonOutlineLayerId:a.outline?`${g}_outline`:"",polygonSourceId:h};if(a.data&&!s.getSource(h)){let fe=a.data;typeof fe=="string"&&Lv(fe)&&(fe=`https://api.maptiler.com/data/${fe}/features.json?key=${ba.apiKey}`),s.addSource(h,{type:"geojson",data:fe})}let A=a.outlineDashArray??null;const w=a.outlineWidth??1,c=a.outlineColor??"#FFFFFF",k=a.outlineOpacity??1,N=a.outlineBlur??0,H=a.fillColor??Yv(),K=a.fillOpacity??1,ae=a.outlinePosition??"center",ue=a.pattern??null;typeof A=="string"&&(A=Ox(A));const ge=(fe=null)=>{if(s.addLayer({id:g,type:"fill",source:h,minzoom:a.minzoom??0,maxzoom:a.maxzoom??23,paint:{"fill-color":typeof H=="string"?H:gf(H),"fill-opacity":typeof K=="number"?K:Vn(K),...fe&&{"fill-pattern":fe}}},a.beforeId),a.outline===!0){let ce;ae==="inside"?typeof w=="number"?ce=.5*w:ce=Vn(w.map(({zoom:qe,value:Fe})=>({zoom:qe,value:.5*Fe}))):ae==="outside"?typeof w=="number"?ce=-.5*w:ce=Vn(w.map(qe=>({zoom:qe.zoom,value:-.5*qe.value}))):ce=0,s.addLayer({id:S.polygonOutlineLayerId,type:"line",source:h,layout:{"line-join":a.outlineJoin??"round","line-cap":a.outlineCap??"butt"},minzoom:a.minzoom??0,maxzoom:a.maxzoom??23,paint:{"line-opacity":typeof k=="number"?k:Vn(k),"line-color":typeof c=="string"?c:gf(c),"line-width":typeof w=="number"?w:Vn(w),"line-blur":typeof N=="number"?N:Vn(N),"line-offset":ce,...A&&{"line-dasharray":A}}},a.beforeId)}};return ue?s.hasImage(ue)?ge(ue):s.loadImage(ue).then(fe=>{s.addImage(ue,fe.data),ge(ue)}).catch(fe=>{console.error("Could not load the pattern image.",fe.message),ge()}):ge(),S}function dL(s,a){if(a.layerId&&s.getLayer(a.layerId))throw new Error(`A layer already exists with the layer id: ${a.layerId}`);const h=a.minPointRadius??10,g=a.maxPointRadius??50,S=a.cluster??!1,A=20,w=Array.isArray(a.pointColor)?a.pointColor:sS.TURBO.scale(10,a.cluster?1e4:1e3).resample("ease-out-square"),c=w.getBounds(),k=a.sourceId??Zy(),N=a.layerId??qy(),H=a.showLabel??S,K=a.alignOnViewport??!0,ae=a.outline??!1,ue=a.outlineOpacity??1,ge=a.outlineWidth??1,fe=a.outlineColor??"#FFFFFF";let ce;const qe=a.zoomCompensation??!0,Fe=a.minzoom??0,Ne=a.maxzoom??23;typeof a.pointOpacity=="number"?ce=a.pointOpacity:Array.isArray(a.pointOpacity)?ce=Vn(a.pointOpacity):a.cluster?ce=zb(w,"point_count"):a.property?ce=zb(w,a.property):ce=Vn([{zoom:Fe,value:0},{zoom:Fe+.25,value:1},{zoom:Ne-.25,value:1},{zoom:Ne,value:0}]);const Be={pointLayerId:N,clusterLayerId:"",labelLayerId:"",pointSourceId:k};if(a.data&&!s.getSource(k)){let Pe=a.data;typeof Pe=="string"&&Lv(Pe)&&(Pe=`https://api.maptiler.com/data/${Pe}/features.json?key=${ba.apiKey}`),s.addSource(k,{type:"geojson",data:Pe,cluster:S})}if(S){Be.clusterLayerId=`${N}_cluster`;const Pe=Array.from({length:A},($e,Qe)=>{const Et=c.min+Qe*(c.max-c.min)/(A-1);return{value:Et,pointRadius:h+(g-h)*(Qe/(A-1))**.5,color:w.getColorHex(Et)}});s.addLayer({id:Be.clusterLayerId,type:"circle",source:k,filter:["has","point_count"],paint:{"circle-color":typeof a.pointColor=="string"?a.pointColor:Cb(Pe,"point_count"),"circle-radius":typeof a.pointRadius=="number"?a.pointRadius:Array.isArray(a.pointRadius)?Vn(a.pointRadius):Pb(Pe,"point_count",!1),"circle-pitch-alignment":K?"viewport":"map","circle-pitch-scale":"map","circle-opacity":ce,...ae&&{"circle-stroke-opacity":typeof ue=="number"?ue:Vn(ue),"circle-stroke-width":typeof ge=="number"?ge:Vn(ge),"circle-stroke-color":typeof fe=="string"?fe:gf(fe)}},minzoom:Fe,maxzoom:Ne},a.beforeId),s.addLayer({id:Be.pointLayerId,type:"circle",source:k,filter:["!",["has","point_count"]],paint:{"circle-pitch-alignment":K?"viewport":"map","circle-pitch-scale":"map","circle-color":typeof a.pointColor=="string"?a.pointColor:w.getColorHex(w.getBounds().min),"circle-radius":typeof a.pointRadius=="number"?a.pointRadius:Array.isArray(a.pointRadius)?Vn(a.pointRadius):Pe[0].pointRadius*.75,"circle-opacity":ce,...ae&&{"circle-stroke-opacity":typeof ue=="number"?ue:Vn(ue),"circle-stroke-width":typeof ge=="number"?ge:Vn(ge),"circle-stroke-color":typeof fe=="string"?fe:gf(fe)}},minzoom:Fe,maxzoom:Ne},a.beforeId)}else{let Pe=typeof a.pointColor=="string"?a.pointColor:Array.isArray(a.pointColor)?a.pointColor.getColorHex(a.pointColor.getBounds().min):Yv(),$e=typeof a.pointRadius=="number"?qe?Vn([{zoom:0,value:a.pointRadius*.025},{zoom:2,value:a.pointRadius*.05},{zoom:4,value:a.pointRadius*.1},{zoom:8,value:a.pointRadius*.25},{zoom:16,value:a.pointRadius*1}]):a.pointRadius:Array.isArray(a.pointRadius)?Vn(a.pointRadius):qe?Vn([{zoom:0,value:h*.05},{zoom:2,value:h*.1},{zoom:4,value:h*.2},{zoom:8,value:h*.5},{zoom:16,value:h*1}]):h;if(a.property&&Array.isArray(a.pointColor)){const Qe=Array.from({length:A},(Et,Ut)=>{const $t=c.min+Ut*(c.max-c.min)/(A-1);return{value:$t,pointRadius:typeof a.pointRadius=="number"?a.pointRadius:h+(g-h)*(Ut/(A-1))**.5,color:typeof a.pointColor=="string"?a.pointColor:w.getColorHex($t)}});Pe=Cb(Qe,a.property),$e=Pb(Qe,a.property,qe)}s.addLayer({id:Be.pointLayerId,type:"circle",source:k,layout:{"circle-sort-key":a.property?["/",1,["get",a.property]]:0},paint:{"circle-pitch-alignment":K?"viewport":"map","circle-pitch-scale":"map","circle-color":Pe,"circle-opacity":ce,"circle-radius":$e,...ae&&{"circle-stroke-opacity":typeof ue=="number"?ue:Vn(ue),"circle-stroke-width":typeof ge=="number"?ge:Vn(ge),"circle-stroke-color":typeof fe=="string"?fe:gf(fe)}},minzoom:Fe,maxzoom:Ne},a.beforeId)}if(H!==!1&&(a.cluster||a.property)){Be.labelLayerId=`${N}_label`;const Pe=a.labelColor??"#fff",$e=a.labelSize??12;s.addLayer({id:Be.labelLayerId,type:"symbol",source:k,filter:["has",a.cluster?"point_count":a.property],layout:{"text-field":a.cluster?"{point_count_abbreviated}":`{${a.property}}`,"text-font":["Noto Sans Regular"],"text-size":$e,"text-pitch-alignment":K?"viewport":"map","symbol-sort-key":["/",1,["get",a.cluster?"point_count":a.property]]},paint:{"text-color":Pe,"text-opacity":ce},minzoom:Fe,maxzoom:Ne},a.beforeId)}return Be}function fL(s,a){if(a.layerId&&s.getLayer(a.layerId))throw new Error(`A layer already exists with the layer id: ${a.layerId}`);const h=a.sourceId??Zy(),g=a.layerId??qy(),S=a.minzoom??0,A=a.maxzoom??23,w=a.zoomCompensation??!0,c=a.opacity??[{zoom:S,value:0},{zoom:S+.25,value:1},{zoom:A-.25,value:1},{zoom:A,value:0}];let k=Array.isArray(a.colorRamp)?a.colorRamp:sS.TURBO.transparentStart();const N=k.getBounds();(N.min!==0||N.max!==1)&&(k=k.scale(0,1)),k.hasTransparentStart()||(k=k.transparentStart());const H=a.intensity??[{zoom:0,value:.01},{zoom:4,value:.2},{zoom:16,value:1}],K=a.property??null,ae=a.weight??1;let ue=1;K?typeof ae=="number"?(ue=ae,typeof a.weight=="number"&&console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`")):Array.isArray(ae)?ue=rS(ae,K):console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`"):typeof ae=="number"?ue=ae:Array.isArray(ae)&&console.warn("The options `.propertyValueWeights` can only be used when `.property` is provided.");const ge=[{zoom:0,value:50*.025},{zoom:2,value:50*.05},{zoom:4,value:50*.1},{zoom:8,value:50*.25},{zoom:16,value:50}],fe=a.radius??(w?ge:10);let ce=1;typeof fe=="number"?ce=fe:Array.isArray(fe)&&"zoom"in fe[0]?ce=Vn(fe):K&&Array.isArray(fe)&&"propertyValue"in fe[0]?ce=aS(fe,K,w):!K&&Array.isArray(fe)&&"propertyValue"in fe[0]?(ce=Vn(ge),console.warn("The option `.radius` can only be property-driven if the option `.property` is provided.")):ce=Vn(ge);const qe={heatmapLayerId:g,heatmapSourceId:h};if(a.data&&!s.getSource(h)){let Fe=a.data;typeof Fe=="string"&&Lv(Fe)&&(Fe=`https://api.maptiler.com/data/${Fe}/features.json?key=${ba.apiKey}`),s.addSource(h,{type:"geojson",data:Fe})}return s.addLayer({id:g,type:"heatmap",source:h,minzoom:S,maxzoom:A,paint:{"heatmap-weight":ue,"heatmap-intensity":typeof H=="number"?H:Vn(H),"heatmap-color":oS(k),"heatmap-radius":ce,"heatmap-opacity":typeof c=="number"?c:Vn(c)}},a.beforeId),qe}const uy=Object.freeze(Object.defineProperty({__proto__:null,addHeatmap:fL,addPoint:dL,addPolygon:hL,addPolyline:uL,colorDrivenByProperty:Cb,colorPalettes:Eb,computeRampedOutlineWidth:nS,dashArrayMaker:Ox,generateRandomLayerName:qy,generateRandomSourceName:Zy,getRandomColor:Yv,heatmapIntensityFromColorRamp:oS,lerpZoomNumberValues:Ab,opacityDrivenByProperty:zb,paintColorOptionsToPaintSpec:gf,radiusDrivenByProperty:Pb,radiusDrivenByPropertyHeatmap:aS,rampedOptionsToLayerPaintSpec:Vn,rampedPropertyValueWeight:rS,takeScreenshot:oL},Symbol.toStringTag,{value:"Module"}));function lS(){return"3.10.2"}si.Map;si.Marker;si.Popup;si.Style;si.CanvasSource;si.GeoJSONSource;si.ImageSource;si.RasterTileSource;si.RasterDEMTileSource;si.VectorTileSource;si.VideoSource;si.NavigationControl;si.GeolocateControl;si.AttributionControl;si.LogoControl;si.ScaleControl;si.FullscreenControl;si.TerrainControl;si.BoxZoomHandler;si.ScrollZoomHandler;si.CooperativeGesturesHandler;si.KeyboardHandler;si.TwoFingersTouchPitchHandler;si.MapWheelEvent;si.MapTouchEvent;si.MapMouseEvent;si.config;si.getVersion;const{setRTLTextPlugin:VL,getRTLTextPluginStatus:GL,LngLat:ZL,LngLatBounds:qL,MercatorCoordinate:$L,Evented:HL,AJAXError:XL,prewarm:YL,clearPrewarmedResources:WL,Hash:KL,Point:JL,EdgeInsets:QL,DragRotateHandler:e3,DragPanHandler:t3,TwoFingersTouchZoomRotateHandler:i3,DoubleClickZoomHandler:n3,TwoFingersTouchZoomHandler:r3,TwoFingersTouchRotateHandler:a3,getWorkerCount:o3,setWorkerCount:s3,getMaxParallelImageRequests:l3,setMaxParallelImageRequests:u3,getWorkerUrl:c3,setWorkerUrl:h3,addSourceType:d3,importScriptInWorkers:f3,addProtocol:p3,removeProtocol:m3}=si,pL="@maptiler/leaflet-maptilersdk",mL="4.1.1",gL=Dr.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},map:null,initialize:function(s){Dr.setOptions(this,s),this._throttledUpdate=Dr.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(s){var a;this._container||this._initContainer();const h=this.getPaneName();(a=s.getPane(h))==null||a.appendChild(this._container),this._initMaptilerSDK(),this._offset=this._map.containerPointToLayerPoint([0,0]),s.options.zoomAnimation&&Dr.DomEvent.on(s._proxy,Dr.DomUtil.TRANSITION_END,this._transitionEnd,this),s.attributionControl.addAttribution('<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>')},onRemove:function(s){var a;this._map._proxy&&this._map.options.zoomAnimation&&Dr.DomEvent.off(this._map._proxy,Dr.DomUtil.TRANSITION_END,this._transitionEnd,this);const h=this.getPaneName();(a=s.getPane(h))==null||a.removeChild(this._container),this._maptilerMap.remove(),this._maptilerMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaptilerSDKMap:function(){return this._maptilerMap},getCanvas:function(){return this._maptilerMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){const s=this.getSize().multiplyBy(.5),a=this._map.latLngToContainerPoint(this._map.getCenter());return Dr.latLngBounds(this._map.containerPointToLatLng(a.subtract(s)),this._map.containerPointToLatLng(a.add(s)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},setStyle:function(s){this._maptilerMap.setStyle(s)},setLanguage:function(s){this._maptilerMap.setLanguage(s)},_roundPoint:s=>({x:Math.round(s.x),y:Math.round(s.y)}),_initContainer:function(){this._container=Dr.DomUtil.create("div","leaflet-gl-layer");const s=this.getSize(),a=this._map.getSize().multiplyBy(this.options.padding);this._container.style.width=`${s.x}px`,this._container.style.height=`${s.y}px`;const h=this._map.containerPointToLayerPoint([0,0]).subtract(a);Dr.DomUtil.setPosition(this._container,this._roundPoint(h))},_initMaptilerSDK:function(){const s=this._map.getCenter(),a=this.options.maxBounds?this.options.maxBounds:[[Number.NEGATIVE_INFINITY,-90],[Number.POSITIVE_INFINITY,90]];this._map.setMaxBounds(Dr.latLngBounds(Dr.latLng(a[0][1],a[0][0]),Dr.latLng(a[1][1],a[1][0])));const h={maxBounds:a,...this.options,projection:"mercator",container:this._container,center:[s.lng,s.lat],zoom:this._map.getZoom()-1,attributionControl:!1};this.options.geolocate&&(h.center=void 0,h.zoom=void 0),this._maptilerMap=new HT(h),this._maptilerMap.telemetry.registerModule(pL,mL),this._maptilerMap.once("load",()=>{this.fire("ready")}),this._maptilerMap.once("load",async()=>{let S={logo:null};try{const A=Object.keys(this._maptilerMap.style.sourceCaches).map(c=>this._maptilerMap.getSource(c)).filter(c=>c&&"url"in c&&typeof c.url=="string"&&c?.url.includes("tiles.json")),w=new URL(A[0].url);w.searchParams.has("key")||w.searchParams.append("key",h.apiKey),S=await(await fetch(w.href)).json()}catch{}if(S.logo||h.maptilerLogo){const A=S.logo??"https://api.maptiler.com/resources/logo.svg",w=document.createElement("a");w.href="https://www.maptiler.com",w.style.setProperty("position","absolute"),w.style.setProperty("left","10px"),w.style.setProperty("bottom","2px"),w.style.setProperty("z-index","999");const c=document.createElement("img");c.src=A,c.alt="MapTiler logo",c.width=100,c.height=30,w.appendChild(c),this._map.getContainer().appendChild(w)}}),this._maptilerMap.transform.freezeElevation=!0,this.options.geolocate&&this._maptilerMap.on("load",()=>{this._map.setView(this._maptilerMap.getCenter(),this._maptilerMap.getZoom()+1)}),this._transformGL(),this._maptilerMap._actualCanvas=this._maptilerMap._canvas;const g=this._maptilerMap._actualCanvas;Dr.DomUtil.addClass(g,"leaflet-image-layer"),Dr.DomUtil.addClass(g,"leaflet-zoom-animated"),this.options.interactive&&Dr.DomUtil.addClass(g,"leaflet-interactive"),this.options.className&&Dr.DomUtil.addClass(g,this.options.className),this.addHeatmap=S=>uy.addHeatmap(this._maptilerMap,S),this.addPolygon=S=>uy.addPolygon(this._maptilerMap,S),this.addPoint=S=>uy.addPoint(this._maptilerMap,S),this.addPolyline=S=>uy.addPolyline(this._maptilerMap,S),this.takeScreenshot=S=>uy.takeScreenshot(this._maptilerMap,S)},_update:function(){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;const s=this.getSize(),a=this._map.getSize().multiplyBy(this.options.padding),h=this._map.containerPointToLayerPoint([0,0]).subtract(a);Dr.DomUtil.setPosition(this._container,this._roundPoint(h)),this._transformGL(),this._maptilerMap.transform.width!==s.x||this._maptilerMap.transform.height!==s.y?(this._container.style.width=`${s.x}px`,this._container.style.height=`${s.y}px`,this._maptilerMap._resize!==null&&this._maptilerMap._resize!==void 0?this._maptilerMap._resize():this._maptilerMap.resize()):this._maptilerMap._update!==null&&this._maptilerMap._update!==void 0?this._maptilerMap._update():this._maptilerMap.update()},_transformGL:function(){this._maptilerMap.setCenter(this._map.getCenter()),this._maptilerMap.setZoom(this._map.getZoom()-1)},_pinchZoom:function(){this._maptilerMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(s){const a=this._map.getZoomScale(s.zoom),h=this._map.getSize().multiplyBy(this.options.padding*a),g=this.getSize()._divideBy(2),S=this._map.project(s.center,s.zoom)._subtract(g)._add(this._map._getMapPanePos().add(h))._round(),A=this._map.project(this._map.getBounds().getNorthWest(),s.zoom)._subtract(S);Dr.DomUtil.setTransform(this._maptilerMap.getCanvas(),A.subtract(this._offset),a)},_zoomStart:function(){this._zooming=!0},_zoomEnd:function(){const s=this._map.getZoomScale(this._map.getZoom());Dr.DomUtil.setTransform(this._maptilerMap.getCanvas(),new Dr.Point(0,0),s),this._zooming=!1,this._update()},_transitionEnd:function(){Dr.Util.requestAnimFrame(()=>{const s=this._map.getZoom(),a=this._map.getCenter(),h=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());Dr.DomUtil.setTransform(this._maptilerMap._actualCanvas,h,1),this._maptilerMap.once("moveend",Dr.Util.bind(()=>{this._zoomEnd()},this)),this._maptilerMap.jumpTo({center:a,zoom:s-1})},this)},_resize:function(s){this._transitionEnd(s)}});function yL(){const s=ct.useRef(null),a=ct.useRef(null);return ct.useEffect(()=>a.current||!s.current?void 0:(a.current=Dr.map(s.current,{center:[49.2125578,16.62662018],zoom:14}),new gL({apiKey:"NvWSomKHnqk2ky65h9RN"}).addTo(a.current),()=>{a.current&&(a.current.remove(),a.current=null)}),[]),rt.jsx("div",{ref:s,style:{width:"100%",height:"500px"}})}function _L(){return rt.jsxs(Xm,{children:["Maps will include map tiles, routing, scrubbing, jumping to locations, travel pins, flights, etc.",rt.jsx(yL,{})]})}function vL(){const[s,a]=ct.useState(null),[h,g]=ct.useState("1"),[S,A]=ct.useState({}),w=c=>k=>{S[c]=k,A(S)};return rt.jsx(Xm,{align:"stretch",w:"80vw",mx:"auto",style:{overflow:"hidden"},gap:"xs",children:rt.jsxs(Xs,{variant:"none",value:h,onChange:g,children:[rt.jsxs(Xs.List,{ref:a,className:Lm.list,style:{display:"flex",justifyContent:"center"},children:[rt.jsx(Xs.Tab,{value:"1",ref:w("1"),className:Lm.tab,children:"Maps"}),rt.jsx(Xs.Tab,{value:"2",ref:w("2"),className:Lm.tab,children:"Micro-frontends"}),rt.jsx(Xs.Tab,{value:"3",ref:w("3"),className:Lm.tab,children:"AWS"}),rt.jsx(Xs.Tab,{value:"4",ref:w("4"),className:Lm.tab,children:"Games"}),rt.jsx(Jb,{target:h?S[h]:null,parent:s,className:Lm.indicator})]}),rt.jsx(Xs.Panel,{value:"1",children:rt.jsx(_L,{})}),rt.jsx(Xs.Panel,{value:"2",children:"Micro-frontends should showcase module federated widgets like a calculator, Sankey diagram maker, and others"}),rt.jsx(Xs.Panel,{value:"3",children:"AWS could include architectures, learnings, best practices, etc."}),rt.jsx(Xs.Panel,{value:"4",children:"After I finish the WebRTC games I can showcase some learnings there too."})]})})}function bL(){const[s,a]=ct.useState(null),h=rt.jsx(EC,{}),g=async S=>{S.preventDefault();const A=S.currentTarget,w=new FormData(A);w.append("access_key","4f764b66-efef-4656-b7eb-1c426af6d1d7"),(await(await fetch("https://api.web3forms.com/submit",{method:"POST",body:w})).json()).success?(a("Success!"),A.reset()):a("Error")};return rt.jsxs(Xm,{bg:"var(--mantine-color-body)",p:"md",gap:"md",w:"80vw",mx:"auto",align:"center",children:[s&&rt.jsx(Qb,{variant:"light",color:"blue",withCloseButton:!0,title:s,icon:h,onClose:()=>a(null)}),rt.jsxs(Ui,{component:"form",onSubmit:g,w:"100%",style:{textAlign:"left"},children:[rt.jsx(my,{withAsterisk:!0,label:"Name",placeholder:"John Wick",required:!0,type:"text",name:"name",autoComplete:"name"}),rt.jsx(Fm,{h:"md"}),rt.jsx(my,{withAsterisk:!0,label:"Email",placeholder:"your@email.com",required:!0,name:"email",type:"email"}),rt.jsx(Fm,{h:"md"}),rt.jsx(my,{withAsterisk:!0,label:"Message",placeholder:"I'd like to offer you a job!",required:!0,name:"message",type:"text"}),rt.jsx(Yb,{justify:"flex-end",mt:"md",children:rt.jsxs(Fy,{type:"submit",children:["Submit ",rt.jsx(Fm,{})," ",rt.jsx(CC,{})]})})]})]})}LS.createRoot(document.getElementById("root")).render(rt.jsx(ct.StrictMode,{children:rt.jsx(p2,{children:rt.jsx(DM,{children:rt.jsxs(EM,{children:[rt.jsx(tv,{path:"/",element:rt.jsx(PC,{})}),rt.jsx(tv,{path:"/works",element:rt.jsx(vL,{})}),rt.jsx(tv,{path:"/contact",element:rt.jsx(bL,{})})]})})})}));
